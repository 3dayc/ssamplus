!function(){"use strict";var t;(t=String.prototype).trim||(t.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});t.isNumber||(t.isNumber=function(){return!!/^([0-9]+)$/.exec(this)});t.includes||(t.includes=function(t,e){"number"!=typeof e&&(e=0);return!(e+t.length>this.length)&&-1!==this.indexOf(t,e)})}();!function(){"use strict";if(!window.getDframework){var i={}.toString,p={};!function(){function t(t,e){p.versionText=e;p.type=t;return p[t]=parseFloat(e)}var e,i,n=navigator.userAgent,r=null,s=null;p.isWindows=!1;p.isMacosx=!1;p.isLinux=!1;if(e=/Mozilla\/([0-9\.]+)[\s\S]+(Windows NT) ([0-9\.]+);/i.exec(n)){p.isWindows=!0;p.mozilla=parseFloat(e[1]);p.mozillaText=e[1];p.os="windows";p.osText=e[2];p.osVersionText=e[3];p.osVersion=parseFloat(p.osVersionText)}else if(e=/Mozilla\/([0-9\.]+)[\s\S]+Macintosh[\s\S]+(Mac OS X)[\s\S]+/i.exec(n)){p.isMacosx=!0;p.mozilla=parseFloat(e[1]);p.mozillaText=e[1];p.os="macosx";p.osText=e[2];p.osVersionText=""}else if(e=/Mozilla\/([0-9\.]+)/i.exec(n)){if(-1!=n.indexOf("Linux")){p.isLinux=!0;p.os="linux"}else p.os="etc";p.mozilla=parseFloat(e[1]);p.mozillaText=e[1];p.osText="";p.osVersionText=""}else{p.mozilla=0;p.mozillaText="0.0";p.os="etc";p.osText="";p.osVersionText=""}p.gecko=-1!=n.indexOf("Gecko");(e=/[\S\s]+Firefox\/([0-9\.]+)/i.exec(n))&&(i=t("firefox",e[1]));(e=/[\S\s]+Safari\/([0-9\.]+)/i.exec(n))&&(i=t("safari",e[1]));(e=/[\S\s]+Chrome\/([0-9\.]+)/i.exec(n))&&(i=t("chrome",e[1]));(e=/[\S\s]+Whale\/([0-9\.]+)/i.exec(n))&&(i=t("whale",e[1]));(e=/[\S\s]+Edge\/([0-9\.]+)/i.exec(n))&&(i=t("edge",e[1]));(e=/[\S\s]+OPR\/([0-9\.]+)/i.exec(n))&&(i=t("opera",e[1]));!i&&(e=/MSIE[\s\S]+?([0-9\.]+)/i.exec(n))&&(i=t("ie",e[1]));i||-1==n.indexOf("Trident/")||-1==n.indexOf("rv:")||(i=t("ie","11.0"));if(p.opera){p._chrome=p.chrome;p._safari=p.safari;p.chrome=p.safari=null}else if(p.whale){p._chrome=p.chrome;p._safari=p.safari;p.chrome=p.safari=null}else if(p.chrome){p._safari=p.safari;p.safari=null}p.version=i?Math.floor(i):0;!function(){if(-1!=n.indexOf("Windows CE"))r="ce";else if(-1!=n.indexOf("Windows 95"))r="95";else if(-1!=n.indexOf("Windows 98"))r=-1!=n.indexOf("Win9x4.90")?"me":"98";else if(-1!=n.indexOf("Windows NT 4.0"))r="NT 4.0";else if(-1!=n.indexOf("Windows NT 5.0"))r="2000";else if(-1!=n.indexOf("Windows NT 5.01")){r="2000";s="sp1"}else r=-1!=n.indexOf("Windows NT 5.1")?"xp":-1!=n.indexOf("Windows NT 5.2")?"2003":-1!=n.indexOf("Windows NT 6.0")?"vista":-1!=n.indexOf("Windows NT 6.1")?"7":-1!=n.indexOf("Windows NT 6.2")?"8":-1!=n.indexOf("Windows NT 6.3")?"8.1":-1!=n.indexOf("Windows NT 6.4")?"10":null;p.osAlias=r;p.osSp=s;p.osAlias&&(p.isWindows=!0)}();p.isMobile=!0;p.iOS=!1;p.ios=!1;var a=n.toLowerCase();if(e=/Android[\s]+([0-9\.]);/i.exec(n)){p.androidText=e[1];p.android=parseFloat(e[1]);p.android||(p.android=!0)}else if(e=/(Android)/i.exec(n)){if(e=/Android[\s]+([0-9\.]+)/i.exec(n)){p.androidVersion=e[1];p.android=parseFloat(e[1])}p.android||(p.android=!0)}else if(-1!==a.indexOf("android"))p.android=!0;else if(e=/(iPhone)/i.exec(n)){if(e=/[\s]+Version\/([0-9\.]+)/i.exec(n)){p.iphoneVersion=e[1];p.iphone=parseFloat(e[1])}p.iphone||(p.iphone=!0)}else if(-1!==a.indexOf("iphone"))p.iphone=!0;else if(e=/(iPad)/i.exec(n)){if(e=/[\s]+Version\/([0-9\.]+)/i.exec(n)){p.ipadVersion=e[1];p.ipad=parseFloat(e[1])}p.ipad||(p.ipad=!0)}else-1!==a.indexOf("iphone")?p.iphone=!0:(e=/(iPod)/i.exec(n))?p.ipod=!0:(e=/(blackberry)/i.exec(n))?p.blackberry=!0:(e=/(webos)/i.exec(n))?p.webos=!0:(e=/(windows phone)/i.exec(n))?p.windowsPhone=!0:p.isMobile=!1;(p.iphone||p.ipad||p.ipod)&&(p.ios=p.iOS=!0);p.isWindows||delete p.isWindows;p.isMacosx||delete p.isMacosx;p.isLinux||delete p.isLinux;p.isMobile||delete p.isMobile;p.iOS||delete p.iOS;p.ios||delete p.ios;p.androidVersion||delete p.androidVersion;p.android||delete p.android}();var g,m,t,y,h,u,r,c,l=!!window.addEventListener||!window.attachEvent&&undefined,o=(Object.defineProperty,{}),_={},n={},E={},b={},T={},d=function(){var t=!(p.ie&&p.ie<9)&&typeof Element,e=("function"==t||"object"==t)&&Element.prototype;if(e){e._duitest=function(){return this.nodeName};if("a"==document.createElement("a")._duitest().toLowerCase()){delete e._duitest;return!0}delete e._duitest}return!1}(),s="DFWLANG";window.getDframework=function(){return g};(g={version:"0.0.4.4",b:p,bstyle:["-ms-","-webkit-","-khtml-","-moz-","-o-"],error:function(t,e,i,n,r,s,a){try{var o=window.console&&window.console.error,u=g.b;o&&(u.ie?a!==undefined?o(t,e,i,n,r,s,a):s!==undefined?o(t,e,i,n,r,s):r!==undefined?o(t,e,i,n,r):n!==undefined?o(t,e,i,n):i!==undefined?o(t,e,i):e!==undefined?o(t,e):t!==undefined&&o(t):o.apply(this,arguments))}catch(l){}},log:function(t,e,i,n,r,s,a){try{var o=window.console&&window.console.log;o&&(p.ie?a!==undefined?o(t,e,i,n,r,s,a):s!==undefined?o(t,e,i,n,r,s):r!==undefined?o(t,e,i,n,r):n!==undefined?o(t,e,i,n):i!==undefined?o(t,e,i):e!==undefined?o(t,e):t!==undefined&&o(t):o.apply(this,arguments))}catch(u){}},warn:function(t,e,i,n,r,s,a){try{var o=window.console&&window.console.warn;o&&(p.ie?a?o(t,e,i,n,r,s,a):s?o(t,e,i,n,r,s):r?o(t,e,i,n,r):n?o(t,e,i,n):i?o(t,e,i):e?o(t,e):t&&o(t):o.apply(this,arguments))}catch(u){}},toString:function(t){return i.call(t)},scriptUrl:function(t,e){function i(){if(e)throw new TypeError("Not found "+t+" name at script elements.");return!1}var n,r=document.getElementsByTagName("script"),s=r[r.length-1],a=s.src.lastIndexOf("/"),o=-1==a?s.src:s.src.substring(0,a);return(n=new RegExp("[\\S]*/("+t+")\\?{0,1}[\\S]*","i").exec(s.src))?n[1]!==t?i():s.baseurl?s.baseurl:o:i()},setNamespaceUrl:function(t,e){var i=o[t];if(i)return i===e?undefined:g.error("Aleady has namespace. ns: "+t,NaN+i+", new-url: "+e);o[t]=e},getNamespaceUrl:function(t){var e=t.indexOf("/"),i=-1==e?t:t.substring(0,e);return o[i]?o[i]:""},namespaceurl:function(t,e){var i=t.indexOf("/"),n=-1==i?t:t.substring(0,i),r=-1==i?"":t.substring(i),s=e&&"string"==typeof e?0===e.indexOf(".")?e:"."+e:"";return o[n]?o[n]+r+s:t+s},define:function(t,e,i){var n=typeof _[t];if("undefined"!=n&&null!==n)throw new TypeError("Already defined module. name: "+t);var r=typeof e,s=typeof i;if("function"==r)return _[t]=e.apply(this);if("function"!=s)return"undefined"==r&&null===e?e:_[t]=e;var a=[];"string"==r?a.push(_[e]):e.length&&g.each(e,function(t){a.push(_[t])});return _[t]=i.apply(this,a)},module:function(t){var e,i,n,r,s=[];if("string"==typeof t){r=!0;t=[t]}g.each(t,function(t){if(-1!=(e=t.lastIndexOf("#"))){i=t.substring(e+1).trim();t=t.substring(0,e).trim()}n=_[t];i&&(n=n[i]);n&&s.push(n)});return r?s[0]:s},require:function(t,e,i,s){function r(t,n){var r=g.namespaceurl(t),e={url:r,error:function(t){n(null,t||"Not load "+r)},success:function(t,e,i){if(200!=e)return n(null,"Not load "+r+". status: "+e);n(t)}};s&&s.headers&&(e.headers=s.headers);g.ajax(e)}function a(t,e,i,n,r){if(i){if(!e[i])return new Error("Not found module shap special member. name: "+n+", shap: "+i+", loaded-url: "+r);t.push(e[i])}else t.push(e)}function o(t,e,i,n,r){var s;if(i){if(!(s=g.query(e,'[viewid="'+i+'"]')))return new Error("Not found element shap special member. name: "+n+", shap: "+i+", loaded-url: "+r);t.push(s)}else t.push(e)}var u,l,h,c,d,f,p=[],n=[];"string"==typeof t?n.push(t):n=t;m.each.call(this,n,function(i,n){if(0===(i=i.trim()).indexOf("text://")){l="text";i=i.substring(7)}else if(0===i.indexOf("html://")){l="html";i=i.substring(7)}else if(0===i.indexOf("resource://")){l="resource";i=i.substring(11)}if(-1!=(f=i.lastIndexOf("#"))){d=i.substring(f+1).trim();i=i.substring(0,f).trim()}else d=!1;switch(l){case"text":if(!(h=E[i]))return r(i,function(t,e){if(!e){E[i]=t;p.push(t)}n(e)});p.push(h);return n();case"html":return(h=b[i])?n(o(p,h,d,i,u)):(c=E[i])?n(o(p,b[i]=g.element(c),d,i,u)):r(i,function(t,e){if(!e){E[i]=t;return n(o(p,b[i]=g.element(t),d,i,u))}n(e)});case"resource":if(!(h=T[i])){u=g.namespaceurl(i);throw new TypeError("require: Not surport resource mode.")}p.push(h);return n();default:if(!(h=_[i])){u=g.namespaceurl(i,"js");return g.loadScript(u,function(t){t||(t=(h=_[i])?a(p,h,d,i,u):new Error("Not found module. name: "+i+", loaded-url: "+u));n(t)})}err=a(p,h,d,i,u);return n(err)}},function(t){if(t){g.error(t);i&&i.call(this,t)}else e.apply(this,p)})},hasCssString:function(t,e){var i,n=0;if((e=e||document).createStyleSheet&&(i=e.styleSheets)){for(;n<i.length;)if(i[n++].owningElement.id===t)return!0}else if(i=e.getElementsByTagName("style"))for(;n<i.length;)if(i[n++].id===t)return!0;return!1},importCssString:function(t,e,i){i=i||document;if(e&&g.hasCssString(e,i))return null;var n;e&&(t+=" /*# sourceURL=dframework/css/"+e+" */");if(i.createStyleSheet){(n=i.createStyleSheet()).cssText=t;e&&(n.owningElement.id=e)}else{(n=document.createElement("style")).appendChild(i.createTextNode(t));e&&(n.id=e);g.getDocumentHead(i).appendChild(n)}},importCssStylsheet:function(t,e){e||(e=document);if(e.createStyleSheet)e.createStyleSheet(t);else{var i=document.createElement("link");i.rel="stylesheet";i.href=t;g.getDocumentHead(e).appendChild(i)}},parseCss:function(t){for(var e,i,n,r,s,a,o,u,l,h,c=[];;){if(-1==(e=t.indexOf("{"))||-1==(i=t.indexOf("}",e)))return c;if((n=t.substring(0,e).trim())&&(r=t.substring(e+1,i).trim())){a=r.split(";");u=[];for(s=0;s<a.length;s++)-1!=(l=(o=a[s].trim()).indexOf(":"))?(h=o.substring(0,l).trim())&&u.push({name:h,value:o.substring(l+1).trim()}):o&&u.push({name:o,value:""});c.push({name:n,value:r,childs:u})}if(!(t=t.substring(i+1).trim()))return c}},importJteStyleParsed:function(t){function e(t){var e,i,n,r,s,a,o,u="",l={};g.each(t,function(t){if(e=/^(-[\S]+?-)([\S]+)$/i.exec(t.name)){i=e[2];switch(e[0]){case"-ms-zoom":break;default:l[i]||(l[i]=[]);return l[i].push({b:e[1],val:t.value})}}u+=t.name+": "+t.value+"; "});for(r in l){o={text:"",bs:{},val:""};for(a=0;a<l[r].length;a++){s=l[r][a];o.bs[s.b]=1;o.val=s.val;o.text+=s.b+r+": "+s.val+"; "}for(a=0;a<g.bstyle.length;a++){i=g.bstyle[a];if(!o.bs[i]){o.text+=i+r+": "+o.val+"; ";o.bs[i]=2}}o.text+=r+": "+o.val+"; ";o.bs.x=2;n=o.val;(e=/scale\(([\S\s]+?)\)/i.exec(n))&&((i=/(\-ms\-zoom[\s]*?\:)/i.exec(u))||(o.text+="-ms-zoom: "+e[1]+"; "));u+=o.text}return u}g.isArray(t)?g.each(t,function(t){t.text=e(t.childs)}):t.childs&&(t.text=e(t.childs))},importJteStyleText:function(t,e){var i=g.parseCss(t),n="";g.importJteStyleParsed(i);g.each(i,function(t){n+=t.name+" { "+t.text+" }\n"});g.importCssString(n,e?e.id:"")},importJteStyleElement:function(t){var e=g.attrs(t);"jte-style"==e.type&&(e.type="text/style");g.importJteStyleText(t.innerHTML,e)},computedStyle:function(t,e){return e?window.getComputedStyle(t).getPropertyValue(e):window.getComputedStyle(t)},addPrefixStyle:function(t,e){var i,n,r,s=document.createElement("style"),a="",o=e.split("\n");for(i in o)if((r=o[i].trim()).length)if(-1!=(n=r.indexOf("{"))){var u=r.substring(0,n).trim(),l=r.substring(n).trim();u||l||(a+=t+" "+u+" "+l+"\n")}else g.error('Not found "{" in \''+r+"'");s.innerText=a;document.body.appendChild(s)},getDocument:function(t){return t||document},getDocumentHead:function(t){return(t=g.getDocument(t)).head||t.getElementsByTagName("head")[0]||t.documentElement},loadScript:function(i,n){var t=g.getDocumentHead(),r=document.createElement("script");r.src=i;r.type="text/javascript";r.async=!0;r.onload=r.onreadystatechange=function(t,e){if(e||!r.readyState||"loaded"==r.readyState||"complete"==r.readyState){r=r.onload=r.onreadystatechange=null;if(!n&&e)throw new Error("Abort load "+i);n&&(e?n(new Error("Abort load "+i)):n())}};r.onerror=function(){r.onerror=null;n&&n(new Error("Not load "+i))};t.appendChild(r);g.b.ie&&g.b.ie<9||r.parentNode.removeChild(r)},__guids:{},guid:function(t){void 0===t&&(t="-");function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}for(var i;;){i=e()+e()+t+e()+t+e()+t+e()+t+e()+e()+e();if(!g.__guids[i]){g.__guids[i]=!0;return i}}},uname:function(t,e){if("function"!=typeof t&&"object"!=typeof t)return g.error(new Error("uname argument is function or object."));for(var i,n,r;;){i="A"+g.guid("");if(!window[i]){r=window[i]=t;if(e)for(n in e)r[n]=e[n];return r.uname=i}}},extendClass:function(t,e,i){t.prototype=new e;t.prototype.constructor=t;if(i)for(var n in i)t.prototype[n]=i[n];t.__super=new e;return t},url:function(t){var e=DFrameworkJson;return e&&(e=e.dframework)&&(e=e.workPath)?e+t:t},sortNumber:function(t){return t.sort(function(t,e){return t-e})},isArray:function(t){return"[object Array]"===i.call(t)},isElement:function(t){function e(t){return t instanceof HTMLElement}function i(t){return t&&"object"==typeof t&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName}if(t&&"object"==typeof HTMLElement)return(g.isElement=e)(t);if(i(t)){g.isElement=i;return!0}return!1},initDui:function(){if(!c){(c=document.createElement("div")).style.display="none";g.attr(c,"id","dui-saved-element");g.attr(c,"dui-saved-element","true");g.append(document.body,c)}},appendDui:function(t){g.initDui();g.append(c,t)},copy:function(t,e){for(var i in e)t[i]=e[i]},each:function(t,e){var i,n="function";if(!g.isArray(t))return typeof e==n?e.call(this,t):typeof t==n&&t.call(this);if(typeof e==n)for(i=0;i<t.length;i++)e.call(this,t[i]);else if(typeof t[0]==n)for(i=0;i<t.length;i++)t[i].call(this);t=e=null},on:function(t,e,i,n,r,s){if(t){if(void 0===l){var a=g.isArray(t)&&t.length?t[0]:t;if(void 0===(l=!!a.addEventListener||!a.attachEvent&&undefined))throw new TypeError("Not found element add event listener or attach event.")}if(!g.isArray(t))return l?t.addEventListener(e,i,n,r,s):t.attachEvent("on"+e,i,n,r,s);var o;for(o=0;o<t.length;o++)l?t[o].addEventListener(e,i,n,r,s):t[o].attachEvent("on"+e,i,n,r,s)}},off:function(t,e,i){if(t){if(void 0===l){var n=g.isArray(t)&&t.length?t[0]:t;if(void 0===(l=!!n.removeEventListener||!n.detachEvent&&undefined))throw new TypeError("Not found element remove event listener or attach event.")}if(!g.isArray(t))return l?t.removeEventListener(e,i):t.detachEvent("on"+e,i);var r;for(r=0;r<t.length;r++)l?t[r].removeEventListener(e,i):t[r].detachEvent("on"+e,i)}},parseInt:function(t,e){var i=parseInt(t);return isNaN(i)?"number"==typeof e?e:-1:i},cursor:function(t,e){var i;if(e){"hand"==e&&(e="pointer");if(g.isElement(t))t.style.cursor=e;else if(g.isArray(t))for(i=0;i<t.length;i++)t[i].style.cursor=e}else if(1<arguments.length)if(g.isElement(t))t.style.cursor="";else if(g.isArray(t))for(i=0;i<t.length;i++)t[i].style.cursor="";if(g.isElement(t))return t.style.cursor},param:function(t,e){if(!e&&h)return h[t];var i,n,r,s,a=e||document.location.href,o=a.indexOf("?"),u=(-1==o?a:a.substring(o+1)).split("&"),l={};for(n=0;n<u.length;n++){r=(i=u[n].split("=",2))[0].trim();s=1<i.length?i[1].trim():"";r?l[r]=decodeURI(s):s&&(l[r]="="+decodeURI(s))}e||(h=l);return l[t]},makeUrl:function(t,e){var i,n="";for(i in e)n=n?n+"&"+i+"="+encodeURI(e[i]):i+"="+encodeURI(e[i]);return t+(n?"?"+n:"")},location:function(){},query:function(t,e){if("string"==typeof t){e=t;t=document}var i=t.querySelector?function r(t,e){if("string"==typeof t)return document.querySelector(t);if(g.isElement(t)||t===document)return t.querySelector(e);if(g.isArray(t)){var i,n;for(i=0;i<t.length;i++)if(n=t[i].querySelector(e))return n}return null}:g.jQuery?function s(t,e){var i;if("string"==typeof t)return(i=g.jQuery(document).find(t))&&i.length?i[0]:null;if(g.isElement(t)||t===document)return(i=g.jQuery(t).find(e))&&i.length?i[0]:null;if(g.isArray(t)){var n,r;for(n=0;n<t.length;n++)if((i=g.jQuery(t[n]).find(e))&&i.length&&(r=i[0]))return r}return null}:null;return i?(g.query=i)(t,e):null},queryAll:function(t,e){if("string"==typeof t){e=t;t=document}var i=t.querySelectorAll?function s(t,e){if("string"==typeof t){e=t;t=document}var i,n=[],r=t&&t.querySelectorAll(e);if(r)for(i=0;i<r.length;i++)n.push(r[i]);return n}:g.jQuery?function a(t,e){if("string"==typeof t){e=t;t=document}var i,n=[],r=g.jQuery(t).find(e);for(i=0;i<r.length;i++)n.push(r[i]);return n}:null;return i&&(g.queryAll=i)?i(t,e):null},zindex:function(t,e){function i(t,e){if(t&&t.style){e!==undefined&&(t.style.zIndex=e);return t.style.zIndex}}if(!g.isArray(t))return i(t,e);for(var n=0;n<t.length;n++)i(t[n],e)},zIndex:function(t,e){return g.zindex(t,e)},checkedName:function(t,e,i){var n=g.queryAll(t,e),r=[];g.each(n,function(t){t.checked&&r.push(t)});return r},element:function(t){var e=t.trim(),i=/^<([\S]+?)[\s|>|\/]/.exec(e),n=i&&2==i.length?i[1]:null;if(!n)return null;function a(t){var e=document.createElement("div");e.innerHTML=t;return e}function r(t,e){var i=a("<"+e+">"+t+"</"+e+">"),n=g.childs(i.children[0]);return 1<n.length?n:1==n.length?n[0]:null}switch(n.toLowerCase()){case"thead":case"tbody":return r(e,"table");case"tr":return function s(t,e,i){var n=a("<"+e+"><"+i+">"+t+"</"+i+"></"+e+">"),r=g.childs(n.children[0].children[0]);return 1<r.length?r:1==r.length?r[0]:null}(e,"table","tbody");case"td":case"th":return function o(t,e,i,n){var r=a("<"+e+"><"+i+"><"+n+">"+t+"</"+n+"></"+i+"></"+e+">"),s=g.childs(r.children[0].children[0].children[0]);return 1<s.length?s:1==s.length?s[0]:null}(e,"table","tbody","tr");case"option":return r(e,"select");default:return function u(t){var e=a(t),i=g.childs(e);return 1<i.length?i:1==i.length?i[0]:null}(e)}},append:function(t,e){var i;if(g.isElement(t))if(g.isElement(e))t.appendChild(e);else if(g.isArray(e))for(i=0;i<e.length;i++)t.appendChild(e[i])},parent:function(t,e){if(!e)return t.parentNode;g.before(t,e);g.remove(t);e.appendChild(t)},first:function(t,e){if(e){t.children&&t.children.length?t.insertBefore(e,t.children[0]):t.appendChild(e);return e}if(t.children&&t.children.length)return t.children[0]},last:function(t,e){if(e){t.appendChild(e);return e}if(t.children&&t.children.length)return t.children[t.children.length-1]},before:function(t,e){if(!e){if(!1===e)return t.previousSibling;for(;;){if(!(t=t.previousSibling))return;if(g.isElement(t))return t}}t.parentNode.insertBefore(e,t);return e},after:function(t,e){var i;if(!e)return t.nextSibling;if(t.nextSibling)return g.before(t.nextSibling,e);(i=g.parent(t))&&i.appendChild(e);return e},childs:function(t){var e,i=[];for(e=0;e<t.children.length;e++)i.push(t.children[e]);return i},childAll:function(t){var e,i=[];for(e=0;e<t.childNodes.length;e++)i.push(t.childNodes[e]);return i},removeElement:function(t){t.parentElement.removeChild(t)},remove:function(t,e){if(g.isArray(t)&&"number"==typeof e)return t.splice(e,1);if(g.isElement(t)){var i=typeof e;if("string"==i)return t.removeAttribute(e);if("undefined"==i&&t.parentElement)return t.parentElement.removeChild(t)}},removeChildAll:function(t){if(g.isElement(t))for(var e=g.childs(t),i=e.length-1;0<=i;i--)g.remove(e[i])},text:function(t,e){if(!t)return"";function i(t,e){return e!==undefined?t.innerText=e:t.innerText}if(g.isArray(t)){for(var n="",r=0;r<t.length;r++)n+=i(t[r],e);return n}return i(t,e)},html:function(t,e){if(!t)return"";function i(t,e){return e!==undefined?t.innerHTML=e:t.innerHTML}if(g.isArray(t)){for(var n="",r=0;r<t.length;r++)n+=i(t[r],e);return n}return i(t,e)},save:function(t){function e(t){g.remove(t)}if(p.ie&&p.ie<9){var i=document.createElement("div");i.style.display="none";r=i;g.appendDui(i);g.save=function n(t){g.append(r,t)};return g.append(r,t)}return(g.save=e)(t)},val:function(t,e,i){if(!t)return"";function n(t,e,i){var n,r,s,a,o=typeof i;if(g.isElement(t))switch(t.nodeName.toLowerCase()){case"select":s=!1;if("undefined"!=(o=typeof(i=e))&&"object"!=o){for(n=0;n<t.options.length;n++)if((r=t.options[n]).value){if(r.value===i){s=t.selectedIndex=n;break}}else if(r.text===i){s=t.selectedIndex=n;break}if(!1===s)return!1}return t.options[t.selectedIndex].value;case"option":case"input":return e!==undefined?t.value=e:t.value;default:switch(e.toLowerCase()){case"outerhtml":return"undefined"==o||"object"==o?t.outerHTML:t.outerHTML=i;case"html":return"undefined"==o||"object"==o?t.innerHTML:t.innerHTML=i;default:return"undefined"==o||"object"==o?t.innerText:t.innerText=i}}else if(g.isArray(t)&&t.length&&g.isElement(a=t[0]))switch(a.nodeName.toLowerCase()){case"input":switch(a.getAttribute("type")){case"radio":for(n=0;n<t.length;n++)if(t[n].checked)return g.val(t[n])}}return""}if(!g.isArray(t))return n(t,e,i);for(var r=0;r<t.length;r++)n(t[r],e,i)},hasAttr:function(t,e){return t.hasAttribute?t.hasAttribute(e):null!==(v=t.getAttribute(e))&&v!==undefined},attr:function(t,e,i){if(!t)return null;if(arguments.length<3)return t.getAttribute?t.getAttribute(e):t[e];t.setAttribute?t.setAttribute(e,i):t[e]=i},attrs:function(t){g.attrs=p.ie&&p.ie<8?function a(t){var e,i,n,r={},s=t.attributes;if(!s)return r;for(e=0;e<s.length;e++){i=s[e];null!==(n=t.getAttribute(i.name))&&""!==n&&(r[i.name]=n)}return r}:function s(t){var e,i,n={},r=t.attributes;if(!r)return n;for(e=0;e<r.length;e++)n[(i=r[e]).name]=i.value;return n};return g.attrs(t)},duiAttr:function(t,e,i){g.duiAttr=!d||p.ie&&p.ie<9?function r(t,e,i){var n="--dui-attr-"+e;return arguments.length<3?t[n]:t[n]=i}:function s(t,e,i){var n=t.dui.__attr;return arguments.length<3?n[e]:n[e]=i};return g.duiAttr(t,e,i)},hasDuiAttr:function(t,e){g.hasDuiAttr=!d||p.ie&&p.ie<9?function n(t,e){var i="--dui-attr-"+e;return null!==t[i]&&"undefined"!=typeof t[i]}:function i(t,e){return"undefined"!=typeof t.dui.__attr[e]};return g.hasDuiAttr(t,e)},duiAttrs:function(t){return t.dui&&t.dui.__attr?t.dui.__attr:{}},includes:function(t,e,i){return function a(t){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");var e,i=Object(this),n=parseInt(i.length,10)||0;if(0===n)return!1;var r,s=parseInt(arguments[1],10)||0;0<=s?e=s:(e=n+s)<0&&(e=0);for(;e<n;){if(t===(r=i[e])||t!=t&&r!=r)return!0;e++}return!1}.call(t,e,i)},addClass:function(t,e){if(t&&e){if(!g.isArray(t))return n(t,e);for(var i=0;i<t.length;i++)n(t[i],e)}function n(e,t){var i=[];g.each(t.split(" "),function(t){t&&(t=t.trim())&&i.push(t)});g.each(i,function(t){!function i(t,e){if(t.classList)return t.classList.add(e);g.hasClass(t,e)||(t.className?t.className+=" "+e:t.className=e)}(e,t)})}},removeClass:function(t,e){if(t&&e){var r=[];g.each(e.split(" "),function(t){t&&(t=t.trim())&&r.push(t)});if(!g.isArray(t))return n(t);for(var i=0;i<t.length;i++)n(t[i])}function n(t,e){var i=t.className.split(" "),n="";g.each(i,function(t){t&&(t=t.trim())&&(g.includes(r,t)||(n?n+=" "+t:n=t))});t.className=n}},hasClass:function(t,e){if(!t||!e)return!1;if(t.classList)return t.classList.contains(e);var i,n=t.className.split(" ");for(i=0;i<n.length;i++)if(n[i]&&n[i].trim()===e)return!0;return!1},toggleClass:function(t,e){if(t&&e){if(t.classList)return t.classList.toggle(e);g.hasClass(t,e)?g.removeClass(t,e):g.addClass(t,e)}},stringPad:function(t,e){return(t+="").length>=e?t:new Array(e-t.length+1).join("0")+t},formatBytes:function(t,e){if(0===t)return"0 Bytes";var i=e||2,n=Math.floor(Math.log(t)/Math.log(1024)),r=parseFloat((t/Math.pow(1024,n)).toFixed(i));return(e?r.toFixed(i):r)+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]},byteLength:function(t){var e,i,n;for(e=i=0;n=t.charCodeAt(i++);e+=n>>11?3:n>>7?2:1);return e},target:function(t){return t.target?t.target:t.srcElement?t.srcElement:t.toElement?t.toElement:undefined},urlencoded:function(t){return encodeURI(t)},getBoundingClientRect:function(t){if(!t)return null;var e=t.getBoundingClientRect(),i=g.math.rect();i.left=e.left;i.top=e.top;i.right=e.right;i.bottom=e.bottom;return i},getElementsByPoint:function(s,a){var t,e,o=[],i=[],n=0,r=0,u=a&&a.document?a.document:document;function l(t){var e,i,n=g.getBoundingClientRect(t).contains(s),r=!1;if(!t.children||t.children&&0===t.children.length)return!!n&&(o.push(t)||1);for(i=0;i<t.children.length;i++){e=t.children[i];!g.hasClass(e,"dui-devel-ui")&&l(e)&&(r=!0)}return!r&&n||r&&a&&a.isparent?o.push(t)||1:r}if(u.body.children)for(t=0;t<u.body.children.length;t++)(e=u.body.children[t]).classList.contains("dui-devel-ui")||l(e);if(1<o.length){o.forEach(function(t){t.children&&0<t.children.length?n++:r++});if((!a||!a.isparent)&&r&&n){o.forEach(function(t){t.children&&0<t.children.length||i.push(t)});return i.length?i:null}}return o.length?o:null},getCompatElement:function(t){var e=t.getDocument();return e.compatMode&&"CSS1Compat"!=e.compatMode?e.body:e.html},getCompatMode:function(t){return t.compatMode&&"CSS1Compat"!=t.compatMode?t.body:t.html},scrollTop:function(t){if(g.b.ie){if(document.documentElement){(0===t||t)&&(document.documentElement.scrollTop=t);return document.documentElement.scrollTop}if(document.body){(0===t||t)&&(document.body.scrollTop=t);return document.body.scrollTop}return g.warn("Not found documentElement and body.")}(t||0===t)&&(window.scrollTo?window.scrollTo(window.scrollX,t):window.scrollY=t);return window.scrollY},scrollLeft:function(t){if(g.b.ie){if(document.documentElement){(0===t||t)&&(document.documentElement.scrollLeft=t);return document.documentElement.scrollLeft}if(document.body){(0===t||t)&&(document.body.scrollLeft=t);return document.body.scrollLeft}return g.warn("Not found documentElement and body.")}(t||0===t)&&(window.scrollTo?window.scrollTo(t,window.scrollY):window.scrollX=t);return window.scrollX},fileSize:function(t){return t<1024?t+" b":t<1048576?(t/1024).toFixed(1)+" Kb":t<1073741824?(t/1048576).toFixed(1)+" Mb":(t/1073741824).toFixed(1)+" Gb"},event:function(t,e){function i(t,e){var i=document.createEvent("Event"),n=!e||"boolean"!=typeof e.bubbles||e.bubbles,r=!e||"boolean"!=typeof e.cancelable||e.cancelable,s=e?e.detail:undefined;i.initEvent(t,n,r,s);return i}function n(t,e){e=e||{bubbles:!0,cancelable:!0,detail:undefined};return new Event(t,e)}return document.createEvent?(g.event=i)(t,e):window.Event?(g.event=n)(t,e):void 0},keyCode:{ENTER:13,SPACE:32,ESCAPE:27,ENDED:-1},ready:function(t){if("complete"==document.readyState||"loading"!=document.readyState&&!document.documentElement.doScroll)return t();!p.ie||p.ie&&9<=p.ie&&10!=p.ie?g.on(document,"DOMContentLoaded",function(){t()}):g.on(window,"load",function(){t()})},load:function(t){g.on(window,"load",t)},alert:function(t,e){alert(t);return e},confirm:function(t,e){confirm(t);return e},supportFileApi:function(){var t=document.createElement("INPUT");t.type="file";return"files"in t},supportProgressEvent:function(){var t=O.getRequest();return!!(t&&"upload"in t&&"onprogress"in t.upload)},supportFormData:function(){return!!window.FormData},supportUploadProgress:function(){return g.supportFileApi()&&g.supportProgressEvent()&&g.supportFormData()},toJson:function(t){g.toJson=p.ie&&p.ie<9?function n(t){var i;try{i=g.jQuery.parseJSON(t)}catch(e){g.error("parse error: ",t);throw e}return i}:function r(t){var i;try{i=JSON.parse(t)}catch(e){g.error("parse error: ",t);throw e}return i};return g.toJson(t)},json:function(t){if(DFrameworkJson&&"undefined"!=typeof DFrameworkJson[t])return DFrameworkJson[t]},ajax:function(t){return new O(t)},ajaxJson:function(a){var o=a.error,u=a.success;a.error=function(t){if(a.no_result_error)return o?o(t):null;g.ui.alert("Error",{close:function(){o&&o(t)}})};a.success=function(t,i,n){var r,s;try{r=g.toJson(t)}catch(e){g.error(e);s="Not parse result."}if(s||r&&!r.result){s||(s=r.error_msg?r.error_msg:"Error");if(a.no_result_error)return o?o(n,s):null;g.ui.alert(s,{close:function(){o&&o(n)}})}else a.no_result_ok?u&&u(r,n):g.ui.alert("Success.",{close:function(){u&&u(r,n)}})};return g.ajax(a)},cookie:function(t,e,i){u=function(){var t,e,i,n,r,s=[],a=document.cookie,o=a?a.split(";"):null;if(o)for(t in o){i=(e=o[t]).indexOf("=");n=e.substring(0,i).trim();r=e.substring(i+1).trim();s.push({name:n,value:r})}return s}();g.cookie=function o(t,e,i){if(1===arguments.length){var n,r=u;for(n=0;n<r.length;n++)if(r[n].name===t)return r[n].value}else if(1<arguments.length){i||(i={});i.path||(i.path="/");var s=t+"="+escape(e)+"; path="+i.path;if(i.seconds){var a=new Date;a.setTime(a.getTime()+i.seconds);s+="; expires="+a.toGMTString()}u.push({name:t,value:e,attr:i});document.cookie=s}};return 1===arguments.length?g.cookie(t):2==arguments.length?g.cookie(t,e):3==arguments.length?g.cookie(t,e,i):void 0},lang:function(t){t&&g.cookie(s,t);return g.cookie(s)},igEventAll:function(t){if(!t)return!1;"function"==typeof t.preventDefault&&t.preventDefault();"function"==typeof t.stopPropagation&&t.stopPropagation();"function"==typeof t.stopImmediatepropagation&&t.stopImmediatepropagation();t.returnValue=!1;return!(t.cancelBubble=!0)},contains:function(t,e){if(g.isArray(t)){var i;for(i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}},onlyNumber:function(t){g.on(t,"keydown",function(t){var e=t.keyCode;if(!g.contains([46,8,9,27,13,110,190],e)&&(65!=e&&67!=e&&88!=e||!0!==t.ctrlKey&&!0!==t.metaKey)&&!(35<=e&&e<=39||96<=e&&e<=105||!t.shiftKey&&48<=e&&e<=57))return g.igEventAll(t)})},offset:function(t,e){if(e){t.style.top=e.top+"px";t.style.left=e.left+"px"}return g.getBoundingClientRect(t)},height:function(t){return g.offset(t).height()},width:function(t){return g.offset(t).width()},dataURItoBlob:function(t){for(var e=atob(t.split(",")[1]),i=t.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(e.length),r=new Uint8Array(n),s=0;s<e.length;s++)r[s]=e.charCodeAt(s);return new Blob([n],{type:i})},open:function(t){if(!t)return window.open();if("string"==typeof t)return window.open(t);if("object"!=typeof t)return window.open();var e,i,n,r,s,a,o="boolean"==typeof t.replace?t.replace:"true"==t.replace||"false"!=t.replace&&null,u=t.specs?t.specs:{},l="";if("string"==(a=typeof u)){i=u.split(",");u={};for(r=0;r<i.length;r++)(s=(n=i[r].split("=",2))[0].trim())&&(1<n.length?u[s]=n[1].trim():u[s]="")}else"object"!=a&&(u={});t.width&&(u.width=t.width);t.height&&(u.height=t.height);t.top&&(u.top=t.top);t.left&&(u.left=t.left);function h(t,e,i){var n=e[i],r=typeof n;!r||"string"!=r&&"number"!=r&&"boolean"!=r||(t[i]="true"==n||!0===n?"yes":"false"==n||!1===n?"no":n)}h(u,t,"channelmode");h(u,t,"directories");h(u,t,"fullscreen");h(u,t,"location");h(u,t,"menubar");h(u,t,"resizable");h(u,t,"scrollbars");h(u,t,"status");h(u,t,"titlebar");h(u,t,"toolbar");if(!0===t.notab||"true"==t.notab){u.width||(u.width=300);u.height||(u.height=300)}for(s in u)l+=s+"="+u[s]+"; ";e="boolean"==typeof o?window.open(t.url,t.name,l,o):l?window.open(t.url,t.name,l):t.name?window.open(t.url,t.name):window.open(t.url);var c=["load","ready","unload","pageshow","close"];for(r=0;r<c.length;r++){c[r];"function"==typeof t[s]&&g.on(e,s,an)}return e},worker:function(t){if(!window.Worker)return g.error(new Error("Not support Worker class."));if("object"!=typeof t)return g.error(new TypeError("worker arguments is null."));if(!t.url||"string"!=typeof t.url)return g.error(new TypeError("worker url is js filepath string."));var e=g.namespaceurl(t.url,"js"),i=new Worker(e);i.args=t;i.namespaceurl=e;"function"==typeof t.message&&(i.onmessage=function(){t.message.apply(i,arguments)});"function"==typeof t.error&&(i.onerror=function(){t.error.apply(i,arguments)});"function"==typeof t.ready&&setTimeout(function(){t.ready.apply(i)},1);return i},websocket:function(i){if(!window.WebSocket)return g.error(new Error("Not support WebSocket class."));if("object"!=typeof i)return g.error(new TypeError("web socket arguments is null."));if(!i.url||"string"!=typeof i.url)return g.error(new TypeError("web socket url is server url string."));var n,t=-1!=i.url.indexOf("://")?g.namespaceurl(i.url,""):i.url;try{n=new WebSocket(t,i.protocol?i.protocol:"")}catch(e){return i.error?i.error(e):null}n.onopen=function(t){"function"==typeof i.connect&&i.connect.apply(n,arguments)};i.message&&(n.onmessage=i.message);i.error&&(n.oneror=i.error);i.close&&(n.onclose=i.close);return n},upload:function(r,t){return window.WebSocket?window.FileReader?r?g.worker({url:"dframework/worker/uploader",ready:function(){this.postMessage({type:"init",data:{url:r.url,file:r.file,sleepTime:r.sleepTime,readBytes:r.readBytes,sendBytes:r.sendBytes,data:r.data}})},message:function(t){var e=t.data,i=e.type,n=e.data;switch(i){case"init":case"ready":break;case"progress":"function"==typeof r.progress&&r.progress(n);break;case"error":"function"==typeof r.error&&r.error(e)}},error:function(t){}}):g.error("Not found arguments"):g.error("Not support FileReader."):g.error("Not support WebSocket.")}}).prettyDate=function(t){var e,i=new Date((t||"").replace(/-/g,"/").replace(/[TZ]/g," ").split(".")[0]),n=((new Date).getTime()-i.getTime())/1e3;(n-=33e3)<0&&(n=0);e=Math.floor(n/86400);if(!(isNaN(e)||e<0))return 0===e&&((n<60?"\ubc29\uae08\uc804":n<120&&"1\ubd84\uc804")||n<3600&&Math.floor(n/60)+" \ubd84\uc804"||n<7200&&"1 \uc2dc\uac04\uc804"||n<86400&&Math.floor(n/3600)+" \uc2dc\uac04\uc804")||1==e&&"\uc5b4\uc81c"||e<7&&e+" \uc77c\uc804"||e<31&&Math.floor(e/7)+" \uc8fc\uc804"||e<360&&Math.floor(e/30)+" \uac1c\uc6d4 \uc804"||360<=e&&(0===Math.floor(e/360)?1:Math.floor(e/360))+" \ub144 \uc804"};(g.DuiFromData=L).prototype={constructor:L,append:function(t,e){if(g.isElement(e)&&"input"==e.nodeName.toLowerCase()&&"string"==typeof e.type&&"file"==e.type.toLowerCase()){e.value&&(this._hasFile=!0);this.data.push({name:t,value:e,isfile:!0,element:!0})}else if(window.FileList&&e instanceof FileList){e.length&&(this._hasFile=!0);this.data.push({name:t,value:e,isfile:!0,filelist:!0})}else this.data.push({name:t,value:e})},hasFile:function(){if(this.formElement){ae=g.queryAll(this.formElement,'input[type="file"]');if(ae&&ae.length)return!0}return!!this._hasFile},body:function(){},empty:function(){return!this.data.length&&!this.formElement},length:function(){return this.data.length},get:function(t){return this.data[t]},form:function(t){var e,i,n,r,s=this.formElement?this.formElement:document.createElement("form");if(t){t.target&&(s.target=t.target);t.url&&(s.action=t.url);t.method&&(s.method=t.method)}this.formElement&&(r=g.queryAll(this.formElement,'input[type="file"]'))&&r.length&&(s.enctype="multipart/form-data");for(e=0;e<this.data.length;e++)if((i=this.data[e]).element)i.isfile&&g.error("Warring: file is using form tag(element).");else{(n=document.createElement("input")).duiType=!0;n.type="hidden";n.name=i.name;n.value=i.value;s.appendChild(n);this.formElement&&this.saveElement.push(n)}return s},submit:function(i){var t="A"+g.guid(""),n={target:i&&i.target?i.target:t,url:i&&i.url?i.url:null,method:i&&i.method?i.method:"POST"},r=this.form(n),s=document.createElement("iframe");s.width="300";s.height="300";s.style.border="solid 1px red";s.name=n.target;s.src="";s.style.display="none";this.formElement||document.body.appendChild(r);document.body.appendChild(s);var a=this;g.on(s,"load",function(){try{if("about:blank"==s.contentWindow.document.location.href)return""!==r.action&&"about:blank"!=r.action?r.submit():void 0}catch(e){"function"==typeof i.error&&i.error(e);return a.clean()}var t=s.contentWindow.document.body.innerText;g.remove(s);a.formElement||g.remove(r);"function"==typeof i.success&&i.success(t,200,null);a.clean();a=null})},clean:function(){var t;for(t=0;t<this.saveElement.length;t++)g.remove(this.saveElement[t])}};(g.DuiHeader=I).prototype={constructor:I,append:function(t,e){this.data.push({name:t,value:e})},length:function(){return this.data.length},get:function(t){return this.data[t]}};(g.HttpAjaxClient=O).xhrType=null;O.getRequest=function(){switch(O.xhrType){case"xhr":return new XMLHttpRequest;case"xdr":return new XDomainRequest;case"mxh":return new ActiveXObject("Microsoft.XMLHTTP")}if((!p.ie||p.ie&&9<=p.ie)&&window.XMLHttpRequest){O.xhrType="xhr";return new XMLHttpRequest}if(window.XDomainRequest){O.xhrType="xdr";return new XDomainRequest}if(window.ActiveXObject){O.xhrType="mxh";return new ActiveXObject("Microsoft.XMLHTTP")}return g.error(new TypeError("Not found XMLHttpRequest object."))};O.prototype={constructor:O,onerror:function(t){g.error("onerror: ",t)},onsuccess:function(t,e,i){},onreadystatechange:function(t){},onprogress:function(){},close:function(){this.xmlHttp=null},ready:function(){function e(t){"function"==typeof this.onerror&&this.onerror.call(this,this);this.close()}function i(){var t;switch(O.xhrType){case"xdr":if(!(t=this.xmlHttp))return"function"==typeof this.onerror?this.onerror.call(this,"Not found xmlhttp"):null;this.onsuccess.call(this,t.responseText,200,t)}}function n(t){}function r(t){this.onprogress(t)}function s(t){}function a(){"function"==typeof this.onerror&&this.onerror.call(this,this);this.close()}if(!(this.xmlHttp=O.getRequest()))return g.error("Not found xml http object.");!function(t){t.xmlHttp.onreadystatechange=function(){(function r(t){var e;if(!(e=t?g.target(t):p.ie&&p.ie<9?this:null))return this.onerror.call(this,"error: state change");this.readyState=e.readyState;"function"==typeof this.onreadystatechange&&this.onreadystatechange(e);switch(e.readyState){case 0:case 1:case 2:case 3:break;case 4:if(0<e.status){this.status=e.status;this.statusText=e.statusText;if(this.responseType)switch(this.responseType.toLowerCase()){case"xml":if(this.responseTypeException){var i=document.createElement("div");i.innerHTML=e.responseText;var n=i.children[0];this.onsuccess.call(this,n,e.status,e)}else if(e&&e.responseXML)this.onsuccess.call(this,e.responseXML.documentElement,e.status,e);else{g.error("Not found responseXML");this.onerror.call(this,"Not found responseXML")}return this.close()}this.onsuccess.call(this,e.responseText,e.status,e);this.close()}}}).apply(t,arguments)};switch(O.xhrType){case"xhr":t.xmlHttp.onabort=function(){(function e(t){"function"==typeof this.onerror&&this.onerror.call(this,this);this.close()}).apply(t,arguments)};t.xmlHttp.onerror=function(){e.apply(t,arguments)};t.xmlHttp.onload=function(){i.apply(t,arguments)};t.xmlHttp.ontimeout=function(){a.apply(t,arguments)};if(t.xmlHttp.upload){t.xmlHttp.upload.onloadstart=function(){n.apply(t,arguments)};t.xmlHttp.upload.onprogress=function(){r.apply(t,arguments)};t.xmlHttp.upload.onloadend=function(){s.apply(t,arguments)}}else{t.xmlHttp.onloadstart=function(){n.apply(t,arguments)};t.xmlHttp.onprogress=function(){r.apply(t,arguments)};t.xmlHttp.onloadend=function(){s.apply(t,arguments)}}break;case"xdr":t.xmlHttp.onerror=function(){e.apply(t,arguments)};t.xmlHttp.onload=function(){i.apply(t,arguments)};t.xmlHttp.onprogress=function(){r.apply(t,arguments)};t.xmlHttp.ontimeout=function(){a.apply(t,arguments)}}}(this);return!0},open:function(t,e){if(!0!==this.ready())return!1;t&&(this.type=t.toUpperCase());this.type||(this.type="GET");e&&(this.url=e);this.formdata&&(this.type="POST");if(this.responseType)if(g.b.ie)this.responseTypeException="No support responsetype for IE";else try{this.xmlHttp.responseType=this.responseType}catch(i){this.responseTypeException=i}!0===this.async||!1===this.async?this.xmlHttp.open(this.type,this.url,this.async):this.xmlHttp.open(this.type,this.url,!0);return!0},setRequestHeader:function(t,e){this.headers.append(t,e)},repairData:function(t){var e,i,n,r,s,a=this.formdata?this.formdata:g.supportFormData()?this.formdata=new FormData:this.formdata=new L;if(g.isElement(t)&&"form"==t.nodeName.toLowerCase())a=g.supportFormData()?this.formdata=new FormData(t):this.formdata=new L(t);else if(t instanceof FormData)a=this.formdata=t;else if(g.isArray(t))for(i=0;i<t.length;i++){n=t[i];s=!1;if(g.isElement(n)&&"input"==n.nodeName.toLowerCase())switch("string"==typeof n.type?n.type.toLowerCase():""){case"input":case"hidden":s=!0;a.append(n.name,n.value);break;case"file":s=!0;if(n.files){g.hasAttr(n,"multiple")&&!/(\[\]$)/.exec(n.name)&&g.error('multiple input file name suffix "[]".');for(r=0;r<n.files.length;r++)a.append(n.name,n.files[r])}else a.append(n.name,n)}!s&&n.name&&a.append(n.name,n.value)}else if("object"==typeof t)for(e in t)a.append(e,t[e])},send:function(t){var e,i,n;t&&this.repairData(t);for(i=0;i<this.headers.length();i++){n=this.headers.get(i);this.xmlHttp.setRequestHeader(n.name,n.value)}e=this.formdata;this.enctype&&(e.enctype=this.enctype);if(g.supportFormData()&&e)return e?this.xmlHttp.send(e):this.xmlHttp.send();if("POST"!=this.type)return this.xmlHttp.send();if(!e||e&&e.empty())return this.xmlHttp.send();e.hasFile()&&g.error("Warring:: Not support file upload on ajax. Your response content-type is text/plain.");var r=this;e.submit({error:function(t){g.error(t);"function"==typeof r.onerror&&r.onerror.call(this,"Don't submit.")},success:function(t,e,i){"function"==typeof r.onsuccess&&r.onsuccess.call(this,t,e,r)},method:this.type,url:this.url})},abort:function(){this.xmlHttp&&this.xmlHttp.abort&&this.xmlHttp.abort()}};m={waterfall:function(t,e){var o=this;return 0<t.length?function u(i,n,r,s){var t=r[i];n||(n=[]);n.push(function a(){if(arguments[0]){s&&s.apply(o,arguments);o=r=s=n=undefined}else{var t,e=[];for(t=1;t<arguments.length;t++)e.push(arguments[t]);r.length>i+1?u.call(o,i+1,e,r,s):s&&s.apply(o,arguments)}});if(t)t.apply(o,n);else{s&&s.call(o);o=r=s=n=undefined}}.call(o,0,null,t,e):e&&e.call(o)},each:function(n,t,r){return 0<n.length?function s(e){var i=this;t.call(this,n[e],function(t){!t&&n.length>e+1?s.call(i,e+1):r&&r.call(i,t);i=undefined})}.call(this,0):r?r.call(this):""},ins:function(t,e,i){var n,r=[];for(n in t)r.push(n);m.each.call(this,r,e,i)},mapSeries:function(t,e,n){var r=[];function s(t){if("function"==typeof n)return t?n(t):n(null,r);g.error("Not found callback function at mapSeries.")}!function a(i){if(i>=t.length)return s(null);if("function"!=typeof e)return g.error("Not found array callback function at mapSeries.");e(t[i],function(t,e){if(!t){r.push(e);return a(i+1)}if("function"==typeof n)return s(t)})}(0)}};t={RADIAN:180/Math.PI,point:function(t,e){return new f(t,e)},rect:function(t,e,i,n){return new P(t,e,i,n)}};var f=function f(t,e){switch(typeof t){case"number":this.x=t;this.y=e;break;case"object":if(t instanceof P){this.x=t.left;this.y=t.top}else{this.x=t.x;this.y=t.y}break;case"string":this.x=parseInt(t);this.y=parseInt(e)}};f.prototype={vector:function(t,e){var i=new f(t,e);return new f(i.x-this.x,i.y-this.y)},abs:function(){return Math.pow(this.x,2)+Math.pow(this.y,2)},dotproduct:function(t,e){var i=new f(t,e);return this.x*i.x+this.y*i.y},distance:function(t,e){if(void 0===t)return Math.sqrt(this.abs());var i=new f(t,e),n=i.x-this.x,r=i.y-this.y;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2))},normalize:function(){var t=this.distance();return new f(this.x/t,this.y/t)},atan2:function(){return Math.atan2(this.y,this.x)},angle:function(){return this.atan2()*t.RADIAN},clone:function(){return new f(this)}};P.copy=function(t,e){t.left=e.left;t.top=e.top;t.right=e.right;t.bottom=t.bottom};P.prototype={constructor:P,width:function(){return this.right-this.left},height:function(){return this.bottom-this.top},area:function(){return this.width*this.height},clone:function(){return new P(this)},vector:function(){return new f(this.right-this.left,this.bottom-this.top)},distance:function(){var t=this.right-this.left,e=this.bottom-this.top;return Math.sqrt(Math.abs(t*t)+Math.abs(e*e))},normalize:function(){var t=this.distance();return new f(this.right/t,this.bottom/t)},contains:function(t,e){var i;1==arguments.length?"object"==typeof t&&(t instanceof f||"number"==typeof t.x&&"number"==typeof t.y)&&(i=t):2==arguments.length&&"number"==typeof t&&"number"==typeof e&&(i={x:t,y:e});return!!(i&&this.left<=i.x&&this.right>=i.x&&this.top<=i.y&&this.bottom>=i.y)},center:function(t){return{x:(this.width()-t.width())/2,y:(this.height()-t.height())/2}}};t.DuiPoint=f;t.DuiRect=P;y={innerWidth:function(){return window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth},innerHeight:function(){return window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight},FRAME:30,getFrame:function(t){return t*y.FRAME/1e3},addShowModule:function(t){if(!t.name)throw new TypeError("Not found name at show module.");n[t.name]=t},getShowModule:function(t){return n[t]},showhide:function(t,e,i,n){var r,s="dui-showhide-origin";function a(t,e){var i,n=t.style.display;if(!(e&&"none"!=n||!e&&"none"==n)){if(!(r=t[s])){r={style:{display:n&&"none"!=n?n:""}};t[s]=r}i=r.style;n&&"none"!=n&&i.display!=n&&(i.display=n);t.style.display=e?i.display&&"none"!=i.display?i.display:"":"none"}}if(g.isElement(t))return a(t,"show"==n)},hide:function(t,e){if(g.isArray(t)){var i;for(i=0;i<t.length;i++)y.showhide(t[i],e,"none","hide")}else y.showhide(t,e,"none","hide")},show:function(t,e){if(g.isArray(t)){var i;for(i=0;i<t.length;i++)y.showhide(t[i],e,"block","show")}else y.showhide(t,e,"block","show")},repaireUi:function(t){var e=g.getBoundingClientRect(t);e.top<=0&&(t.style.top="10px");e.left<=0&&(t.style.left="10px")},center:function(t,e){var i=g.math.rect(0,0,g.ui.innerWidth(),g.ui.innerHeight()),n=g.getBoundingClientRect(t),r=i.center(n),s=r.y,a=r.x;e||(e={});e.offsetTop||(e.offsetTop=20);t.style.top=s-e.offsetTop+"px";t.style.left=a+"px";g.ui.repaireUi(t)},popup:function(t){t||(t={});var e=(!0===t.modal||"true"==t.modal)&&document.createElement("div"),i=t.ui;if(!g.isElement(i))throw new TypeError("ui parameter is not element.");i.style.position="absolute";if(e){g.addClass(e,"dui-protect-background");e.style.position="fixed";g.append(e,i);g.append(document.body,e)}else g.append(document.body,i);g.ui.center(i,t);t.auto;return e||i}};!function(){function t(t){var e=g.getBoundingClientRect(this),i=g.documentSize();t.user_data={depth:{x:t.width/(t.duration/t.perSeconds),y:t.height/(t.duration/t.perSeconds),left:e.right/(t.duration/t.perSeconds),right:(i.x-e.left)/(t.duration/t.perSeconds),top:e.bottom/(t.duration/t.perSeconds),bottom:(i.y-e.top)/(t.duration/t.perSeconds)},current:{x:0,y:0,left:0,top:0,right:0,bottom:0},rect:e,ds:i}}function e(t){var e=t.user_data.current,i=t.user_data.depth,n=t.user_data.rect,r=t.user_data.ds;e.x+=i.x;e.y+=i.y;e.left+=i.left;e.top+=i.top;e.right+=i.right;e.bottom+=i.bottom;if(t.isshow){e.ml=-n.right+e.left;e.mr=r.x-n.left-e.right;e.mt=-n.bottom+e.top;e.mb=r.y-n.top-e.bottom}else{e.ml=-e.left;e.mr=e.right;e.mt=-e.top;e.mb=e.bottom}switch(t.type){case"out-right":this.style.marginLeft=e.mr+"px";break;case"out-left":this.style.marginLeft=e.ml+"px";break;case"out-bottom":this.style.marginTop=e.mb+"px";break;case"out-top":this.style.marginTop=e.mt+"px";break;case"out-leftbottom":case"out-lefttop":break;case"out-rightbottom":case"out-righttop":break;default:throw new TypeError("Not found show/hide method(type) name. type: "+t.type)}return e.top>n.bottom}for(var i=["out-left","out-right","out-top","out-bottom","out-lefttop","out-leftbottom","out-righttop","out-rightbottom"],n=0;n<i.length;n++)y.addShowModule({name:i[n],init:t,onevent:e})}();!function(){function t(t){this.style.paddingLeft=this.style.paddingRight=this.style.paddingTop=this.style.paddingBottom="0px";t.user_data={depth:{x:t.width/(t.duration/t.perSeconds),y:t.height/(t.duration/t.perSeconds)},current:{x:0,y:0}}}function e(t){var e=t.user_data.current,i=t.user_data.depth;e.x+=i.x;e.y+=i.y;if(t.isshow){e.rw=e.x;e.rh=e.y;e.ml=t.width-e.x+g.parseInt(t.origin.margin.left,0);e.mt=t.height-e.y+g.parseInt(t.origin.margin.top,0)}else{e.rw=t.width-e.x;e.rh=t.height-e.y;e.ml=e.x+g.parseInt(t.origin.margin.left,0);e.mt=e.y+g.parseInt(t.origin.margin.top,0)}switch(t.type){case"right":this.style.marginLeft=e.ml+"px";case"left":this.style.width=e.rw+"px";this.style.height=t.height+"px";break;case"bottom":this.style.marginTop=e.mt+"px";case"top":this.style.height=e.rh+"px";this.style.width=t.width+"px";break;case"leftbottom":this.style.marginTop=e.mt+"px";case"lefttop":this.style.width=e.rw+"px";this.style.height=e.rh+"px";break;case"rightbottom":this.style.marginTop=e.mt+"px";case"righttop":this.style.marginLeft=e.ml+"px";this.style.width=e.rw+"px";this.style.height=e.rh+"px";break;default:throw new TypeError("Not found show/hide method(type) name. type: "+t.type)}return e.x>=t.width}for(var i=["left","right","top","bottom","lefttop","leftbottom","righttop","rightbottom"],n=0;n<i.length;n++)y.addShowModule({name:i[n],init:t,onevent:e})}();var S=[];y.addResizeable=function(t){S.push(t);1===S.length&&g.on(window,"resize",y.onResizeable)};y.removeResizeable=function(t){var e;for(e=0;e<S.length;e++)if(S[e]===t){g.remove(S,e);break}0===S.length&&g.off(window,"resize",y.onResizeable)};y.onResizeable=function(t){var i,n;for(i=0;i<S.length;i++)if("function"==typeof(n=S[i]).resize)try{n.resize(t)}catch(e){}};!function(){var n=function(t,a){if(t){a||(a={});a.offset||(a.offset=5);a.limitHeightOffset||(a.limitHeightOffset=2);a.limitWidthOffset||(a.limitWidthOffset=2);this.attr=a;this.sourceElement=t;this.enable=!1;this.lastEvent=null;this.status="";this.statusList=[];this.statusTarget={};this.type=function(){var t,e,i="string"==typeof a.type?a.type.split(","):[],n=["right","bottom","left","top"],r=[],s=[];for(t in i)(e=i[t].trim())&&r.push(e);if(!r.length)return n;for(t in r){if("all"==r[t])return n;switch(r[t]){case"right":case"bottom":case"left":case"top":s.push(r[t])}}return s.length?s:n}()}},h=n,s=[],a=[],r=["active","unactive","down","up"],o=["resizeable_down","resizeable_move","resizeable_up"],u=["bottom","top","right","left"];h.defaultOffset=10;h.addObject=function(t){var e,i=s;for(e=0;e<i.length;e++)if(i[e]===t)return;i.push(t);if(1===i.length){g.on(document,"mousedown",h.mousedown);g.on(document,"mousemove",h.mousemove);g.on(document,"mouseup",h.mouseup)}};h.removeObject=function(t){var e,i=s;for(e=0;e<i.length;e++)if(i[e]===t){i.slice(e,1);h.removeDownObject(t);break}if(0===i.length){g.off(document,"mousedown",h.mousedown);g.on(document,"mousemove",h.mousemove);g.on(document,"mouseup",h.mouseup)}};h.removeDownObject=function(t){var e,i=a;for(e=0;e<i.length;e++)if(i[e]===t)return i.slice(e,1)};h.mousedown=function(t){var e,i,n=s,r=[];for(e=0;e<n.length;e++){(i=n[e]).onmosuedown(t);switch(i.status){case h.s_down:r.push(i)}}r.length&&g.addClass(document.body,"dui-none-select");a=r};h.mouseup=function(t){var e,i=a;for(e=0;e<i.length;e++)i[e].onmouseup(t);g.removeClass(document.body,"dui-none-select");a=[]};h.mousemove=function(t){var e,i=a;for(e=0;e<i.length;e++)i[e].onmousemove(t)};h.prototype={constructor:n,active:function(){this.status=h.s_active;h.addObject(this)},unactive:function(){h.removeObject(this);this.status=h.s_unactive},rect:function(){return g.getBoundingClientRect(this.sourceElement)},refreshCursor:function(){var t=this.statusTarget,e=window.document.body;this.oldCursor=e.style.cursor;t.rightBottom?e.style.cursor="se-resize":t.rightTop?e.style.cursor="ne-resize":t.leftBottom?e.style.cursor="sw-resize":t.leftTop?e.style.cursor="nw-resize":t.right?e.style.cursor="e-resize":t.bottom?e.style.cursor="s-resize":t.left?e.style.cursor="w-resize":t.top&&(e.style.cursor="n-resize")},getMouseRange:function(t){var e,i,n=this.attr,r=n.offset?n.offset:h.defaultOffset,s=this.rect(),a=t.clientX,o=t.clientY,u=this.type,l={status:"",statusList:[],statusTarget:{}};for(e in u)switch(i=u[e]){case"right":if(a>=s.right-r&&a<=s.right+r&&o>=s.top-r&&o<=s.bottom+r){l.status=h.s_down;l.statusList.push(i);l.statusTarget.right=!0;l.statusTarget.top?l.statusTarget.rightTop=!0:l.statusTarget.bottom&&(l.statusTarget.rightBottom=!0)}break;case"bottom":if(o>=s.bottom-r&&o<=s.bottom+r&&a>=s.left-r&&a<=s.right+r){l.status=h.s_down;l.statusList.push(i);l.statusTarget.bottom=!0;l.statusTarget.left?l.statusTarget.leftBottom=!0:l.statusTarget.right&&(l.statusTarget.rightBottom=!0)}break;case"left":if(a>=s.left-r&&a<=s.left+r&&o>=s.top-r&&o<=s.bottom+r){l.status=h.s_down;l.statusList.push(i);l.statusTarget.left=!0;l.statusTarget.top?l.statusTarget.leftTop=!0:l.statusTarget.bottom&&(l.statusTarget.leftBottom=!0)}break;case"top":if(o>=s.top-r&&o<=s.top+r&&a>=s.left-r&&a<=s.right+r){l.status=h.s_down;l.statusList.push(i);l.statusTarget.top=!0;l.statusTarget.left?l.statusTarget.leftTop=!0:l.statusTarget.right&&(l.statusTarget.rightTop=!0)}}return l},onmosuedown:function(t){var e=this.getMouseRange(t);this.status=e.status;this.statusList=e.statusList;this.statusTarget=e.statusTarget;this.lastEvent=this.status?t:null;this.refreshCursor()},onmouseup:function(t){var e=document.body;this.lastEvent=null;this.status=h.s_up;this.statusTarget={};e.style.cursor=this.oldCursor?this.oldCursor:""},onmousemove:function(t){this.attr,this.rect();var e,i=this.lastEvent,n=t.clientX-i.clientX,r=t.clientY-i.clientY;for(e in this.statusList)switch(this.statusList[e]){case"right":this.resizeRight(this.sourceElement,{dx:n,dy:r,attr:this.attr});break;case"bottom":this.resizeBottom(this.sourceElement,{dx:n,dy:r,attr:this.attr});break;case"left":this.resizeLeft(this.sourceElement,{dx:n,dy:r,attr:this.attr});break;case"top":this.resizeTop(this.sourceElement,{dx:n,dy:r,attr:this.attr})}this.lastEvent=t},resizeRight:function(t,e){if(!g.isElement(t))throw new TypeError("Not found element parameter.");if(!e)throw new TypeError("Not found attribute parameter.");var i=window.getComputedStyle(t),n=parseInt(i.getPropertyValue("left")),r=parseInt(i.getPropertyValue("width")),s=e.attr&&e.attr.offset?e.attr.offset:h.defaultOffset,a=e.dx,o=e.dy,u=r+a;if(2*s<u&&u+n<window.innerWidth){t.style.width=u+"px";e.attr&&e.attr.resizeRight&&e.attr.resizeRight.call(this,{dx:a,dy:o})}},resizeLeft:function(t,e){if(!g.isElement(t))throw new TypeError("Not found element parameter.");if(!e)throw new TypeError("Not found attribute parameter.");var i=window.getComputedStyle(t),n=parseInt(i.getPropertyValue("left")),r=parseInt(i.getPropertyValue("width")),s=e.attr&&e.attr.offset?e.attr.offset:h.defaultOffset,a=e.dx,o=e.dy,u=n+a,l=r-a;if(0<u){t.style.left=u+"px";e.attr&&e.attr.resizeLeft&&e.attr.resizeLeft.call(this,{dx:a,dy:o})}!e.noWidth&&2*s<l&&(t.style.width=l+"px")},resizeTop:function(t,e){if(!g.isElement(t))throw new TypeError("Not found element parameter.");if(!e)throw new TypeError("Not found attribute parameter.");var i=window.getComputedStyle(t),n=parseInt(i.getPropertyValue("top")),r=parseInt(i.getPropertyValue("height")),s=e.attr&&e.attr.offset?e.attr.offset:h.defaultOffset,a=e.dx,o=e.dy,u=n+o,l=r-o;if(0<u){t.style.top=u+"px";e.attr&&e.attr.resizeTop&&e.attr.resizeTop.call(this,{dx:a,dy:o})}!e.noHeight&&2*s<l&&(t.style.height=l+"px")},resizeBottom:function(t,e){if(!g.isElement(t))throw new TypeError("Not found element parameter.");if(!e)throw new TypeError("Not found attribute parameter.");var i=window.getComputedStyle(t),n=parseInt(i.getPropertyValue("top")),r=parseInt(i.getPropertyValue("height")),s=e.attr&&e.attr.offset?e.attr.offset:h.defaultOffset,a=e.dx,o=e.dy,u=r+o;if(2*s<u&&u+n<window.innerHeight){t.style.height=u+"px";e.attr&&e.attr.resizeBottom&&e.attr.resizeBottom.call(this,{dx:a,dy:o})}}};y.resizeable=function(t,e){var i=new n(t,e);e&&!1===e.auto||i.active();return i};!function(){var t,e,i;for(t in r){e="s_"+(i=r[t]);y.resizeable[e]=h[e]=i}for(t in o){e="css_"+(i=o[t]);y.resizeable[e]=h[e]=i}for(t in u){e="type_"+(i=u[t]);y.resizeable[e]=h[e]=i}}()}();B.prototype={constructor:B,addUi:function(t){this.ui=t;this.contents=g.query(this.ui,".contents"),this.linkElement();if(!0===this._modal){this.background=document.createElement("div");g.addClass(this.background,"dui-protect-background");this.background.style.position="fixed";g.append(this.background,this.ui)}},auto:function(){!0!==this._auto&&"true"!==this._auto||this.show()},show:function(){document.body.appendChild(this.background);this.linkEvent();this.linkPosition()},linkElement:function(){var t=this.attr;this.main=g.query(this.ui,".main");this.ctrlMain=g.query(this.ui,".ctrl-main");this.okBtn=g.query(this.ui,".ok-btn");this.okBtn.innerText="OK";"string"==typeof this.text&&this.text&&(this.contents.innerText=this.text);t.width&&(this.main.style.width=t.width+"px");t.height&&(this.main.style.height=t.height+"px")},linkEvent:function(){var e=this;g.on(this.okBtn,"click",function(t){e.onOk(t)})},linkPosition:function(){var t=g.math.rect(0,0,g.ui.innerWidth(),g.ui.innerHeight()),e=g.getBoundingClientRect(this.ui),i=t.center(e),n=this.attr.top||"number"==typeof this.attr.top?this.attr.top:i.y,r=this.attr.left||"number"==typeof this.attr.left?this.attr.left:i.x;this.ui.style.top=n+this.offsetTop+"px";this.ui.style.left=r+"px";this.repaire();y.addResizeable(this);t=e=i=null},onOk:function(t){this.close(t)},close:function(t){if("function"==typeof this.attr.close&&!1===this.attr.close.call(this,t))return!1;!0===this._modal?g.remove(this.background):g.remove(this.ui);y.removeResizeable(this);this.reuse||this.destroy()},resize:function(t){var e=g.math.rect(0,0,g.ui.innerWidth(),g.ui.innerHeight()),i=g.getBoundingClientRect(this.ui),n=e.center(i);this.ui.style.top=n.y+this.offsetTop+"px";this.ui.style.left=n.x+"px";this.repaire()},repaire:function(){var t=g.getBoundingClientRect(this.ui);t.top<=0&&(this.ui.style.top="10px");t.left<=0&&(this.ui.style.left="10px")},destroy:function(){this.background&&delete this.background;this.ui&&delete this.ui;this.text&&delete this.text;this.attr&&delete this.attr;this.contents&&delete this.contents;this.okBtn&&delete this.okBtn}};y.DuiAlert=B;y.alert=function(e,i){e||(e="");i||(i={});var t=window.top&&window.top!==window?window.top.getDframework():null;if(t)return t.ui.alert(e,i);var n=new B(e,i),r=i.resource?i.resource:"html://dframework/html/base.html";g.require(r+"#dui-alert",function(t){n.addUi(g.element(t.outerHTML));n.auto();n=e=i=r=null},function(t){t&&g.error(t)});return n};g.extendClass(F,B,{linkElement:function(){F.__super.linkElement.apply(this,arguments);this.cancelBtn=g.query(this.ui,".cancel-btn");this.cancelBtn.innerText="Cancel"},linkEvent:function(){F.__super.linkEvent.apply(this,arguments);var e=this;g.on(this.cancelBtn,"click",function(t){e.onCancel(t)})},onCancel:function(t){if("function"==typeof this.attr.cancel&&!1===this.attr.cancel(t))return!1;this.close(t)},onOk:function(t){if("function"==typeof this.attr.ok&&!1===this.attr.ok(t))return!1;this.close(t)}});y.DuiConfirm=F;y.confirm=function(e,i){e||(e="");i||(i={});var t=window.top&&window.top!==window?window.top.getDframework():null;if(t)return t.ui.confirm(e,i);var n=new F(e,i),r=i.resource?i.resource:"html://dframework/html/base.html";g.require(r+"#dui-confirm",function(t){n.addUi(g.element(t.outerHTML));n.auto();n=e=i=r=null},function(t){t&&g.error(t)});return n};g.extendClass(U,F,{show:function(){var i,t,n=this.attr,r=this;this.titlebar=g.query(this.ui,".ctrl-titlebar");if(this.noiframe){if(this.userui){i=g.element(this.userui.outerHTML);this.contents.appendChild(i)}}else{i=this.iframe=document.createElement("iframe");g.attr(i,"frameborder",0);g.addClass(i,"dui-iframe");n.name&&(i.name=n.name);n.url&&(i.src=n.url);g.on(this.iframe,"load",function(t){var e=i.contentWindow||i.contentDocument;e.dframework_dialog_guid=r.guid;e.dframework_parent_window=window;(e.dframework_parent_dialog=r).iframeWindow=e;"function"==typeof n.load&&n.load.apply(r,t)});this.contents.appendChild(i)}U.__super.show.apply(this,arguments);if(this.no_button){g.getBoundingClientRect(this.main);g.getBoundingClientRect(this.ctrlMain);g.ui.hide(this.ctrlMain)}if(this.use_titlebar){n.title&&(t=g.query(this.ui,".titlebar"))&&(t.innerText=n.title);this.closeTitleBtn=g.query(this.ui,".close-btn");g.on(this.closeTitleBtn,"click",function(){r.close()})}else{g.getBoundingClientRect(this.main);g.getBoundingClientRect(this.titlebar);g.ui.hide(this.titlebar)}"function"==typeof n.show&&n.show.apply(this)}});y.DuiDialog=U;y.dialog=function(t){t||(t={});t.nobutton=!0;var e=new U(t),i=t.resource?t.resource:"html://dframework/html/base.html";g.require(i+"#dui-dialog",function(t){e.addUi(g.element(t.outerHTML));e.auto()},function(t){t&&g.error(t)});return e};y.closeDialog=function(){var t,e=dframework_dialog_guid;e&&(t=dframework_parent_dialog)&&t.guid==e&&t.close()};y.callbackDialog=function(t,e){var i,n=dframework_dialog_guid;if(n&&(i=dframework_parent_dialog)&&i.guid==n&&"function"==typeof i.callback)return i.callback(t,e)};y.open=function(t){t||(t={});t.nobutton=!0;var e=new U(t),i=t.resource?t.resource:"html://dframework/html/base.html";g.require(i+"#dui-dialog",function(t){e.addUi(g.element(t.outerHTML));e.auto()},function(t){t&&g.error(t)});return e};V.prototype={constructor:V,addUi:function(t){this.ui=t;this.contents=g.query(this.ui,".contents");this.contents&&(this.contentsHtml=this.contents.innerHTML);this.linkElement();if(!0===this._modal){this.background=document.createElement("div");g.addClass(this.background,"dui-protect-background");this.background.style.position="fixed";g.append(this.background,this.ui)}},auto:function(){!0!==this._auto&&"true"!==this._auto||this.show()},show:function(t){var e=t&&t.event?t.event:window.event,i={left:e.clientX+30,top:e.clientY-10};this._lastShowAttr=t;this.linkElement();this._parent=t?t.parent:undefined;t.addItems&&this.addItems(t.addItems);t.disable&&this.disableItem(t.disable);i.top+g.height(this.ui)+5>window.innerHeight&&(i.top-=g.height(this.ui)+5);i.left+g.width(this.ui)+5>window.innerWidth&&(i.left-=g.width(this.ui)+5);!0===this._modal?document.body.appendChild(this.background):document.body.appendChild(this.ui);g.offset(this.ui,i);V.showObjects.push(this)},close:function(t){var e;for(e=V.showObjects.length-1;0<=e;e--)if(V.showObjects[e]===this){g.remove(V.showObjects,e);break}if("function"==typeof this.attr.close&&!1===this.attr.close.call(this,t))return!1;!0===this._modal?g.remove(this.background):g.remove(this.ui);y.removeResizeable(this)},disableItem:function(t){var e,i,n,r,s=g.childs(this.contents);for(e=0;e<s.length;e++){r=(n=s[e]).getAttribute("cmd");for(i=0;i<t.length;i++)if(r==t[i]){g.addClass(n,"disable");break}}},onClickItem:function(t,e,i){if(this.attr.fn&&"function"==typeof this.attr.fn.click){this.attr.fn.click({item:i,target:e,event:t,data:this._lastShowAttr});i.hassub||this.close()}},setClickItem:function(e,i){var n=this;g.on(e,"click",function(t){g.hasClass(e,"disable")||n.onClickItem(t,e,i)})},addItems:function(t){var e,i,n;for(e=0;e<t.length;e++){i=t[e];(n=g.element(this.contentsHtml)).innerText=i.name;n.setAttribute("cmd",i.cmd);this.setClickItem(n,i);this.contents.appendChild(n);g.removeClass(n,"disable")}},linkElement:function(){var t=this.attr;this.main=g.query(this.ui,".main");t.width&&(this.main.style.width=t.width+"px");t.height&&(this.main.style.height=t.height+"px");this.contents.innerHTML="";this.items&&this.items.length&&this.addItems(this.items)}};V.showObjects=[];y.closeContextmenu=function(){var t;for(t=V.showObjects.length-1;0<=t;t--)V.showObjects[t].close()};y.contextmenu=function(t){t||(t={});t.nobutton=!0;y.closeContextmenu();var e=new V(t),i=t.resource?t.resource:"html://dframework/html/base.html";g.require(i+"#dui-contextmenu",function(t){e.addUi(g.element(t.outerHTML));e.auto()},function(t){t&&g.ui.alert(t)});return e};g.define("dframework/uitl/resize-ui",function(){function n(t,e){this.attr=e;this.ui=t}n.prototype={resize:function(t){"function"==typeof this.attr.onresize&&this.attr.onresize.call(this,t)}};return function(t,e){var i=new n(t,e);Ui.addResizeable(i);return i}});g.define("dframework/uitl/select-ui",function(){function e(t){this.uuid="selectui_"+g.guid("");this.attr=t||{};this.selectedUis=[];this.selectedParents=[];this.drawUis=[];this.isstarted=!1;!function(e){e.__static__onselect=function(t){e.onSelectUi(t)};e.__static__oncontext=function(t){return e.onContextmenu(t)}}(this)}e.prototype={constructor:e,getDocument:function(){return"function"==typeof this.attr.document?this.attr.document():this.attr.document?this.attr.document:document},clean:function(){var t;for(t=0;t<this.selectedUis.length;t++)g.remove(this.selectedUis[t].rectUi);for(t=0;t<this.selectedParents.length;t++)g.remove(this.selectedParents[t].rectUi);for(t=0;t<this.drawUis.length;t++)g.remove(this.drawUis[t].rectUi);this.selectedUis=[];this.selectedParents=[];this.drawUis=[]},createRoundUi:function(t){var e=doc.createElement("div");g.offset(e,{top:t.top,left:t.left});e.style.position="absolute";e.style.width=t.width+"px";e.style.height=t.height+"px";e.style.border=t.border;e.style.zIndex=9999999;return e},drawRoundUi:function(t,e){var i=this.getDocument(),n=g.getBoundingClientRect(t),r=i.body.scrollTop||i.documentElement.scrollTop,s=i.body.scrollLeft||i.documentElement.scrollLeft,a=this.createRoundUi({top:n.top+r,left:n.left+s,width:n.width(),height:n.height(),border:"solid 2px red"});i.body.appendChild(a);e||this.drawUis.push({rectUi:a,srcUi:t});return a},onSelectUi:function(t){var e,i,n=this.getDocument(),r=g.math.point(t.clientX,t.clientY),s=g.getElementsByPoint(r,{document:n});if(s){this.clean();for(e=0;e<s.length;e++){i=s[e];this.selectedUis.push({rectUi:this.drawRoundUi(i,!0),srcUi:i})}"function"==typeof this.attr.onselect&&this.attr.onselect.call(this)}},onSelectParent:function(t,e){var i,n,r,s=doc.body.scrollTop||doc.documentElement.scrollTop,a=doc.body.scrollLeft||doc.documentElement.scrollLeft;e||(e=0);if((i=g.parent(t))&&g.isElement(i)){n=g.getBoundingClientRect(i);r=this.createRoundUi({top:n.top+s,left:n.left+a,width:n.width(),height:n.height(),border:"solid 1px blue"});doc.body.appendChild(r);this.selectedParents.push({rectUi:r,srcUi:i});this.onSelectParent(i,e+1)}},onContextmenu:function(t){var e;this.selectedParents=[];for(e=0;e<this.selectedUis.length;e++)this.onSelectParent(this.selectedUis[e].srcUi);if(this.selectedParents.length){"function"==typeof this.attr.onselectparent&&this.attr.onselectparent.call(this,this.selectedParents);return g.igEventAll(t)}},start:function(t){var e=this.getDocument();g.on(e,"mousemove",this.__static__onselect);g.on(e,"contextmenu",this.__static__oncontext);this.isstarted=!0},stop:function(t){var e=this.getDocument();g.off(e,"mousemove",this.__static__onselect);g.off(e,"contextmenu",this.__static__oncontext);this.clean();this.isstarted=!1}};return function(t){return new e(t)}});H.aname="@dui-module-data";H.mname="@dui-module-list";(H.Cursor=function(t){this.iscd=t instanceof H.Cursor.Data;this.root=this.iscd?t:new H.Cursor.Data(t);this.current=this.root}).prototype={constructor:H.Cursor};H.JteData=H.Cursor.Data=function(t,e){this.origin=t;this.type="undefined";this.parent=e;if(!(t instanceof H.JteData||t instanceof G)&&(null!==t&&t!==undefined||"string"==typeof t||"boolean"==typeof t))if(g.isArray(t)){this.hasName=!0;this.type="array";this.index=-1;this.length=t.length;this.hasData=!!this.length;this.current=undefined;this.childs=[];for(var i=0;i<t.length;i++){var n=t[i];if(g.isArray(n))throw new Error("ERROR(jte): array has not array.");n instanceof H.JteData||n instanceof G||this.childs.push(new H.Cursor.Data(n,this))}}else if("object"==typeof t){this.hasName=!0;this.type="object";this.childs={};for(var r in t){r&&(this.hasData=!0);(n=t[r])instanceof H.JteData||n instanceof G||(this.childs[r]=new H.Cursor.Data(n,this))}}else if("function"==typeof t){this.type="function";this.childs=t;this.hasData=!1}else{this.type="value";this.childs=t;this.hasData=""!==t&&null!==t&&t!==undefined}};H.Cursor.Data.prototype={constructor:H.Cursor.Data,data:function(t){return this.hasName?this.childs[t]:this.childs},value:function(){return this.hasName?"":this.origin},cursor:function(t,e){var i;if("array"!=this.type||t){if(!t)return;i=this.data(t)}else i=this;switch(e){case"i":return i;case"":case"current":return-1<i.index?i.data(i.index):i.data(0);case"l":case"last":return i.data(i.length-1);case"f":case"first":return i.data(0);default:var n,r,s,a;if(n=/([\S]+?)\=([\S]+)/.exec(e)){for(r=0;r<i.length;r++)if((s=i.data(r))&&(a=s.data(n[1]))&&a.data()===n[2])return s;return}if(e)return i.data(parseInt(e))}},isa:function(){return"array"==this.type},isArray:function(){return this.isa()}};G.prototype={constructor:G,callModule:function(t,e){var i,n="ERROR(jte): Not found module. moduleName: "+t;if(!(i=this.module?this.module[t]:undefined)&&!(i=g.module(t)))throw new TypeError(n);if("function"!=typeof i)throw new TypeError(n);i.call(this,e)},draw:function(){var t=this.from,e=g.attr(t,"jte-register");e&&(e=e.trim())&&A.push(k[e]=new j(t,e));this.drawElement(this.cursor.current,t)},removeElement:function(t,e){var i,n,r,s,a,o=g.childs(e),u=g.isArray(t)?t:[t];g.each(u,function(t){if(t=t.origin?t.origin:null)for(i=0;i<o.length;i++){n=o[i];if(!g.hasAttr(n,"jte-sample")){a=!1;for(s in t)if(r=g.query(n,'[jte-name="'+s+'"]')){a=!0;if(r.innerText===t[s]||r.innerHTML===t[s])break;a=!1}a&&g.remove(n)}}})},drawSpecialElement:function(t,e){},drawElement:function(t,e){var i,n,r,s,a,o,u=g.attr(e,"jte-control"),l=e.nodeName.toLowerCase();if(!u||!1!==this.callModule(u,{data:t,element:e})){e=this.sampleElement(e);if(g.hasAttr(e,"jte-sample"))p.ie&&p.ie<9&&y.hide(e);else{switch(l){case"select":case"option":return this.drawSpecialElement(t,e)}this.patchJteElement(t,e);switch(this.type){case"module":return this.drawChilds(t,g.childs(e))}if(!(i=g.attr(e,"jte-list")))return this.drawElementSub(t,e);var h=g.attr(e,"jte-row-last");null==h&&(h=-1);"number"!=typeof h&&(h=g.parseInt(h,-1));if(n=g.attr(e,"jte-list-from")){if(!(r=H.query(e,{target:n,query:'[jte-name="'+i+'"]'})))return g.error("Not found jte-list. name: "+i+", target: "+n,"at element :",e);if(!r.element||!r.element.length)return g.error("Not found jte-list. name: "+i+", target: "+n,"at element :",e);r=r.element[0];s=[];if("table"==r.nodeName.toLowerCase()&&r.children.length)for(a=0;a<r.children.length;a++)if("tbody"==r.children[a].nodeName.toLowerCase()){r=r.children[a];break}for(a=0;a<r.children.length;a++)s.push(g.element(r.children[a].outerHTML))}else{if(!(r=g.query(e,'[jte-name="'+i+'"]')))return g.error("Not found jte-list. name: "+i,"at element :",e);s=[g.element(r.outerHTML)]}if(this.remove)return this.removeElement(t,e);var c="array"==t.type?t.childs:[t],d=h+1;g.each.call(this,c,function(t){for(a=0;a<s.length;a++){o=s[a];g.remove(o,"jte-sample");g.remove(o,"jte-name");g.attr(o,"jte-row-no",d);o["jte-row-object"]=t;g.append(e,o);this.drawElement(t,o)}g.attr(e,"jte-row-last",d++)})}}},drawElementSub:function(t,e){var i,n,r="jte-only-array",s=t===this.cursor.current,a=g.hasAttr(e,r),o=g.hasAttr(e,"jte-must"),u=g.hasAttr(e,"jte-no-array"),l=(a?e.getAttribute(r):undefined,this.cursor),h=t.isa();if(a&&!h)return g.error(new Error("ERROR(jte): jte-only-array."));if(h){if(u)return g.error(new Error("ERROR(jte): jte-no-array."));if(o&&(!t||t&&!t.hasData))return this.empty(e);this.drawArray(t,e);l.current=t}else{if("value"==t.type)return o&&!t.hasData?this.empty(e):this.value(t.origin,e);var c,d=e.getAttribute("jte-name");n=g.childs(e);!d||(c=this.findValue(t,d))||s||g.error(new Error("ERROR(jte): Not found jte-name's vlaue. name:"+d));if(!d||c===undefined||null===c||""===c)return o&&d?this.empty(e):this.drawChilds(t,n);if(o&&!c.hasData)return this.empty(e);switch(c.type){case"array":i=l.current;l.current=c;this.drawArray(c,e);l.current=i;break;case"object":i=l.current;l.current=c;this.drawChilds(c,n);l.current=i;break;case"value":this.value(c.origin,e)}}},drawChilds:function(t,e){var i,n;if(0!==e.length)for(i=0;i<e.length;i++)try{n=e[i];g.isElement(n)&&this.drawElement(t,n)}catch(r){g.error(r)}},drawArray:function(t,e){if(0===t.length)return this.empty(e);var i,n,r,s,a,o=this.getArrayAttribute(e),u=e.nodeName.toLowerCase(),l=o.inner?e.getAttribute("jte-save-html"):"",h=l||(o.inner?e.innerHTML:e.outerHTML),c=this.cursor;if(o.inner){switch(u){case"thead":case"tbody":case"tr":case"select":g.removeChildAll(e);break;default:e.innerText=""}!l&&h&&e.setAttribute("jte-save-html",h)}else{if(l)return g.error("Already called draw array !");!l&&h&&e.setAttribute("jte-save-html",h)}for(i=0;i<t.childs.length;i++){if(o.max&&o.max<=i)return;r=t.childs[i];t.index=i;c.current=t.current=r;if(o.inner){s=g.element(h);a=g.isArray(s)?s:[s];for(n=0;n<a.length;n++){s=a[n];e.appendChild(s);if(g.isElement(s)){if("value"==r.type){var d=g.attrs(e);for(var f in d)null!==d[f]&&"undefined"!=typeof d[f]&&s.setAttribute(f,d[f])}this.drawElement(r,s)}}}else{(s=g.element(h)).removeAttribute("jte-only-array");s.removeAttribute("jte-name");s.setAttribute("jte-no-array","true");g.before(e,s);this.drawElement(r,s)}}o.inner||g.remove(e);t.index=-1;t.current=undefined},empty:function(t){var e=t.getAttribute("jte-empty");g.hasAttr(t,"jte-must");switch(e){case"remove":g.remove(t);break;case"noremove":case"no-remove":break;default:t.innerText=""}},value:function(t,e){if(null===t||t===undefined||""===t)return this.empty(e);var i=this.getValueAttribute(e),n=g.hasAttr(e,"jte-must"),r=i.prefix+(t+"")+i.sufix;switch(typeof t){case"string":if((t===undefined||null===t||""===t)&&n)return this.empty(e);i.html?e.innerHTML=r:e.innerText=r;break;case"number":case"boolean":if((t===undefined||null===t||""===t)&&n)return this.empty(e);e.innerText=r}},getValueAttribute:function(t){var e=this.getMultiAttribute(t.getAttribute("jte-value")),i=t.getAttribute("jte-prefix"),n=t.getAttribute("jte-sufix");e.prefix=i||"";e.sufix=n||"";e.html=g.hasAttr(t,"jte-html");return e},getArrayAttribute:function(t){var e=this.getMultiAttribute(t.getAttribute("jte-array"));e.max=e.max?parseInt(e.max):0;e.inner=!e.html||"inner"==e.html.toLowerCase();return e},getMultiAttribute:function(t){var r={};if(t){t=t.split(";");g.each(t,function(t){var e=t.split(":",2),i=e[0].trim(),n=2==e.length?e[1].trim():undefined;i&&(r[i]=n)})}return r},patchJteElement:function(t,e){var i,n,r,s="module"==this.type?H.getJteModuleElements(e):H.getJteAttrElements(e);for(i=0;i<s.length;i++)switch((n=s[i]).type){case"attr":this.patchAttributeElement(t,n,g.attrs(n.element));break;case"module":r=this.patchAttributeWithChildElement(n.element);this.patchModuleElement(t,n,r)}},patchAttributeWithChildElement:function(t){var e,i,n=g.childs(t),r=g.attrs(t);if(0===n.length)return r;r.childs=[];for(i=0;i<n.length;i++){e=this.patchAttributeWithChildElement(n[i]);r.childs.push(e)}return r},patchAttributeElement:function(t,e,i){var n,r=e.mine,s=e.name;if(r){if(g.hasDuiAttr(r,"jte-removed"))return;if(s){n=this.findValue(t,i.value);if(!1===this.patchEmpty(r,i,n))return;g.attr(r,s,n?n.value():"")}}i.module&&this.callModule(i.module,{data:t,element:r,attr:i})},patchModuleElement:function(t,e,i){var n=e.mine,r=e.name;if(r&&!g.hasDuiAttr(n,"jte-removed")){if(H.jteHasModule(r))return H.jteCallModuleElement(r,{jte:this,data:t,element:n,attr:i});this.callModule(r,{jte:this,data:t,element:n,attr:i})}},findValue:function(t,e,i){if(e){if("/"!=(e?e.charAt(0):undefined))return t.data(e);var n,r,s=/^([\S]*?)\[([\S]*)\]$/i,a=e.substring(1).split("/"),o=a.length,u=this.cursor?this.cursor.root:undefined;for(r=0;r<o;r++){if(!u)return;if(e=a[r].trim())if(n=s.exec(e))u=u.cursor(n[1],n[2]);else if(void 0===(u=u.cursor(e,"i")))return}return u}},isEmpty:function(t){return void 0===t||""===t||null===t||"object"==typeof t&&(void 0===(t=t.value())||""===t||null===t)},patchEmpty:function(t,e,i){if(this.isEmpty(i))switch(e.empty){case"remove":g.duiAttr(t,"jte-removed",!0);g.remove(t);return!1}else switch(e.noempty){case"remove":g.duiAttr(t,"jte-removed",!0);g.remove(t);return!1}},sampleElement:function(t){var e,i,n,r,s,a,o,u;if(!(i=g.attr(t,"jte-from")))return t;if(!(e=-1!=(n=i.indexOf(":"))?i.substring(n+1):i))return t;r=-1!=n?i.substring(0,n):"outer";g.attr(t,"jte-source");s="jte-sample";g.isElement(this.top)&&(u=g.query(this.top,'[jte-name="'+e+'"]'));if(!u&&!(u=g.query(document,'[jte-name="'+e+'"]')))throw new Error("Not found jte-name("+e+")");if(a=g.hasAttr(u,s)){p.ie&&p.ie<8&&y.hide(u);o=u.getAttribute(s);u.removeAttribute(s)}if("inner"==r){t.innerHTML=u.outerHTML.trim();a&&u.setAttribute(s,o);a&&p.ie&&p.ie<8&&y.show(g.first(t));return t}var l,h,c,d=g.element(u.outerHTML.trim());a&&p.ie&&p.ie<8&&y.show(d);for(h=0;h<t.attributes.length;h++){l=t.attributes[h];if(p.ie&&p.ie<8)if("style"==l.name){c=t.getAttribute(l.name);for(var f in c)c[f]&&(d.style[f]=c[f])}else null!==(c=t.getAttribute(l.name))&&"null"!=l.value&&""!==c&&void 0!==c&&"boolean"!=typeof c&&0!==c&&d.setAttribute(l.name,l.value);else d.setAttribute(l.name,l.value)}g.before(t,d);g.remove(t);(t=d).removeAttribute(s);t.removeAttribute("jte-from");a&&u.setAttribute(s,o);return t}};H.baseController=function(t){new G(t).draw()};H.selectTag=function(t,e,i,n){var r,s,a,o,u;if(g.isArray(e))for(a=0;a<e.length;a++){o=e[a];(r=document.createElement("option")).value=o.name;r.innerText=o.value;r.value===i&&(u=r.selected=!0);t.appendChild(r)}else for(s in e){(r=document.createElement("option")).value=s;r.value===i&&(u=r.selected=!0);r.innerText="string"==typeof e[s]?e[s]:e[s].value;t.appendChild(r)}"function"==typeof n&&n(u)};H.isJteAttrElement=function(t){var e,i=t.nodeName.toLowerCase();if("div"==i||"tr"==i||"thead"==i||"tbody"==i||"option"==i){if(e=t.getAttribute("jte-module"))return{type:"module",element:t,name:e};if(e=t.getAttribute("jte-attr"))return{type:"attr",element:t,name:e}}return!1};H.getJteAttrElements=function(t){var e,i,n,r=[];for(e=0;e<t.children.length;e++)(n=H.isJteAttrElement(i=t.children[e]))&&r.push(n);if(0===r.length)return r;for(e=0;e<r.length;e++){(i=r[e]).mine=H.searchMineElement(t,i.element);g.remove(i.element)}return r};H.isJteModuleElement=function(t){var e,i=t.nodeName.toLowerCase();return!("div"!=i&&"tr"!=i&&"thead"!=i&&"tbody"!=i&&"option"!=i||!(e=t.getAttribute("jte-module")))&&{type:"module",element:t,name:e}};H.getJteModuleElements=function(t){var e,i,n,r=[];for(e=0;e<t.children.length;e++)(n=H.isJteModuleElement(i=t.children[e]))&&r.push(n);if(0===r.length)return r;for(e=0;e<r.length;e++){(i=r[e]).mine=H.searchMineElement(t,i.element);g.remove(i.element)}return r};(H.jteModuleNames={})["@event"]="dframework/jte/module/event";H.jteModuleNames["@show"]="dframework/jte/module/show";H.jteModuleNames["@hide"]="dframework/jte/module/hide";H.jteModuleNames["@toggle"]="dframework/jte/module/toggle";H.jteModuleNames["@checked"]="dframework/jte/module/checked";H.jteModuleNames["@checkbox"]="dframework/jte/module/checkbox";H.jteModuleNames["@receiver"]="dframework/jte/module/receiver";H.jteModuleNames["@remove-row"]="dframework/jte/module/remove-row";H.jteModuleNames["@dragzone"]="dframework/jte/module/dragzone";H.jteModuleNames["@filedragzone"]="dframework/jte/module/filedragzone";H.jteModuleNames["@file"]="dframework/jte/module/file";H.jteModuleNames["@gallery"]="dframework/jte/module/gallery";H.jteModuleNames["@cburl"]="dframework/jte/module/cburl";H.jteModuleNames["@inputchk"]="dframework/jte/module/inputchk";H.jteModuleNames["@submit"]="dframework/jte/module/submit";H.jteModuleNames["@ajax"]="dframework/jte/module/ajax";H.jteModuleNames["@dialog"]="dframework/jte/module/dialog";H.jteModuleNames["@close"]="dframework/jte/module/close";H.jteHasModule=function(t){return!!H.jteModuleNames[t]};H.jteModuleName=function(t){return H.jteModuleNames[t]};H.jteCallModuleElement=function(t,e){var i=e.attr,n=g.module(H.jteModuleNames[t]);if("function"!=typeof n)return g.error(new TypeError("Not found jte element module. name: "+t));i.sourceJTE=e.jte;i.sourceData=e.data;n(e.element,i)};H.findTargetElement=function(t,e){var i=window.document,n=i.body;function r(t,e){switch(e){case"document":return i;case"body":return n;case"this":return t;case"parent":return g.parent(t);case"before":case"beforeall":return g.before(t);case"after":case"afterall":return g.after(t);case"first":return g.first(t);case"last":return g.last(t);default:return}}for(var s=r(t,e);;){if(!s||!g.isElement(s)||s===n)return s;if(!!!(g.hasAttr(s,"jte-sample")||g.hasAttr(s,"jte-attr")||g.hasAttr(s,"jte-module")))return s;switch(e){case"before":case"beforeall":case"after":case"afterall":s=r(s,e);continue}return s}};H.query=function(t,e){if(!e)return null;var i,n,r,s=document,a=s.body,o=t,u=e.target;if(e.query)i=e.query.trim();else if(e.queryAll||e.queryall){n=!0;i=e.queryAll?e.queryAll.trim():e.queryall.trim()}if(g.isElement(u)||u===s||u===a)o=u;else{var l,h,c,d,f,p=[],m=u?u.split("/"):["before"];for(c=0;c<m.length;c++)if(f=m[c].trim())if(-1!=(l=f.indexOf(":"))){if(h=f.substring(0,l).trim()){p.push(h);if((f=f.substring(l+1).trim())&&1<(f=parseInt(f)))for(d=1;d<f;d++)p.push(h)}}else p.push(f);for(c=0;c<p.length;c++)if(f=p[c].trim()){if(!(o=H.findTargetElement(o,f)))return null;r=f}}o&&i&&(o=n?g.queryAll(o,i):g.query(o,i));return!o||g.isArray(o)&&0===o.length?null:{source:t,lastName:r,names:p,element:n?o:[o]}};H.searchMineElement=function(t,e){var i;if(!(i=g.attr(e,"mine"))||!(i=i.trim())||"parent"==i.toLowerCase())return t;if("before"!=i.toLowerCase())return g.error(new Error("attribute element mine value is parent or before."));for(;;){if(!(e=g.before(e)))return;if(g.isElement(e)&&!H.isJteAttrElement(e))return e}};H.toJson=p.ie&&p.ie<9?function W(t){return g.jQuery.parseJSON(t)}:function Y(t){var e,r,i=function(){for(var t;;){t="a"+g.guid("");if(!window[t])return t}}(),n="'"+i+"'";function s(t,e,i){var n=window[t];if(n){r=e;p.ie&&p.ie<9||g.remove(window[t].script);window[t]=n=n.error=n.script=undefined}}window[i]=function(t,e){s(t,e)};window[i].error=function(t,e){s(t,null)};window[i].script=document.createElement("script");window[i].script.type="text/javascript";e="try {\n\twindow["+n+"]("+n+", "+t+");\n} catch(e){\n\t\twindow["+n+"].error("+n+", e);\n}";if(p.ie&&p.ie<9)return g.error(new Error("Not support script inner text. under ie 9."));window[i].script.innerText=e;document.body.appendChild(window[i].script);return r};H.elementToJson=function(t){var e;if(e=t.innerText.trim())return H.toJson(e)};H.getChildAttribute=function(t,e,i,n){if(t&&t.childs){var r,s,a,o=[];if(!n){for(s=0;s<t.childs.length;s++)(r=t.childs[s])[e]===i&&o.push(r);return o.length?o:null}for(s=t.childs.length-1;0<=s;s--)if((r=t.childs[s])[e]===i){o.push(r);t.childs.splice(s,1)}if(o.length){a=[];for(s=o.length-1;0<=s;s--)a.push(o[s]);return a}}};var w=[];H.addUserData=function(t,e){var i=new Error("add data : "+t);w.push({name:t,value:e,stack:i})};H.removeUserData=function(t,e){for(var i=w.length-1;0<=i;i--)w[i].name===t&&w.splice(i,1)};H.getUserData=function(t){for(var e=0;e<w.length;e++)if(w[e].name===t)return w[e]};H.getUserDataValue=function(t){var e=H.getUserData(t);if(e)return e.value};H.getUserDataAll=function(t){for(var e=[],i=0;i<w.length;i++)w[i].name===t&&e.push(w[i]);return e};var C,A=[],k={},N={},x=[];H.getRegister=function(t){return k[t]};H.getRegisterModule=function(t){return N[t]};j.prototype={constructor:j,hasEvent:function(t){return!!this.event[t]},getEvent:function(t){return this.event[t]},addEvent:function(t,e){if(t){var i,n,r,s=t.split(",");g.each.call(this,s,function(t){if(t=t.trim()){n=this.event[t];if((r=n||(this.event[t]=[])).length)for(i=0;i<r.length;i++)if(r[i]===e)return;r.push(e);this._events.push(e);n||g.on(this.element,t,j.onEvent)}})}},removeEvent:function(t,e){if(t){var i,n,r,s,a,o=t.split(",");for(i=0;i<o.length;i++)if((r=o[i].trim())&&(s=this.event[r])){a=!1;for(n=0;n<s.length;n++)if(s[n]===e){a=n;break}if(!1!==a){g.remove(s,a);0===s.length&&g.off(this.element,r,j.onEvent)}}}},callEvent:function(t){var e,i,n;if(e=this.event[t.type])for(n=0;n<e.length;n++){i=e[n];try{if(i instanceof q&&!1===i.__on(t))return!1}catch(err){g.error(err)}}}};j.onEvent=function(t){var e,i=p.ie&&p.ie<9?g.target(t):this;if(p.ie&&p.ie<9)for(;(!(e=g.duiAttr(i,"jte-element"))||!e.hasEvent(t.type))&&(i=g.parent(i)););else e=g.duiAttr(i,"jte-element");if(e)return e.callEvent(t)};j.on=function(t,e,i){j.get(t).addEvent(e,i)};j.off=function(t,e,i){j.get(t).removeEvent(e,i)};j.get=function(t){var e=g.duiAttr(t,"jte-element");return e||(e=g.duiAttr(t,"jte-element",new j(t)))?e:g.error(new Error("Not found JteElement dui attribute."),t)};j.has=function(t){return!!g.duiAttr(t,"jte-element")};q.prototype={constructor:q,ready:function(){var t=this.args,e=H.getChildAttribute(t,"way","to",!0),i=H.getChildAttribute(t,"way","from",!0);e&&e.length&&(this.toElement=this.patchWithElement(e));i&&i.length&&(this.fromElement=this.patchWithElement(i));this.callUserModule("ready")},patchWithElement:function(t){var u,l,h=null;if(t&&t.length){h=[];g.each.call(this,t,function(t){u=t.module?g.module(t.module):null;if(t.event&&"string"==typeof t.event){var e,i,n,r,s,a={},o=t.event.split(",");for(e=0;e<o.length;e++)(i=o[e].trim())&&(-1==(n=i.indexOf(":"))?a[i]=!0:(r=i.substring(0,n).trim())?a[r]=!(s=i.substring(n+1).trim())||s:a.all=!(s=i.substring(n+1).trim())||s);t.event=a}if(t.target)return(l=this.patchQuery(t))?this.addWithElement(h,l,t,u):null;h.push({module:u})})}return h},addWithElement:function(t,i,n,r){var s,a,e=g.isArray(i.element)?i.element:[i.element],o=n.childs;g.each.call(this,e,function(e){if(g.isElement(e)&&!this.getWithElement(t,e)){g.each.call(this,o,function(t){if(t){s=(s=H.jteModuleName(t.module))?s:t.module;if(!(a=g.module(s)))return g.error(new Error("Not found module. name: "+t.name));"this"==t.target&&(t.target=this.origin);a(e,t)}});t.push({module:r,element:e,query:i,option:n})}})},getWithElement:function(t,e){var i;for(i=0;i<t.length;i++)if(t[i].element===e)return t[i]},patchQuery:function(t){var e;if(t.target&&(e=H.query(this.origin,t)))return e;t.target||g.error("Not found query element.",t,"at element: ",this.origin);return null},_addEvent:function(t){var e,i,n=this.asEvent?this.asEvent:this.asEvent={},r=t.indexOf(":");if(-1==r)i=t.trim();else{i=t.substring(0,r).trim();e=t.substring(r+1).trim()}n[i]=e||!0;this.jtee.addEvent(i,this)},addEvent:function(t){"string"==typeof t?g.each.call(this,t.split(","),function(t){this._addEvent(t)}):g.isArray(t)&&t.length&&g.each.call(this,t,function(t){this._addEvent(t)})},removeEvent:function(t){this.jtee&&this.jtee.removeEvent(t,this)},hasEvent:function(t){return!(!this.asEvent||!this.asEvent[t])},getEvent:function(t){return this.asEvent?this.asEvent[t]:null},callUserModule:function(t){var e,i,n,r=this.userModule;if(r&&r.length)for(e=0;e<r.length;e++)if(i=r[e][t])if(this.jte&&this.jte.module&&(n=this.jte.module[i])){if(!1===n.apply(this,arguments))return!1}else if(n=g.module(i)){if(!1===n.apply(this,arguments))return!1}else g.error(new Error("Not found module ("+i+") for "+t+".",this))},_getDispatchEventArgument:function(t,e,i,n,r){var s,a,o=r&&r.event?r.event:null;t||(t={});t.target=g.isElement(i)?i:this.origin;if(o&&o.all&&!0!==o.all){t.type&&(t.originType=t.type);t.type=o.all}else t.type?t.type=o&&o[t.type]&&!0!==o[t.type]?o[t.type]:t.type:e&&e.type&&(t.type=o&&o[e.type]&&!0!==o[e.type]?o[e.type]:e.type);if(!t.type)return g.error(new Error("Not found event type. ",e,i,n,r));e&&(t.fromEvent=e);t.fromElement||(t.fromElement=g.isElement(this.origin)?this.origin:e?e.target:null);if(t.args){if("object"==typeof n){s=t.args;for(a in n)s[a]=n[a]}}else s=t.args="object"==typeof n?n:{};s.data=this.data;s.jte=this.jte;s.fromModule=this;return t},getDispatchEventArgument:function(t,e,i,n,r){return this._getDispatchEventArgument(t,e,i,n,r)},repatchEventToElement:function(t,e){return j.get(t).callEvent(e)},_dispatchEventToElement:function(t,e,i,n){var r;if("function"==typeof i.module){r=this.getDispatchEventArgument(t,e,i.element,n,i.option);if(!1===i.module(r))return!1}if(g.isElement(i.element)&&i.element!==this.origin){r=this.getDispatchEventArgument(t,e,i.element,n,i.option);if(!1===this.repatchEventToElement(i.element,r))return!1}if(g.isElement(i)&&i!==this.origin){r=this.getDispatchEventArgument(t,e,i,n);if(!1===this.repatchEventToElement(i,r))return!1}},dispatchEventToElement:function(t,e,i,n){return this._dispatchEventToElement(t,e,i,n)},_dispatchEvent:function(t,e,i,n){var r;if(!g.isArray(i))return this.dispatchEventToElement(t,e,i,n);for(r=0;r<i.length;r++)if(!1===this.dispatchEventToElement(t,e,i[r],n))return!1},dispatchEvent:function(t,e,i){var n,r=this.targetElement;return("function"!=typeof this.module||!1!==this.module.call(this,this.getDispatchEventArgument(t,e,null,i)))&&((!(n=r&&r.element)||!1!==this._dispatchEvent(t,e,n,i))&&((!(n=this.toElement)||!1!==this._dispatchEvent(t,e,n,i))&&void 0))},_dispatchElement:function(e,t){g.isArray(t)?g.each.call(this,t,function(t){e.push(t)}):e.push(t)},dispatchElement:function(){var t,e=this.targetElement,i=[];"function"==typeof this.module&&i.push(this.module);(t=e&&e.element)&&this._dispatchElement(i,t);(t=this.toElement)&&this._dispatchElement(i,t);return i},__on:function(t){return!1!==this.callUserModule("on")&&(!1!==this.on(t)&&(!1!==this.callUserModule("complete")&&void 0))},on:function(t){}};H.JteModule=q;g.define("dframework/jte/module/event",function(){function i(t,e){H.JteModule.apply(this,arguments)}g.extendClass(i,H.JteModule,{on:function(t){var e,i=t.type;if(e=this.getEvent(i)){if(!0===e)return this.dispatchEvent({type:i},t);if("string"==typeof e)return this.dispatchEvent({type:e},t)}}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/show",function(){function i(t,e){H.JteModule.apply(this,arguments);this.isUserEvent||this.addEvent("click")}g.extendClass(i,H.JteModule,{on:function(t){if(this.hasEvent(t.type))return this.show(t)},show:function(t){var e,i=this.targetElement;return("function"!=typeof this.module||!1!==this.module.call(this,this.getDispatchEventArgument(ne,oe,null,a)))&&((!(e=i&&i.element)||!1!==function n(t,e){g.each(e,function(t){g.ui.show(t)})}.call(this,t,e))&&void 0)}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/hide",function(){function i(t,e){H.JteModule.apply(this,arguments);this.isUserEvent||this.addEvent("click")}g.extendClass(i,H.JteModule,{on:function(t){if(this.hasEvent(t.type))return this.hide(t)},hide:function(t){var e,i=this.targetElement;return("function"!=typeof this.module||!1!==this.module.call(this,this.getDispatchEventArgument(ne,oe,null,a)))&&((!(e=i&&i.element)||!1!==function n(t,e){g.each(e,function(t){g.ui.hide(t)})}.call(this,t,e))&&void 0)}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/toggle",function(){function i(t,e){H.JteModule.apply(this,arguments);this.toggleStatus="show";e.nocursor||g.cursor(t,e.cursor?e.cursor:"hand");if("hide"==e.status){this.toggleStatus="show";this.toggle({target:t},"hide")}else if("show"==e.status){this.toggleStatus="hide";this.toggle({target:t},"show")}this.isUserEvent||this.addEvent("click")}g.extendClass(i,H.JteModule,{on:function(t){if(this.hasEvent(t.type))return this.toggle(t)},toggle:function(t,e){function i(t,e,i,n,r){for(var s,a=r||this.toggleStatus;e;){g.isElement(e)&&!g.hasAttr(e,"jte-sample")&&("hide"==r?y.hide(e):"show"==r?y.show(e):"show"==a?y.show(e,n):y.hide(e,n));switch(i.lastName){case"beforeall":e=g.before(e);break;case"afterall":e=g.after(e);break;default:e=undefined}}(s="function"==typeof o.module?o.module:"string"==typeof o.module&&g.module(o.module))&&a&&s.call(this.origin,t,a)}var n,r,s,o=this.args;(o.animation||o.duration||o.method)&&(n={module:o.method,duration:o.duration?parseInt(o.duration):undefined});this.toggleStatus="show"==this.toggleStatus?"hide":"show";if(s=this.patchQuery(o))for(r=0;r<s.element.length;r++)i.call(this,t,s.element[r],s,n,e)}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/checked",function(){function i(t,e){H.JteModule.apply(this,arguments);e.nocursor||g.cursor(t,e.cursor?e.cursor:"hand");this.isUserEvent||this.addEvent("click")}g.extendClass(i,H.JteModule,{on:function(t){if(this.hasEvent(t.type))return this.toggleChecked(t)},toggleChecked:function(t){var e,i,n=this.args;if(e=this.patchQuery(n))for(i=0;i<e.element.length;i++)this.toggleCheckedTarget(t,e.element[i])},toggleCheckedTarget:function(t,e){var i,n;(i=g.attr(e,"type"))||(i="");if(!e.disabled){n=!e.checked;switch(i.toLowerCase()){case"checkbox":case"radio":default:e.checked=n}e.checked===n&&this.dispatchEventToElement({type:"change"},t,e,{value:n})}}});return function(t,e){return new i(t,e)}});g.setTimeout=function(t,e){setTimeout(function(){},e)};g.define("dframework/jte/module/receiver",function(){function n(t,e){H.JteModule.apply(this,arguments);this.addEvent("receiver")}g.extendClass(n,H.JteModule,{on:function(t){if(this.hasEvent(t.type))return this.receiver(t)},receiver:function(t){var e,i,n=this.args,r=t.args,s=n?n.method:t.args&&t.args.method?t.args.method:"";switch(s){case"class":if(r&&!0===r.value){n.on&&g.addClass(this.origin,n.on);"string"==typeof n.ontext?this.origin.innerText=n.ontext:"string"==typeof n.onhtml&&(this.origin.innerHTML=n.onhtml);n.off&&g.removeClass(this.origin,n.off);n.init&&g.removeClass(this.origin,n.init)}else if(!r||r&&!1===r.value){n.on&&g.removeClass(this.origin,n.on);n.off&&g.addClass(this.origin,n.off);"string"==typeof n.offtext?this.origin.innerText=n.offtext:"string"==typeof n.offhtml&&(this.origin.innerHTML=n.offhtml);n.init&&g.removeClass(this.origin,n.init)}else if(r&&0===r.value){n.on&&g.removeClass(this.origin,n.on);n.off&&g.removeClass(this.origin,n.off);n.init&&g.addClass(this.origin,n.init);"string"==typeof n.inittext?this.origin.innerText=n.inittext:"string"==typeof n.inithtml&&(this.origin.innerHTML=n.inithtml)}return;case"setclass":if(r){r.add&&g.addClass(this.origin,r.add);r.remove&&g.removeClass(this.origin,r.remove)}return;case"toggle-data":return this.receiver_data(t,{remove:!(!r||"boolean"!=typeof r.value)&&!r.value,data:t.args.data});case"toggle-value":return this.receiver_data(t,{remove:!(!r||"boolean"!=typeof r.value)&&!r.value,data:t.args.value});case"jte-data":return this.receiver_data(t);case"jte-module":if(!(e=n?n.moduleName:""))return g.error("Not found module name at receiver module",t);i=(i=H.jteModuleName(e))?i:e;return(i=g.module(i))?"function"!=typeof i?g.error(new Error("Is Not function. module-name: "+e),t):i(t,this):g.error(new Error("Not found module. name: "+e),t);case"enabled":this.origin.disabled=!r.value;break;case"disabled":this.origin.disabled=!!r.value;break;default:g.error("Not found method at receiver module. method: "+s,t)}},receiver_data:function(t,e){var i,n={from:this.origin};if(e)for(i in e)n[i]=e[i];H(n)}});return function(t,e){var i=j.get(t).event.receiver;if(!i||!i.length)return new n(t,e)}});g.define("dframework/jte/module/checkbox",function(){function i(t,e){H.JteModule.apply(this,arguments);p.ie&&p.ie<9&&this.addEvent("click");this.addEvent("change")}g.extendClass(i,H.JteModule,{on:function(t){return this.dispatchEvent({type:"receiver"},t,{value:this.origin.checked})}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/remove-row",function(){function i(t,e){H.JteModule.apply(this,arguments);e.nocursor||g.cursor(t,e.cursor?e.cursor:"hand");this.isUserEvent||this.addEvent("click")}g.extendClass(i,H.JteModule,{on:function(t){if(this.hasEvent(t.type)){for(var e,i,n,r,s=this.origin,a=null;;){if(!g.isElement(s))break;if(n||null===(a=g.attr(s,"jte-row-no"))){if(!r&&null!==g.attr(s,"jte-list")){r=s;break}}else n=s;s=g.parent(s)}if(n&&r&&(e=g.queryAll(r,'[jte-row-no="'+a+'"]')))for(i=0;i<e.length;i++)g.remove(e[i]);return this.dispatchEvent({},t,{value:{removeElement:e,listElement:r}})}}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/dragzone",function(){function i(t,e){H.JteModule.apply(this,arguments);var i;this.getEvent(i="dragenter")||this.addEvent(i);this.getEvent(i="dragover")||this.addEvent(i);this.getEvent(i="dragleave")||this.addEvent(i);this.getEvent(i="drop")||this.addEvent(i)}g.extendClass(i,H.JteModule,{on:function(t){var e,i=t.type;if(e=this.getEvent(i))switch(i){case"drop":break;default:if(!0===e)return this.dispatchEvent({type:i},t);if("string"==typeof e)return this.dispatchEvent({type:e},t)}}});return function(t,e){return new i(t,e)}});var M,R=function(t){t.stopPropagation&&t.stopPropagation();t.preventDefault&&t.preventDefault();t.dataTransfer.dropEffect="copy";return C.on(t)},D=function(t){var e,i,n;t.preventDefault&&t.preventDefault();if((e=t.dataTransfer.files)&&e.length){i=[];for(n=0;n<e.length;n++)i.push(e[n])}t.args={value:i};return C.on(t)};z.prototype={constructor:z,add:function(t){this.mods.push(t);1==this.mods.length&&this.start()},remove:function(t){for(var e=0;e<this.mods.length;e++)if(this.mods[e]===t)return this.mods.splice(e,1);0===this.mods.length&&this.stop()},start:function(){g.on(this.target,"dragover",R);g.on(this.target,"drop",D)},stop:function(){g.off(this.target,"dragover",R);g.off(this.target,"drop",D)},on:function(t){var e,i,n,r,s,a,o,u;for(i=this.mods.length-1;0<=i;i--){e=this.mods[i];if(g.isElement(n=e.origin)&&"none"!=e.origin.style.display){s=!1;r=n;for(;;){a=g.parent(r);if("none"==r.style.display||g.attr(r,"jte-sample")||!a)break;if(a===document.body||a===document){s=!0;break}r=a}if(s&&(!((u=e.args)&&u.inrect&&"false"!=u.inrect&&(o=g.getBoundingClientRect(e.origin)))||o.contains(t.x,t.y))&&!1===e.__on(t))return!1}}}};C=new z;g.define("dframework/jte/module/filedragzone",function(){function i(t,e){H.JteModule.apply(this,arguments);C.add(this)}g.extendClass(i,H.JteModule,{on:function(t){var e,i,n,r=t.type,s=t.args,a=s&&s.value;if(a)for(e=0;e<a.length;e++){(i=a[e]).sizeText=g.fileSize(i.size);2==(n=i.sizeText.split(" ")).length&&(i.sizeName=n[1])}return"drop"!==r?this.dispatchEvent({type:r},t,{value:a}):this.dispatchEvent({type:"receiver"},t,{value:a})}});return function(t,e){if(p.ie&&p.ie<10)throw new TypeError("filedragzone module is not support. ie<=9");return new i(t,e)}});g.define("dframework/jte/module/cburl",function(){function i(t,e){H.JteModule.apply(this,arguments);this.getEvent("click")||this.addEvent("click")}g.extendClass(i,H.JteModule,{on:function(t){var e,i=this.args;if(i.method&&(e=g.param("cb-"+i.method))){"true"===i.replace?document.location.replace(e):document.location.href=e;return"true"==i.replace?document.location.replace(e):document.location.href=e}switch(i.method){case"cancel":window.history.back()}}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/inputchk",function(){var c=function(t,e){return new i(t,e)};c.specialChars="`~!@#$%^&*()-=_+[]{}:;\"'\\|<>?,./";c.numberChars="0123456789";c.E2000={code:2e3,val:"There is no {$x-name} input."};c.E2001={code:2001,val:"{$x-name} is english, number, '_'"};c.E2002={code:2002,val:"{$x-name} length is min better {$min}."};c.E2003={code:2003,val:"{$x-name} length is max better {$max}."};c.E2004={code:2004,val:"{$x-name} with special charactor"};c.E2005={code:2005,val:"{$x-name} with number charactor"};c.E2006={code:2006,val:"{$x-name} is Wrong email type"};c.E2007={code:2007,val:"{$x-name} is no comparison found"};c.E2008={code:2008,val:"{$x-name} is not equals confirm password"};c.E2009={code:2009,val:"Integer"};c.E2010={code:2010,val:"Float"};c.E2012={code:2012,val:"min value"};c.E2013={code:2013,val:"max value"};c.E2800={code:2800,val:"Not found target element."};c.E2810={code:2810,val:"Not found form element."};c.E2811={code:2811,val:"You has submit element."};c.E2990={code:2990,val:"Wrong format"};c.E2999={code:2999,val:""};function i(t,e){H.JteModule.apply(this,arguments);this.getEvent("keyup")||this.addEvent("keyup");this.id="dframework/jte/module/inputchk";this.errorCode}g.extendClass(i,H.JteModule,{ready:function(){i.__super.ready.call(this);var t=this.args;t.min&&(t.min=g.parseInt(t.min));t.max&&(t.max=g.parseInt(t.max))},on:function(t){return this.check(t)},getErrorMessage:function(){var t,e,i,n,r,s,a=this.errorInfo?this.errorInfo.val:"",o=a,u="";if(!a)return"";for(;;){if(!o||!(t=/\{[\s]*\$([a-zA-Z0-9\-\_\:]+)[\s]*\}/i.exec(o)))break;e=t[0];i=t[1];r=o.indexOf(e);s=o.substring(0,r);o=o.substring(r+e.length);(n=this.args[i])?u+=s+n:u+=s}return o?u+o:u},getErrorCode:function(){return this.errorInfo?this.errorInfo.code:0},setErrorCode:function(t,e){return!(this.errorInfo={code:t.code,val:t.val,args:e})},repatchEventToElement:function(t,e){if(!j.has(t))return!1;var i,n,r,s,a=j.get(t).event.receiver;if(!a)return!1;for(i=0;i<a.length;i++){n=a[i];try{if(n instanceof q)switch(n.args.method){case"class":s=e.args.value;e.args.value.checksum;e.args.value=0===this.origin.value.length?0:!e.args.value.checksum;r=n.__on(e);e.args.value=s;if(!1===r)return!1;break;default:if(!1===n.__on(e))return!1}}catch(err){g.error(err)}}},check:function(t,e){var i=this._check(t,e),n=(this.dispatchElement(),this.origin.value);this.dispatchEvent({type:"receiver"},t,{value:{value:n,checksum:!1!==i,errorCode:this.getErrorCode(),errorMessage:this.getErrorMessage(),args:this.args}});return i},_check:function(t,e){var i,n,r=this.args,s=this.origin.value?this.origin.value:"";this.errorInfo=null;"false"!=r.trim&&s&&(s=s.trim());switch(r.method){case"string":if(!s)return this.setErrorCode(c.E2000,r);if("number"==typeof r.min&&s.length<r.min)return this.setErrorCode(c.E2002,r);if("number"==typeof r.max&&s.length>r.max)return this.setErrorCode(c.E2003,r);break;case"number":if(!s)return this.setErrorCode(c.E2000,r);iv=parseInt(s);if("number"==typeof r.min&&iv<r.min)return this.setErrorCode(c.E2012,r);if("number"==typeof r.max&&iv>r.max)return this.setErrorCode(c.E2013,r)}switch(r.format){case"id":if(!/^([a-zA-Z]{1}[0-9a-zA-Z\_]+)$/.exec(s))return this.setErrorCode(c.E2001,r);break;case"integer":if(!/^([0-9]+)$/.exec(s))return this.setErrorCode(c.E2009,r);break;case"float":if(!/^([0-9\.]+)$/.exec(s))return this.setErrorCode(c.E2010,r);break;case"email":if(!/^([\S]+?)@([\S]+)$/.exec(s))return this.setErrorCode(c.E2006,r);break;case"password":var a=0,o=0,u=g.parseInt(r["with-special-char"],0),l=g.parseInt(r["with-number-char"],0);if(u||l)for(n=0;n<s.length;n++){u&&-1!=c.specialChars.indexOf(s[n])&&a++;l&&-1!=c.numberChars.indexOf(s[n])&&o++}if(u&&a<u)return this.setErrorCode(c.E2004,r);if(l&&o<l)return this.setErrorCode(c.E2005,r);if(!1===this.checkWithEqual(s,r,e))return!1}if(r.regexp&&(i=r.regexp.trim())){var h=r["regexp-flags"];if(!(h&&(h=h.trim())?new RegExp(i,h):new RegExp(i)).exec(s))return this.setErrorCode(c.E2990,r)}if("password"!=r.format&&!1===this.checkWithEqual(s,r,e))return!1},checkWithEqual:function(t,e,i){if(!i&&e["with-equal-target"]){var n,r,s,a,o,u={target:e["with-equal-target"],query:e["with-equal-query"],queryAll:e["with-equal-queryall"]?e["with-equal-queryall"]:e["with-equal-queryAll"]},l=H.query(this.origin,u);if(!l||!l.element||!l.element.length)return this.setErrorCode(c.E2007,e);for(n=0;n<l.element.length;n++){if((s=l.element[n]).value!==t)return this.setErrorCode(c.E2008,e);if(j.has(s)){a=j.get(s);for(r=0;r<a._events.length;r++)"dframework/jte/module/inputchk"==(o=a._events[r]).id&&o.check(null,!0)}}}}});return c});y.openArguments=["width","height","top","left","channelmode","directories","fullscreen","location","menubar","resizable","scrollbars","status","titlebar","toolbar","notab","replace","no-result-ok","x-ok-btn","x-ok-btnAll","x-cancel-btn","x-cancel-btnAll"];g.define("dframework/jte/module/submit",function(){var a=g.module("dframework/jte/module/inputchk");function i(t,e){H.JteModule.apply(this,arguments);this.formElement=(i=this.targetElement,n=i&&i.element?i.element[0]:null,!(!g.isElement(n)||"form"!=n.nodeName.toLowerCase())&&n);var i,n;if(this.formElement){var r=this;g.on(this.formElement,"submit",function(t){return r.__on(t)})}this.getEvent("click")||this.addEvent("click")}g.extendClass(i,H.JteModule,{on:function(t){return this.check(t)},check:function(t){var e,i=this.args,n=this.targetElement,r=n&&n.element?n.element[0]:null;"function"==typeof t.preventDefault&&t.preventDefault();"function"==typeof t.stopPropagation&&t.stopPropagation();"function"==typeof t.stopImmediatepropagation&&t.stopImmediatepropagation();this._ces_error=[];this._submits=[];this._inputs=[];this._files=0;r&&g.isElement(r)||this._ces_error.push({element:this.origin,mod:null,code:a.E2800.code,val:a.E2800.val});this.checkElement(t,r);if(!this.formElement)switch(i.method){case"form":this._ces_error.push({element:this.origin,mod:null,code:a.E2810.code,val:a.E2810.val})}this._submits.length&&this._ces_error.push({element:this.origin,mod:null,code:a.E2811.code,val:a.E2811.val});if(this._ces_error.length){g.error(this._ces_error);var s=this._ces_error[0];setTimeout(function(){g.ui.alert(s.val,{close:function(){s.element.focus&&s.element.focus();s=null}})},1)}else e=this.submit(t,r);delete this._ces_error;delete this._submits;delete this._inputs;delete this._files;return e},checkElement:function(t,e){if(g.isElement(e)){var i,n=g.childs(e),r=g.attr(e,"type"),s=r?r.toLowerCase():"",a=e.nodeName.toLowerCase();if("submit"==s&&"input"!=a)this._submits.push(e);else if("input"==a){"file"==s&&this._files++;"button"!=s&&this._inputs.push(e)}this.checkJteElement(t,e);this._ces_error.length;for(i=0;i<n.length;i++)this.checkElement(t,n[i])}},checkJteElement:function(t,e){var i,n,r;if(j.has(e)&&(i=j.get(e))&&i._events&&i._events.length)for(n=0;n<i._events.length;n++)"dframework/jte/module/inputchk"==i._events[n].id&&!1===(r=i._events[n]).check()&&this._ces_error.push({element:e,mod:r,code:r.getErrorCode(),val:r.getErrorMessage()})},submit:function(t,s){var a=this.args,e=a.method?a.method:"",i=a.url?a.url:"",n=a.type?a.type.toLowerCase():"",r=a.enctype?a.enctype.toLowerCase():"",o=a.window?a.window:a.windowName?a.windowName:"",u={action:i||(this.formElement&&s.action?s.action:""),enctype:r||(this.formElement&&s.enctype?s.enctype:""),target:o||(this.formElement&&s.target?s.target:""),method:n||(this.formElement&&s.method?s.method:"")};if(this.formElement){s.action=u.action;s.enctype=u.enctype;s.target=u.target;s.method=u.method;if(!a.method||"form"==a.method)return s.submit()}var l,h,c,d={},f=y.openArguments;for(c=0;c<f.length;c++){h=f[c];!(l=typeof a[h])||"string"!=l&&"boolean"!=l&&"number"!=l||(d[h]=a[h])}d.url=u.action;d.name=u.target;var p=this;switch(e){case"window":if(this.formElement){s.target=d.name?d.name:d.name="A"+g.guid("");s.action=d.url;d.url="about:blank";g.open(d);return s.submit()}return g.error("Not support.");case"dialog":s.target=d.name?d.name:d.name="A"+g.guid("");s.action=d.url;d.url="about:blank";d.show=function(){s.submit();d=s=null};return g.ui.open(d);case"ajax":d.type=u.method;d.data=this.formElement?s:this._inputs;d.error=function(t){g.ui.alert("Error",{close:function(){p.error(null,t)}})};d.success=function(t,e,i){var n,r;try{n=g.toJson(t)}catch(s){g.error(s);r="Not parse result."}if(r||n&&!n.result){r||(r=n.error_msg?n.error_msg:"Error");g.ui.alert(r,{close:function(){p.error(n,i)}})}else a["no-result-ok"]?p.success():g.ui.alert("Success.",{close:function(){p.success(n,i)}})};return g.ajax(d);default:p=null}},error:function(t,e){this.lastjob(t,e,!1,"error")},success:function(t,e){this.lastjob(t,e,!0,"success")},lastjob:function(t,e,i,n){var r,s,a,o,u,l,h,c,d=this.args,f=H.getChildAttribute(d,"way",n,!0);if(f&&(!f||f.length))for(r=0;r<f.length;r++)if(o=(a=f[r]).location)document.location=o;else if(o=a["location-replace"])document.location.replace(o);else if(o=a["location-reload"])document.location.reload();else if(o=a["parent-href"])parent.location=o;else if(o=a["parent-replace"])parent.location.replace(o);else if(o=a["parent-reload"])parent.location.reload();else if(o=a["top-href"])top.location=o;else if(o=a["top-replace"])top.location.replace(o);else if(o=a["top-reload"])top.location.reload();else if(o=a.window){h={url:o};for(s=0;s<nl.length;s++)!(l=typeof a[u=nl[r]])||"string"!=l&&"boolean"!=l&&"number"!=l||(h[u]=a[u]);g.open(h)}else if(o=a.dialog){h={url:o};for(s=0;s<nl.length;s++)!(l=typeof a[u=nl[r]])||"string"!=l&&"boolean"!=l&&"number"!=l||(h[u]=a[u]);g.ui.open(h)}else(o=a.history)?history.go(parseInt(o)):(o=a.module)&&"function"==typeof(c=g.module(o))&&c.call(this,t,e,i)}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/ajax",function(){function i(t,e){H.JteModule.apply(this,arguments);this.getEvent("click")||this.addEvent("click")}g.extendClass(i,H.JteModule,{on:function(t){if(this.getEvent(t.type))return this.ajax(t)},ajax:function(t){var a=this.args,i={type:a.method?a.method:"get",url:a.url},o=this;i.error=function(t){g.ui.alert("Error",{close:function(){o.error(null,t)}})};i.success=function(t,i,n){var r,s;try{r=g.toJson(t)}catch(e){g.error(e);s="Not parse result."}if(s||r&&!r.result){s||(s=r.error_msg?r.error_msg:"Error");g.ui.alert(s,{close:function(){o.error(r,n)}})}else a["no-result-ok"]?o.success():g.ui.alert("Success.",{close:function(){o.success(r,n)}})};return g.ajax(i)},error:function(t,e){this.lastjob(t,e,!1,"error")},success:function(t,e){this.lastjob(t,e,!0,"success")},lastjob:function(t,e,i,n){var r,s,a,o,u,l,h,c,d=this.args,f=H.getChildAttribute(d,"way",n,!0);if(f&&(!f||f.length))for(r=0;r<f.length;r++)if(o=(a=f[r]).location)document.location=o;else if(o=a["location-replace"])document.location.replace(o);else if(o=a["location-reload"])document.location.reload();else if(o=a["parent-href"])parent.location=o;else if(o=a["parent-replace"])parent.location.replace(o);else if(o=a["parent-reload"])parent.location.reload();else if(o=a["top-href"])top.location=o;else if(o=a["top-replace"])top.location.replace(o);else if(o=a["top-reload"])top.location.reload();else if(o=a.window){h={url:o};for(s=0;s<nl.length;s++)!(l=typeof a[u=nl[r]])||"string"!=l&&"boolean"!=l&&"number"!=l||(h[u]=a[u]);g.open(h)}else if(o=a.dialog){h={url:o};for(s=0;s<nl.length;s++)!(l=typeof a[u=nl[r]])||"string"!=l&&"boolean"!=l&&"number"!=l||(h[u]=a[u]);g.ui.open(h)}else(o=a.history)?history.go(parseInt(o)):(o=a.module)&&"function"==typeof(c=g.module(o))&&c.call(this,t,e,i)}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/dialog",function(){function i(t,e){H.JteModule.apply(this,arguments);this.getEvent("click")||this.addEvent("click")}g.extendClass(i,H.JteModule,{on:function(t){if(this.getEvent(t.type))return this.open(t)},open:function(t){var e,i,n,r=this.args,s={url:r.url?r.url:"about:blank"},a=y.openArguments;for(e=0;e<a.length;e++)!(n=typeof r[i=a[e]])||"string"!=n&&"boolean"!=n&&"number"!=n||(s[i]=r[i]);g.ui.open(s);return!1}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/close",function(){function i(t,e){H.JteModule.apply(this,arguments);this.getEvent("click")||this.addEvent("click")}g.extendClass(i,H.JteModule,{on:function(t){if(this.getEvent(t.type))return this.close(t)},close:function(t){this.args;return window.dframework_parent_dialog?window.dframework_parent_dialog.close():window.close()}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/file",function(){function i(t,e){H.JteModule.apply(this,arguments);this.getEvent("change")||this.addEvent("change:receiver");this.getEvent("remove-file")||this.addEvent("remove-file")}g.extendClass(i,H.JteModule,{on:function(t){var e,i,n=t.type;if(i=this.getEvent(n))switch(n){case"remove-file":if(p.ie&&10==p.ie){this.origin.type="text";this.origin.type="file"}else if(p.ie&&p.ie<10||"safari"==p.type&&p.safari<600){var r=document.createElement("div"),s=document.createElement("form");g.before(this.origin,r);s.appendChild(this.origin);s.reset();g.after(r,this.origin);g.remove(r)}else this.origin.value="";break;case"change":var a,o,u=t.target.files,l=[];if(u)for(e=0;e<u.length;e++){(o=u[e]).sizeText=g.fileSize(o.size);2==(a=o.sizeText.split(" ")).length&&(o.sizeName=a[1]);l.push(o)}return!0===i?this.dispatchEvent({type:n},t,{value:l}):this.dispatchEvent({type:i},t,{value:l})}}});return function(t,e){return new i(t,e)}});g.define("dframework/jte/module/gallery",function(){var a="click-gallary-ctrl";function o(t,e){H.JteModule.apply(this,arguments);this.addEvent(a)}g.extendClass(o,H.JteModule,{ready:function(){o.__super.ready.call(this);var t,e,i=this.args,n=this.fromElement,r=H.getChildAttribute(i,"way","ui-controller",!0);this.curId=-1;this.maxId=-1;this.real=[];this.receiverCtrl=[];if(!n||!n.length)return g.error("Not found from elements for gallery module.");g.each.call(this,n,function(t){if(g.isElement(t.element)){g.save(t.element);g.ui.show(t.element);"element"==i.method&&this.real.push(t.element)}});r&&r.length&&(t=this.patchWithElement(r))&&t.length&&this.readyCtrlEvent(this.uiController=t);if(i=this.args){i.timer&&(this.timerMsec=g.parseInt(i.timer));if(i.autotimer){this.autoTimer=!0;this.timerMsec||(this.timerMsec=2e3)}else i.timer&&(this.autoTimer=!0);switch(t=i["enable-user-next"]){case"false":this.enableUserNext=!1;break;case"true":this.enableUserNext=!0;break;default:this.enableUserNext=t||!0}}this.timerName=(e=this,g.uname(function s(t,e){setTimeout(function(){window[t].object.onTimer()},e)},{object:e}));this.lastTime=(new Date).getTime();this.next();this.autoTimer&&this.timer()},_readyCtrlEvent:function(t){var e=t.element,i=g.queryAll(e,"[gal-event]"),s=g.module("dframework/jte/module/event"),n=g.module("dframework/jte/module/receiver");g.each.call(this,i,function(t){var e=g.attr(t,"gal-event");g.attr(t,"gal-checked");e||s(t,{event:"click:"+a,target:this.origin});if(e){var i=e.split(",")[0].trim(),n=i?i.indexOf(":"):-1,r=-1==n?i:i.substring(0,n);r&&s(t,{event:r+":"+a,target:this.origin})}});i=g.queryAll(e,"[gal-checked]");g.each.call(this,i,function(t){g.attr(t,"gal-checked");n(t);this.receiverCtrl.push({element:t,prefix:""})})},readyCtrlEvent:function(t){if(!g.isArray(t))return this._readyCtrlEvent(t);var e;for(e=0;e<t.length;e++)this._readyCtrlEvent(t[e])},currentId:function(){return this.curId},nextId:function(){return this.real.length>this.curId+1?this.curId+1:this.args.loop?0:-1},next:function(t,e){var i;if("number"==typeof t){var n=this.real.length;i=n<=t?n-1:t<0?0:t}else i=this.nextId();if(-1==i)return!1;this._showid(i,e);return!0},go:function(t){return this.next(t,!0)},timer:function(t){if(this.autoTimer){t=t||this.timerMsec;this.timerName&&t&&window[this.timerName](this.timerName,t)}},onTimer:function(){var t=(new Date).getTime()-this.lastTime;return t<this.timerMsec?this.timer(t):!1!==this.next()?this.timer(this.timerMsec):void 0},_showid:function(t,e){var i=this.real[t];if(g.isElement(i)){if(!e&&this.module&&!1===this.module.call(this,this.getDispatchEventArgument({type:"show-element"},null,this.origin,{id:t,element:i})))return!1;this._showElement(i,t);this.curId=t;this.curId>this.maxId&&(this.maxId=this.curId)}},_showElement:function(t,n){this.lastTime=(new Date).getTime();var e=g.first(this.origin);g.remove(e);g.append(this.origin,t);this.receiverCtrl&&this.receiverCtrl.length&&g.each.call(this,this.receiverCtrl,function(t){var e,i=g.attr(t.element,"gal-dataid");if(0<=(i=g.parseInt(i)))if(i<n){g.cursor(t.element,"pointer");this.dispatchEventToElement({type:"receiver"},{},t,{method:"setclass",add:"gal-selected-ctrl",remove:"gal-current-ctrl gal-noselected-ctrl"})}else if(i===n){g.cursor(t.element,"pointer");this.dispatchEventToElement({type:"receiver"},{},t,{method:"setclass",add:"gal-current-ctrl",remove:"gal-selected-ctrl gal-noselected-ctrl"})}else if(n<i){!0===(e=this.enableUserNext)?g.cursor(t.element,"pointer"):"max"==e&&this.maxId>=i?g.cursor(t.element,"pointer"):g.cursor(t.element,"");this.dispatchEventToElement({type:"receiver"},{},t,{method:"setclass",add:"gal-noselected-ctrl",remove:"gal-selected-ctrl gal-current-ctrl"})}})},on:function(t){var e,i=t.fromElement;switch(t.type){case a:if(this.enableUserNext&&(e=g.attrs(i)["gal-dataid"])&&(e=e.trim())&&e.isNumber()&&(0===(e=parseInt(e))||e)){if("max"===this.enableUserNext&&this.maxId<e)return;if("latest"===this.enableUserNext&&this.curId<e)return;return this.next(e)}}}});return function(t,e){return new o(t,e)}});g.async=m;g.math=t;g.ui=y;g.jte=H;g.define("dframework",function(){return g});g.define("dframework/async",function(){return m});g.define("dframework/math",function(){return t});g.define("dframework/ui",function(){return y});g.define("dframework/jte",function(){return H});M=g.scriptUrl("dframework"),g.setNamespaceUrl("dframework",M);g.readyFunction=function(){!0;g.async.waterfall([function(t){g.getNamespaceUrl("dframework");!function l(){var t,e,i;if(p.ie&&p.ie<8){e=g.queryAll(document,"[jte-sample]");for(t=0;t<e.length;t++)y.hide(e[t])}c||g.initDui();var n=g.queryAll(document,'style[type="jte-style"]');for(t=0;t<n.length;t++)g.importJteStyleElement(n[t]);var r=g.queryAll(document,"[jte-user-data]");function s(t){var e,i,n;if((e=t.innerText.trim())&&(i=H.toJson(e)))for(n in i)H.addUserData(n,i[n])}var a,o=[];for(t=0;t<r.length;t++)o.push(r[t]);for(t=0;t<o.length;t++){a=o[t];if(g.isArray(a))for(i=0;i<a.length;i++)s(a[i]);else s(a);y.hide(a);g.remove(a)}r=o=undefined;var u=g.queryAll(document,"[jte-auto]");g.each(u,function(t){var e,i,n=g.attr(t,"jte-auto"),r=g.attr(t,"jte-data-name"),s=r?r.split("/"):null,a=s?s[0]:null,o=a?(o=H.getUserDataValue(a))?o:window.DFrameworkJson&&(o=window.DFrameworkJson[a])?o:window[a]:undefined;if(o&&1<s.length)for(e=1;o&&e<s.length;e++)o=void 0===(i=o[s[e]])?undefined:i;n&&"false"==n||H({from:t,data:o,type:n,debug:!0})});u=undefined}();t()},function(e){g.require("text://dframework/css/jte-style.css",function(t){g.importJteStyleText(t);e()},function(t){e(t)})}],function(t){t&&g.error(t)})}}function L(t){this.data=[];this.formElement=g.isElement(t)&&"form"==t.nodeName.toLowerCase()?t:null;this.saveElement=[]}function I(){this.data=[]}function O(t){this.readyState=0;this.xmlHttp=null;this.headers=new I;this.form={};if(t){var e;"function"==typeof t.error&&(this.onerror=t.error);"function"==typeof t.success&&(this.onsuccess=t.success);"function"==typeof t.progress&&(this.onprogress=t.progress);"function"==typeof t.readystatechange&&(this.onreadystatechange=t.readystatechange);this.async=t.async;this.enctype=t.enctype;this.type=t.type;this.user=t.user;this.password=t.password;this.url=t.url&&"string"==typeof t.url?t.url:undefined;this.responseType=t.responseType;t.data&&this.repairData(t.data);if(t.headers)for(e in t.headers)this.headers.append(e,t.headers[e]);"boolean"==typeof t.auto?this.auto=t.auto:this.auto=!0}this.auto&&!0===this.open()&&this.send()}function P(t,e,i,n){switch(typeof t){case"number":this.left=t;this.top=e;this.right=i;this.bottom=n;break;case"object":if(t instanceof f){this.left=t.x;this.top=t.y;if(e instanceof f){this.right=e.x;this.bottom=e.y}}else{this.left=t.left;this.top=t.top;this.right=t.right;this.bottom=t.bottom}break;case"string":this.left=parseInt(t);this.top=parseInt(e);this.right=parseInt(i);this.bottom=parseInt(n)}}function B(t,e){if("string"==typeof t)this.text=t;else if("object"==typeof t){e=t;this.title=e.title;this.text=e.text}this.attr=e||{};this.offsetTop=-100;this._auto="boolean"==typeof this.attr.auto?this.attr.auto:"false"!==this.attr.auto;this._modal="boolean"==typeof this.attr.modal?this.attr.modal:"false"!==this.attr.modal}function F(t,e){B.call(this,t,e)}function U(t){"object"==typeof t?F.call(this,t):F.call(this);this.guid=g.guid();this.userui=g.isElement(t.ui)?t.ui:null;this.noiframe=!!this.userui;this.no_button="true"===t.nobutton||!0===t.nobutton;this.use_titlebar="false"!==t.titlebar&&!1!==t.titlebar;this.no_result_ok="false"!==t.no_result_ok&&!1!==t.no_result_ok;this.callback=t.callback;t.success&&(this.success=t.success);t.error&&(this.error=t.error)}function V(t){this.attr=t||{};this.items=t.items;this.offsetTop=-100;this._auto="boolean"==typeof this.attr.auto?this.attr.auto:(this.attr.auto,!1);this._modal="boolean"==typeof this.attr.modal?this.attr.modal:(this.attr.modal,!1);this.ui;this.main;this.contents;this.contentsHtml="";this.background;this.reuse;this._lastShowAttr;this._parent}function H(s){var o,t,e,i;!function(){if(!s)throw new TypeError("ERROR(jte): Not found attribute parameter.");var t,e,i,n=typeof s.source,r=g.isElement(s.source)?s.source:undefined;s.to;if(!s.from)throw new TypeError("ERROR(jte): Not found from attribute.");s.to||"string"==n||(s.to=s.from);if(s.to&&"string"!=typeof s.to&&!g.isElement(s.to))throw new TypeError("ERROR(jte): to attribute is query-string or Element.");t=s.from===s.to&&"string"!=n;if("string"==typeof s.from&&s.source&&!r&&"string"!=n)throw new TypeError("ERROR(jte): source is Element or String.");(e={}).name="string"==typeof s.from?s.from:undefined;e.element=g.isElement(s.from)?s.from:e.name?s.source?g.isElement(s.source)?g.query(s.source,'[jte-name="'+a+'"]'):undefined:g.query(document,'[jte-name="'+s.from+'"]'):undefined;e.sourceName="string"==typeof s.source?s.source:undefined;if(!e.sourceName&&!e.element)throw new TypeError("ERROR(jte): from or to attribute is Element or query-string.");i={name:t?e.name:"string"==typeof s.to?s.to:undefined,element:t?e.element:s.to?g.isElement(s.to)?s.to:g.isElement(s.source)?g.query(s.source,'[jte-name="'+s.to+'"]'):g.query(document,'[jte-name="'+s.to+'"]'):undefined};if(s.to&&!i.element)throw new TypeError("ERROR(jte): Not found to element. to: "+s.to);o={debug:!!s.debug,type:s.type?s.type:undefined,data:s.data,cursor:new H.Cursor(s.data),module:s.module,init:s.init,from:e.element,fromName:e.name,source:r,sourceName:e.sourceName?0===e.sourceName.indexOf("html://")?e.sourceName:"html://"+e.sourceName:undefined,to:i.element,toName:i.name,equals:t,remove:s.remove}}();if(o.init&&(t=o.init.call(o)))return g.error(t);if(!s.controller){(e=o.from.getAttribute("jte-control"))&&(e=e.trim());if(e){if("function"!=typeof o.module[e])return g.error(new Error("Not found jte-control module. name: "+e));s.controller=o.module[e]}}switch(typeof s.controller){case"function":o.controller=s.controller;break;case"string":if("function"!=typeof o.module[e=s.controller])return g.error(new Error("Not found controller module. name: "+e));o.controller=o.module[e];break;default:o.controller=H.baseController}0;o.top||(o.top=o.from);e=o.controller(o);o.equals||!o.to?i&&g.before(i,o.from):g.isElement(o.to)&&o.to.appendChild(o.from);i&&g.remove(i);return e}function G(t){for(var e in t)this[e]=t[e];this.controller&&(this.controller=undefined)}function j(t){this.element=t;this.event={};this._events=[]}function q(t,e){g.isElement(this.origin=t)&&(this.jtee=j.get(t));if(e){var i,n;this.userModule=[];(this.args=e).sourceData&&(this.data=e.sourceData);e.sourceJTE&&(this.jte=e.sourceJTE);e.module&&(n=(r=e.module,(s=H.jteModuleName(r))?s:r))&&(n=n.trim())&&(this.module=g.module(this.moduleName=n));(i=H.getChildAttribute(e,"way","user",!0))&&i.length&&g.each.call(this,i,function(t){this.userModule.push(t)});e.target&&(this.targetElement=this.patchQuery(e));if(e.event){this.addEvent(e.event);this.asEvent&&(this.isUserEvent=!0)}(n=e["jte-register"])&&(n=n.trim())&&x.push(N[n]=this);this.ready()}var r,s}function z(){this.mods=[];this.target=document}}(window);!function(){var t,e,i=getDframework(),n=window.$,r=window.jQuery;window.$=window.jQuery=undefined;t="undefined"!=typeof window?window:this,e=function(C,e){var c=[],p=C.document,h=c.slice,m=c.concat,o=c.push,u=c.indexOf,i={},l=i.toString,g=i.hasOwnProperty,A={},t="1.12.5-pre e09907ce152fb6ef7537a3733b1d65ead8ee6303",k=function(t,e){return new k.fn.init(t,e)},n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,r=/^-ms-/,s=/-([\da-z])/gi,a=function(t,e){return e.toUpperCase()};k.fn=k.prototype={jquery:t,constructor:k,selector:"",length:0,toArray:function(){return h.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:h.call(this)},pushStack:function(t){var e=k.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return k.each(this,t)},map:function(i){return this.pushStack(k.map(this,function(t,e){return i.call(t,e,t)}))},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(0<=i&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:c.sort,splice:c.splice},k.extend=k.fn.extend=function(){var t,e,i,n,r,s,a=arguments[0]||{},o=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[o]||{},o++),"object"==typeof a||k.isFunction(a)||(a={}),o===u&&(a=this,o--);o<u;o++)if(null!=(r=arguments[o]))for(n in r)t=a[n],a!==(i=r[n])&&(l&&i&&(k.isPlainObject(i)||(e=k.isArray(i)))?(s=e?(e=!1,t&&k.isArray(t)?t:[]):t&&k.isPlainObject(t)?t:{},a[n]=k.extend(l,s,i)):void 0!==i&&(a[n]=i));return a},k.extend({expando:"jQuery"+(t+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===k.type(t)},isArray:Array.isArray||function(t){return"array"===k.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){var e=t&&t.toString();return!k.isArray(t)&&0<=e-parseFloat(e)+1},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},isPlainObject:function(t){var e;if(!t||"object"!==k.type(t)||t.nodeType||k.isWindow(t))return!1;try{if(t.constructor&&!g.call(t,"constructor")&&!g.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(!A.ownFirst)for(e in t)return g.call(t,e);for(e in t);return void 0===e||g.call(t,e)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?i[l.call(t)]||"object":typeof t},globalEval:function(t){t&&k.trim(t)&&(C.execScript||function(t){C.eval.call(C,t)})(t)},camelCase:function(t){return t.replace(r,"ms-").replace(s,a)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var i,n=0;if(v(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":(t+"").replace(n,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(v(Object(t))?k.merge(i,"string"==typeof t?[t]:t):o.call(i,t)),i},inArray:function(t,e,i){var n;if(e){if(u)return u.call(e,t,i);for(n=e.length,i=i?i<0?Math.max(0,n+i):i:0;i<n;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;n<i;)t[r++]=e[n++];if(i!=i)for(;void 0!==e[n];)t[r++]=e[n++];return t.length=r,t},grep:function(t,e,i){for(var n=[],r=0,s=t.length,a=!i;r<s;r++)!e(t[r],r)!==a&&n.push(t[r]);return n},map:function(t,e,i){var n,r,s=0,a=[];if(v(t))for(n=t.length;s<n;s++)null!=(r=e(t[s],s,i))&&a.push(r);else for(s in t)null!=(r=e(t[s],s,i))&&a.push(r);return m.apply([],a)},guid:1,proxy:function(t,e){var i,n,r;if("string"==typeof e&&(r=t[e],e=t,t=r),k.isFunction(t))return i=h.call(arguments,2),(n=function(){return t.apply(e||this,i.concat(h.call(arguments)))}).guid=t.guid=t.guid||k.guid++,n},now:function(){return+new Date},support:A}),"function"==typeof Symbol&&(k.fn[Symbol.iterator]=c[Symbol.iterator]),k.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){i["[object "+e+"]"]=e.toLowerCase()});function v(t){var e=!!t&&"length"in t&&t.length,i=k.type(t);return"function"!==i&&!k.isWindow(t)&&("array"===i||0===e||"number"==typeof e&&0<e&&e-1 in t)}var d=function(i){var t,p,E,s,r,m,c,g,b,u,l,T,S,a,w,v,o,h,y,C="sizzle"+1*new Date,_=i.document,A=0,n=0,k=rt(),d=rt(),N=rt(),f=function(t,e){return t===e&&(l=!0),0},x={}.hasOwnProperty,e=[],M=e.pop,R=e.push,D=e.push,L=e.slice,I=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},O="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",F="\\["+P+"*("+B+")(?:"+P+"*([*^$|!~]?=)"+P+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+P+"*\\]",U=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+F+")*)|.*)\\)|)",V=new RegExp(P+"+","g"),H=new RegExp("^"+P+"+|((?:^|[^\\\\])(?:\\\\.)*)"+P+"+$","g"),G=new RegExp("^"+P+"*,"+P+"*"),j=new RegExp("^"+P+"*([>+~]|"+P+")"+P+"*"),q=new RegExp("="+P+"*([^\\]'\"]*?)"+P+"*\\]","g"),z=new RegExp(U),W=new RegExp("^"+B+"$"),Y={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+F),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+P+"*(even|odd|(([+-]|)(\\d*)n|)"+P+"*(?:([+-]|)"+P+"*(\\d+)|))"+P+"*\\)|)","i"),bool:new RegExp("^(?:"+O+")$","i"),needsContext:new RegExp("^"+P+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+P+"*((?:-\\d)?\\d*)"+P+"*\\)|)(?=[^-]|$)","i")},K=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,Z=/'|\\/g,tt=new RegExp("\\\\([\\da-f]{1,6}"+P+"?|("+P+")|.)","ig"),et=function(t,e,i){var n="0x"+e-65536;return n!=n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},it=function(){T()};try{D.apply(e=L.call(_.childNodes),_.childNodes),e[_.childNodes.length].nodeType}catch(Et){D={apply:e.length?function(t,e){R.apply(t,L.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function nt(t,e,i,n){var r,s,a,o,u,l,h,c,d=e&&e.ownerDocument,f=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==f&&9!==f&&11!==f)return i;if(!n&&((e?e.ownerDocument||e:_)!==S&&T(e),e=e||S,w)){if(11!==f&&(l=J.exec(t)))if(r=l[1]){if(9===f){if(!(a=e.getElementById(r)))return i;if(a.id===r)return i.push(a),i}else if(d&&(a=d.getElementById(r))&&y(e,a)&&a.id===r)return i.push(a),i}else{if(l[2])return D.apply(i,e.getElementsByTagName(t)),i;if((r=l[3])&&p.getElementsByClassName&&e.getElementsByClassName)return D.apply(i,e.getElementsByClassName(r)),i}if(p.qsa&&!N[t+" "]&&(!v||!v.test(t))){if(1!==f)d=e,c=t;else if("object"!==e.nodeName.toLowerCase()){(o=e.getAttribute("id"))?o=o.replace(Z,"\\$&"):e.setAttribute("id",o=C),s=(h=m(t)).length,u=W.test(o)?"#"+o:"[id='"+o+"']";for(;s--;)h[s]=u+" "+pt(h[s]);c=h.join(","),d=$.test(t)&&dt(e.parentNode)||e}if(c)try{return D.apply(i,d.querySelectorAll(c)),i}catch(k){}finally{o===C&&e.removeAttribute("id")}}}return g(t.replace(H,"$1"),e,i,n)}function rt(){var i=[];return function n(t,e){return i.push(t+" ")>E.cacheLength&&delete n[i.shift()],n[t+" "]=e}}function st(t){return t[C]=!0,t}function at(t){var e=S.createElement("div");try{return!!t(e)}catch(p){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ot(t,e){for(var i=t.split("|"),n=i.length;n--;)E.attrHandle[i[n]]=e}function ut(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||1<<31)-(~t.sourceIndex||1<<31);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function lt(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function ht(i){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===i}}function ct(a){return st(function(s){return s=+s,st(function(t,e){for(var i,n=a([],t.length,s),r=n.length;r--;)t[i=n[r]]&&(t[i]=!(e[i]=t[i]))})})}function dt(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}p=nt.support={},r=nt.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},T=nt.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:_;return n!==S&&9===n.nodeType&&n.documentElement&&(a=(S=n).documentElement,w=!r(S),(i=S.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",it,!1):i.attachEvent&&i.attachEvent("onunload",it)),p.attributes=at(function(t){return t.className="i",!t.getAttribute("className")}),p.getElementsByTagName=at(function(t){return t.appendChild(S.createComment("")),!t.getElementsByTagName("*").length}),p.getElementsByClassName=Q.test(S.getElementsByClassName),p.getById=at(function(t){return a.appendChild(t).id=C,!S.getElementsByName||!S.getElementsByName(C).length}),p.getById?(E.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&w){var i=e.getElementById(t);return i?[i]:[]}},E.filter.ID=function(t){var e=t.replace(tt,et);return function(t){return t.getAttribute("id")===e}}):(delete E.find.ID,E.filter.ID=function(t){var i=t.replace(tt,et);return function(t){var e="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return e&&e.value===i}}),E.find.TAG=p.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):p.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,s=e.getElementsByTagName(t);if("*"!==t)return s;for(;i=s[r++];)1===i.nodeType&&n.push(i);return n},E.find.CLASS=p.getElementsByClassName&&function(t,e){if("undefined"!=typeof e.getElementsByClassName&&w)return e.getElementsByClassName(t)},o=[],v=[],(p.qsa=Q.test(S.querySelectorAll))&&(at(function(t){a.appendChild(t).innerHTML="<a id='"+C+"'></a><select id='"+C+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+P+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||v.push("\\["+P+"*(?:value|"+O+")"),t.querySelectorAll("[id~="+C+"-]").length||v.push("~="),t.querySelectorAll(":checked").length||v.push(":checked"),t.querySelectorAll("a#"+C+"+*").length||v.push(".#.+[+~]")}),at(function(t){var e=S.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&v.push("name"+P+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),v.push(",.*:")})),(p.matchesSelector=Q.test(h=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&at(function(t){p.disconnectedMatch=h.call(t,"div"),h.call(t,"[s!='']:x"),o.push("!=",U)}),v=v.length&&new RegExp(v.join("|")),o=o.length&&new RegExp(o.join("|")),e=Q.test(a.compareDocumentPosition),y=e||Q.test(a.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},f=e?function(t,e){if(t===e)return l=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!p.sortDetached&&e.compareDocumentPosition(t)===i?t===S||t.ownerDocument===_&&y(_,t)?-1:e===S||e.ownerDocument===_&&y(_,e)?1:u?I(u,t)-I(u,e):0:4&i?-1:1)}:function(t,e){if(t===e)return l=!0,0;var i,n=0,r=t.parentNode,s=e.parentNode,a=[t],o=[e];if(!r||!s)return t===S?-1:e===S?1:r?-1:s?1:u?I(u,t)-I(u,e):0;if(r===s)return ut(t,e);i=t;for(;i=i.parentNode;)a.unshift(i);i=e;for(;i=i.parentNode;)o.unshift(i);for(;a[n]===o[n];)n++;return n?ut(a[n],o[n]):a[n]===_?-1:o[n]===_?1:0}),S},nt.matches=function(t,e){return nt(t,null,null,e)},nt.matchesSelector=function(t,e){if((t.ownerDocument||t)!==S&&T(t),e=e.replace(q,"='$1']"),p.matchesSelector&&w&&!N[e+" "]&&(!o||!o.test(e))&&(!v||!v.test(e)))try{var i=h.call(t,e);if(i||p.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(s){}return 0<nt(e,S,null,[t]).length},nt.contains=function(t,e){return(t.ownerDocument||t)!==S&&T(t),y(t,e)},nt.attr=function(t,e){(t.ownerDocument||t)!==S&&T(t);var i=E.attrHandle[e.toLowerCase()],n=i&&x.call(E.attrHandle,e.toLowerCase())?i(t,e,!w):void 0;return void 0!==n?n:p.attributes||!w?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},nt.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},nt.uniqueSort=function(t){var e,i=[],n=0,r=0;if(l=!p.detectDuplicates,u=!p.sortStable&&t.slice(0),t.sort(f),l){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return u=null,t},s=nt.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=s(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=s(e);return i},(E=nt.selectors={cacheLength:50,createPseudo:st,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(tt,et),t[3]=(t[3]||t[4]||t[5]||"").replace(tt,et),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||nt.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&nt.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return Y.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&z.test(i)&&(e=m(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(tt,et).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=k[t+" "];return e||(e=new RegExp("(^|"+P+")"+t+"("+P+"|$)"))&&k(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(i,n,r){return function(t){var e=nt.attr(t,i);return null==e?"!="===n:!n||(e+="","="===n?e===r:"!="===n?e!==r:"^="===n?r&&0===e.indexOf(r):"*="===n?r&&-1<e.indexOf(r):"$="===n?r&&e.slice(-r.length)===r:"~="===n?-1<(" "+e.replace(V," ")+" ").indexOf(r):"|="===n&&(e===r||e.slice(0,r.length+1)===r+"-"))}},CHILD:function(p,t,e,m,g){var v="nth"!==p.slice(0,3),y="last"!==p.slice(-4),_="of-type"===t;return 1===m&&0===g?function(t){return!!t.parentNode}:function(t,e,i){var n,r,s,a,o,u,l=v!==y?"nextSibling":"previousSibling",h=t.parentNode,c=_&&t.nodeName.toLowerCase(),d=!i&&!_,f=!1;if(h){if(v){for(;l;){a=t;for(;a=a[l];)if(_?a.nodeName.toLowerCase()===c:1===a.nodeType)return!1;u=l="only"===p&&!u&&"nextSibling"}return!0}if(u=[y?h.firstChild:h.lastChild],y&&d){f=(o=(n=(r=(s=(a=h)[C]||(a[C]={}))[a.uniqueID]||(s[a.uniqueID]={}))[p]||[])[0]===A&&n[1])&&n[2],a=o&&h.childNodes[o];for(;a=++o&&a&&a[l]||(f=o=0)||u.pop();)if(1===a.nodeType&&++f&&a===t){r[p]=[A,o,f];break}}else if(d&&(f=o=(n=(r=(s=(a=t)[C]||(a[C]={}))[a.uniqueID]||(s[a.uniqueID]={}))[p]||[])[0]===A&&n[1]),!1===f)for(;(a=++o&&a&&a[l]||(f=o=0)||u.pop())&&((_?a.nodeName.toLowerCase()!==c:1!==a.nodeType)||!++f||(d&&((r=(s=a[C]||(a[C]={}))[a.uniqueID]||(s[a.uniqueID]={}))[p]=[A,f]),a!==t)););return(f-=g)===m||f%m==0&&0<=f/m}}},PSEUDO:function(t,s){var e,a=E.pseudos[t]||E.setFilters[t.toLowerCase()]||nt.error("unsupported pseudo: "+t);return a[C]?a(s):1<a.length?(e=[t,t,"",s],E.setFilters.hasOwnProperty(t.toLowerCase())?st(function(t,e){for(var i,n=a(t,s),r=n.length;r--;)t[i=I(t,n[r])]=!(e[i]=n[r])}):function(t){return a(t,0,e)}):a}},pseudos:{not:st(function(t){var n=[],r=[],o=c(t.replace(H,"$1"));return o[C]?st(function(t,e,i,n){for(var r,s=o(t,null,n,[]),a=t.length;a--;)(r=s[a])&&(t[a]=!(e[a]=r))}):function(t,e,i){return n[0]=t,o(n,null,i,r),n[0]=null,!r.pop()}}),has:st(function(e){return function(t){return 0<nt(e,t).length}}),contains:st(function(e){return e=e.replace(tt,et),function(t){return-1<(t.textContent||t.innerText||s(t)).indexOf(e)}}),lang:st(function(i){return W.test(i||"")||nt.error("unsupported lang: "+i),i=i.replace(tt,et).toLowerCase(),function(t){var e;do{if(e=w?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===i||0===e.indexOf(i+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=i.location&&i.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===a},focus:function(t){return t===S.activeElement&&(!S.hasFocus||S.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!E.pseudos.empty(t)},header:function(t){return X.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ct(function(){return[0]}),last:ct(function(t,e){return[e-1]}),eq:ct(function(t,e,i){return[i<0?i+e:i]}),even:ct(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:ct(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:ct(function(t,e,i){for(var n=i<0?i+e:i;0<=--n;)t.push(n);return t}),gt:ct(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}}).pseudos.nth=E.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})E.pseudos[t]=lt(t);for(t in{submit:!0,reset:!0})E.pseudos[t]=ht(t);function ft(){}ft.prototype=E.filters=E.pseudos,E.setFilters=new ft,m=nt.tokenize=function(t,e){var i,n,r,s,a,o,u,l=d[t+" "];if(l)return e?0:l.slice(0);a=t,o=[],u=E.preFilter;for(;a;){i&&!(n=G.exec(a))||(n&&(a=a.slice(n[0].length)||a),o.push(r=[])),i=!1,(n=j.exec(a))&&(i=n.shift(),r.push({value:i,type:n[0].replace(H," ")}),a=a.slice(i.length));for(s in E.filter)!(n=Y[s].exec(a))||u[s]&&!(n=u[s](n))||(i=n.shift(),r.push({value:i,type:s,matches:n}),a=a.slice(i.length));if(!i)break}return e?a.length:a?nt.error(t):d(t,o).slice(0)};function pt(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function mt(o,t,e){var u=t.dir,l=e&&"parentNode"===u,h=n++;return t.first?function(t,e,i){for(;t=t[u];)if(1===t.nodeType||l)return o(t,e,i)}:function(t,e,i){var n,r,s,a=[A,h];if(i){for(;t=t[u];)if((1===t.nodeType||l)&&o(t,e,i))return!0}else for(;t=t[u];)if(1===t.nodeType||l){if((n=(r=(s=t[C]||(t[C]={}))[t.uniqueID]||(s[t.uniqueID]={}))[u])&&n[0]===A&&n[1]===h)return a[2]=n[2];if((r[u]=a)[2]=o(t,e,i))return!0}}}function gt(r){return 1<r.length?function(t,e,i){for(var n=r.length;n--;)if(!r[n](t,e,i))return!1;return!0}:r[0]}function vt(t,e,i,n,r){for(var s,a=[],o=0,u=t.length,l=null!=e;o<u;o++)(s=t[o])&&(i&&!i(s,n,r)||(a.push(s),l&&e.push(o)));return a}function yt(p,m,g,v,y,t){return v&&!v[C]&&(v=yt(v)),y&&!y[C]&&(y=yt(y,t)),st(function(t,e,i,n){var r,s,a,o=[],u=[],l=e.length,h=t||function f(t,e,i){for(var n=0,r=e.length;n<r;n++)nt(t,e[n],i);return i}(m||"*",i.nodeType?[i]:i,[]),c=!p||!t&&m?h:vt(h,o,p,i,n),d=g?y||(t?p:l||v)?[]:e:c;if(g&&g(c,d,i,n),v){r=vt(d,u),v(r,[],i,n),s=r.length;for(;s--;)(a=r[s])&&(d[u[s]]=!(c[u[s]]=a))}if(t){if(y||p){if(y){r=[],s=d.length;for(;s--;)(a=d[s])&&r.push(c[s]=a);y(null,d=[],r,n)}s=d.length;for(;s--;)(a=d[s])&&-1<(r=y?I(t,a):o[s])&&(t[r]=!(e[r]=a))}}else d=vt(d===e?d.splice(l,d.length):d),y?y(null,e,d,n):D.apply(e,d)})}function _t(t){for(var r,e,i,n=t.length,s=E.relative[t[0].type],a=s||E.relative[" "],o=s?1:0,u=mt(function(t){return t===r},a,!0),l=mt(function(t){return-1<I(r,t)},a,!0),h=[function(t,e,i){var n=!s&&(i||e!==b)||((r=e).nodeType?u(t,e,i):l(t,e,i));return r=null,n}];o<n;o++)if(e=E.relative[t[o].type])h=[mt(gt(h),e)];else{if((e=E.filter[t[o].type].apply(null,t[o].matches))[C]){for(i=++o;i<n&&!E.relative[t[i].type];i++);return yt(1<o&&gt(h),1<o&&pt(t.slice(0,o-1).concat({value:" "===t[o-2].type?"*":""})).replace(H,"$1"),e,o<i&&_t(t.slice(o,i)),i<n&&_t(t=t.slice(i)),i<n&&pt(t))}h.push(e)}return gt(h)}return c=nt.compile=function(t,e){var i,n=[],r=[],s=N[t+" "];if(!s){e||(e=m(t)),i=e.length;for(;i--;)(s=_t(e[i]))[C]?n.push(s):r.push(s);(s=N(t,function a(g,v){var y=0<v.length,_=0<g.length,t=function(t,e,i,n,r){var s,a,o,u=0,l="0",h=t&&[],c=[],d=b,f=t||_&&E.find.TAG("*",r),p=A+=null==d?1:Math.random()||.1,m=f.length;for(r&&(b=e===S||e||r);l!==m&&null!=(s=f[l]);l++){if(_&&s){a=0,e||s.ownerDocument===S||(T(s),i=!w);for(;o=g[a++];)if(o(s,e||S,i)){n.push(s);break}r&&(A=p)}y&&((s=!o&&s)&&u--,t&&h.push(s))}if(u+=l,y&&l!==u){a=0;for(;o=v[a++];)o(h,c,e,i);if(t){if(0<u)for(;l--;)h[l]||c[l]||(c[l]=M.call(n));c=vt(c)}D.apply(n,c),r&&!t&&0<c.length&&1<u+v.length&&nt.uniqueSort(n)}return r&&(A=p,b=d),h};return y?st(t):t}(r,n))).selector=t}return s},g=nt.select=function(t,e,i,n){var r,s,a,o,u,l="function"==typeof t&&t,h=!n&&m(t=l.selector||t);if(i=i||[],1===h.length){if(2<(s=h[0]=h[0].slice(0)).length&&"ID"===(a=s[0]).type&&p.getById&&9===e.nodeType&&w&&E.relative[s[1].type]){if(!(e=(E.find.ID(a.matches[0].replace(tt,et),e)||[])[0]))return i;l&&(e=e.parentNode),t=t.slice(s.shift().value.length)}r=Y.needsContext.test(t)?0:s.length;for(;r--&&(a=s[r],!E.relative[o=a.type]);)if((u=E.find[o])&&(n=u(a.matches[0].replace(tt,et),$.test(s[0].type)&&dt(e.parentNode)||e))){if(s.splice(r,1),!(t=n.length&&pt(s)))return D.apply(i,n),i;break}}return(l||c(t,h))(n,e,!w,i,!e||$.test(t)&&dt(e.parentNode)||e),i},p.sortStable=C.split("").sort(f).join("")===C,p.detectDuplicates=!!l,T(),p.sortDetached=at(function(t){return 1&t.compareDocumentPosition(S.createElement("div"))}),at(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||ot("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),p.attributes&&at(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ot("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),at(function(t){return null==t.getAttribute("disabled")})||ot(O,function(t,e,i){var n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),nt}(C);k.find=d,k.expr=d.selectors,k.expr[":"]=k.expr.pseudos,k.uniqueSort=k.unique=d.uniqueSort,k.text=d.getText,k.isXMLDoc=d.isXML,k.contains=d.contains;var f=function(t,e,i){for(var n=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&k(t).is(i))break;n.push(t)}return n},y=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},_=k.expr.match.needsContext,N=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,E=/^.[^:#\[\.,]*$/;function b(t,i,n){if(k.isFunction(i))return k.grep(t,function(t,e){return!!i.call(t,e,t)!==n});if(i.nodeType)return k.grep(t,function(t){return t===i!==n});if("string"==typeof i){if(E.test(i))return k.filter(i,t,n);i=k.filter(i,t)}return k.grep(t,function(t){return-1<k.inArray(t,i)!==n})}k.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?k.find.matchesSelector(n,t)?[n]:[]:k.find.matches(t,k.grep(e,function(t){return 1===t.nodeType}))},k.fn.extend({find:function(t){var e,i=[],n=this,r=n.length;if("string"!=typeof t)return this.pushStack(k(t).filter(function(){for(e=0;e<r;e++)if(k.contains(n[e],this))return!0}));for(e=0;e<r;e++)k.find(t,n[e],i);return(i=this.pushStack(1<r?k.unique(i):i)).selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(b(this,t||[],!1))},not:function(t){return this.pushStack(b(this,t||[],!0))},is:function(t){return!!b(this,"string"==typeof t&&_.test(t)?k(t):t||[],!1).length}});var T,S=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(k.fn.init=function(t,e,i){var n,r;if(!t)return this;if(i=i||T,"string"!=typeof t)return t.nodeType?(this.context=this[0]=t,this.length=1,this):k.isFunction(t)?"undefined"!=typeof i.ready?i.ready(t):t(k):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),k.makeArray(t,this));if(!(n="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&3<=t.length?[null,t,null]:S.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof k?e[0]:e,k.merge(this,k.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:p,!0)),N.test(n[1])&&k.isPlainObject(e))for(n in e)k.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}if((r=p.getElementById(n[2]))&&r.parentNode){if(r.id!==n[2])return T.find(t);this.length=1,this[0]=r}return this.context=p,this.selector=t,this}).prototype=k.fn,T=k(p);var w=/^(?:parents|prev(?:Until|All))/,x={children:!0,contents:!0,next:!0,prev:!0};k.fn.extend({has:function(t){var e,i=k(t,this),n=i.length;return this.filter(function(){for(e=0;e<n;e++)if(k.contains(this,i[e]))return!0})},closest:function(t,e){for(var i,n=0,r=this.length,s=[],a=_.test(t)||"string"!=typeof t?k(t,e||this.context):0;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?-1<a.index(i):1===i.nodeType&&k.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(1<s.length?k.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?k.inArray(this[0],k(t)):k.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(k.uniqueSort(k.merge(this.get(),k(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}});function M(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}k.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return f(t,"parentNode")},parentsUntil:function(t,e,i){return f(t,"parentNode",i)},next:function(t){return M(t,"nextSibling")},prev:function(t){return M(t,"previousSibling")},nextAll:function(t){return f(t,"nextSibling")},prevAll:function(t){return f(t,"previousSibling")},nextUntil:function(t,e,i){return f(t,"nextSibling",i)},prevUntil:function(t,e,i){return f(t,"previousSibling",i)},siblings:function(t){return y((t.parentNode||{}).firstChild,t)},children:function(t){return y(t.firstChild)},contents:function(t){return k.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:k.merge([],t.childNodes)}},function(n,r){k.fn[n]=function(t,e){var i=k.map(this,r,t);return"Until"!==n.slice(-5)&&(e=t),e&&"string"==typeof e&&(i=k.filter(e,i)),1<this.length&&(x[n]||(i=k.uniqueSort(i)),w.test(n)&&(i=i.reverse())),this.pushStack(i)}});var R,D,L=/\S+/g;k.Callbacks=function(n){n="string"==typeof n?function h(t){var i={};return k.each(t.match(L)||[],function(t,e){i[e]=!0}),i}(n):k.extend({},n);var r,t,e,i,s=[],a=[],o=-1,u=function(){for(i=n.once,e=r=!0;a.length;o=-1){t=a.shift();for(;++o<s.length;)!1===s[o].apply(t[0],t[1])&&n.stopOnFalse&&(o=s.length,t=!1)}n.memory||(t=!1),r=!1,i&&(s=t?[]:"")},l={add:function(){return s&&(t&&!r&&(o=s.length-1,a.push(t)),function i(t){k.each(t,function(t,e){k.isFunction(e)?n.unique&&l.has(e)||s.push(e):e&&e.length&&"string"!==k.type(e)&&i(e)})}(arguments),t&&!r&&u()),this},remove:function(){return k.each(arguments,function(t,e){for(var i;-1<(i=k.inArray(e,s,i));)s.splice(i,1),i<=o&&o--}),this},has:function(t){return t?-1<k.inArray(t,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return i=a=[],s=t="",this},disabled:function(){return!s},lock:function(){return i=!0,t||l.disable(),this},locked:function(){return!!i},fireWith:function(t,e){return i||(e=[t,(e=e||[]).slice?e.slice():e],a.push(e),r||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!e}};return l},k.extend({Deferred:function(t){var s=[["resolve","done",k.Callbacks("once memory"),"resolved"],["reject","fail",k.Callbacks("once memory"),"rejected"],["notify","progress",k.Callbacks("memory")]],r="pending",a={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var r=arguments;return k.Deferred(function(n){k.each(s,function(t,e){var i=k.isFunction(r[t])&&r[t];o[e[1]](function(){var t=i&&i.apply(this,arguments);t&&k.isFunction(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[e[0]+"With"](this===a?n.promise():this,i?[t]:arguments)})}),r=null}).promise()},promise:function(t){return null!=t?k.extend(t,a):a}},o={};return a.pipe=a.then,k.each(s,function(t,e){var i=e[2],n=e[3];a[e[1]]=i.add,n&&i.add(function(){r=n},s[1^t][2].disable,s[2][2].lock),o[e[0]]=function(){return o[e[0]+"With"](this===o?a:this,arguments),this},o[e[0]+"With"]=i.fireWith}),a.promise(o),t&&t.call(o,o),o},when:function(t){var r,e,i,n=0,s=h.call(arguments),a=s.length,o=1!==a||t&&k.isFunction(t.promise)?a:0,u=1===o?t:k.Deferred(),l=function(e,i,n){return function(t){i[e]=this,n[e]=1<arguments.length?h.call(arguments):t,n===r?u.notifyWith(i,n):--o||u.resolveWith(i,n)}};if(1<a)for(r=new Array(a),e=new Array(a),i=new Array(a);n<a;n++)s[n]&&k.isFunction(s[n].promise)?s[n].promise().progress(l(n,e,r)).done(l(n,i,s)).fail(u.reject):--o;return o||u.resolveWith(i,s),u.promise()}});k.fn.ready=function(t){return k.ready.promise().done(t),this},k.extend({isReady:!1,readyWait:1,holdReady:function(t){t?k.readyWait++:k.ready(!0)},ready:function(t){(!0===t?--k.readyWait:k.isReady)||((k.isReady=!0)!==t&&0<--k.readyWait||(R.resolveWith(p,[k]),k.fn.triggerHandler&&(k(p).triggerHandler("ready"),k(p).off("ready"))))}});function I(){p.addEventListener?(p.removeEventListener("DOMContentLoaded",O),C.removeEventListener("load",O)):(p.detachEvent("onreadystatechange",O),C.detachEvent("onload",O))}function O(){(p.addEventListener||"load"===C.event.type||"complete"===p.readyState)&&(I(),k.ready())}k.ready.promise=function(t){if(!R)if(R=k.Deferred(),"complete"===p.readyState||"loading"!==p.readyState&&!p.documentElement.doScroll)C.setTimeout(k.ready);else if(p.addEventListener)p.addEventListener("DOMContentLoaded",O),C.addEventListener("load",O);else{p.attachEvent("onreadystatechange",O),C.attachEvent("onload",O);var e=!1;try{e=null==C.frameElement&&p.documentElement}catch(h){}e&&e.doScroll&&function i(){if(!k.isReady){try{e.doScroll("left")}catch(t){return C.setTimeout(i,50)}I(),k.ready()}}()}return R.promise(t)},k.ready.promise();for(D in k(A))break;A.ownFirst="0"===D,A.inlineBlockNeedsLayout=!1,k(function(){var t,e,i,n;(i=p.getElementsByTagName("body")[0])&&i.style&&(e=p.createElement("div"),(n=p.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(e),"undefined"!=typeof e.style.zoom&&(e.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",A.inlineBlockNeedsLayout=t=3===e.offsetWidth,t&&(i.style.zoom=1)),i.removeChild(n))}),function(){var t=p.createElement("div");A.deleteExpando=!0;try{delete t.test}catch(e){A.deleteExpando=!1}t=null}();var P,B=function(t){var e=k.noData[(t.nodeName+" ").toLowerCase()],i=+t.nodeType||1;return(1===i||9===i)&&(!e||!0!==e&&t.getAttribute("classid")===e)},F=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,U=/([A-Z])/g;function V(t,e,i){if(void 0===i&&1===t.nodeType){var n="data-"+e.replace(U,"-$1").toLowerCase();if("string"==typeof(i=t.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:F.test(i)?k.parseJSON(i):i)}catch(h){}k.data(t,e,i)}else i=void 0}return i}function H(t){var e;for(e in t)if(("data"!==e||!k.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function G(t,e,i,n){if(B(t)){var r,s,a=k.expando,o=t.nodeType,u=o?k.cache:t,l=o?t[a]:t[a]&&a;if(l&&u[l]&&(n||u[l].data)||void 0!==i||"string"!=typeof e)return l||(l=o?t[a]=c.pop()||k.guid++:a),u[l]||(u[l]=o?{}:{toJSON:k.noop}),"object"!=typeof e&&"function"!=typeof e||(n?u[l]=k.extend(u[l],e):u[l].data=k.extend(u[l].data,e)),s=u[l],n||(s.data||(s.data={}),s=s.data),void 0!==i&&(s[k.camelCase(e)]=i),"string"==typeof e?null==(r=s[e])&&(r=s[k.camelCase(e)]):r=s,r}}function j(t,e,i){if(B(t)){var n,r,s=t.nodeType,a=s?k.cache:t,o=s?t[k.expando]:k.expando;if(a[o]){if(e&&(n=i?a[o]:a[o].data)){r=(e=k.isArray(e)?e.concat(k.map(e,k.camelCase)):e in n?[e]:(e=k.camelCase(e))in n?[e]:e.split(" ")).length;for(;r--;)delete n[e[r]];if(i?!H(n):!k.isEmptyObject(n))return}(i||(delete a[o].data,H(a[o])))&&(s?k.cleanData([t],!0):A.deleteExpando||a!=a.window?delete a[o]:a[o]=void 0)}}}k.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return!!(t=t.nodeType?k.cache[t[k.expando]]:t[k.expando])&&!H(t)},data:function(t,e,i){return G(t,e,i)},removeData:function(t,e){return j(t,e)},_data:function(t,e,i){return G(t,e,i,!0)},_removeData:function(t,e){return j(t,e,!0)}}),k.fn.extend({data:function(t,e){var i,n,r,s=this[0],a=s&&s.attributes;if(void 0!==t)return"object"==typeof t?this.each(function(){k.data(this,t)}):1<arguments.length?this.each(function(){k.data(this,t,e)}):s?V(s,t,k.data(s,t)):void 0;if(this.length&&(r=k.data(s),1===s.nodeType&&!k._data(s,"parsedAttrs"))){i=a.length;for(;i--;)a[i]&&(0===(n=a[i].name).indexOf("data-")&&V(s,n=k.camelCase(n.slice(5)),r[n]));k._data(s,"parsedAttrs",!0)}return r},removeData:function(t){return this.each(function(){k.removeData(this,t)})}}),k.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=k._data(t,e),i&&(!n||k.isArray(i)?n=k._data(t,e,k.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=k.queue(t,e),n=i.length,r=i.shift(),s=k._queueHooks(t,e);"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete s.stop,r.call(t,function(){k.dequeue(t,e)},s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return k._data(t,i)||k._data(t,i,{empty:k.Callbacks("once memory").add(function(){k._removeData(t,e+"queue"),k._removeData(t,i)})})}}),k.fn.extend({queue:function(e,i){var t=2;return"string"!=typeof e&&(i=e,e="fx",t--),arguments.length<t?k.queue(this[0],e):void 0===i?this:this.each(function(){var t=k.queue(this,e,i);k._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&k.dequeue(this,e)})},dequeue:function(t){return this.each(function(){k.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=k.Deferred(),s=this,a=this.length,o=function(){--n||r.resolveWith(s,[s])};"string"!=typeof t&&(e=t,t=void 0),t=t||"fx";for(;a--;)(i=k._data(s[a],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(o));return o(),r.promise(e)}}),A.shrinkWrapBlocks=function(){if(null!=P)return P;P=!1;var t,e,i;return(e=p.getElementsByTagName("body")[0])&&e.style?(t=p.createElement("div"),(i=p.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",e.appendChild(i).appendChild(t),"undefined"!=typeof t.style.zoom&&(t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",t.appendChild(p.createElement("div")).style.width="5px",P=3!==t.offsetWidth),e.removeChild(i),P):void 0};var q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,z=new RegExp("^(?:([+-])=|)("+q+")([a-z%]*)$","i"),W=["Top","Right","Bottom","Left"],Y=function(t,e){return t=e||t,"none"===k.css(t,"display")||!k.contains(t.ownerDocument,t)};function K(t,e,i,n){var r,s=1,a=20,o=n?function(){return n.cur()}:function(){return k.css(t,e,"")},u=o(),l=i&&i[3]||(k.cssNumber[e]?"":"px"),h=(k.cssNumber[e]||"px"!==l&&+u)&&z.exec(k.css(t,e));if(h&&h[3]!==l){l=l||h[3],i=i||[],h=+u||1;for(;h/=s=s||".5",k.style(t,e,h+l),s!==(s=o()/u)&&1!==s&&--a;);}return i&&(h=+h||+u||0,r=i[1]?h+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=h,n.end=r)),r}var X,Q,J,$=function(t,e,i,n,r,s,a){var o=0,u=t.length,l=null==i;if("object"===k.type(i)){r=!0;for(o in i)$(t,e,o,i[o],!0,s,a)}else if(void 0!==n&&(r=!0,k.isFunction(n)||(a=!0),l&&(e=a?(e.call(t,n),null):(l=e,function(t,e,i){return l.call(k(t),i)})),e))for(;o<u;o++)e(t[o],i,a?n:n.call(t[o],o,e(t[o],i)));return r?t:l?e.call(t):u?e(t[0],i):s},Z=/^(?:checkbox|radio)$/i,tt=/<([\w:-]+)/,et=/^$|\/(?:java|ecma)script/i,it=/^\s+/,nt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";function rt(t){var e=nt.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}X=p.createElement("div"),Q=p.createDocumentFragment(),J=p.createElement("input"),X.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",A.leadingWhitespace=3===X.firstChild.nodeType,A.tbody=!X.getElementsByTagName("tbody").length,A.htmlSerialize=!!X.getElementsByTagName("link").length,A.html5Clone="<:nav></:nav>"!==p.createElement("nav").cloneNode(!0).outerHTML,J.type="checkbox",J.checked=!0,Q.appendChild(J),A.appendChecked=J.checked,X.innerHTML="<textarea>x</textarea>",A.noCloneChecked=!!X.cloneNode(!0).lastChild.defaultValue,Q.appendChild(X),(J=p.createElement("input")).setAttribute("type","radio"),J.setAttribute("checked","checked"),J.setAttribute("name","t"),X.appendChild(J),A.checkClone=X.cloneNode(!0).cloneNode(!0).lastChild.checked,A.noCloneEvent=!!X.addEventListener,X[k.expando]=1,A.attributes=!X.getAttribute(k.expando);var st={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:A.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};st.optgroup=st.option,st.tbody=st.tfoot=st.colgroup=st.caption=st.thead,st.th=st.td;function Et(t,e){var i,n,r=0,s="undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e||"*"):"undefined"!=typeof t.querySelectorAll?t.querySelectorAll(e||"*"):void 0;if(!s)for(s=[],i=t.childNodes||t;null!=(n=i[r]);r++)!e||k.nodeName(n,e)?s.push(n):k.merge(s,Et(n,e));return void 0===e||e&&k.nodeName(t,e)?k.merge([t],s):s}function at(t,e){for(var i,n=0;null!=(i=t[n]);n++)k._data(i,"globalEval",!e||k._data(e[n],"globalEval"))}var ot=/<|&#?\w+;/,ut=/<tbody/i;function lt(t){Z.test(t.type)&&(t.defaultChecked=t.checked)}function ht(t,e,i,n,r){for(var s,a,o,u,l,h,c,d=t.length,f=rt(e),p=[],m=0;m<d;m++)if((a=t[m])||0===a)if("object"===k.type(a))k.merge(p,a.nodeType?[a]:a);else if(ot.test(a)){u=u||f.appendChild(e.createElement("div")),l=(tt.exec(a)||["",""])[1].toLowerCase(),c=st[l]||st._default,u.innerHTML=c[1]+k.htmlPrefilter(a)+c[2],s=c[0];for(;s--;)u=u.lastChild;if(!A.leadingWhitespace&&it.test(a)&&p.push(e.createTextNode(it.exec(a)[0])),!A.tbody){s=(a="table"!==l||ut.test(a)?"<table>"!==c[1]||ut.test(a)?0:u:u.firstChild)&&a.childNodes.length;for(;s--;)k.nodeName(h=a.childNodes[s],"tbody")&&!h.childNodes.length&&a.removeChild(h)}k.merge(p,u.childNodes),u.textContent="";for(;u.firstChild;)u.removeChild(u.firstChild);u=f.lastChild}else p.push(e.createTextNode(a));u&&f.removeChild(u),A.appendChecked||k.grep(Et(p,"input"),lt),m=0;for(;a=p[m++];)if(n&&-1<k.inArray(a,n))r&&r.push(a);else if(o=k.contains(a.ownerDocument,a),u=Et(f.appendChild(a),"script"),o&&at(u),i){s=0;for(;a=u[s++];)et.test(a.type||"")&&i.push(a)}return u=null,f}!function(){var t,e,i=p.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})e="on"+t,(A[t]=e in C)||(i.setAttribute(e,"t"),A[t]=!1===i.attributes[e].expando);i=null}();var ct=/^(?:input|select|textarea)$/i,dt=/^key/,ft=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,pt=/^(?:focusinfocus|focusoutblur)$/,mt=/^([^.]*)(?:\.(.+)|)/;function gt(){return!0}function vt(){return!1}function yt(){try{return p.activeElement}catch(C){}}function _t(t,e,i,n,r,s){var a,o;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=void 0);for(o in e)_t(t,o,i,n,e[o],s);return t}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=vt;else if(!r)return t;return 1===s&&(a=r,(r=function(t){return k().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=k.guid++)),t.each(function(){k.event.add(this,e,r,n,i)})}k.event={global:{},add:function(t,e,i,n,r){var s,a,o,u,l,h,c,d,f,p,m,g=k._data(t);if(g){i.handler&&(i=(u=i).handler,r=u.selector),i.guid||(i.guid=k.guid++),(a=g.events)||(a=g.events={}),(h=g.handle)||((h=g.handle=function(t){return void 0===k||t&&k.event.triggered===t.type?void 0:k.event.dispatch.apply(h.elem,arguments)}).elem=t),o=(e=(e||"").match(L)||[""]).length;for(;o--;)f=m=(s=mt.exec(e[o])||[])[1],p=(s[2]||"").split(".").sort(),f&&(l=k.event.special[f]||{},f=(r?l.delegateType:l.bindType)||f,l=k.event.special[f]||{},c=k.extend({type:f,origType:m,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&k.expr.match.needsContext.test(r),namespace:p.join(".")},u),(d=a[f])||((d=a[f]=[]).delegateCount=0,l.setup&&!1!==l.setup.call(t,n,p,h)||(t.addEventListener?t.addEventListener(f,h,!1):t.attachEvent&&t.attachEvent("on"+f,h))),l.add&&(l.add.call(t,c),c.handler.guid||(c.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,c):d.push(c),k.event.global[f]=!0);t=null}},remove:function(t,e,i,n,r){var s,a,o,u,l,h,c,d,f,p,m,g=k.hasData(t)&&k._data(t);if(g&&(h=g.events)){l=(e=(e||"").match(L)||[""]).length;for(;l--;)if(f=m=(o=mt.exec(e[l])||[])[1],p=(o[2]||"").split(".").sort(),f){c=k.event.special[f]||{},d=h[f=(n?c.delegateType:c.bindType)||f]||[],o=o[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),u=s=d.length;for(;s--;)a=d[s],!r&&m!==a.origType||i&&i.guid!==a.guid||o&&!o.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(d.splice(s,1),a.selector&&d.delegateCount--,c.remove&&c.remove.call(t,a));u&&!d.length&&(c.teardown&&!1!==c.teardown.call(t,p,g.handle)||k.removeEvent(t,f,g.handle),delete h[f])}else for(f in h)k.event.remove(t,f+e[l],i,n,!0);k.isEmptyObject(h)&&(delete g.handle,k._removeData(t,"events"))}},trigger:function(t,e,i,n){var r,s,a,o,u,l,h,c=[i||p],d=g.call(t,"type")?t.type:t,f=g.call(t,"namespace")?t.namespace.split("."):[];if(a=l=i=i||p,3!==i.nodeType&&8!==i.nodeType&&!pt.test(d+k.event.triggered)&&(-1<d.indexOf(".")&&(d=(f=d.split(".")).shift(),f.sort()),s=d.indexOf(":")<0&&"on"+d,(t=t[k.expando]?t:new k.Event(d,"object"==typeof t&&t)).isTrigger=n?2:3,t.namespace=f.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:k.makeArray(e,[t]),u=k.event.special[d]||{},n||!u.trigger||!1!==u.trigger.apply(i,e))){if(!n&&!u.noBubble&&!k.isWindow(i)){for(o=u.delegateType||d,pt.test(o+d)||(a=a.parentNode);a;a=a.parentNode)c.push(a),l=a;l===(i.ownerDocument||p)&&c.push(l.defaultView||l.parentWindow||C)}h=0;for(;(a=c[h++])&&!t.isPropagationStopped();)t.type=1<h?o:u.bindType||d,(r=(k._data(a,"events")||{})[t.type]&&k._data(a,"handle"))&&r.apply(a,e),(r=s&&a[s])&&r.apply&&B(a)&&(t.result=r.apply(a,e),!1===t.result&&t.preventDefault());if(t.type=d,!n&&!t.isDefaultPrevented()&&(!u._default||!1===u._default.apply(c.pop(),e))&&B(i)&&s&&i[d]&&!k.isWindow(i)){(l=i[s])&&(i[s]=null),k.event.triggered=d;try{i[d]()}catch(v){}k.event.triggered=void 0,l&&(i[s]=l)}return t.result}},dispatch:function(t){t=k.event.fix(t);var e,i,n,r,s,a=[],o=h.call(arguments),u=(k._data(this,"events")||{})[t.type]||[],l=k.event.special[t.type]||{};if((o[0]=t).delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,t)){a=k.event.handlers.call(this,t,u),e=0;for(;(r=a[e++])&&!t.isPropagationStopped();){t.currentTarget=r.elem,i=0;for(;(s=r.handlers[i++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(s.namespace)||(t.handleObj=s,t.data=s.data,void 0!==(n=((k.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,o))&&!1===(t.result=n)&&(t.preventDefault(),t.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,r,s,a=[],o=e.delegateCount,u=t.target;if(o&&u.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;u!=this;u=u.parentNode||this)if(1===u.nodeType&&(!0!==u.disabled||"click"!==t.type)){for(n=[],i=0;i<o;i++)void 0===n[r=(s=e[i]).selector+" "]&&(n[r]=s.needsContext?-1<k(r,this).index(u):k.find(r,this,null,[u]).length),n[r]&&n.push(s);n.length&&a.push({elem:u,handlers:n})}return o<e.length&&a.push({elem:this,handlers:e.slice(o)}),a},fix:function(t){if(t[k.expando])return t;var e,i,n,r=t.type,s=t,a=this.fixHooks[r];a||(this.fixHooks[r]=a=ft.test(r)?this.mouseHooks:dt.test(r)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,t=new k.Event(s),e=n.length;for(;e--;)t[i=n[e]]=s[i];return t.target||(t.target=s.srcElement||p),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,a.filter?a.filter(t,s):t},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,r,s=e.button,a=e.fromElement;return null==t.pageX&&null!=e.clientX&&(r=(n=t.target.ownerDocument||p).documentElement,i=n.body,t.pageX=e.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?e.toElement:a),t.which||void 0===s||(t.which=1&s?1:2&s?3:4&s?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==yt()&&this.focus)try{return this.focus(),!1}catch(C){}},delegateType:"focusin"},blur:{trigger:function(){if(this===yt()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(k.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(t){return k.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i){var n=k.extend(new k.Event,i,{type:t,isSimulated:!0});k.event.trigger(n,null,e),n.isDefaultPrevented()&&i.preventDefault()}},k.removeEvent=p.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)}:function(t,e,i){var n="on"+e;t.detachEvent&&("undefined"==typeof t[n]&&(t[n]=null),t.detachEvent(n,i))},k.Event=function(t,e){return this instanceof k.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?gt:vt):this.type=t,e&&k.extend(this,e),this.timeStamp=t&&t.timeStamp||k.now(),void(this[k.expando]=!0)):new k.Event(t,e)},k.Event.prototype={constructor:k.Event,isDefaultPrevented:vt,isPropagationStopped:vt,isImmediatePropagationStopped:vt,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=gt,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=gt,t&&!this.isSimulated&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=gt,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},k.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,r){k.event.special[t]={delegateType:r,bindType:r,handle:function(t){var e,i=t.relatedTarget,n=t.handleObj;return i&&(i===this||k.contains(this,i))||(t.type=n.origType,e=n.handler.apply(this,arguments),t.type=r),e}}}),A.submit||(k.event.special.submit={setup:function(){return!k.nodeName(this,"form")&&void k.event.add(this,"click._submit keypress._submit",function(t){var e=t.target,i=k.nodeName(e,"input")||k.nodeName(e,"button")?k.prop(e,"form"):void 0;i&&!k._data(i,"submit")&&(k.event.add(i,"submit._submit",function(t){t._submitBubble=!0}),k._data(i,"submit",!0))})},postDispatch:function(t){t._submitBubble&&(delete t._submitBubble,this.parentNode&&!t.isTrigger&&k.event.simulate("submit",this.parentNode,t))},teardown:function(){return!k.nodeName(this,"form")&&void k.event.remove(this,"._submit")}}),A.change||(k.event.special.change={setup:function(){return ct.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(k.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._justChanged=!0)}),k.event.add(this,"click._change",function(t){this._justChanged&&!t.isTrigger&&(this._justChanged=!1),k.event.simulate("change",this,t)})),!1):void k.event.add(this,"beforeactivate._change",function(t){var e=t.target;ct.test(e.nodeName)&&!k._data(e,"change")&&(k.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||k.event.simulate("change",this.parentNode,t)}),k._data(e,"change",!0))})},handle:function(t){var e=t.target;if(this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type)return t.handleObj.handler.apply(this,arguments)},teardown:function(){return k.event.remove(this,"._change"),!ct.test(this.nodeName)}}),A.focusin||k.each({focus:"focusin",blur:"focusout"},function(i,n){var r=function(t){k.event.simulate(n,t.target,k.event.fix(t))};k.event.special[n]={setup:function(){var t=this.ownerDocument||this,e=k._data(t,n);e||t.addEventListener(i,r,!0),k._data(t,n,(e||0)+1)},teardown:function(){var t=this.ownerDocument||this,e=k._data(t,n)-1;e?k._data(t,n,e):(t.removeEventListener(i,r,!0),k._removeData(t,n))}}}),k.fn.extend({on:function(t,e,i,n){return _t(this,t,e,i,n)},one:function(t,e,i,n){return _t(this,t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,k(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=vt),this.each(function(){k.event.remove(this,t,i,e)});for(r in t)this.off(r,e,t[r]);return this},trigger:function(t,e){return this.each(function(){k.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return k.event.trigger(t,e,i,!0)}});var bt=/ jQuery\d+="(?:null|\d+)"/g,Tt=new RegExp("<(?:"+nt+")[\\s/>]","i"),St=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,wt=/<script|<style|<link/i,Ct=/checked\s*(?:[^=]|=\s*.checked.)/i,At=/^true\/(.*)/,kt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Nt=rt(p).appendChild(p.createElement("div"));function xt(t,e){return k.nodeName(t,"table")&&k.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function Mt(t){return t.type=(null!==k.find.attr(t,"type"))+"/"+t.type,t}function Rt(t){var e=At.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function Dt(t,e){if(1===e.nodeType&&k.hasData(t)){var i,n,r,s=k._data(t),a=k._data(e,s),o=s.events;if(o){delete a.handle,a.events={};for(i in o)for(n=0,r=o[i].length;n<r;n++)k.event.add(e,i,o[i][n])}a.data&&(a.data=k.extend({},a.data))}}function Lt(t,e){var i,n,r;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!A.noCloneEvent&&e[k.expando]){r=k._data(e);for(n in r.events)k.removeEvent(e,n,r.handle);e.removeAttribute(k.expando)}"script"===i&&e.text!==t.text?(Mt(e).text=t.text,Rt(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),A.html5Clone&&t.innerHTML&&!k.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&Z.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}}function It(i,n,r,s){n=m.apply([],n);var t,e,a,o,u,l,h=0,c=i.length,d=c-1,f=n[0],p=k.isFunction(f);if(p||1<c&&"string"==typeof f&&!A.checkClone&&Ct.test(f))return i.each(function(t){var e=i.eq(t);p&&(n[0]=f.call(this,t,e.html())),It(e,n,r,s)});if(c&&(t=(l=ht(n,i[0].ownerDocument,!1,i,s)).firstChild,1===l.childNodes.length&&(l=t),t||s)){for(a=(o=k.map(Et(l,"script"),Mt)).length;h<c;h++)e=l,h!==d&&(e=k.clone(e,!0,!0),a&&k.merge(o,Et(e,"script"))),r.call(i[h],e,h);if(a)for(u=o[o.length-1].ownerDocument,k.map(o,Rt),h=0;h<a;h++)e=o[h],et.test(e.type||"")&&!k._data(e,"globalEval")&&k.contains(u,e)&&(e.src?k._evalUrl&&k._evalUrl(e.src):k.globalEval((e.text||e.textContent||e.innerHTML||"").replace(kt,"")));l=t=null}return i}function Ot(t,e,i){for(var n,r=e?k.filter(e,t):t,s=0;null!=(n=r[s]);s++)i||1!==n.nodeType||k.cleanData(Et(n)),n.parentNode&&(i&&k.contains(n.ownerDocument,n)&&at(Et(n,"script")),n.parentNode.removeChild(n));return t}k.extend({htmlPrefilter:function(t){return t.replace(St,"<$1></$2>")},clone:function(t,e,i){var n,r,s,a,o,u=k.contains(t.ownerDocument,t);if(A.html5Clone||k.isXMLDoc(t)||!Tt.test("<"+t.nodeName+">")?s=t.cloneNode(!0):(Nt.innerHTML=t.outerHTML,Nt.removeChild(s=Nt.firstChild)),!(A.noCloneEvent&&A.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||k.isXMLDoc(t)))for(n=Et(s),o=Et(t),a=0;null!=(r=o[a]);++a)n[a]&&Lt(r,n[a]);if(e)if(i)for(o=o||Et(t),n=n||Et(s),a=0;null!=(r=o[a]);a++)Dt(r,n[a]);else Dt(t,s);return 0<(n=Et(s,"script")).length&&at(n,!u&&Et(t,"script")),n=o=r=null,s},cleanData:function(t,e){for(var i,n,r,s,a=0,o=k.expando,u=k.cache,l=A.attributes,h=k.event.special;null!=(i=t[a]);a++)if((e||B(i))&&(s=(r=i[o])&&u[r])){if(s.events)for(n in s.events)h[n]?k.event.remove(i,n):k.removeEvent(i,n,s.handle);u[r]&&(delete u[r],l||"undefined"==typeof i.removeAttribute?i[o]=void 0:i.removeAttribute(o),c.push(r))}}}),k.fn.extend({domManip:It,detach:function(t){return Ot(this,t,!0)},remove:function(t){return Ot(this,t)},text:function(t){return $(this,function(t){return void 0===t?k.text(this):this.empty().append((this[0]&&this[0].ownerDocument||p).createTextNode(t))},null,t,arguments.length)},append:function(){return It(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){xt(this,t).appendChild(t)}})},prepend:function(){return It(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=xt(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return It(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return It(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){1===t.nodeType&&k.cleanData(Et(t,!1));for(;t.firstChild;)t.removeChild(t.firstChild);t.options&&k.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return k.clone(this,t,e)})},html:function(t){return $(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t)return 1===e.nodeType?e.innerHTML.replace(bt,""):void 0;if("string"==typeof t&&!wt.test(t)&&(A.htmlSerialize||!Tt.test(t))&&(A.leadingWhitespace||!it.test(t))&&!st[(tt.exec(t)||["",""])[1].toLowerCase()]){t=k.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(k.cleanData(Et(e,!1)),e.innerHTML=t);e=0}catch(h){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var i=[];return It(this,arguments,function(t){var e=this.parentNode;k.inArray(this,i)<0&&(k.cleanData(Et(this)),e&&e.replaceChild(t,this))},i)}}),k.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,a){k.fn[t]=function(t){for(var e,i=0,n=[],r=k(t),s=r.length-1;i<=s;i++)e=i===s?this:this.clone(!0),k(r[i])[a](e),o.apply(n,e.get());return this.pushStack(n)}});var Pt,Bt={HTML:"block",BODY:"block"};function Ft(t,e){var i=k(e.createElement(t)).appendTo(e.body),n=k.css(i[0],"display");return i.detach(),n}function Ut(t){var e=p,i=Bt[t];return i||("none"!==(i=Ft(t,e))&&i||((e=((Pt=(Pt||k("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentWindow||Pt[0].contentDocument).document).write(),e.close(),i=Ft(t,e),Pt.detach()),Bt[t]=i),i}var Vt=/^margin/,Ht=new RegExp("^("+q+")(?!px)[a-z%]+$","i"),Gt=function(t,e,i,n){var r,s,a={};for(s in e)a[s]=t.style[s],t.style[s]=e[s];r=i.apply(t,n||[]);for(s in e)t.style[s]=a[s];return r},jt=p.documentElement;!function(){var n,r,s,a,o,u,l=p.createElement("div"),h=p.createElement("div");function t(){var t,e,i=p.documentElement;i.appendChild(l),h.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",n=s=u=!1,r=o=!0,C.getComputedStyle&&(e=C.getComputedStyle(h),n="1%"!==(e||{}).top,u="2px"===(e||{}).marginLeft,s="4px"===(e||{width:"4px"}).width,h.style.marginRight="50%",r="4px"===(e||{marginRight:"4px"}).marginRight,(t=h.appendChild(p.createElement("div"))).style.cssText=h.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",h.style.width="1px",o=!parseFloat((C.getComputedStyle(t)||{}).marginRight),h.removeChild(t)),h.style.display="none",(a=0===h.getClientRects().length)&&(h.style.display="",h.innerHTML="<table><tr><td></td><td>t</td></tr></table>",h.childNodes[0].style.borderCollapse="separate",(t=h.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",(a=0===t[0].offsetHeight)&&(t[0].style.display="",t[1].style.display="none",a=0===t[0].offsetHeight)),i.removeChild(l)}h.style&&(h.style.cssText="float:left;opacity:.5",A.opacity="0.5"===h.style.opacity,A.cssFloat=!!h.style.cssFloat,h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",A.clearCloneStyle="content-box"===h.style.backgroundClip,(l=p.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",h.innerHTML="",l.appendChild(h),A.boxSizing=""===h.style.boxSizing||""===h.style.MozBoxSizing||""===h.style.WebkitBoxSizing,k.extend(A,{reliableHiddenOffsets:function(){return null==n&&t(),a},boxSizingReliable:function(){return null==n&&t(),s},pixelMarginRight:function(){return null==n&&t(),r},pixelPosition:function(){return null==n&&t(),n},reliableMarginRight:function(){return null==n&&t(),o},reliableMarginLeft:function(){return null==n&&t(),u}}))}();var qt,zt,Wt=/^(top|right|bottom|left)$/;C.getComputedStyle?(qt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=C),e.getComputedStyle(t)},zt=function(t,e,i){var n,r,s,a,o=t.style;return""!==(a=(i=i||qt(t))?i.getPropertyValue(e)||i[e]:void 0)&&void 0!==a||k.contains(t.ownerDocument,t)||(a=k.style(t,e)),i&&!A.pixelMarginRight()&&Ht.test(a)&&Vt.test(e)&&(n=o.width,r=o.minWidth,s=o.maxWidth,o.minWidth=o.maxWidth=o.width=a,a=i.width,o.width=n,o.minWidth=r,o.maxWidth=s),void 0===a?a:a+""}):jt.currentStyle&&(qt=function(t){return t.currentStyle},zt=function(t,e,i){var n,r,s,a,o=t.style;return null==(a=(i=i||qt(t))?i[e]:void 0)&&o&&o[e]&&(a=o[e]),Ht.test(a)&&!Wt.test(e)&&(n=o.left,(s=(r=t.runtimeStyle)&&r.left)&&(r.left=t.currentStyle.left),o.left="fontSize"===e?"1em":a,a=o.pixelLeft+"px",o.left=n,s&&(r.left=s)),void 0===a?a:a+""||"auto"});function Yt(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}var Kt=/alpha\([^)]*\)/i,Xt=/opacity\s*=\s*([^)]*)/i,Qt=/^(none|table(?!-c[ea]).+)/,Jt=new RegExp("^("+q+")(.*)$","i"),$t={position:"absolute",visibility:"hidden",display:"block"},Zt={letterSpacing:"0",fontWeight:"400"},te=["Webkit","O","Moz","ms"],ee=p.createElement("div").style;function ie(t){if(t in ee)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),i=te.length;i--;)if((t=te[i]+e)in ee)return t}function ne(t,e){for(var i,n,r,s=[],a=0,o=t.length;a<o;a++)(n=t[a]).style&&(s[a]=k._data(n,"olddisplay"),i=n.style.display,e?(s[a]||"none"!==i||(n.style.display=""),""===n.style.display&&Y(n)&&(s[a]=k._data(n,"olddisplay",Ut(n.nodeName)))):(r=Y(n),(i&&"none"!==i||!r)&&k._data(n,"olddisplay",r?i:k.css(n,"display"))));for(a=0;a<o;a++)(n=t[a]).style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?s[a]||"":"none"));return t}function re(t,e,i){var n=Jt.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function se(t,e,i,n,r){for(var s=i===(n?"border":"content")?4:"width"===e?1:0,a=0;s<4;s+=2)"margin"===i&&(a+=k.css(t,i+W[s],!0,r)),n?("content"===i&&(a-=k.css(t,"padding"+W[s],!0,r)),"margin"!==i&&(a-=k.css(t,"border"+W[s]+"Width",!0,r))):(a+=k.css(t,"padding"+W[s],!0,r),"padding"!==i&&(a+=k.css(t,"border"+W[s]+"Width",!0,r)));return a}function ae(t,e,i){var n=!0,r="width"===e?t.offsetWidth:t.offsetHeight,s=qt(t),a=A.boxSizing&&"border-box"===k.css(t,"boxSizing",!1,s);if(r<=0||null==r){if(((r=zt(t,e,s))<0||null==r)&&(r=t.style[e]),Ht.test(r))return r;n=a&&(A.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+se(t,e,i||(a?"border":"content"),n,s)+"px"}k.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=zt(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":A.cssFloat?"cssFloat":"styleFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,s,a,o=k.camelCase(e),u=t.style;if(e=k.cssProps[o]||(k.cssProps[o]=ie(o)||o),a=k.cssHooks[e]||k.cssHooks[o],void 0===i)return a&&"get"in a&&void 0!==(r=a.get(t,!1,n))?r:u[e];if("string"===(s=typeof i)&&(r=z.exec(i))&&r[1]&&(i=K(t,e,r),s="number"),null!=i&&i==i&&("number"===s&&(i+=r&&r[3]||(k.cssNumber[o]?"":"px")),A.clearCloneStyle||""!==i||0!==e.indexOf("background")||(u[e]="inherit"),!(a&&"set"in a&&void 0===(i=a.set(t,i,n)))))try{u[e]=i}catch(l){}}},css:function(t,e,i,n){var r,s,a,o=k.camelCase(e);return e=k.cssProps[o]||(k.cssProps[o]=ie(o)||o),(a=k.cssHooks[e]||k.cssHooks[o])&&"get"in a&&(s=a.get(t,!0,i)),void 0===s&&(s=zt(t,e,n)),"normal"===s&&e in Zt&&(s=Zt[e]),""===i||i?(r=parseFloat(s),!0===i||isFinite(r)?r||0:s):s}}),k.each(["height","width"],function(t,r){k.cssHooks[r]={get:function(t,e,i){if(e)return Qt.test(k.css(t,"display"))&&0===t.offsetWidth?Gt(t,$t,function(){return ae(t,r,i)}):ae(t,r,i)},set:function(t,e,i){var n=i&&qt(t);return re(0,e,i?se(t,r,i,A.boxSizing&&"border-box"===k.css(t,"boxSizing",!1,n),n):0)}}}),A.opacity||(k.cssHooks.opacity={get:function(t,e){return Xt.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,r=k.isNumeric(e)?"alpha(opacity="+100*e+")":"",s=n&&n.filter||i.filter||"";((i.zoom=1)<=e||""===e)&&""===k.trim(s.replace(Kt,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=Kt.test(s)?s.replace(Kt,r):s+" "+r)}}),k.cssHooks.marginRight=Yt(A.reliableMarginRight,function(t,e){if(e)return Gt(t,{display:"inline-block"},zt,[t,"marginRight"])}),k.cssHooks.marginLeft=Yt(A.reliableMarginLeft,function(t,e){if(e)return(parseFloat(zt(t,"marginLeft"))||(k.contains(t.ownerDocument,t)?t.getBoundingClientRect().left-Gt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}):0))+"px"}),k.each({margin:"",padding:"",border:"Width"},function(r,s){k.cssHooks[r+s]={expand:function(t){for(var e=0,i={},n="string"==typeof t?t.split(" "):[t];e<4;e++)i[r+W[e]+s]=n[e]||n[e-2]||n[0];return i}},Vt.test(r)||(k.cssHooks[r+s].set=re)}),k.fn.extend({css:function(t,e){return $(this,function(t,e,i){var n,r,s={},a=0;if(k.isArray(e)){for(n=qt(t),r=e.length;a<r;a++)s[e[a]]=k.css(t,e[a],!1,n);return s}return void 0!==i?k.style(t,e,i):k.css(t,e)},t,e,1<arguments.length)},show:function(){return ne(this,!0)},hide:function(){return ne(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Y(this)?k(this).show():k(this).hide()})}});function oe(t,e,i,n,r){return new oe.prototype.init(t,e,i,n,r)}((k.Tween=oe).prototype={constructor:oe,init:function(t,e,i,n,r,s){this.elem=t,this.prop=i,this.easing=r||k.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(k.cssNumber[i]?"":"px")},cur:function(){var t=oe.propHooks[this.prop];return t&&t.get?t.get(this):oe.propHooks._default.get(this)},run:function(t){var e,i=oe.propHooks[this.prop];return this.options.duration?this.pos=e=k.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):oe.propHooks._default.set(this),this}}).init.prototype=oe.prototype,(oe.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=k.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){k.fx.step[t.prop]?k.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[k.cssProps[t.prop]]&&!k.cssHooks[t.prop]?t.elem[t.prop]=t.now:k.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=oe.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},k.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},k.fx=oe.prototype.init,k.fx.step={};var ue,le,he,ce,de,fe,pe,me=/^(?:toggle|show|hide)$/,ge=/queueHooks$/;function ve(){return C.setTimeout(function(){ue=void 0}),ue=k.now()}function ye(t,e){var i,n={height:t},r=0;for(e=e?1:0;r<4;r+=2-e)n["margin"+(i=W[r])]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function _e(t,e,i){for(var n,r=(Ee.tweeners[e]||[]).concat(Ee.tweeners["*"]),s=0,a=r.length;s<a;s++)if(n=r[s].call(i,e,t))return n}function Ee(s,t,e){var i,a,n=0,r=Ee.prefilters.length,o=k.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var t=ue||ve(),e=Math.max(0,l.startTime+l.duration-t),i=1-(e/l.duration||0),n=0,r=l.tweens.length;n<r;n++)l.tweens[n].run(i);return o.notifyWith(s,[l,i,e]),i<1&&r?e:(o.resolveWith(s,[l]),!1)},l=o.promise({elem:s,props:k.extend({},t),opts:k.extend(!0,{specialEasing:{},easing:k.easing._default},e),originalProperties:t,originalOptions:e,startTime:ue||ve(),duration:e.duration,tweens:[],createTween:function(t,e){var i=k.Tween(s,l.opts,t,e,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(i),i},stop:function(t){var e=0,i=t?l.tweens.length:0;if(a)return this;for(a=!0;e<i;e++)l.tweens[e].run(1);return t?(o.notifyWith(s,[l,1,0]),o.resolveWith(s,[l,t])):o.rejectWith(s,[l,t]),this}}),h=l.props;for(function c(t,e){var i,n,r,s,a;for(i in t)if(r=e[n=k.camelCase(i)],s=t[i],k.isArray(s)&&(r=s[1],s=t[i]=s[0]),i!==n&&(t[n]=s,delete t[i]),(a=k.cssHooks[n])&&"expand"in a){s=a.expand(s),delete t[n];for(i in s)i in t||(t[i]=s[i],e[i]=r)}else e[n]=r}(h,l.opts.specialEasing);n<r;n++)if(i=Ee.prefilters[n].call(l,s,h,l.opts))return k.isFunction(i.stop)&&(k._queueHooks(l.elem,l.opts.queue).stop=k.proxy(i.stop,i)),i;return k.map(h,_e,l),k.isFunction(l.opts.start)&&l.opts.start.call(s,l),k.fx.timer(k.extend(u,{elem:s,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}k.Animation=k.extend(Ee,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return K(i.elem,t,z.exec(e),i),i}]},tweener:function(t,e){for(var i,n=0,r=(t=k.isFunction(t)?(e=t,["*"]):t.match(L)).length;n<r;n++)i=t[n],Ee.tweeners[i]=Ee.tweeners[i]||[],Ee.tweeners[i].unshift(e)},prefilters:[function pi(e,t,i){var n,r,s,a,o,u,l,h=this,c={},d=e.style,f=e.nodeType&&Y(e),p=k._data(e,"fxshow");i.queue||(null==(o=k._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,u=o.empty.fire,o.empty.fire=function(){o.unqueued||u()}),o.unqueued++,h.always(function(){h.always(function(){o.unqueued--,k.queue(e,"fx").length||o.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===("none"===(l=k.css(e,"display"))?k._data(e,"olddisplay")||Ut(e.nodeName):l)&&"none"===k.css(e,"float")&&(A.inlineBlockNeedsLayout&&"inline"!==Ut(e.nodeName)?d.zoom=1:d.display="inline-block")),i.overflow&&(d.overflow="hidden",A.shrinkWrapBlocks()||h.always(function(){d.overflow=i.overflow[0],d.overflowX=i.overflow[1],d.overflowY=i.overflow[2]}));for(n in t)if(r=t[n],me.exec(r)){if(delete t[n],s=s||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!p||void 0===p[n])continue;f=!0}c[n]=p&&p[n]||k.style(e,n)}else l=void 0;if(k.isEmptyObject(c))"inline"===("none"===l?Ut(e.nodeName):l)&&(d.display=l);else{p?"hidden"in p&&(f=p.hidden):p=k._data(e,"fxshow",{}),s&&(p.hidden=!f),f?k(e).show():h.done(function(){k(e).hide()}),h.done(function(){var t;k._removeData(e,"fxshow");for(t in c)k.style(e,t,c[t])});for(n in c)a=_e(f?p[n]:0,n,h),n in p||(p[n]=a.start,f&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}],prefilter:function(t,e){e?Ee.prefilters.unshift(t):Ee.prefilters.push(t)}}),k.speed=function(t,e,i){var n=t&&"object"==typeof t?k.extend({},t):{complete:i||!i&&e||k.isFunction(t)&&t,duration:t,easing:i&&e||e&&!k.isFunction(e)&&e};return n.duration=k.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in k.fx.speeds?k.fx.speeds[n.duration]:k.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){k.isFunction(n.old)&&n.old.call(this),n.queue&&k.dequeue(this,n.queue)},n},k.fn.extend({fadeTo:function(t,e,i,n){return this.filter(Y).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(e,t,i,n){var r=k.isEmptyObject(e),s=k.speed(t,i,n),a=function(){var t=Ee(this,k.extend({},e),s);(r||k._data(this,"finish"))&&t.stop(!0)};return a.finish=a,r||!1===s.queue?this.each(a):this.queue(s.queue,a)},stop:function(r,t,s){var a=function(t){var e=t.stop;delete t.stop,e(s)};return"string"!=typeof r&&(s=t,t=r,r=void 0),t&&!1!==r&&this.queue(r||"fx",[]),this.each(function(){var t=!0,e=null!=r&&r+"queueHooks",i=k.timers,n=k._data(this);if(e)n[e]&&n[e].stop&&a(n[e]);else for(e in n)n[e]&&n[e].stop&&ge.test(e)&&a(n[e]);for(e=i.length;e--;)i[e].elem!==this||null!=r&&i[e].queue!==r||(i[e].anim.stop(s),t=!1,i.splice(e,1));!t&&s||k.dequeue(this,r)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var t,e=k._data(this),i=e[a+"queue"],n=e[a+"queueHooks"],r=k.timers,s=i?i.length:0;for(e.finish=!0,k.queue(this,a,[]),n&&n.stop&&n.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===a&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<s;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete e.finish})}}),k.each(["toggle","show","hide"],function(t,n){var r=k.fn[n];k.fn[n]=function(t,e,i){return null==t||"boolean"==typeof t?r.apply(this,arguments):this.animate(ye(n,!0),t,e,i)}}),k.each({slideDown:ye("show"),slideUp:ye("hide"),slideToggle:ye("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,n){k.fn[t]=function(t,e,i){return this.animate(n,t,e,i)}}),k.timers=[],k.fx.tick=function(){var t,e=k.timers,i=0;for(ue=k.now();i<e.length;i++)(t=e[i])()||e[i]!==t||e.splice(i--,1);e.length||k.fx.stop(),ue=void 0},k.fx.timer=function(t){k.timers.push(t),t()?k.fx.start():k.timers.pop()},k.fx.interval=13,k.fx.start=function(){le||(le=C.setInterval(k.fx.tick,k.fx.interval))},k.fx.stop=function(){C.clearInterval(le),le=null},k.fx.speeds={slow:600,fast:200,_default:400},k.fn.delay=function(n,t){return n=k.fx&&k.fx.speeds[n]||n,t=t||"fx",this.queue(t,function(t,e){var i=C.setTimeout(t,n);e.stop=function(){C.clearTimeout(i)}})},ce=p.createElement("input"),de=p.createElement("div"),fe=p.createElement("select"),pe=fe.appendChild(p.createElement("option")),(de=p.createElement("div")).setAttribute("className","t"),de.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",he=de.getElementsByTagName("a")[0],ce.setAttribute("type","checkbox"),de.appendChild(ce),(he=de.getElementsByTagName("a")[0]).style.cssText="top:1px",A.getSetAttribute="t"!==de.className,A.style=/top/.test(he.getAttribute("style")),A.hrefNormalized="/a"===he.getAttribute("href"),A.checkOn=!!ce.value,A.optSelected=pe.selected,A.enctype=!!p.createElement("form").enctype,fe.disabled=!0,A.optDisabled=!pe.disabled,(ce=p.createElement("input")).setAttribute("value",""),A.input=""===ce.getAttribute("value"),ce.value="t",ce.setAttribute("type","radio"),A.radioValue="t"===ce.value;var be=/\r/g,Te=/[\x20\t\r\n\f]+/g;k.fn.extend({val:function(i){var n,t,r,e=this[0];return arguments.length?(r=k.isFunction(i),this.each(function(t){var e;1===this.nodeType&&(null==(e=r?i.call(this,t,k(this).val()):i)?e="":"number"==typeof e?e+="":k.isArray(e)&&(e=k.map(e,function(t){return null==t?"":t+""})),(n=k.valHooks[this.type]||k.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,e,"value")||(this.value=e))})):e?(n=k.valHooks[e.type]||k.valHooks[e.nodeName.toLowerCase()])&&"get"in n&&void 0!==(t=n.get(e,"value"))?t:"string"==typeof(t=e.value)?t.replace(be,""):null==t?"":t:void 0}}),k.extend({valHooks:{option:{get:function(t){var e=k.find.attr(t,"value");return null!=e?e:k.trim(k.text(t)).replace(Te," ")}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,s="select-one"===t.type||r<0,a=s?null:[],o=s?r+1:n.length,u=r<0?o:s?r:0;u<o;u++)if(((i=n[u]).selected||u===r)&&(A.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!k.nodeName(i.parentNode,"optgroup"))){if(e=k(i).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var i,n,r=t.options,s=k.makeArray(e),a=r.length;a--;)if(n=r[a],-1<k.inArray(k.valHooks.option.get(n),s))try{n.selected=i=!0}catch(u){n.scrollHeight}else n.selected=!1;return i||(t.selectedIndex=-1),r}}}}),k.each(["radio","checkbox"],function(){k.valHooks[this]={set:function(t,e){if(k.isArray(e))return t.checked=-1<k.inArray(k(t).val(),e)}},A.checkOn||(k.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var Se,we,Ce=k.expr.attrHandle,Ae=/^(?:checked|selected)$/i,ke=A.getSetAttribute,Ne=A.input;k.fn.extend({attr:function(t,e){return $(this,k.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){k.removeAttr(this,t)})}}),k.extend({attr:function(t,e,i){var n,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return"undefined"==typeof t.getAttribute?k.prop(t,e,i):(1===s&&k.isXMLDoc(t)||(e=e.toLowerCase(),r=k.attrHooks[e]||(k.expr.match.bool.test(e)?we:Se)),void 0!==i?null===i?void k.removeAttr(t,e):r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:(t.setAttribute(e,i+""),i):r&&"get"in r&&null!==(n=r.get(t,e))?n:null==(n=k.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!A.radioValue&&"radio"===e&&k.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n,r=0,s=e&&e.match(L);if(s&&1===t.nodeType)for(;i=s[r++];)n=k.propFix[i]||i,k.expr.match.bool.test(i)?Ne&&ke||!Ae.test(i)?t[n]=!1:t[k.camelCase("default-"+i)]=t[n]=!1:k.attr(t,i,""),t.removeAttribute(ke?i:n)}}),we={set:function(t,e,i){return!1===e?k.removeAttr(t,i):Ne&&ke||!Ae.test(i)?t.setAttribute(!ke&&k.propFix[i]||i,i):t[k.camelCase("default-"+i)]=t[i]=!0,i}},k.each(k.expr.match.bool.source.match(/\w+/g),function(t,e){var s=Ce[e]||k.find.attr;Ne&&ke||!Ae.test(e)?Ce[e]=function(t,e,i){var n,r;return i||(r=Ce[e],Ce[e]=n,n=null!=s(t,e,i)?e.toLowerCase():null,Ce[e]=r),n}:Ce[e]=function(t,e,i){if(!i)return t[k.camelCase("default-"+e)]?e.toLowerCase():null}}),Ne&&ke||(k.attrHooks.value={set:function(t,e,i){return k.nodeName(t,"input")?void(t.defaultValue=e):Se&&Se.set(t,e,i)}}),ke||(Se={set:function(t,e,i){var n=t.getAttributeNode(i);if(n||t.setAttributeNode(n=t.ownerDocument.createAttribute(i)),n.value=e+="","value"===i||e===t.getAttribute(i))return e}},Ce.id=Ce.name=Ce.coords=function(t,e,i){var n;if(!i)return(n=t.getAttributeNode(e))&&""!==n.value?n.value:null},k.valHooks.button={get:function(t,e){var i=t.getAttributeNode(e);if(i&&i.specified)return i.value},set:Se.set},k.attrHooks.contenteditable={set:function(t,e,i){Se.set(t,""!==e&&e,i)}},k.each(["width","height"],function(t,i){k.attrHooks[i]={set:function(t,e){if(""===e)return t.setAttribute(i,"auto"),e}}})),A.style||(k.attrHooks.style={get:function(t){return t.style.cssText||void 0},set:function(t,e){return t.style.cssText=e+""}});var xe=/^(?:input|select|textarea|button|object)$/i,Me=/^(?:a|area)$/i;k.fn.extend({prop:function(t,e){return $(this,k.prop,t,e,1<arguments.length)},removeProp:function(t){return t=k.propFix[t]||t,this.each(function(){try{this[t]=void 0,delete this[t]}catch(e){}})}}),k.extend({prop:function(t,e,i){var n,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&k.isXMLDoc(t)||(e=k.propFix[e]||e,r=k.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=k.find.attr(t,"tabindex");return e?parseInt(e,10):xe.test(t.nodeName)||Me.test(t.nodeName)&&t.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),A.hrefNormalized||k.each(["href","src"],function(t,e){k.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),A.optSelected||(k.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),k.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){k.propFix[this.toLowerCase()]=this}),A.enctype||(k.propFix.enctype="encoding");var Re=/[\t\r\n\f]/g;function De(t){return k.attr(t,"class")||""}k.fn.extend({addClass:function(e){var t,i,n,r,s,a,o,u=0;if(k.isFunction(e))return this.each(function(t){k(this).addClass(e.call(this,t,De(this)))});if("string"==typeof e&&e){t=e.match(L)||[];for(;i=this[u++];)if(r=De(i),n=1===i.nodeType&&(" "+r+" ").replace(Re," ")){a=0;for(;s=t[a++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");r!==(o=k.trim(n))&&k.attr(i,"class",o)}}return this},removeClass:function(e){var t,i,n,r,s,a,o,u=0;if(k.isFunction(e))return this.each(function(t){k(this).removeClass(e.call(this,t,De(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e){t=e.match(L)||[];for(;i=this[u++];)if(r=De(i),n=1===i.nodeType&&(" "+r+" ").replace(Re," ")){a=0;for(;s=t[a++];)for(;-1<n.indexOf(" "+s+" ");)n=n.replace(" "+s+" "," ");r!==(o=k.trim(n))&&k.attr(i,"class",o)}}return this},toggleClass:function(r,e){var s=typeof r;return"boolean"==typeof e&&"string"===s?e?this.addClass(r):this.removeClass(r):k.isFunction(r)?this.each(function(t){k(this).toggleClass(r.call(this,t,De(this),e),e)}):this.each(function(){var t,e,i,n;if("string"===s){e=0,i=k(this),n=r.match(L)||[];for(;t=n[e++];)i.hasClass(t)?i.removeClass(t):i.addClass(t)}else void 0!==r&&"boolean"!==s||((t=De(this))&&k._data(this,"__className__",t),k.attr(this,"class",t||!1===r?"":k._data(this,"__className__")||""))})},hasClass:function(t){var e,i,n=0;e=" "+t+" ";for(;i=this[n++];)if(1===i.nodeType&&-1<(" "+De(i)+" ").replace(Re," ").indexOf(e))return!0;return!1}}),k.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,i){k.fn[i]=function(t,e){return 0<arguments.length?this.on(i,null,t,e):this.trigger(i)}}),k.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}});var Le=C.location,Ie=k.now(),Oe=/\?/,Pe=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;k.parseJSON=function(t){if(C.JSON&&C.JSON.parse)return C.JSON.parse(t+"");var r,s=null,e=k.trim(t+"");return e&&!k.trim(e.replace(Pe,function(t,e,i,n){return r&&e&&(s=0),0===s?t:(r=i||e,s+=!n-!i,"")}))?Function("return "+e)():k.error("Invalid JSON: "+t)},k.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{C.DOMParser?e=(new C.DOMParser).parseFromString(t,"text/xml"):((e=new C.ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t))}catch(h){e=void 0}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length||k.error("Invalid XML: "+t),e};var Be=/#.*$/,Fe=/([?&])_=[^&]*/,Ue=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ve=/^(?:GET|HEAD)$/,He=/^\/\//,Ge=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,je={},qe={},ze="*/".concat("*"),We=Le.href,Ye=Ge.exec(We.toLowerCase())||[];function Ke(s){return function(t,e){"string"!=typeof t&&(e=t,t="*");var i,n=0,r=t.toLowerCase().match(L)||[];if(k.isFunction(e))for(;i=r[n++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(s[i]=s[i]||[]).unshift(e)):(s[i]=s[i]||[]).push(e)}}function Xe(e,r,s,a){var o={},u=e===qe;function l(t){var n;return o[t]=!0,k.each(e[t]||[],function(t,e){var i=e(r,s,a);return"string"!=typeof i||u||o[i]?u?!(n=i):void 0:(r.dataTypes.unshift(i),l(i),!1)}),n}return l(r.dataTypes[0])||!o["*"]&&l("*")}function Qe(t,e){var i,n,r=k.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&k.extend(!0,t,i),t}k.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:We,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ye[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ze,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":k.parseJSON,"text xml":k.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Qe(Qe(t,k.ajaxSettings),e):Qe(k.ajaxSettings,t)},ajaxPrefilter:Ke(je),ajaxTransport:Ke(qe),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,n,d,f,p,m,g,r,v=k.ajaxSetup({},e),y=v.context||v,_=v.context&&(y.nodeType||y.jquery)?k(y):k.event,E=k.Deferred(),b=k.Callbacks("once memory"),T=v.statusCode||{},s={},a={},S=0,o="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===S){if(!r){r={};for(;e=Ue.exec(f);)r[e[1].toLowerCase()]=e[2]}e=r[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===S?f:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return S||(t=a[i]=a[i]||t,s[t]=e),this},overrideMimeType:function(t){return S||(v.mimeType=t),this},statusCode:function(t){var e;if(t)if(S<2)for(e in t)T[e]=[T[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||o;return g&&g.abort(e),u(0,e),this}};if(E.promise(w).complete=b.add,w.success=w.done,w.error=w.fail,v.url=((t||v.url||We)+"").replace(Be,"").replace(He,Ye[1]+"//"),v.type=e.method||e.type||v.method||v.type,v.dataTypes=k.trim(v.dataType||"*").toLowerCase().match(L)||[""],null==v.crossDomain&&(i=Ge.exec(v.url.toLowerCase()),v.crossDomain=!(!i||i[1]===Ye[1]&&i[2]===Ye[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(Ye[3]||("http:"===Ye[1]?"80":"443")))),v.data&&v.processData&&"string"!=typeof v.data&&(v.data=k.param(v.data,v.traditional)),Xe(je,v,e,w),2===S)return w;(m=k.event&&v.global)&&0==k.active++&&k.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Ve.test(v.type),d=v.url,v.hasContent||(v.data&&(d=v.url+=(Oe.test(d)?"&":"?")+v.data,delete v.data),!1===v.cache&&(v.url=Fe.test(d)?d.replace(Fe,"$1_="+Ie++):d+(Oe.test(d)?"&":"?")+"_="+Ie++)),v.ifModified&&(k.lastModified[d]&&w.setRequestHeader("If-Modified-Since",k.lastModified[d]),k.etag[d]&&w.setRequestHeader("If-None-Match",k.etag[d])),(v.data&&v.hasContent&&!1!==v.contentType||e.contentType)&&w.setRequestHeader("Content-Type",v.contentType),w.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+ze+"; q=0.01":""):v.accepts["*"]);for(n in v.headers)w.setRequestHeader(n,v.headers[n]);if(v.beforeSend&&(!1===v.beforeSend.call(y,w,v)||2===S))return w.abort();o="abort";for(n in{success:1,error:1,complete:1})w[n](v[n]);if(g=Xe(qe,v,e,w)){if(w.readyState=1,m&&_.trigger("ajaxSend",[w,v]),2===S)return w;v.async&&0<v.timeout&&(p=C.setTimeout(function(){w.abort("timeout")},v.timeout));try{S=1,g.send(s,u)}catch(N){if(!(S<2))throw N;u(-1,N)}}else u(-1,"No Transport");function u(t,e,i,n){var r,s,a,o,u,l=e;2!==S&&(S=2,p&&C.clearTimeout(p),g=void 0,f=n||"",w.readyState=0<t?4:0,r=200<=t&&t<300||304===t,i&&(o=function h(t,e,i){for(var n,r,s,a,o=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(a in o)if(o[a]&&o[a].test(r)){u.unshift(a);break}if(u[0]in i)s=u[0];else{for(a in i){if(!u[0]||t.converters[a+" "+u[0]]){s=a;break}n||(n=a)}s=s||n}if(s)return s!==u[0]&&u.unshift(s),i[s]}(v,w,i)),o=function c(t,e,i,n){var r,s,a,o,u,l={},h=t.dataTypes.slice();if(h[1])for(a in t.converters)l[a.toLowerCase()]=t.converters[a];s=h.shift();for(;s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!u&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=s,s=h.shift())if("*"===s)s=u;else if("*"!==u&&u!==s){if(!(a=l[u+" "+s]||l["* "+s]))for(r in l)if((o=r.split(" "))[1]===s&&(a=l[u+" "+o[0]]||l["* "+o[0]])){!0===a?a=l[r]:!0!==l[r]&&(s=o[0],h.unshift(o[1]));break}if(!0!==a)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(A){return{state:"parsererror",error:a?A:"No conversion from "+u+" to "+s}}}return{state:"success",data:e}}(v,o,w,r),r?(v.ifModified&&((u=w.getResponseHeader("Last-Modified"))&&(k.lastModified[d]=u),(u=w.getResponseHeader("etag"))&&(k.etag[d]=u)),204===t||"HEAD"===v.type?l="nocontent":304===t?l="notmodified":(l=o.state,s=o.data,r=!(a=o.error))):(a=l,!t&&l||(l="error",t<0&&(t=0))),w.status=t,w.statusText=(e||l)+"",r?E.resolveWith(y,[s,l,w]):E.rejectWith(y,[w,l,a]),w.statusCode(T),T=void 0,m&&_.trigger(r?"ajaxSuccess":"ajaxError",[w,v,r?s:a]),b.fireWith(y,[w,l]),m&&(_.trigger("ajaxComplete",[w,v]),--k.active||k.event.trigger("ajaxStop")))}return w},getJSON:function(t,e,i){return k.get(t,e,i,"json")},getScript:function(t,e){return k.get(t,void 0,e,"script")}}),k.each(["get","post"],function(t,r){k[r]=function(t,e,i,n){return k.isFunction(e)&&(n=n||i,i=e,e=void 0),k.ajax(k.extend({url:t,type:r,dataType:n,data:e,success:i},k.isPlainObject(t)&&t))}}),k._evalUrl=function(t){return k.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},k.fn.extend({wrapAll:function(e){if(k.isFunction(e))return this.each(function(t){k(this).wrapAll(e.call(this,t))});if(this[0]){var t=k(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(i){return k.isFunction(i)?this.each(function(t){k(this).wrapInner(i.call(this,t))}):this.each(function(){var t=k(this),e=t.contents();e.length?e.wrapAll(i):t.append(i)})},wrap:function(e){var i=k.isFunction(e);return this.each(function(t){k(this).wrapAll(i?e.call(this,t):e)})},unwrap:function(){return this.parent().each(function(){k.nodeName(this,"body")||k(this).replaceWith(this.childNodes)}).end()}});k.expr.filters.hidden=function(t){return A.reliableHiddenOffsets()?t.offsetWidth<=0&&t.offsetHeight<=0&&!t.getClientRects().length:function i(t){if(!k.contains(t.ownerDocument||p,t))return!0;for(;t&&1===t.nodeType;){if("none"===((e=t).style&&e.style.display||k.css(e,"display"))||"hidden"===t.type)return!0;t=t.parentNode}var e;return!1}(t)},k.expr.filters.visible=function(t){return!k.expr.filters.hidden(t)};var Je=/%20/g,$e=/\[\]$/,Ze=/\r?\n/g,ti=/^(?:submit|button|image|reset|file)$/i,ei=/^(?:input|select|textarea|keygen)/i;function ii(i,t,n,r){var e;if(k.isArray(t))k.each(t,function(t,e){n||$e.test(i)?r(i,e):ii(i+"["+("object"==typeof e&&null!=e?t:"")+"]",e,n,r)});else if(n||"object"!==k.type(t))r(i,t);else for(e in t)ii(i+"["+e+"]",t[e],n,r)}k.param=function(t,e){var i,n=[],r=function(t,e){e=k.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=k.ajaxSettings&&k.ajaxSettings.traditional),k.isArray(t)||t.jquery&&!k.isPlainObject(t))k.each(t,function(){r(this.name,this.value)});else for(i in t)ii(i,t[i],e,r);return n.join("&").replace(Je,"+")},k.fn.extend({serialize:function(){return k.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=k.prop(this,"elements");return t?k.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!k(this).is(":disabled")&&ei.test(this.nodeName)&&!ti.test(t)&&(this.checked||!Z.test(t))}).map(function(t,e){var i=k(this).val();return null==i?null:k.isArray(i)?k.map(i,function(t){return{name:e.name,value:t.replace(Ze,"\r\n")}}):{name:e.name,value:i.replace(Ze,"\r\n")}}).get()}}),k.ajaxSettings.xhr=void 0!==C.ActiveXObject?function(){return this.isLocal?oi():8<p.documentMode?ai():/^(get|post|head|put|delete|options)$/i.test(this.type)&&ai()||oi()}:ai;var ni=0,ri={},si=k.ajaxSettings.xhr();C.attachEvent&&C.attachEvent("onunload",function(){for(var t in ri)ri[t](void 0,!0)}),A.cors=!!si&&"withCredentials"in si,(si=A.ajax=!!si)&&k.ajaxTransport(function(u){if(!u.crossDomain||A.cors){var l;return{send:function(t,s){var e,a=u.xhr(),o=++ni;if(a.open(u.type,u.url,u.async,u.username,u.password),u.xhrFields)for(e in u.xhrFields)a[e]=u.xhrFields[e];u.mimeType&&a.overrideMimeType&&a.overrideMimeType(u.mimeType),u.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest");for(e in t)void 0!==t[e]&&a.setRequestHeader(e,t[e]+"");a.send(u.hasContent&&u.data||null),l=function(t,e){var i,n,r;if(l&&(e||4===a.readyState))if(delete ri[o],l=void 0,a.onreadystatechange=k.noop,e)4!==a.readyState&&a.abort();else{r={},i=a.status,"string"==typeof a.responseText&&(r.text=a.responseText);try{n=a.statusText}catch(g){n=""}i||!u.isLocal||u.crossDomain?1223===i&&(i=204):i=r.text?200:404}r&&s(i,n,r,a.getAllResponseHeaders())},u.async?4===a.readyState?C.setTimeout(l):a.onreadystatechange=ri[o]=l:l()},abort:function(){l&&l(void 0,!0)}}}});function ai(){try{return new C.XMLHttpRequest}catch(e){}}function oi(){try{return new C.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}k.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return k.globalEval(t),t}}}),k.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),k.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=p.head||k("head")[0]||p.documentElement;return{send:function(t,i){(n=p.createElement("script")).async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(t,e){(e||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,e||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(void 0,!0)}}}});var ui=[],li=/(=)\?(?=&|$)|\?\?/;k.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ui.pop()||k.expando+"_"+Ie++;return this[t]=!0,t}}),k.ajaxPrefilter("json jsonp",function(t,e,i){var n,r,s,a=!1!==t.jsonp&&(li.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&li.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return n=t.jsonpCallback=k.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(li,"$1"+n):!1!==t.jsonp&&(t.url+=(Oe.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return s||k.error(n+" was not called"),s[0]},t.dataTypes[0]="json",r=C[n],C[n]=function(){s=arguments},i.always(function(){void 0===r?k(C).removeProp(n):C[n]=r,t[n]&&(t.jsonpCallback=e.jsonpCallback,ui.push(n)),s&&k.isFunction(r)&&r(s[0]),s=r=void 0}),"script"}),k.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||p;var n=N.exec(t),r=!i&&[];return n?[e.createElement(n[1])]:(n=ht([t],e,r),r&&r.length&&k(r).remove(),k.merge([],n.childNodes))};var hi=k.fn.load;k.fn.load=function(t,e,i){if("string"!=typeof t&&hi)return hi.apply(this,arguments);var n,r,s,a=this,o=t.indexOf(" ");return-1<o&&(n=k.trim(t.slice(o,t.length)),t=t.slice(0,o)),k.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),0<a.length&&k.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){s=arguments,a.html(n?k("<div>").append(k.parseHTML(t)).find(n):t)}).always(i&&function(t,e){a.each(function(){i.apply(this,s||[t.responseText,e,t])})}),this},k.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){k.fn[e]=function(t){return this.on(e,t)}}),k.expr.filters.animated=function(e){return k.grep(k.timers,function(t){return e===t.elem}).length};function ci(t){return k.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}k.offset={setOffset:function(t,e,i){var n,r,s,a,o,u,l=k.css(t,"position"),h=k(t),c={};"static"===l&&(t.style.position="relative"),o=h.offset(),s=k.css(t,"top"),u=k.css(t,"left"),r=("absolute"===l||"fixed"===l)&&-1<k.inArray("auto",[s,u])?(a=(n=h.position()).top,n.left):(a=parseFloat(s)||0,parseFloat(u)||0),k.isFunction(e)&&(e=e.call(t,i,k.extend({},o))),null!=e.top&&(c.top=e.top-o.top+a),null!=e.left&&(c.left=e.left-o.left+r),"using"in e?e.using.call(t,c):h.css(c)}},k.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){k.offset.setOffset(this,e,t)});var t,i,n={top:0,left:0},r=this[0],s=r&&r.ownerDocument;return s?(t=s.documentElement,k.contains(t,r)?("undefined"!=typeof r.getBoundingClientRect&&(n=r.getBoundingClientRect()),i=ci(s),{top:n.top+(i.pageYOffset||t.scrollTop)-(t.clientTop||0),left:n.left+(i.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):n):void 0},position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===k.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),k.nodeName(t[0],"html")||(i=t.offset()),i.top+=k.css(t[0],"borderTopWidth",!0),i.left+=k.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-k.css(n,"marginTop",!0),left:e.left-i.left-k.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&!k.nodeName(t,"html")&&"static"===k.css(t,"position");)t=t.offsetParent;return t||jt})}}),k.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,r){var s=/Y/.test(r);k.fn[e]=function(t){return $(this,function(t,e,i){var n=ci(t);return void 0===i?n?r in n?n[r]:n.document.documentElement[e]:t[e]:void(n?n.scrollTo(s?k(n).scrollLeft():i,s?i:k(n).scrollTop()):t[e]=i)},e,t,arguments.length,null)}}),k.each(["top","left"],function(t,i){k.cssHooks[i]=Yt(A.pixelPosition,function(t,e){if(e)return e=zt(t,i),Ht.test(e)?k(t).position()[i]+"px":e})}),k.each({Height:"height",Width:"width"},function(s,a){k.each({padding:"inner"+s,content:a,"":"outer"+s},function(n,t){k.fn[t]=function(t,e){var i=arguments.length&&(n||"boolean"!=typeof t),r=n||(!0===t||!0===e?"margin":"border");return $(this,function(t,e,i){var n;return k.isWindow(t)?t.document.documentElement["client"+s]:9===t.nodeType?(n=t.documentElement,Math.max(t.body["scroll"+s],n["scroll"+s],t.body["offset"+s],n["offset"+s],n["client"+s])):void 0===i?k.css(t,e,r):k.style(t,e,i,r)},a,i?t:void 0,i,null)}})}),k.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}}),k.fn.size=function(){return this.length},k.fn.andSelf=k.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return k});var di=C.jQuery,fi=C.$;return k.noConflict=function(t){return C.$===k&&(C.$=fi),t&&C.jQuery===k&&(C.jQuery=di),k},e||(C.jQuery=C.$=k),k},"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t);i.jQuery=window.jQuery?window.jQuery:window.$;window.$=n;window.jQuery=r}();!function(){"use strict";var d=getDframework();d.define("imgtech.media.Fullscreen",function(){function t(t,e){this.attr=t;this.addedObject=e;this.realElement=null;this.fullscreenElement=null;this.fullscreenAttribute=null;this.__replaceCsse=null;this.__replaceZindexes=null;this.__replaceHideElement=null;this.__replaceIframeElement=null;this.__ieResizeWindow=null;this.mobileDepthSize=150;this.__isVirtualFullscreen=!1}t.prototype={constructor:t,onOrientationChange:function(t){t.orientation&&"landscape"==t.orientation&&(90==window.rotation?this.rotate(this,-90):this.rotate(this,90))},rotate:function(t,e){var i=this.realElement||this.fullscreenElement;if(i&&this.isFullscreen()){var n=e/90;n<0&&(n+=4);var r="rotate("+e+"deg)",s="progid:DXImageTransform.Microsoft.BasicImage(rotation="+n+")";i.style.transform=r;i.style.WebkitTransform=r;i.style.MozTransform=r;i.style.OTransform=r;if(d.b.ie){i.style.filter=s;i.style.MsFilter=s}}},fullscreenNavigationUI:function(){return this.attr&&this.attr.fullscreenNavigationUI},isReplaceElement:function(){return this.attr&&this.attr.fullscreenReplaceElement},isReplaceCss:function(){return this.attr&&this.attr.fullscreenReplaceCss},isReplaceZindex:function(){return this.attr&&this.attr.fullscreenReplaceZindex},isReplaceHideElement:function(){return this.attr&&this.attr.fullscreenHideElement},isReplaceIframe:function(){return this.attr&&this.attr.fullscreenReplaceIframe},isAllowFullscreen:function(){return this.attr&&this.attr.fullscreenAllowFullscreen},isResizeWindow:function(){return this.attr&&this.attr.fullscreenResizeWindow},getBodyElement:function(t){for(var e,i,n=t;e=n.parentNode;){if("body"==(i=e.nodeName.toLowerCase())||"html"==i)return e;n=e}},getFullscreenParentElements:function(t){for(var e,i={fsElements:[],hideElements:[]},n=t;e=n.parentNode;){i.fsElements.push({parent:e,safe:n});if("body"==e.nodeName.toLowerCase())break;n=e}for(var r=0;r<i.fsElements.length;r++){var s=i.fsElements[r],a=s.parent,o=s.safe,u=a.children;if(u)for(var l=0;l<u.length;l++)u[l]!==o&&i.hideElements.push({element:u[l]})}return i},getFullscreenParentIframes:function(t){var e,i,n,r={fsElements:[],hideElements:[]},s=window;do{try{if(!(e=(i=s).parent)||e===i)break;s=e;if(!(n=d.queryAll(e.document.body,"iframe"))||n&&!n.length)break;for(var a=0;a<n.length;a++){var o=n[a];o.contentWindow===i||o.contentDocument===i?r.fsElements.push({iframe:o}):r.hideElements.push({iframe:o})}}catch(u){d.error(u)}}while(s);return r},replaceCss:function(t,e){var i,n,r,s="mpv-fullscreen-none-node",a="mpv-fullscreen-node",o=this.__replaceCsse;if(o){i=o.fsElements;n=o.hideElements;for(r=0;r<n.length;r++)d.removeClass(n[r].element,s);for(r=0;r<i.length;r++)d.removeClass(i[r].safe,a);this.__replaceCsse=null}if(e){i=(o=this.getFullscreenParentElements(t)).fsElements;n=o.hideElements;for(r=0;r<n.length;r++)d.addClass(n[r].element,s);for(r=0;r<i.length;r++)d.addClass(i[r].safe,a);this.__replaceCsse=o}},replaceZindex:function(t,e){var i,n,r,s=this.__replaceZindexes;if(s){i=s.fsElements;n=s.hideElements;for(r=0;r<n.length;r++)n[r].element.style.zIndex=n[r].element_style.zIndex;for(r=0;r<i.length;r++)i[r].safe.style.zIndex=i[r].safe_style.zIndex;this.__replaceZindexes=null}if(e){i=(s=this.getFullscreenParentElements(t)).fsElements;n=s.hideElements;for(r=0;r<n.length;r++){n[r].element_style={zIndex:n[r].element.style.zIndex};n[r].element.style.zIndex=1}for(r=0;r<i.length;r++){i[r].safe_style={zIndex:i[r].safe.style.zIndex};i[r].safe.style.zIndex=999}this.__replaceZindexes=s}},replaceHideElement:function(t,e){var i,n,r=this.__replaceHideElement;if(r){r.fsElements;i=r.hideElements;for(n=0;n<i.length;n++)i[n].element.style.display=i[n].element_style.display;this.__replaceHideElement=null}if(e){(r=this.getFullscreenParentElements(t)).fsElements;i=r.hideElements;for(n=0;n<i.length;n++){var s=i[n].element.style.display;i[n].element_style={display:s||""};i[n].element.style.display="none"}this.__replaceHideElement=r}},allowFullscreen:function(t){var e,i,n=this.getFullscreenParentIframes(t).fsElements;for(i=0;i<n.length;i++){e=n[i];try{d.attr(e.iframe,"allowFullscreen",!0)}catch(r){d.error("Exception (Set allowFullscreen)");d.error(e);d.error(r);break}}},replaceIframe:function(t,e){function i(t,e){var i;try{i={style:{position:t.style.position,display:t.style.display,width:t.style.width,height:t.style.height,margin:t.style.margin,padding:t.style.padding,border:t.style.border,top:t.style.top,left:t.style.left,right:t.style.right,bottom:t.style.bottom},frameborder:t.frameborder,width:t.width,height:t.height,scrolling:t.scrolling,marginwidth:t.marginwidth,marginheight:t.marginheight}}catch(n){d.error(n);i=null}if(i)if(e){t.style.position="absolute";t.style.display="block";t.style.width="100%";t.style.height="100%";t.style.margin="0px 0px";t.style.padding="0px 0px";t.style.border="0px";t.style.top="0px";t.style.left="0px";t.style.right="auto";t.style.bottom="auto";t.frameborder="0";t.width="100%";t.height="100%";t.scrolling="no";t.marginwidth="0";t.marginheight="0"}else t.style.display="none";return i}function n(t,e,i){if(e)if(i){t.style.position=e.style.position;t.style.display=e.style.display;t.style.width=e.style.width;t.style.height=e.style.height;t.style.margin=e.style.margin;t.style.padding=e.style.padding;t.style.border=e.style.border;t.style.top=e.style.top;t.style.left=e.style.left;t.style.right=e.style.right;t.style.bottom=e.style.bottom;t.frameborder=e.frameborder;t.width=e.width;t.height=e.height;t.scrolling=e.scrolling;t.marginwidth=e.marginwidth;t.marginheight=e.marginheight}else t.style.display=e.style.display?e.style.display:""}var r,s,a,o,u=this.__replaceIframeElement;if(u){r=u.fsElements;s=u.hideElements;for(a=0;a<r.length;a++)n((o=r[a]).iframe,o.save,!0);for(a=0;a<s.length;a++)n((o=s[a]).iframe,o.save,!1);this.__replaceIframeElement=u=null}if(e){r=(u=this.getFullscreenParentIframes(t)).fsElements;s=u.hideElements;for(a=0;a<r.length;a++)(o=r[a]).save=i(o.iframe,!0);for(a=0;a<s.length;a++)(o=s[a]).save=i(o.iframe,!1);this.__replaceIframeElement=u}},replaceElement:function(t,e){var i=this.windowSize();if(e){this.hasReplaceElement=!0;var n=document.body.children[0];this._originPosition=document.createElement("div");d.addClass(this._originPosition,"mpv-fullscreen-origin-position");this._virtualPosition=document.createElement("div");this._virtualPosition.innerText="mpv-fullscreen-virtual-position";d.addClass(this._virtualPosition,"mpv-fullscreen-virtual-position");this._virtualPosition.style.height=i.height+this.mobileDepthSize+"px";d.before(t,this._originPosition);d.before(n,this._virtualPosition);d.append(this._virtualPosition,t)}else{this.hasReplaceElement=!1;if(this._originPosition){d.before(this._originPosition,t);d.remove(this._originPosition);this._originPosition=null}if(this._virtualPosition){d.remove(this._virtualPosition);this._virtualPosition=null}}},windowSize:function(){var t=window,e=document,i=e.documentElement,n=e.getElementsByTagName("body")[0];return{width:t.innerWidth||i.clientWidth||n.clientWidth,height:t.innerHeight||i.clientHeight||n.clientHeight}},getScreenSize:function(){return{width:window.screen.width,height:window.screen.height}},viewportSize:function(){var t,e;if(d.b.ie&&d.b.ie<=8)if(document.documentElement&&document.documentElement.clientWidth){t=document.documentElement.clientWidth;e=document.documentElement.clientHeight}else if(document.body.clientWidth){t=document.body.clientWidth;e=document.body.clientHeight}else d.warn("Not found client width / height.");else{t=window.outerWidth||window.innerWidth;e=window.outerHeight||window.innerHeight}return{width:t,height:e}},ieResizeWindow:function(t){var e=this.__ieResizeWindow;if(t)(function c(){var t,e,i=this.getScreenSize(),n=i.width,r=i.height,s=this.viewportSize();if(d.b.ie&&d.b.ie<=8){t=window.screenLeft;e=window.screenTop}else{t=window.screenX;e=window.screenY}var a=this.__ieResizeWindow={windowX:t,windowY:e,viewportWidth:s.width,viewportHeight:s.height};try{window.moveTo(0,0)}catch(h){}try{window.resizeTo(n,r)}catch(h){}if(d.b.ie&&d.b.ie<=8){var o=this.viewportSize(),u=window.screenLeft,l=window.screenTop;a.depthWidth=i.width-o.width;a.depthHeight=i.height-o.height;if(o.width===a.viewportWidth)a.unchanged=!0;else{a.viewportWidth+=a.depthWidth;a.viewportHeight+=a.depthHeight;a.windowX-=u;a.windowY-=l}}}).call(this);else if(e){if(d.b.ie&&d.b.ie<=8){if(!0!==e.unchanged)if(d.b.osVersion<6.1){window.resizeTo(e.viewportWidth,e.viewportHeight-30);window.moveTo(e.windowX,e.windowY)}else{window.resizeTo(e.viewportWidth+0,e.viewportHeight-40);window.moveTo(e.windowX,e.windowY)}}else{window.resizeTo(e.viewportWidth,e.viewportHeight);window.moveTo(e.windowX,e.windowY)}this.__ieResizeWindow=null}},enable:function(t,e){var i=window.event;return!(d.b.iOS||!1===e||!i&&!d.b.firefox||this.fullscreenElement)&&((!d.b.ie||11!==d.b.ie||!i||"keydown"!=i.type&&"keyup"!=i.type)&&(!!t.webkitRequestFullscreen||(!!t.mozRequestFullScreen||(!!t.msRequestFullscreen||!!t.requestFullscreen))))},_fullscreen:function(t){var e={};if(d.b.isMobile){var i=this.fullscreenNavigationUI();i&&(e.navigationUI=i)}if(t.webkitRequestFullscreen)t.webkitRequestFullscreen(e);else if(t.mozRequestFullScreen)t.mozRequestFullScreen(e);else if(t.msRequestFullscreen)t.msRequestFullscreen(e);else{if(!t.requestFullscreen)return!1;t.requestFullscreen(e)}return!0},_exit:function(){if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else{if(!document.exitFullscreen)return!1;document.exitFullscreen()}return!0},fullscreen:function(t,e){e||window.event||d.b.firefox||(e=!1);if(this.isFullscreen())throw new Error("current is fullscreen.");var i,n=this.enable(t,e);if(n){this.isAllowFullscreen()&&this.allowFullscreen(t);this.realElement=t;this._fullscreen(t);d.addClass(t,"mpv-real-fullscreen");i=!1}else{this.fullscreenElement=t;this.fullscreenAttribute=e;d.addClass(t,"mpv-virtual-fullscreen");this.isReplaceElement()&&this.replaceElement(t,!0);this.isReplaceCss()&&this.replaceCss(t,!0);this.isReplaceZindex()&&this.replaceZindex(t,!0);this.isReplaceHideElement()&&this.replaceHideElement(t,!0);this.isReplaceIframe()&&this.replaceIframe(t,!0);!d.b.isMobile&&d.b.ie&&this.isResizeWindow()&&this.ieResizeWindow(!0);i=!0}this.__isVirtualFullscreen=i;return n},enableExit:function(){return this.isRealFullscreen()},exit:function(t){var e,i=this.realElement;if(t)this.realElement=null;else if(!this.isFullscreen())throw new Error("current is not fullscreen.");if(i){t||this._exit();!(e=!0);this.realElement=null}else if(i=this.fullscreenElement){!(e=!1);this.fullscreenElement=null;this.fullscreenAttribute=null;this.isReplaceElement()&&this.replaceElement(i,!1);this.isReplaceCss()&&this.replaceCss(i,!1);this.isReplaceZindex()&&this.replaceZindex(i,!1);this.isReplaceHideElement()&&this.replaceHideElement(i,!1);this.isReplaceIframe()&&this.replaceIframe(i,!1);!d.b.isMobile&&d.b.ie&&this.isResizeWindow()&&this.ieResizeWindow(!1)}this.__isVirtualFullscreen=!1;d.removeClass(i,"mpv-virtual-fullscreen");d.removeClass(i,"mpv-real-fullscreen");return e},toggle:function(t,e){return this.isFullscreen()?this.exit(t,e):this.fullscreen(t,e)},isRealFullscreen:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},isVirtualFullscreen:function(){return this.__isVirtualFullscreen},isFullscreen:function(){return null!==this.fullscreenElement?this.fullscreenElement:this.isRealFullscreen()},isWindowFullscreen:function(t,e){return null!==this.fullscreenElement}};return t})}();!function(){"use strict";var l=getDframework();l.define("imgtech.media.module.Moveable",function(){function t(t,e,i){if(e){this.repmod=t;this.mineElement=e;this.attr=i||{};this.changeListener=null;this.total=0;this.min=0;this.max=0;this.value=0;this.fixed=!1;var n=this;this.self_mousemove=function(t){return n.mousemove(t)};this.self_mouseup=function(t){return n.mouseup(t)};this.self_touchmove=function(t){return n.touchmove(t)};this.self_touchend=function(t){return n.touchend(t)};l.on(e,"mousedown",function(t){return n.mousedown(t)});l.on(e,"touchstart",function(t){return n.touchstart(t)})}}t.prototype={constructor:t,clean:function(){this.total=0;this.min=0;this.max=0;this.value=0},setOuterElement:function(t){this.outer=t},setChangeListener:function(t){this.changeListener=t},setFixed:function(t){var e=this.mineElement;(this.fixed=t)?e&&(e.style.cursor="default"):e&&(e.style.cursor="pointer")},setTotal:function(t){this.total=t},setMin:function(t){this.min=t},setMax:function(t){this.max=t},setValue:function(t){if(t!==undefined&&!1!==t){var e=this.mineElement,i=this.total,n=this.outer,r=n?l.getBoundingClientRect(n):null,s=r?r.width():0;t>this.max?t=this.max:t<this.min&&(t=this.min);if(s&&i){var a=s*t/i;e.style.left=Math.floor(a)+"px"}this.value=t}},draw:function(){if(this.value!==undefined){var t=this;setTimeout(function(){t.setValue(t.value)},1)}},drawing:function(t,e){var i=this.mineElement,n=this.outer,r=n?l.getBoundingClientRect(n):null,s=r?r.width():0;if(i&&s){var a=e.x-r.left;s<a?a=s:a<0&&(a=0);var o=a/s*this.total,u=this.changeListener?this.changeListener({type:t,event:e,value:o}):undefined;this.setValue(u)}},mousedown:function(t){if(!this.fixed){this.isMouseDown=t;if(this.changeListener){var e={x:t.clientX,y:t.clientY};l.on(document.body,"mousemove",this.self_mousemove);l.on(document.body,"mouseup",this.self_mouseup);this.changeListener({type:"down",event:e});return l.igEventAll(t)}}},mouseup:function(t){if(!this.fixed&&this.isMouseDown){var e={x:t.clientX,y:t.clientY};this.isMouseDown=!1;if(this.changeListener){l.off(document.body,"mousemove",this.self_mousemove);l.off(document.body,"mouseup",this.self_mouseup);this.drawing("up",e)}return l.igEventAll(t)}},mousemove:function(t){if(!this.fixed&&this.isMouseDown&&this.changeListener){var e={x:t.clientX,y:t.clientY};this.drawing("move",e);return l.igEventAll(t)}},touchstart:function(t){if(!this.fixed){this.isTouchStart=t;if(this.changeListener){var e=t.changedTouches,i=e&&e.length&&e[0],n=i?{x:i.pageX,y:i.pageY}:null,r=this.mineElement;l.on(r,"touchend",this.self_touchend);l.on(r,"touchmove",this.self_touchmove);this.changeListener({type:"touchstart",event:n});return l.igEventAll(t)}}},touchend:function(t){if(!this.fixed&&this.isTouchStart){this.isTouchStart=!1;if(this.changeListener){var e=t.changedTouches,i=e&&e.length&&e[0],n=i?{x:i.pageX,y:i.pageY}:null,r=this.mineElement;l.off(r,"touchend",this.self_touchend);l.off(r,"touchmove",this.self_touchmove);n&&this.drawing("touchend",n)}return l.igEventAll(t)}},touchmove:function(t){if(!this.fixed&&this.isTouchStart&&this.changeListener){var e=t.changedTouches,i=e&&e.length&&e[0],n=i?{x:i.pageX,y:i.pageY}:null;n&&this.drawing("touchmove",n);return l.igEventAll(t)}},init:function(){var t=this.mineElement;l.off(document.body,"mousemove",this.self_mousemove);l.off(document.body,"mouseup",this.self_mouseup);l.off(t,"touchend",this.self_touchend);l.off(t,"touchmove",this.self_touchmove);this.total=0;this.min=0;this.max=0;this.value=0;this.fixed=!1}};return t})}();!function(){"use strict";getDframework().define("imgtech.media.module.Matrix",function(){function f(t,e){this.x=t;this.y=e}f.rotate=function(t,e){return new f(t.x,t.y).rotate(e)};f.prototype={rotate:function(t){var e=s.rotate2dMatrix(t),i=this.x,n=this.y;0===(this.x=parseFloat((e[0]*i+e[1]*n).toFixed(6)))&&(this.x=0);0===(this.y=parseFloat((e[2]*i+e[3]*n).toFixed(6)))&&(this.y=0);return this}};function r(t,e,i){this.x=t;this.y=e;this.z=i||0}r.rotate=function(t,e){return new r(t.x,t.y,t.z).rotate(e)};r.prototype={rotate:function(t){var e=s.rotate3dMatrix(t),i=this.x,n=this.y,r=this.z;0===(this.x=parseFloat((e[0]*i+e[1]*n+e[2]*r).toFixed(6)))&&(this.x=0);0===(this.y=parseFloat((e[3]*i+e[4]*n+e[5]*r).toFixed(6)))&&(this.y=0);0===(this.z=parseFloat((e[6]*i+e[7]*n+e[8]*r).toFixed(6)))&&(this.z=0);return this}};function p(t,e,i,n){this.x=t;this.y=e;this.w=i;this.h=n}p.rotate=function(t,e){return(t=new p(t.x,t.y,t.w,t.h)).rotate(e)};p.prototype={center:function(){return new f(this.x+this.w/2,this.y+this.h/2)},transform:function(t){this.x+=t.x;this.y+=t.y;return this},rotate:function(t,e){function i(t){var e=t.sort(function(t,e){return t-e});return{min:e[0],max:e[e.length-1]}}var n=this.w/2,r=this.h/2,s=new f(this.x+n,this.y+r),a=new f(-n,-r).rotate(t),o=new f(n,-r).rotate(t),u=new f(-n,r).rotate(t),l=new f(n,r).rotate(t),h=i([a.x,o.x,u.x,l.x]),c=i([a.y,o.y,u.y,l.y]),d=new p(h.min,c.min,h.max-h.min,c.max-c.min);return e?[a,o,u,l]:d.transform(s)}};function s(){}s.Point=f;s.Vector=r;s.Rectangle=p;s.degree=function(t){return parseFloat((t/180*Math.PI).toFixed(6))};s.radian=function(t){return parseFloat((180*t/Math.PI).toFixed(3))};s.rotate2dMatrix=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,-i,i,e]};s.rotate3dMatrix=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,-i,0,i,e,0,0,0,1]};s.rotate2d=function(t,e,i){return new f(t,e).rotate(i)};s.rotate3d=function(t,e,i,n){return new r(t,e,i).rotate(n)};s.prototype={};return s})}();!function(){"use strict";var p=getDframework();p.module("imgtech.media.Media");p.define("imgtech.media.extends.ElementManager",function(){var d={bctrl:"mpv-bctrl-btn",ectrl:"mpv-ectrl-btn",inBox:"mpv-in-box",osdLoadingBtn:"mpv-osd-loading",osdToggleBtn:"mpv-osd-toggle",bottom:"mpv-bottom",configBtn:"mpv-config-btn",configLayout:"mpv-config-layout",configMenu:"mpv-config-menu",openLayerBtn:"mpv-openlayer-btn",openLayerRollbackBtn:"mpv-openlayer-rollback-btn",openLayerCloseBtn:"mpv-openlayer-close-btn",fullscreenBtn:"mpv-fullscreen-btn",sizeBtn:"mpv-size-btn",wideBtn:"mpv-wide-btn",previousBtn:"mpv-previous-btn",nextBtn:"mpv-next-btn",playlistLayout:"mpv-playlist-layout",playlistAddBtn:"mpv-playlist-add-btn",playlistMenuBtn:"mpv-playlist-menu-btn",repmarkAddBtn:"mpv-repmark-add-btn",repmarkMenuBtn:"mpv-repmark-menu-btn",bookmarkAddBtn:"mpv-bookmark-add-btn",bookmarkMenuBtn:"mpv-bookmark-menu-btn",rateBtn:"mpv-rate-btn",rateDownBtn:"mpv-rate-down-btn",rateUpBtn:"mpv-rate-up-btn",rateText:"mpv-rate-text",qualityBtn:"mpv-quality-btn",subtitleBtn:"mpv-subtitle-btn",switchSourceBtn:"mpv-switchsource-btn",repeatBtn:"mpv-repeat-btn",previousSkipBtn:"mpv-previous-skip-btn",nextSkipBtn:"mpv-next-skip-btn",skipInput:"mpv-skip-input",currentTimeText:"mpv-currenttime-text",durationText:"mpv-duration-text",toggleBtn:"mpv-toggle-btn",stopBtn:"mpv-stop-btn",popupBtn:"mpv-popup-btn",titleTextBtn:"mpv-title-text-btn",titleText:"mpv-title-text",exitBtn:"mpv-exit-btn",flashBtn:"mpv-flash-icon",lockBtn:"mpv-lock-btn",adDetailBtn:"mpv-ad-detail-btn",adSkipBtn:"mpv-ad-skip-btn",introSkipBtn:"mpv-intro-skip-btn",rotateBtn:"mpv-rotate-btn"};function f(t){this.__type__="element";this.all=t.all;this.bottom=t.bottom;this.extend=t.extend;this.menu=t.menu;this.etc=t.etc}f.prototype={constructor:f,initButton:function(t){if(t){t.hideButton&&p.addClass(this.bottom,"mpv-hide");t.hideExtendButton&&p.addClass(this.extend,"mpv-hide");t.hideMenuButton&&p.addClass(this.menu,"mpv-hide");t.hideEtcButton&&p.addClass(this.etc,"mpv-hide")}},hideButton:function(t,e){p.addClass(this.all,"mpv-hide")},showButton:function(t){if(t){t.hideButton||p.removeClass(this.bottom,"mpv-hide");t.hideExtendButton||p.removeClass(this.extend,"mpv-hide");t.hideMenuButton||p.removeClass(this.menu,"mpv-hide");t.hideEtcButton||p.removeClass(this.etc,"mpv-hide")}},coercionShowButton:function(t){switch(t){case"bottom":return p.removeClass(this.bottom,"mpv-hide");case"extend":return p.removeClass(this.extend,"mpv-hide");case"menu":return p.removeClass(this.menu,"mpv-hide");case"etc":return p.removeClass(this.etc,"mpv-hide");case"all":p.removeClass(this.bottom,"mpv-hide");p.removeClass(this.extend,"mpv-hide");p.removeClass(this.menu,"mpv-hide");p.removeClass(this.etc,"mpv-hide")}},coercionHideButton:function(t){switch(t){case"bottom":return p.addClass(this.bottom,"mpv-hide");case"extend":return p.addClass(this.extend,"mpv-hide");case"menu":return p.addClass(this.menu,"mpv-hide");case"etc":return p.addClass(this.etc,"mpv-hide");case"all":p.addClass(this.bottom,"mpv-hide");p.addClass(this.extend,"mpv-hide");p.addClass(this.menu,"mpv-hide");p.addClass(this.etc,"mpv-hide")}}};function t(t){this.p=t;this.buttonInfo={}}t.NAME=d;t.Button=f;t.prototype={constructor:t,getButton:function(t,e){var i=this.buttonInfo,n=i[t];if(!n){var r=e||d[t],s=r?p.queryAll(this.p.userElement,"."+r):null,a=[],o=[],u=[],l=[];if(s&&s.length)for(var h=0;h<s.length;h++){var c=s[h];p.hasClass(c,"mpv-bctrl-btn")?a.push(c):p.hasClass(c,"mpv-ectrl-btn")?o.push(c):p.hasClass(c,"mpv-etc-btn")?l.push(c):p.hasClass(c,"mpv-in-box")&&u.push(c)}n=i[t]=new f({all:s||[],bottom:a,extend:o,menu:u,etc:l})}return n}};return t})}();!function(){"use strict";var u=getDframework();u.module("imgtech.media.Media");u.define("imgtech.media.extends.Popup",function(){var s="mpv-hide",a="mpv-on",o="mpv-off";function t(t,e){if(!t)throw new Error("Not found owner object on Menu constructor.");if(!e)throw new Error("Not found attribute on Menu constructor.");if(!e.player)throw new Error("Not found player object on Menu constructor.");!1!==e.overwrite&&(e.overwrite=!0);!1!==e.disableControl&&(e.disableControl=!0);this.__menu={owner:t,p:e.player,c:e.player&&e.player.controller,attr:e,box:e.element,closeBtns:null,lastCaller:null};var i=this,n=this.__menu;if(n.box){(n.closeBtns=u.queryAll(n.box,".mpv-view-close-btn"))&&u.on(n.closeBtns,"click",function(t){i.closeMenu()});u.on(n.box,"click",function(t){return u.igEventAll(t)})}this.closeMenu();this.__menu.p.addMenu(this)}t.prototype={constructor:t,patchOverwrite:function(){var t=this.__menu.owner;for(var e in this)"constructor"!==e&&(t[e]=this[e])},isOpenMenu:function(){return!u.hasClass(this.__menu.box,s)},patchMenuClassName:function(t){function e(t,e,i){if(t)for(var n=0;n<t.length;n++){var r=t[n];u.addClass(r,e);u.removeClass(r,i)}}var i=this.__menu,n=i.attr;if(t){e(n.button,a,o);e(n.friend,a,o);u.addClass(i.box,a);u.removeClass(i.box,s)}else{e(n.button,o,a);e(n.friend,o,a);u.addClass(i.box,s);u.removeClass(i.box,a)}if(n.disableControl){var r=i.p&&i.p.module("layout");r&&r.disableHide(this,!!t)}},closeMenu:t.closeMenu=function(t){var e=this.__menu,i=this;"clear"==t&&(e.lastCaller=!0);this.__closeMenu&&this.__closeMenu(t);this.patchMenuClassName(!1);!t&&e.lastCaller&&e.lastCaller.closeChildMenu&&setTimeout(function(){if(e.lastCaller&&e.lastCaller.closeChildMenu){e.lastCaller.closeChildMenu(i);e.lastCaller=null}},1)},openMenu:function(t){this.p.closeAllMenu(!0);this.__openMenu&&this.__openMenu();this.patchMenuClassName(!0);t&&t.caller&&(this.__menu.lastCaller=t.caller)},toggleMenu:t.toggleMenu=function(){if(this.isOpenMenu())this.closeMenu();else{this.p.closeAllMenu("clear");this.openMenu()}},closeChildMenu:t.closeChildMenu=function(t){t&&t.attr&&t.attr.menu&&t.attr.menu.closeParentOnCloseMenu?this.closeMenu():this.openMenu()}};return t})}();!function(){"use strict";var l=getDframework(),e=(l.module("imgtech.media.Media"),l.module("imgtech.media.extends.Popup"));l.define("imgtech.media.extends.Menu",function(){var s=l.module("imgtech.media.extends.ElementManager").Button,a="mpv-hide",o="mpv-on",u="mpv-off";function t(t,e){if(!t)throw new Error("Not found owner object on Menu constructor.");if(!e)throw new Error("Not found attribute on Menu constructor.");if(!e.player)throw new Error("Not found player object on Menu constructor.");!1!==e.overwrite&&(e.overwrite=!0);!1!==e.invalidate&&(e.invalidate=!0);!1!==e.disableControl&&(e.disableControl=!0);this.__menu={owner:t,p:e.player,c:e.player&&e.player.controller,attr:e,isdrawed:!1,box:e.element,rows:null,html:null,closeBtns:null,lastCaller:null};var i,n=this,r=this.__menu;if(r.box){if((r.rows=l.query(r.box,".mpv-view-rows"))&&(i=l.query(r.rows,".mpv-view-item"))){r.html=i.outerHTML;l.remove(i)}(r.closeBtns=l.queryAll(r.box,".mpv-view-close-btn"))&&l.on(r.closeBtns,"click",function(t){n.closeMenu()});l.on(r.box,"click",function(t){return l.igEventAll(t)})}this.closeMenu();this.__menu.p.addMenu(this)}t.prototype={constructor:t,patchOverwrite:function(){var t=this.__menu.owner;for(var e in this)"constructor"!==e&&(t[e]=this[e])},isOpenMenu:function(){var t=this.__menu;return!(!t.html||l.hasClass(t.box,a))},patchMenuClassName:function(t){function e(t,e,i){if(t)for(var n=0;n<t.length;n++){var r=t[n];if(r){(r.constructor==s||r.all&&r.bottom&&r.extend)&&(r=r.all);l.addClass(r,e);l.removeClass(r,i)}}}var i=this.__menu,n=i.attr;if(t){e(n.button,o,u);e(n.friend,o,u);l.addClass(i.box,o);l.removeClass(i.box,u);l.removeClass(i.box,a)}else{e(n.button,u,o);e(n.friend,u,o);l.addClass(i.box,a);l.addClass(i.box,u);l.removeClass(i.box,o)}if(n.disableControl){var r=i.p&&i.p.module("layout");r&&r.disableHide(this,!!t)}},cleanMenu:function(){var t=this.__menu;t.isdrawed=!1;t.rows&&(t.rows.innerText="")},closeMenu:e.closeMenu,openMenu:function(s){function a(t,e){var i=l.element(t.html),n=e.module;t.owner.drawMenu&&t.owner.drawMenu(i,e,s);n&&n.isSubMenu&&n.isSubMenu()&&l.addClass(i,"mpv-view-submenu");t.rows.appendChild(i)}var t,e,i=!1,n=!1;if(s&&s.caller&&(t=s.caller.attr)&&(e=t.menu)){if(l.b.isMobile){var r=e.closeThisOnOpenMenuChildOfMobile;!0!==r&&!1!==r||!(i=!0)===r&&(n=!0)}!0!==i&&!1===e.closeThisOnOpenMenuChild&&(n=!0)}n||this.p.closeAllMenu(!0);if(function o(){var t,e=this.__menu;if(e.isdrawed)return!0;if(!e.html||!e.owner)return!1;if(!((t=e.owner.getMenuList?e.owner.getMenuList():null)&&t.length||e.attr.enableNoData))return!1;t||(t=[]);e.rows.innerText="";for(var i=0;i<t.length;i++)a.call(this,e,t[i]);var n=l.getBoundingClientRect(e.c.resourceElement),r=l.getBoundingClientRect(e.box);n.left>=r.left&&l.addClass(e.box,"mpv-overflow-left");r.right>=n.right&&l.addClass(e.box,"mpv-overflow-right");s&&s.caller&&(e.lastCaller=s.caller);return!0}.call(this)){this.__openMenu&&this.__openMenu();this.patchMenuClassName(!0)}},toggleMenu:e.toggleMenu,closeChildMenu:e.closeChildMenu};return t})}();!function(){"use strict";var s=getDframework();s.module("imgtech.media.Media");s.define("imgtech.media.extends.Confirm",function(){function t(t){this.callback=null;this.element=null;if(t){var e=this;this.attr=t;this.player=t.player;this.callback=t.callback?t.callback:null;if(!this.player)return s.error("Not found player for confirm module !!!");if(t.html){this.html=t.html;this.element=s.element(this.html)}else if(this.player.____confirmHtml___){this.html=this.player.____confirmHtml___;this.element=s.element(this.html)}else if(this.element=s.query(this.player.userElement,".mpv-confirm-layer")){s.removeClass(this.element,"mpv-hide");this.html=this.element.outerHTML;s.remove(this.element);this.player.____confirmHtml___=this.html}else{this.html="<div class='mpv-confirm-layer'>\n    <div class='mpv-confirm-cell'>\n        <div class='mpv-confirm-box'>\n            <div class='mpv-confirm-text'>\n            </div>\n            <div class='mpv-confirm-bottom'>\n                <div class='button cancel'>Cancel</div>\n                <div class='button ok'>OK</div>\n            </div>\n        </div>\n    </div>\n</div>\n";this.element=s.element(this.html)}if(!s.isElement(this.element))throw new Error("Not create element.");(this.cancelBtn=s.query(this.element,".cancel"))||s.error("Not found confirm cancel button.");(this.okBtn=s.query(this.element,".ok"))||s.error("Not found confirm ok button.");(this.textElement=s.query(this.element,".mpv-confirm-text"))||s.error("Not found confirm ok button.");s.on(this.element,"click",function(t){return s.igEventAll(t)});s.on(this.element,"dblclick",function(t){return s.igEventAll(t)});s.on(this.cancelBtn,"click",function(t){e.callback&&e.callback(!1);e.hide();return s.igEventAll(t)});s.on(this.okBtn,"click",function(t){e.callback&&e.callback(!0);e.hide();return s.igEventAll(t)})}}t.prototype={constructor:t,getHTML:function(){return this.html},show:function(t,e,i){if(arguments.length<3){i=e;e=!1}var n=this.player,r=this.attr.dest?this.attr.dest:n.controller.resourceElement;t&&(e?this.textElement.innerHTML=t:this.textElement.innerText=t);i&&(this.callback=i);s.append(r,this.element)},hide:function(){s.remove(this.element);this.textElement.innerText=""}};return t})}();!function(){"use strict";var a=getDframework();a.module("imgtech.media.Media");a.define("imgtech.media.extends.Alert",function(){function t(t){this.callback=null;this.element=null;if(t){var e=this;this.attr=t;this.player=t.player;this.callback=t.callback?t.callback:null;if(!this.player)return a.error("Not found player for alert module !!!");if(t.html){this.html=t.html;this.element=a.element(this.html)}else if(this.player.____alertHtml___){this.html=this.player.____alertHtml___;this.element=a.element(this.html)}else if(this.element=a.query(this.player.userElement,".mpv-alert-layer")){a.removeClass(this.element,"mpv-hide");this.html=this.element.outerHTML;a.remove(this.element);this.player.____alertHtml___=this.html}else{this.html="<div class='mpv-alert-layer'>\n    <div class='mpv-alert-cell'>\n        <div class='mpv-alert-box'>\n            <div class='mpv-alert-text'>\n            </div>\n            <div class='mpv-alert-bottom'>\n                <div class='button ok'>OK</div>\n            </div>\n        </div>\n    </div>\n</div>\n";this.element=a.element(this.html)}if(!a.isElement(this.element))throw new Error("Not create element.");this.bottomLayer=a.query(this.element,".mpv-alert-bottom");this.okBtn=a.queryAll(this.element,".ok");this.attr.addClass&&a.addClass(this.element,this.attr.addClass);if(!(this.textElement=a.query(this.element,".mpv-alert-text")))throw new Error("Not found ok button.");a.on(this.element,"click",function(t){return a.igEventAll(t)});a.on(this.element,"dblclick",function(t){return a.igEventAll(t)});this.okBtn&&a.on(this.okBtn,"click",function(t){e.callback&&e.callback(!0);e.hide();return a.igEventAll(t)})}}t.prototype={constructor:t,getHTML:function(){return this.html},show:function(t,e){var i=this.player,n=this.attr.dest?this.attr.dest:i.controller.resourceElement,r=this,s=a.guid();e||(e={});t&&(e.isHtml?this.textElement.innerHTML=t:this.textElement.innerText=t);e.callback&&(this.callback=e.callback);!0===(this.userAttribute=e).autohide&&(e.autohide=3);e.autohide&&setTimeout(function(){if(r.isShow&&r.guid===s){r.callback&&r.callback(null);r.hide()}},1e3*e.autohide);a.append(n,this.element);this.isShow=!0;this.guid=s},hide:function(){a.remove(this.element);this.textElement.innerText="";this.isShow=!1;this.userAttribute=null;this.guid=null}};return t})}();!function(){"use strict";var e=getDframework();e.module("imgtech.media.Media");e.define("imgtech.media.extends.LibProgress",function(){function t(t){this.parent=t;this.attr=t.attr.timestamp;this.attr||(this.attr={});this.attr.spaceSize||0===this.attr.spaceSize||(this.attr.spaceSize=2);this.rootUi=null;this.totalUi=null;this.bufferUi=null;this.overUi=null;this.currentUi=null;this.prefixUi=null;this.timestamps=null;this.tsData=null;this.duration=0;this.startPixel=null;this.endSeconds=null;this.endPixel=null;this.width=null}t.prototype={constructor:t,setUi:function(t){this.rootUi=t.root;this.totalUi=t.total;this.bufferUi=t.buffer;this.overUi=t.over;this.currentUi=t.current;this.prefixUi=t.prefix;this.prefixUi&&(this.attr.prefixPixel?this.prefixUi.style.width=this.attr.prefixPixel+"px":this.prefixUi.style.display="none");this.tsData=t.timestamp},setTimeStamps:function(t){this.timestamps=t},rect:function(){return this.totalUi?e.getBoundingClientRect(this.totalUi):null},isInRect:function(t){var e=t.clientX,i=t.clientY,n=this.rect();return!!(n&&n.top<=i&&i<=n.bottom&&n.left<=e&&e<=n.right)},timeToPixel:function(t,e,i){var n=i||this.rect();return!!n&&(e?Math.floor(n.width()*(t/e)):0)},durationChange:function(t){this.duration=t;this.drawTimeStamps()},drawTimeStamps:function(){var t=this.attr;if(this.timestamps&&this.timestamps.length)for(var e=this.timestamps.length,i=e-1,n=0;n<e;n++){var r=this.duration,s=this.timestamps[n],a=n<i?this.timestamps[n+1]:null,o=this.timeToPixel(s.tsData.seconds,r),u=a?a.tsData.seconds:r,l=this.timeToPixel(u,r);0<n&&(o+=t.spaceSize);s.startPixel=o;s.endSeconds=u;s.totalSeconds=u-s.tsData.seconds;s.endPixel=l;s.width=l-o;s.rootUi&&(s.rootUi.style.left=o+"px");s.rootUi&&(s.rootUi.style.width=s.width+"px")}},updateTimeStampUi:function(t,e){for(var i=!0,n=0;n<this.timestamps.length;n++){var r=this.timestamps[n];if(r[t])if(i)if(r.endSeconds<=e)r[t].style.width=r.width+"px";else{var s=e-r.tsData.seconds,a=Math.floor(r.width*(s/r.totalSeconds));r[t].style.width=a+"px";i=!1}else r[t].style.width="0px"}},updateBufferUi:function(t){var e,i=this.rect();if(i&&this.bufferUi){e=i.width()*t;this.bufferUi.style.width=e+"px"}e&&this.timestamps&&this.timestamps.length&&this.updateTimeStampUi("bufferUi",this.duration*t);return{rect:i}},updateOverUi:function(t,e){var i=this.rect(),n=this.timeToPixel(t,e,i);if(!1!==n){this.overUi.style.width=n+"px";this.timestamps&&this.timestamps.length&&this.updateTimeStampUi("overUi",t)}},updateCurrentUi:function(t,e){var i=this.rect(),n=this.timeToPixel(t,e,i);if(!1!==n){this.currentUi.style.width=n+"px";this.timestamps&&this.timestamps.length&&this.updateTimeStampUi("currentUi",t)}return{rect:i}}};return t})}();!function(t){"use strict";var p=window.getDframework();p.define("imgtech.media.Media",function(){function l(){}l.prototype={constructor:l};l.version=(l.majorVersion=3)+"."+(l.minorVersion=1)+"."+(l.updateVersion=48)+"."+(l.uniqueVersion=578);l.filename="mediaplayer.min.js";l.NAMESPACE="mediaplayer";l.D_INSTALLED=!1;l.D_SYNC_INTERVAL=null;l.S_VOLUME="ZONEMEDIA_VOL";l.S_MUTED="ZONEMEDIA_MUTE";l.DEFAULT_VOLUME=50;l.MIN_VOLUME=5;l.D_READIED=!1;l.D_MEDIA_GUID_PREFIX=(l.D_MEDIA_GUID_NM="ZONEMEDIA_GUID")+"_";l.D_MEDIA_GUID_ATTR=l.D_MEDIA_GUID_NM;l.D_DEFAULT_CONTROLLER="imgtech.media.Controller";l.D_VIDEO_CONTROLLER="imgtech.media.VideoController";l.D_MEDIA_LIST=[];l.EVENT={STATE_CHANGE:1,RATE_CHANGE:2,QUALITY_CHANGE:3,DURATION_CHANGE:4,CURRENT_TIME_CHANGE:5,BUFFERING_CHANGE:7,VOLUME_CHANGE:8,SIZE_CHANGE:9,RESIZE_WINDOW:10,FULLSCREEN_CHANGE:11,VIDEO_SIZE_DATA:12,RESET:13,ON_SYNC:101,ON_READY:102,ON_BEFORE_PLAY:103,ON_BEFORE_DEVICE_PLAY:104,ON_BEFORE_ONCE_PLAY:105,PLAY_MEDIA:108,PAUSE_MEDIA:109,STOP_MEDIA:110,PREVIOUS_MEDIA:111,NEXT_MEDIA:112,CURRENT_MEDIA:113,MUTE_MEDIA:114,SET_VOLUME:115,SEEKTO_MEDIA:116,SET_PLAYBACK_RATE:117,SET_PLAYBACK_QUALITY:118,SET_PLAYBACK_SUBTITLE:119,SET_SIZE:120,SET_RATE:121,SET_FULLSCREEN:122,EXIT_FULLSCREEN:123,CAN_PLAY:124,WAITTING:125,INDEX_MEDIA:126,CONTINUE_TIME:129,ON_ERROR:133,WIDE_CHANGE:134,OPENLAYER_CHANGE:135,ORIENTATION_CHANGE:136,SEEKTO_CONTINUE_TIME:137,SUBTITLE_EVENT:204,CLICK_EVENT:205,CONTROL_EVENT:206,SELECT_AD:215,SELECTING_AD:216,SELECTED_AD:217,SELECT_VAST:218,SELECTING_VAST:219,SELECTED_VAST:220};l.STATE={UNSTARTED:-1,SETSOURCE:1,CUED:2,PLAYING:3,BUFFERING:4,PAUSED:5,ENDED:6,NONE:7,SYSTEM_ENDED:8};l.getTypeName=function(t){var e=l.EVENT;switch(t){case e.STATE_CHANGE:return"STATE_CHANGE";case e.RATE_CHANGE:return"RATE_CHANGE";case e.QUALITY_CHANGE:return"QUALITY_CHANGE";case e.DURATION_CHANGE:return"DURATION_CHANGE";case e.CURRENT_TIME_CHANGE:return"CURRENT_TIME_CHANGE";case e.BUFFERING_CHANGE:return"BUFFERING_CHANGE";case e.VOLUME_CHANGE:return"VOLUME_CHANGE";case e.SIZE_CHANGE:return"SIZE_CHANGE";case e.RESIZE_WINDOW:return"RESIZE_WINDOW";case e.FULLSCREEN_CHANGE:return"FULLSCREEN_CHANGE";case e.VIDEO_SIZE_DATA:return"VIDEO_SIZE_DATA";case e.RESET:return"RESET";case e.ON_SYNC:return"ON_SYNC";case e.ON_READY:return"ON_READY";case e.ON_BEFORE_PLAY:return"ON_BEFORE_PLAY";case e.ON_BEFORE_DEVICE_PLAY:return"ON_BEFORE_DEVICE_PLAY";case e.ON_BEFORE_ONCE_PLAY:return"ON_BEFORE_ONCE_PLAY";case e.PLAY_MEDIA:return"PLAY_MEDIA";case e.PAUSE_MEDIA:return"PAUSE_MEDIA";case e.STOP_MEDIA:return"STOP_MEDIA";case e.PREVIOUS_MEDIA:return"PREVIOUS_MEDIA";case e.NEXT_MEDIA:return"NEXT_MEDIA";case e.CURRENT_MEDIA:return"CURRENT_MEDIA";case e.MUTE_MEDIA:return"MUTE_MEDIA";case e.SET_VOLUME:return"SET_VOLUME";case e.SEEKTO_MEDIA:return"SEEKTO_MEDIA";case e.SET_PLAYBACK_RATE:return"SET_PLAYBACK_RATE";case e.SET_PLAYBACK_QUALITY:return"SET_PLAYBACK_QUALITY";case e.SET_PLAYBACK_SUBTITLE:return"SET_PLAYBACK_SUBTITLE";case e.SET_SIZE:return"SET_SIZE";case e.SET_RATE:return"SET_RATE";case e.SET_FULLSCREEN:return"SET_FULLSCREEN";case e.EXIT_FULLSCREEN:return"EXIT_FULLSCREEN";case e.CAN_PLAY:return"CAN_PLAY";case e.WAITTING:return"WAITTING";case e.WIDE_CHANGE:return"WIDE_CHANGE";case e.OPENLAYER_CHANGE:return"OPENLAYER_CHANGE";case e.ORIENTATION_CHANGE:return"ORIENTATION_CHANGE";case e.SEEKTO_CONTINUE_TIME:return"SEEKTO_CONTINUE_TIME";case e.SUBTITLE_EVENT:return"SUBTITLE_EVENT";case e.CLICK_EVENT:return"CLICK_EVENT";case e.CONTROL_EVENT:return"CONTROL_EVENT";case e.INDEX_MEDIA:return"INDEX_MEDIA";case e.CONTINUE_TIME:return"CONTINUE_TIME";case e.ON_ERROR:return"ON_ERROR";case e.SELECT_AD:return"SELECT_AD";case e.SELECTING_AD:return"SELECTING_AD";case e.SELECTED_AD:return"SELECTED_AD";case e.SELECT_VAST:return"SELECT_VAST";case e.SELECTING_VAST:return"SELECTING_VAST";case e.SELECTED_VAST:return"SELECTED_VAST"}return t};l.queryAll=function(){var t=p.queryAll.apply(this,arguments);return t&&0===t.length?null:t};l.getStateName=function(t){var e=l.STATE;switch(t){case e.UNSTARTED:return"\uc2dc\uc791\ub418\uc9c0 \uc54a\uc74c";case e.SETSOURCE:return"\ubbf8\ub514\uc5b4 \uc18c\uc2a4 \uc785\ub825";case e.CUED:return"\uc7ac\uc0dd\uc900\ube44 \uc644\ub8cc\ub428";case e.PLAYING:return"\uc7ac\uc0dd \uc911";case e.PAUSED:return"\uc77c\uc2dc\uc911\uc9c0 \ub428";case e.BUFFERING:return"\ubc84\ud37c\ub9c1 \uc911";case e.ENDED:return"\uc885\ub8cc\ub428";case e.SYSTEM_ENDED:return"\uc885\ub8cc\uc911...";default:return"\uc608\uc678"}};l.ERROR={NOT_SOURCE_OBJECT:20001,NOT_FOUND_USED_DEVICE:20002,NOT_FOUND_USED_DEVICE_CLASSNAME:20003,EXIST_USED_DEVICE:20004,EXIST_ACTIVE_SOURCE:20005,EXIST_ACTIVE_SOURCE_TIMER:20006,NOT_FOUND_PLAYER_CLASSNAME:20007,NOT_FOUND_CONTROLLER_MOD:20009,NEED_REPEAT_MOD_FOR_REPMARK:20010,NEED_IS_PSEUDO:20011,NOT_SUPPORT_FLASH_ON_MOBILE:26001,NOT_SUPPORT_YOUTUBE_BROWSER:26002,NOT_SUPPORT_VIDEO_IE8:26003,NOT_FOUND_SOURCE:30001,NOT_FOUND_SOURCE_INDEX:30002,USAGE_SWITCH_SOURCE_QUALITY:30003,USAGE_SWITCH_SOURCE_SRC:30004,NOT_ROTATE_PREVIOUS_MEDIA:40001,NOT_ROTATE_NEXT_MEDIA:40002};l.ERROR_TYPE={LIB:1,DEV:2,USR:3};l.getErrorInfo=function(i){var t;if(!(t=function n(){var t=l.ERROR,e=l.ERROR_TYPE;switch(i){case t.NOT_SOURCE_OBJECT:return{type:e.LIB,code:null,name:"NOT_SOURCE_OBJECT",message:"\uc785\ub825\ub41c \uc18c\uc2a4\uac00 \ud30c\uc2f1\ub41c \uc624\ube0c\uc81d\ud2b8\uac00 \uc544\ub2d9\ub2c8\ub2e4.",fatal:!0};case t.NOT_FOUND_USED_DEVICE:return{type:e.LIB,code:null,name:"NOT_FOUND_USED_DEVICE",message:"\uc0ac\uc6a9\ub41c \ub514\ubc14\uc774\uc2a4 \ubaa9\ub85d\uc5d0 null \uac12\uc744 \ucd94\uac00\ud558\ub824 \ud569\ub2c8\ub2e4.",fatal:!0};case t.NOT_FOUND_USED_DEVICE_CLASSNAME:return{type:e.LIB,code:null,name:"NOT_FOUND_USED_DEVICE_CLASSNAME",message:"\uc0ac\uc6a9\ub41c \ub514\ubc14\uc774\uc2a4 \uc815\ubcf4\uc5d0 \ud074\ub798\uc2a4 \ub124\uc784\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.",fatal:!0};case t.EXIST_USED_DEVICE:return{type:e.LIB,code:null,name:"EXIST_USED_DEVICE",message:"\uc774\ubbf8 \ub4f1\ub85d\ub41c \uc0ac\uc6a9\ub41c \ub514\ubc14\uc774\uc2a4 \uc815\ubcf4 \uc785\ub2c8\ub2e4.",fatal:!0};case t.EXIST_ACTIVE_SOURCE:return{type:e.LIB,code:null,name:"EXIST_ACTIVE_SOURCE",message:"\uc785\ub825 \ucc98\ub9ac \uc911\uc778 \uc18c\uc2a4\uac00 \uc874\uc7ac \ud569\ub2c8\ub2e4.",fatal:!0};case t.EXIST_ACTIVE_SOURCE_TIMER:return{type:e.LIB,code:null,name:"EXIST_ACTIVE_SOURCE_TIMER",message:"\uc785\ub825 \ucc98\ub9ac \uc911\uc778 \uc18c\uc2a4\uc758 \ud0c0\uc774\uba38\uac00 \uc874\uc7ac \ud569\ub2c8\ub2e4.",fatal:!0};case t.NOT_FOUND_PLAYER_CLASSNAME:return{type:e.LIB,code:null,name:"NOT_FOUND_PLAYER_CLASSNAME",message:"{className} \ud50c\ub808\uc774\uc5b4 \ubaa8\ub4c8\uc744 \ucc3e\uc9c0 \ubabb\ud558\uc600\uc2b5\ub2c8\ub2e4.",fatal:!0};case t.NOT_FOUND_CONTROLLER_MOD:return{type:e.LIB,code:null,name:"NOT_FOUND_CONTROLLER_MOD",message:"\ucee8\ud2b8\ub864\ub7ec \ubaa8\ub4c8\uc744 \ucc3e\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4.",fatal:!0};case t.NEED_REPEAT_MOD_FOR_REPMARK:return{type:e.DEV,code:null,name:"NEED_REPEAT_MOD_FOR_REPMARK",message:"\uad6c\uac04\ubc18\ubcf5 \ubd81\ub9c8\ud06c\ub97c \uc704\ud574 repeat \ubaa8\ub4c8\uc774 \ud544\uc694 \ud569\ub2c8\ub2e4.",fatal:!0};case t.NEED_IS_PSEUDO:return{type:e.DEV,code:null,name:"NEED_IS_PSEUDO",message:"\ud50c\ub808\uc26c \ubaa8\ub4dc \uc0ac\uc6a9\uc2dc isPseudo \uc635\uc158\uc744 \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.",fatal:!1};case t.NOT_SUPPORT_FLASH_ON_MOBILE:return{type:e.LIB,code:null,name:"NOT_SUPPORT_FLASH_ON_MOBILE",message:"\ubaa8\ubc14\uc77c\uc5d0\uc11c\ub294 Flash \ud50c\ub808\uc774\uc5b4\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",fatal:!0};case t.NOT_SUPPORT_YOUTUBE_BROWSER:return{type:e.LIB,code:null,name:"NOT_SUPPORT_YOUTUBE_BROWSER",message:"\uc0ac\uc6a9\uc911\uc778 \ube0c\ub77c\uc6b0\uc800\uac00 \uc720\ud29c\ube0c\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\n\ud06c\ub86c \ud639\uc740 \ucd5c\uc2e0 \ubc84\uc804\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc8fc\uc138\uc694.",fatal:!0};case t.NOT_SUPPORT_VIDEO_IE8:return{type:e.LIB,code:null,name:"NOT_SUPPORT_VIDEO_IE8",message:"IE7, IE8 \ube0c\ub77c\uc6b0\uc800\ub294 Flash\ub97c \uc774\uc6a9\ud558\uc5ec \uc7ac\uc0dd\ud574\uc57c \ud569\ub2c8\ub2e4.",fatal:!0};case t.NOT_FOUND_SOURCE:return{type:e.DEV,code:null,name:"NOT_FOUND_SOURCE",message:"\uc18c\uc2a4 \ubaa9\ub85d\uc774 \uc874\uc7ac \ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",fatal:!0};case t.NOT_FOUND_SOURCE_INDEX:return{type:e.DEV,code:null,name:"NOT_FOUND_SOURCE_INDEX",message:"\uc18c\uc2a4 \ubaa9\ub85d\uc758 \ubc94\uc704\ub97c \ubc97\uc5b4\ub09c \ubbf8\ub514\uc5b4\ub97c \uc7ac\uc0dd \ud558\ub824 \ud569\ub2c8\ub2e4.\nindex: {index}, size: {size}",fatal:!0};case t.USAGE_SWITCH_SOURCE_QUALITY:return{type:e.DEV,code:null,name:"USAGE_SWITCH_SOURCE_QUALITY",message:"SwitchSource \uc0ac\uc6a9\uc2dc quality \uc124\uc815\uc774 \uc798\ubabb \uc9c0\uc815 \ub418\uc5c8\uc2b5\ub2c8\ub2e4.",fatal:!0};case t.USAGE_SWITCH_SOURCE_SRC:return{type:e.DEV,code:null,name:"USAGE_SWITCH_SOURCE_SRC",message:"SwitchSource \uc0ac\uc6a9\uc2dc src \uc124\uc815\uc774 \ub418\uc5c8\uc2b5\ub2c8\ub2e4.",fatal:!0};case t.NOT_ROTATE_PREVIOUS_MEDIA:return{type:e.USR,code:null,name:"NOT_ROTATE_PREVIOUS_MEDIA",message:"\uccab\ubc88\uc9f8 \uc601\uc0c1\uc73c\ub85c \uc774\uc804 \uc601\uc0c1\uc744 \uc7ac\uc0dd \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",fatal:!1};case t.NOT_ROTATE_NEXT_MEDIA:return{type:e.USR,code:null,name:"NOT_ROTATE_NEXT_MEDIA",message:"\ub9c8\uc9c0\ub9c9 \uc601\uc0c1\uc73c\ub85c \ub2e4\uc74c \uc601\uc0c1\uc744 \uc7ac\uc0dd \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",fatal:!1}}return null}()))return null;t.code=i;return t};l.CN={NORMAL_SCREEN:"mpv-normal-screen",FULL_SCREEN:"mpv-fullscreen",WIDE_SCREEN:"mpv-wide-screen",LIVE_SCREEN:"mpv-live-screen",DVR_SCREEN:"mpv-dvr-screen",LOCK_SCREEN:"mpv-lock-screen",EXTEND_SCREEN:"mpv-extend-screen",TOUCH_SCREEN:"mpv-touch-screen",NOTOUCH_SCREEN:"mpv-notouch-screen",INSTALL_FLASH_SCREEN:"mpv-install-flash-screen",OPENLAYER_SCREEN:"mpv-openlayer-screen",OPENLAYER_NONE_SCREEN:"mpv-openlayer-none-screen",OPENLAYER_FULLSCREEN_SCREEN:"mpv-openlayer-fullscreen-screen",OPENLAYER_ROOT_SCREEN:"mpv-openlayer-root-screen",STATE_PLAYING:"mpv-state-playing",STATE_PAUSED:"mpv-state-paused",PREVIEW_SCREEN:"mpv-preview-screen",INTRO_SCREEN:"mpv-intro-screen",AD_SCREEN:"mpv-ad-screen",VAST_SCREEN:"mpv-vast-screen",RADIO_SCREEN:"mpv-radio-screen",RADIO_HIDE_SCREEN:"mpv-radio-hide-screen",CHAT_SCREEN:"mpv-chat-screen",ROTATE_SCREEN:"mpv-rotate-screen",ROTATE_SCREEN1:"mpv-rotate-screen1",ROTATE_SCREEN2:"mpv-rotate-screen2",ROTATE_SCREEN3:"mpv-rotate-screen3",TIMESTAMP_SCREEN:"mpv-ts-screen"};l.secondsToString=function(t){if(!t||window.Infinity&&t===Infinity)return"00:00";var e=Math.floor(t/3600),i=Math.floor(t%3600),n=Math.floor(i/60),r=i%60;r<10&&(r="0"+r);n<10&&(n="0"+n);return e?e+":"+n+":"+r:n+":"+r};l.getDocument=function(t){return t.contentDocument||t.contentWindow.document};l.updateStyle=function(t,e){t.__style||(t.__style={});for(var i in e)t.__style[i]=e[i];return t};l.getSavedVolume=function(){var t=document.cookie.match("(^|;) ?"+l.S_VOLUME+"=([^;]*)(;|$)");return t?parseFloat(t[2]):l.DEFAULT_VOLUME};l.setSavedVolume=function(t){document.cookie=l.S_VOLUME+"="+t};l.getSavedMuted=function(t){var e=document.cookie.match("(^|;) ?"+l.S_MUTED+"=([^;]*)(;|$)");return!(!e||"1"!=e[2])};l.setSavedMuted=function(t){document.cookie=l.S_MUTED+"="+(t?"1":"0")};l.getSavedWindowPosition=function(){var t=document.cookie.match("(^|;) ?SWINP=([^;]*)(;|$)");if(t&&t[2]){var e=t[2].split(",");return{x:parseInt(e[0]),y:parseInt(e[1])}}return{x:0,y:0}};l.setSavedWindowPosition=function(t,e){document.cookie="SWINP="+t+","+e};l.getSavedWindowSize=function(){var t=document.cookie.match("(^|;) ?SWINS=([^;]*)(;|$)");if(t&&t[2]){var e=t[2].split(",");return{width:parseInt(e[0]),height:parseInt(e[1])}}return{width:0,height:0}};l.setSavedWindowSize=function(t,e){document.cookie="SWINS="+t+","+e};l.getStyleNumberValue=function(t,e){var i,n=e||"px";switch(typeof t){case"number":case"integer":case"float":case"double":return t+n;case"string":return(i=new RegExp("^([0-9]+)","i").exec(t))?t.substring(i[1].length)?t:i[1]+n:t}};l.GetAutoHeight=function(t){this.module("layout");var e=this.getVideoSize(),i=t||this.userElement,n=p.getBoundingClientRect(i).width();return e&&e.height&&n?n*e.height/e.width:0};var h=null,c=null,d=null,f=null;l.currentWindowPosition=function(){return p.b.ie&&p.b.ie<=9?{x:window.screenLeft,y:window.screenTop}:{x:window.screenX,y:window.screenY}};l.currentWindowSize=function(){if(p.b.ie&&p.b.ie<=8){var t=p.getBoundingClientRect(document.body),e=t&&t.widht(),i=t&&t.height();return{width:e||1024,height:i||720}}return{width:window.innerWidth,height:window.innerHeight}};l.monitorSize=function(){return window.screen?{width:window.screen.width,height:window.screen.height}:{width:1980,height:1024}};var t="";l.windowName=function(){t||(t="ZONEPLAYER_"+p.guid());return t};l.resetWindowSize=function(){if(!(p.b.ie&&p.b.ie<9)){h=window.innerWidth;c=window.innerHeight;d=window.outerWidth;f=window.outerHeight}};l.onPlayerSync=function(){!function(){if(!(p.b.ie&&p.b.ie<=8)){var t=window.innerWidth,e=window.innerHeight,i=window.outerWidth,n=window.outerHeight,r=h,s=c,a=d,o=f;try{if(r!==t||s!==e||a!==i||o!==n){l.resetWindowSize();l.onPlayerResizeWindow({type:"virtual-resize"})}}catch(u){p.error(u)}}}();var t,e;for(t=0;t<l.D_MEDIA_LIST.length;t++){e=l.D_MEDIA_LIST[t];try{e.isReady()&&e.onSync()}catch(i){p.error(i)}}};var r=!(l.onPlayerResizeWindow=function(t){var e,i,n={type:l.EVENT.RESIZE_WINDOW,data:t,target:t.target};for(e=0;e<l.D_MEDIA_LIST.length;e++)try{(i=l.D_MEDIA_LIST[e]).isReady()&&i.callStateChange(n)}catch(r){p.error(r)}});l.autoPopup=function(){function e(){var t=l.currentWindowPosition(),e=l.currentWindowSize();l.setSavedWindowPosition(t.x,t.y);l.setSavedWindowSize(e.width,e.height)}if(!r){r=!0;var t=l.getSavedWindowPosition(),i=l.getSavedWindowSize();!t.x&&0!==t.x||!t.y&&0!==t.y||window.moveTo(t.x,t.y);i.width&&i.height&&window.resizeTo(i.width,i.height);p.b.firefox?p.on(window,"unload",function(t){e()}):p.on(window,"beforeunload",function(t){e();p.b.ie||p.b.chrome&&t.preventDefault()});!function n(){e();setTimeout(function(){n()},500)}()}};l.install=function(t){if(!l.D_INSTALLED){l.D_INSTALLED=!0;t||(t={});var e=t.syncTimeout?t.syncTimeout:400;clearInterval(l.D_SYNC_INTERVAL);l.D_SYNC_INTERVAL=setInterval(l.onPlayerSync,e);p.on(window,"resize",function(t){l.onPlayerResizeWindow(t)})}};l.getRateValue=function(t){switch(typeof t){case"string":case"number":case"integer":case"float":case"double":return{value:t};case"object":if("number"!=typeof t.value)throw new Error("rate value is not number.");return t}},l.parseResource=function(t,e){if(!t)throw new Error("Not found player attributes.");t.namespace||(t.namespace=l.NAMESPACE);if(!t.resource&&!1!==t.resource){if("string"!=typeof t.skin)throw new Error("Not found skin attribute.");var i=t.namespace;e=e||"html";t.resource=e+"://"+i+"/skin/"+t.skin+"/"+t.skin+".html#mediaplayer"}return t.resource};l.getResourceText=function(t,e){l.parseResource(t,"text");p.require(t.resource,function(t){e&&e(null,t)},function(t){e&&e(t,null)})};l.getProgrameableHtml=function(o,t){l.getResourceText(t,function(t,e){if(t)return p.error(t);var i=p.isElement(o)?o:p.query(o);if(i){var n,r,s=e.split("\n"),a='function getHtmlResource() {\n    return ""\n';for(n=0;n<s.length;n++)a+='    + "'+(r=(r=(r=s[n])?r.replace(/\"/gi,"'"):"").replace(/\n|\r/g,""))+'"\n';a+='    + "";\n}';i.style.border="solid 1px green";i.innerText=a;p.log("--- start html text");p.log(a);p.log("--- end html text")}})};l.secondsToTimeString=function(t,e){function i(t){return t?t<9?"0"+t:t:"00"}var n=t%60,r=Math.floor(t/60),s=Math.floor(r/60);r%=60;var a="";s&&(a+=i(s)+"\uc2dc ");r?a+=i(r)+"\ubd84 ":a&&(a+="00\ubd84 ");return a+=n?e?i(n.toFixed(e))+"\ucd08":i(Math.floor(n))+"\ucd08":"00\ucd08"};l.timeStringToseconds=function(t){var e,i=0,n=0,r=0;if(e=/^[\s]*([0-9]+)[\s]*:[\s]*([0-9]+)[\s]*:[\s]*([0-9]+)[\s]*$/.exec(t)){i=parseInt(e[1],10);n=parseInt(e[2],10);r=parseInt(e[3],10)}else{if(!(e=/^[\s]*([0-9]+)[\s]*:[\s]*([0-9]+)[\s]*$/.exec(t)))return null;n=parseInt(e[1],10);r=parseInt(e[2],10)}return 3600*i+60*n+r};!function(){if(p.b.ie&&p.b.ie<9&&window.Element){var n=window.Element.prototype.attachEvent,s=window.Element.prototype.detachEvent;Element.prototype.attachEvent=function(){this.__zonemediaplayer_listener||(this.__zonemediaplayer_listener={});var t=arguments[0],e=arguments[1],i=this.__zonemediaplayer_listener;i[t]||(i[t]=[]);i[t].push(e);n.apply(this,arguments)};Element.prototype.detachEvent=function(){if(this.__zonemediaplayer_listener){var t=this.__zonemediaplayer_listener,e=arguments[0],i=arguments[1],n=t[e];if(n)for(var r=0;r<n.length;r++)if(n[r]===i){n.splice(r,1);break}}s.apply(this,arguments)}}}();l.callElementEvent=function(t,e,i){var n,r=document;if(p.b.ie&&p.b.ie<9){var s=t["on"+e];m=s?/[\s]*(javascript[\s]*:[\s]*|[\s]*)([a-zA-Z0-9\_]+)/i.exec(s):null;if(m){var a=m[2];try{if(!window[a])throw new Error("Not found "+a+" function.");window[a].call(t,i)}catch(c){p.error(c)}}var o=t.__zonemediaplayer_listener,u=o?o["on"+e]:null;if(u)for(var l=0;l<u.length;l++)try{u[l].call(t,i)}catch(c){p.error(c)}}else{if(r.createEvent)(n=r.createEvent("Event")).initEvent(e,!0,!0);else{if(!r.createEventObject)throw new Error("Not found create event function.");n=r.createEventObject()}for(var h in i)h&&i[h]&&("type"==h?n["__"+h]=i[h]:n[h]=i[h]);if(t.dispatchEvent)t.dispatchEvent(n);else{if(!t.fireEvent)throw new Error("Not found dispatch event function.");t.fireEvent("on"+e,n)}}};l.createMediaPlayer=function(t,e,i){if(!e)throw new TypeError("Not found attribute parameter");e.device="imgtech.media.MediaPlayer";return new(p.module("imgtech.media.Player"))(t,e,i)};l.createPlayer=function(t,e,i){return l.createMediaPlayer(t,e,i)};p.log(" ## IMGTech zonemediaplayer version: "+l.version);return l});p.ready(function(){setTimeout(function(){var t=p.module("imgtech.media.Media");t.D_READIED=!0;t.D_INSTALLED||t.install()},1)})}(window);!function(){"use strict";var r=window.getDframework();r.define("imgtech.media.ControllerInterface",function(){function t(){}t.prototype={constructor:t,draw:function(t){throw new Error("draw is abstract method.")},onAddEvent:function(t,e){throw new Error("onAddEvent is abstract method.")},onStateChange:function(t){throw new Error("onStateChange is abstract method.")}};return t});r.define("imgtech.media.ModuleInterface",function(){function t(t,e,i){if(t){this.p=t;this.c=e;this.attr=i;this.__withMod=[];this.__ownerMod=[];this.__actionMods=[];this.__lastOwnerMod=null}}t.prototype={construct:t,onAddEvent:function(){},onStateChange:function(t){},getModuleObject:function(t){return this.c.m?this.c.m[t]:null},_autoUseInnerText:function(t,e){if(t){var i=!!t&&t.getAttribute("useinnertext"),n=typeof e;e||!0===i||"true"==i||(t.innerText="");"string"!=n||!0!==i&&"true"!=i||(t.innerText=e)}},addActionModule:function(t){for(var e=this.__actionMods,i=e.length-1;0<=i;i--)if(e[i]===t)return;this.__actionMods.push(t)},removeActionModule:function(t){for(var e=this.__actionMods,i=e.length-1;0<=i;i--)e[i]===t&&e.splice(i,1)},callActionModule:function(t){var e;for(e=0;e<this.__actionMods.length;e++){var i=this.__actionMods[e];try{i.actionChange&&i.actionChange(t)}catch(n){r.error(n)}}},addOwnerModule:function(t){var e,i=this.__ownerMod;for(e=0;e<i.length;e++)if(i[e]===t)return;i.push(t)},removeOwnerModule:function(t){var e,i=this.__ownerMod;for(e=i.length-1;0<=e;e--)if(i[e]===t)return i.splice(e,1)},invalidateOwner:function(){var t,e,i=this.__ownerMod;for(t=i.length-1;0<=t;t--)(e=i[t]).invalidate&&e.invalidate()},addWithModule:function(t){var e,i=this.__withMod;for(e=0;e<i.length;e++)if(i[e]===t)return;i.push(t)},removeWithModule:function(t){var e,i=this.__withMod;for(e=i.length-1;0<=e;e--)if(i[e]===t)return i.splice(e,1)}};return t})}();!function(){var u=getDframework();u.define("imgtech.media.EventManager",function(){var o=u.module("imgtech.media.Media");function t(t,e){if(t){this.p=t;this.attr=e;this.playing=!1;this.is_destory=!1;this.appMod=null}}t.prototype={constructor:t,destroy:function(){this.is_destory=!0},push:function(t){if(!this.is_destory){if(!t)return u.error("Not found event data.");if("object"!=typeof t)return u.error("event is not object.");if(!t.type)return u.error("Not found event type.");var e,i,n=this.p;try{e=n.device()}catch(r){if(t.type==o.EVENT.ON_SYNC)return;return u.error(r,o.getTypeName(t.type),t)}t.source||(t.source=e?e.currentMediaSource():null);t.device||(t.device=e&&e.deviceInstance?e.deviceInstance():null);if(i=(t.player=n).isDisableEvent(t)){n.stateLog(t,"start",length,!0);n.stateLog(t,"end",length,!0);n.error(" ## "+i)}else{n.stateLog(t,"start",length);this.callEvent(t);n.stateLog(t,"end",length)}}},callEvent:function(t){function e(t){var e=this.p;if(u.b.ie){var i=t.description?t.description:t.message,n=typeof i;if("string"==n||"number"==n||"boolean"==n)e.error(" ## exception : "+i);else{e.error(" ## exception : ");for(var r in i)e.error(" ## exception: "+r+": "+i[r])}}else e.error(" ## exception: ",t);u.error(t)}var i=this.p,n=i.userElement,r=o.EVENT,s=o.STATE;null===this.appMod&&((appMod=i.module("app"))?this.appMod=appMod:t.type==i.EVENT.ON_READY&&(this.appMod=!1));switch(t.type){case r.STATE_CHANGE:switch(t.data){case s.ENDED:o.callElementEvent(n,"ended",t);break;case s.PLAYING:o.callElementEvent(n,"play",t);break;case s.PAUSED:o.callElementEvent(n,"pause",t)}break;case r.DURATION_CHANGE:case r.CURRENT_TIME_CHANGE:o.callElementEvent(n,"timeupdate",t);break;case r.BUFFERING_CHANGE:o.callElementEvent(n,"progress",t);break;case r.VOLUME_CHANGE:o.callElementEvent(n,"volumechange",t);break;case r.CAN_PLAY:o.callElementEvent(n,"canplay",t);break;case r.WAITTING:t.data?o.callElementEvent(n,"waiting",t):o.callElementEvent(n,"canplay",t)}try{i.controller&&i.controller.onStateChange&&i.controller.onStateChange(t)}catch(a){e.call(this,a)}try{i.attr.event&&i.attr.event.callback&&t.type!==i.EVENT.ON_SYNC&&i.attr.event.callback.apply(i,arguments)}catch(a){e.call(this,a)}t.type!==i.EVENT.ON_SYNC&&appMod&&appMod.stateChange&&appMod.stateChange(t)}};return t})}();!function(){"use strict";var c=getDframework(),e=c.module("imgtech.media.Media");c.define("imgtech.media.source.SMI",function(){function h(t,e,i){if(t&&e){this.p=t;this.attr=i;this.list=[];this.timer=null;this.currentMS=null;this.index=null;this.parse(e)}}h.parseAttribute=function(t){if("string"!=typeof t)throw new TypeError("input parameter is not string.");for(var e,i,n,r,s,a=t,o={};;){if(!(a=a.trim()))break;if(!(e=/^([\S]+)[\s]*([\=]+)/.exec(a))&&!(e=/^([\S]+)/.exec(a)))break;r=e[1];a=a.substring(e[0].length);if(e[2])if(i=(e=/[\s]*([\'\"]*)/.exec(a))[1])if(-1===(n=(a=a.substring(e[0].length)).indexOf(i))){s=a;a=""}else{s=a.substring(0,n);a=a.substring(n+1)}else if(e=/[\s]*([\S]+)/.exec(a)){s=e[1];a=a.substring(e[0].length)}else{s=!0;a=""}else s=!0;o[r.toLowerCase()]=s}return o};h.prototype={constructor:h,parse:function(t){var e=t.split(/<sync /gi);if(e.length<2)throw new Error("Not found sync node");var i,n,r,s=e[0].split("\n").length-1,a=e[e.length-1],o=[];if((n=/(<\/body)/i.exec(a))&&-1!==(i=a.indexOf(n[1]))){e[e.length-1]=a.substring(0,i);a=a.substring(i)}for(var u=1;u<e.length;u++)if(-1!==(i=(r=e[u]).indexOf(">"))){var l={start:0,className:null,attr:h.parseAttribute(r.substring(0,i)),contents:r.substring(i+1)};if(l.attr&&l.attr.start){l.start=parseInt(l.attr.start);l.className=l.attr.className?l.attr.className:null;o.push(l)}else c.error("SMI parse error:: Not found start attribute. lineno: "+s+"\n    "+r)}else c.error("SMI parse error:: Not found '>'. lineno: "+s+"\n    "+r);if(!o.length)throw new Error("Not found sync element after parse !!!");this.list=o},data:function(){return null!==this.index?this.list[this.index]:null},searchMS:function(t){var e=this.list.length;if(e){return function s(t,e,i){var n=e+Math.floor((i-e)/2),r=this.list[n];if(t<r.start){if(n!==i)return s.call(this,t,e,n)}else if(t>r.start&&n!==e)return s.call(this,t,n,i);return n}.call(this,t,0,e)}return null},stop:function(){if(this.timer){var t=this.attr;clearInterval(this.timer);this.timer=null;this.p.log(" ## SMI (stop) : "+(t&&t.source))}this.index=null;this.isPlaying=!1},play:function(){if(!this.isPlaying){var t=this,e=this.attr;this.stop();this.isPlaying=!0;this.p.log(" ## SMI (play) : "+(e&&e.source));this.timer=setInterval(function(){t.running(!1)},10)}},sendHide:function(){if(!this.isHide){this.isHide=!0;this.p.callStateChange({type:e.EVENT.SUBTITLE_EVENT,data:"hide",subtitle:this})}},sendShow:function(t){this.isHide=!1;this.p.callStateChange({type:e.EVENT.SUBTITLE_EVENT,data:"show",subtitle:this,subdata:t})},running:function(t){var e=this.p;if(t||e.isPlaying()){var i,n,r=Math.floor(1e3*e.currentTime(!0));if(!(this.currentMS=r)&&0!==r)return this.sendHide();if(null===(n=this.searchMS(r)))return this.sendHide();if(!((i=this.list[n]).start>r))if(n!==this.index){this.index=n;i.start<=r&&this.sendShow(i)}else t&&this.sendShow(i)}}};return h})}();!function(){"use strict";var l=getDframework(),o=l.module("imgtech.media.Media");l.define("imgtech.media.source.SRTParser",function(){function t(){}var u=t.status={INIT:0,NUMBER:1,STRING:2,APPEND:3,END:4},a=t.error={ZERO:0,NOT_INIT:1,ORDER_TIME:2,NOT_APPEND:3};t.prototype={constructor:t,type:"SRT",stringToNumber:function(t,e){var i;if(!(i=/^[\s]*([0-9]+)[\s]*$/.exec(t)))throw new Error("Wrong subtitle format ("+this.type+"). line: "+e+"\n    "+t);return parseInt(i[1])},repaireNumber:function(t,e){if(t.status===u.STRING){t.status=u.APPEND;t.contents.push(e.value)}else{if(t.status!==u.INIT)return a.NOT_INIT;t.status=u.NUMBER;t.number=e.value}return a.ZERO},repaireTime:function(t,e){if(t.status!==u.NUMBER&&t.status!==u.INIT)return a.ORDER_TIME;t.status=u.STRING;t.start=e.start;t.end=e.end;return a.ZERO},repaireString:function(t,e){if(t.status===u.STRING||t.status===u.APPEND){t.status=u.APPEND;t.contents.push(e.value)}return a.ZERO},repaireEnd:function(t,e){if(t.status===u.INIT);else{if(t.status!==u.APPEND)return a.NOT_APPEND;t.status=u.END}return a.ZERO},parseTime:function(t,e){var i;if(!(i=/^[\s]*([0-9\s\:]+)[\,\.]+[\s]*([0-9]+)[\s]*$/i.exec(t)))throw new Error("Wrong subtitle format ("+this.type+"). line: "+e+"\n    "+t);var n={seconds:0,micro:0,_hour:0,_min:0,_sec:0,_msec:parseInt(i[2])},r=i[1].split(":");if(!r.length||3<r.length)throw new Error("Wrong subtitle format ("+this.type+"). line: "+e+"\n    "+t);0<r.length&&(n._sec=this.stringToNumber(r[r.length-1],e));1<r.length&&(n._min=this.stringToNumber(r[r.length-2],e));2<r.length&&(n._hour=this.stringToNumber(r[r.length-3],e));n.seconds=3600*n._hour+60*n._min+n._sec;n.micro=1e3*n.seconds+n._msec;return n},execNumber:function(t,e){var i;return(i=/^[\s]*([0-9]+)[\s]*$/i.exec(t))?{type:"number",value:parseInt(i[1])}:null},execTime:function(t,e){var i;if(i=/^[\s]*([0-9\:\,\.\s]+)[\s]*([\-]*\>)[\s]*([0-9\:\,\.\s]+)/.exec(t)){var n=i[1],r=(i[2],i[3]);return{type:"time",start:this.parseTime(n,e),end:this.parseTime(r,e)}}return null},execString:function(t,e){return t?{type:"string",value:t}:null},execEnd:function(t,e){return{type:"end"}},parseType:function(t,e){var i,n=t?t.trim():"";return(i=this.execTime(n,e))?i:(i=this.execNumber(n,e))?i:(i=this.execString(n,e))?i:this.execEnd(n,e)},parseLine:function(t,e,i,n,r){var s=0;switch(i.type){case"number":s=this.repaireNumber(e,i);break;case"time":s=this.repaireTime(e,i);break;case"string":s=this.repaireString(e,i);break;case"end":(s=this.repaireEnd(e,i))===a.ZERO&&e.status==u.END&&t.push(e);e={status:u.INIT,contents:[]}}if(s){l.error("Subtitle content parse("+this.type+") error("+s+"). line: "+r+"\n    "+n);e={status:u.INIT,contents:[]}}return e},parse:function(t){var e,i,n,r,s=t.split("\n"),a=[],o={status:u.INIT,contents:[]};for(e=0;e<s.length;e++){n=s[e];i=this.parseType(n,e+1);r=o;if(!(o=this.parseLine(a,o,i,n,e+1))){l.warn("parse ("+this.type+") ignore: ",r);o={status:u.INIT,contents:[]}}}a.length&&a[a.length-1]!==o&&o.status!==u.INIT&&a.push(o);return a}};return t});l.define("imgtech.media.source.SRT",function(){function t(t,e,i){if(t&&e){this.p=t;this.attr=i;this.list=[];this.timer=null;this.currentMS=null;this.index=null;this.indexData=null;this.parse(e)}}t.prototype={constructor:t,type:"SRT",parse:function(t){var e=new(l.module("imgtech.media.source.SRTParser"));this.list=e.parse(t)},data:function(){return null!==this.index?this.list[this.index]:null},searchMS:function(t){var e=this.list.length;if(e){return function s(t,e,i){var n=e+Math.floor((i-e)/2),r=this.list[n];if(t<r.start.micro){if(n!==i)return s.call(this,t,e,n)}else if(t>r.start.micro&&n!==e)return s.call(this,t,n,i);return n}.call(this,t,0,e)}return null},stop:function(){if(this.timer){var t=this.attr;this.p.log(" ## stop Subtitle : "+t&&t.source);clearInterval(this.timer);this.timer=null;this.p.log(" ## "+this.type+"(stop)")}this.isPlaying=!1},play:function(){if(!this.isPlaying){var t=this;this.stop();this.isPlaying=!0;this.p.log(" ## "+this.type+"(play)");this.timer=setInterval(function(){t.running(!1)},10)}},running:function(t){function e(){if(!this.isHide){this.isHide=!0;this.p.callStateChange({type:o.EVENT.SUBTITLE_EVENT,data:"hide",subtitle:this})}}var i=this.p;if(t||i.isPlaying()){var n,r=Math.floor(1e3*i.currentTime(!0)),s=this.indexData;if(!(this.currentMS=r)&&0!==r)return e.call(this);if(!(s&&s.start.micro<=r&&s.end.micro>r)){if(!(n=this.searchMS(r)))return e.call(this);if(n!==this.index){s=this.list[n];this.index=n;return(this.indexData=s).end.micro<=r||r<s.start.micro?e.call(this):function a(t){this.isHide=!1;this.p.callStateChange({type:o.EVENT.SUBTITLE_EVENT,data:"show",subtitle:this,subdata:t})}.call(this,s)}if(s.end.micro<=r)return e.call(this);this.index=null;this.indexData=null}}}};return t})}();!function(){"use strict";var r=getDframework(),n=(r.module("imgtech.media.Media"),r.module("imgtech.media.source.SRT"));r.define("imgtech.media.source.SimpleVTTParser",function(){var t=r.module("imgtech.media.source.SRTParser");function s(){t.apply(this,arguments);this.style=[]}var e=t.status,a={NOTE:100,STYLE:101},i=t.error;for(var n in e)n&&(a[n]=e[n]);r.extendClass(s,t,{type:"SimpleVTT",execTime:function(t,e){var i;(i=/^[\s]*([0-9\:\,\.\s]+)[\s]*([\-]*\>)[\s]*([0-9\:\,\.\s]+)$/.exec(t))||(i=/^[\s]*([0-9\:\,\.\s]+)[\s]*([\-]*\>)[\s]*([0-9\:\,\.\s]+)[\s]+([\s\S]+)$/.exec(t));if(i){var n=i[1],r=(i[2],i[3]),s=4<i.length?i[4]:null;return{type:"time",start:this.parseTime(n,e),end:this.parseTime(r,e),css:s}}return null},execNumber:function(t){var e;(e=/^[\s]*([0-9]+)[\s]*$/i.exec(t))||(e=/^[\s]*([0-9]+)[\s]+([\s\S]+)$/i.exec(t));return e?{type:"number",value:parseInt(e[1]),text:2<e.length?e[2]:null}:null},execString:function(t,e){if(!t)return null;var i=t.toLowerCase();return 0===i.indexOf("note")?{type:"note",value:t.substring(4).trim()}:0===i.indexOf("style")?{type:"style",value:t.substring(5).trim()}:{type:"string",value:t}},repaireNote:function(t,e){t.oldstatus=t.status;t.status=a.NOTE;t.note=[];t.note.push(e.value)},repaireStyle:function(t,e){t.status=a.STYLE;t.style=[];e.value&&t.style.push(e.value)},repaireString:function(t,e){switch(t.status){case a.NOTE:t.note.push(e.value);return i.ZERO;case a.STYLE:e.value&&t.style.push(e.value);return i.ZERO}return s.__super.repaireString.apply(this,arguments)},parseLine:function(t,e,i,n,r){switch(i.type){case"note":this.repaireNote(e,i);return e;case"style":this.repaireStyle(e,i);return e;case"end":if(e.status==a.NOTE){delete e.contents;return null}if(e.status!=a.STYLE)break;delete e.contents;this.style.push(e);return null}return s.__super.parseLine.apply(this,arguments)}});return s});r.define("imgtech.media.source.SimpleVTT",function(){function t(t,e,i){n.apply(this,arguments)}r.extendClass(t,n,{type:"SimpleVTT",parse:function(t){var e=new(r.module("imgtech.media.source.SimpleVTTParser"));this.list=e.parse(t)}});return t})}();!function(){"use strict";var e=getDframework();e.module("imgtech.media.Media");e.define("imgtech.media.source.MozillaVTT",function(){function t(t,e,i){if(t&&e){this.parser=null;this.cues=[];this.regions=[];this.parse(e)}}t.prototype={constructor:t,oncue:function(t){this.cues.push(t)},onregion:function(t){this.regions.push(t)},onparsingerror:function(t){e.error(t)},parse:function(t){var e=this;this.parser=new WebVTT.Parser(window,WebVTT.StringDecoder());this.parser.oncue=function(t){e.oncue(t)};this.parser.onregion=function(t){e.onregion(t)};this.parser.onparsingerror=function(t){e.onparsingerror(t)};this.parser.parse(t);this.parser.flush();WebVTT.convertCueToDOMTree(window,this.cues[0].text),WebVTT.processCues(window,this.cues,document.getElementById("overlay"))},stop:function(){},play:function(){}};return t})}();!function(){"use strict";var l=getDframework(),h=l.module("imgtech.media.Media");l.define("imgtech.media.source.Subtitle",function(){function s(t,e,i){if(e&&i){this.source=t;this.p=e;this.list=[];this.selected=null;this.index=0;this.parse(i)}}s.sourceType=function(t){var e,i=-1!==(e=t.lastIndexOf("?"))?t.substring(0,e).trim():t.trim(),n=i&&-1!==(e=i.lastIndexOf("."))?i.substring(e+1).trim().toLowerCase():null;if(!i)throw new TypeError("Not found subtitle source");switch(n){case"smi":case"srt":case"vtt":return n;case"vtml":return null}return null};s.className=function(t){switch(t){case"smi":return"imgtech.media.source.SMI";case"srt":return"imgtech.media.source.SRT";case"vtt":return"imgtech.media.source.SimpleVTT"}return null};s.prototype={constructor:s,parse:function(t){if(!l.isArray(t))throw new Error("subtitle is not array.",t);if(!t.length)throw new Error("subtitle is empty",t);for(var e=0;e<t.length;e++)t[e]&&this.push(t[e]);this.index=null!==this.selected?this.selected:0},push:function(t){var e,i=this.list.length;if(t){if(!1!==t.code&&(!t.code||"string"!=typeof t.code))throw new Error("Not found subtitle or Not string.");if(!1!==t.code&&(!t.src||"string"!=typeof t.src))throw new Error("Not found subtitle src or Not string.");if(t.label&&"string"!=typeof t.label)throw new Error("Subtitle label is not string.");!1!==t.code||t.label||(t.label="None");(e=!(!t.select&&!t.selected))&&(this.selected=i);var n=!1===t.code?null:s.sourceType(t.src),r=!1===t.code?null:t.type?t.type:n;this.list.push({code:t.code,source:t.src,sourceType:n,userType:t.type,type:r,className:s.className(r),parser:t.parser,decoding:t.decoding,index:i,selected:e,label:t.label?t.label:t.code})}},setSubtitle:function(t){t||(t=this.index);switch(typeof t){case"number":case"integer":if(!(0<=t&&t<this.list.length))throw new Error("Not setting subtitle : max: "+this.list.length+", want: "+t);this.index=t;break;case"object":var e=!t.index&&0===t.index||0<t.index?t.index:-1;-1<e&&e<this.list.length&&(this.index=e)}try{this.loadSubtitle()}catch(i){l.error("Not load subtitle !!!");l.error(i)}},get:function(t){return 0===t||t?this.list[t]:this.list[this.index]},loadSubtitle:function(t){var o=this.get(t),u=this;if(!1===o.code)return this.p.callStateChange({type:h.EVENT.SUBTITLE_EVENT,data:"loaded",subtitle:o.instance});if(!o.source)throw new Error("Not load subtitle. because empty subtitle source");if(o.instance)return this.p.callStateChange({type:h.EVENT.SUBTITLE_EVENT,data:"loaded",subtitle:o.instance});var e=this.p.module("subtitle"),i=e?e.attr:null,n=i?i.ajax:null,r=n||{},s=r.headers?r.headers:null;this.source.currentSourceInfo();if(r&&r.contentType){s||(r.headers=s={});s.ContentType&&l.warn(o.source+" request content type rewrite!");s.ContentType=r.contentType}l.require("text://"+o.source,function(t){!function a(t){var e,i;u.p.log(" ## load subtitle source: "+o.source);if(!t)throw new Error("Empty : "+o.source);if(!(e=o.decoding?o.decoding(t):t))throw new Error("Empty decoding: "+o.source);if(o.parser&&"string"!=typeof o.parser)i=o.parser(e);else{var n=o.parser?o.parser:o.className?o.className:"",r=n?l.module(n):null,s=r?new r(u.p,e,o):null;if(!n)throw new Error("Not found subtitle parser className");if(!r)throw new Error("Not found subtitle parser module");if(!s)throw new Error("Not found subtitle parser instance");i=s}i&&(o.instance=i);u.p.log(" ## loaded subtitle instance: "+o.source);u.p.callStateChange({type:h.EVENT.SUBTITLE_EVENT,data:"loaded",subtitle:o.instance});setTimeout(function(){i&&i.running&&i.running(!0)},1)}(t)},function(t){l.error("Failed subtitle ajax: "+o.source);l.error(arguments)},r)},stop:function(){var t,e;for(t=0;t<this.list.length;t++)(e=this.list[t])&&e.instance&&e.instance.stop()},play:function(t){var e=this.get(t),i=e&&e.instance;this.stop();i&&i.play()}};return s})}();!function(){"use strict";var u=getDframework();u.define("imgtech.media.source.SourceInfo",function(){var i=null;function t(t,e){this.source=null;this.attr={};if(t){this.source=t;this.attr=e||{};this.deviceType=null;this.mediaType=null;this.className=null;this.isRTMP=!1;this.parse(t)}}t.prototype={constructor:t,parse:function(t){var e=this.attr.playerType,i=this.getDeviceType(t);this.orginDeviceType=i.ptype;e&&"string"==typeof e&&(i.ptype=e);"flash2"===i.ptype&&(i.ptype="flash");"flash"===i.ptype&&(this.attr.flashType?i.ptype=this.attr.flashType:i.ptype="flash2");this.mediaType=i.type;this.deviceType=i.ptype;this.className=this.getDeviceClassName(this.deviceType);this.path=i.path;this.query=i.query;this.isRTMP=!!i.isRTMP;this.isHLS="hls"===i.type;i.src&&(this.source=i.src)},isKnVersion:function(t){if(null!==i)return i;try{new Audio;i=!1}catch(e){return i=!0}},getDeviceM3U8Type:function(t){return u.b.ie&&(u.b.ie<11||this.isKnVersion()||u.b.ie<=11&&u.b.osAlias&&parseInt(u.b.osAlias)<=7)?{ptype:"flash",type:"hls"}:u.b.isMobile&&-1!=navigator.userAgent.indexOf("Whale/")?{ptype:"video",type:"hls"}:u.b.safari||u.b.ios||u.b.iphone||u.b.ipad||u.b.ipod?{ptype:"video",type:"hls"}:{ptype:"hls",type:"hls"}},getDeviceClassName:function(t){var e;if(this.attr.alwaysDeviceType&&this.attr.deviceClassName&&(e=this.attr.deviceClassName(t)))return e;switch(t){case"video":return"imgtech.media.VideoPlayer";case"hls":return"imgtech.media.HlsPlayer";case"flash":return"imgtech.media.FlashPlayer";case"flash2":return"imgtech.media.FlashPlayer2";case"youtube":return"imgtech.media.Youtube";case"stream":return"imgtech.media.StreamPlayer";case"self":return"imgtech.media.SelfPlayer";case"dash":return"imgtech.media.DashPlayer";case"recorder":return"imgtech.recorder.Recorder";default:if(this.attr.deviceClassName&&(e=this.attr.deviceClassName(t)))return e;throw new TypeError("Not found device class name: "+t)}},getDeviceType:function(t){var e,i,n,r="",s="";if("string"!=typeof t)throw new Error("source is not string.");if(!(e=t.trim()))throw new Error("source is empty.");if(-1!==(i=(e=e.toLowerCase()).lastIndexOf("?"))){r=e.substring(i+1);if(!(e=e.substring(0,i))||!(e=e.trim()))throw new Error("source is empty.");-1!==(i=e.lastIndexOf("/"))&&(s=e.substring(0,i))}if("recorder"===e||0===e.indexOf("recorder://"))return{ptype:"recorder",type:"recorder",path:s,query:r};var a=-1!==(i=e.lastIndexOf("."))?e.substring(i+1):"";if(this.attr.alwaysDeviceType&&this.attr.deviceType&&(n=this.attr.deviceType({isrc:t,type:a,path:s,query:r,src:e})))return n;if(0===e.indexOf("http://")||0===e.indexOf("https://")){if(-1===(i=e.lastIndexOf(".m3u8")))return-1!==(i=e.lastIndexOf(".mpd"))?{ptype:"dash",type:"mpd",path:s,query:r}:u.b.ie&&(u.b.ie<9||this.isKnVersion(t))?{ptype:"flash",type:a,path:s,query:r}:{ptype:"video",type:a,path:s,query:r};var o=this.getDeviceM3U8Type(t);o.path=s;o.query=r;return o}if(0===e.indexOf("rtmp://"))return{ptype:"flash",type:"rtmp",isRTMP:!0,path:s,query:r};if(0===e.indexOf("udp://"))return{ptype:"flash",type:"rtmp",isRTMP:!0,path:s,query:r};if(0===e.indexOf("rtsp://")){if(u.b.android)return{ptype:"video",type:"rtsp",path:s,query:r};throw new Error("Not support source type: rtsp")}if(0===e.indexOf("yt://")||0===e.indexOf("youtube://"))return{ptype:"youtube",type:"youtube",path:s,query:r};if(0===e.indexOf("player://"))return{ptype:"self",type:"self",path:s,query:r};if(0===e.indexOf("stream://")||0===e.indexOf("streams://")){0===(i=e.indexOf("stream://"))?e="http://"+t.substring(i+"stream://".length):0===(i=e.indexOf("streams://"))&&(e="https://"+t.substring(i+"streams://".length));return{ptype:"stream",type:a,path:s,query:r,src:e}}if(this.attr.deviceType&&(n=this.attr.deviceType({isrc:t,type:a,path:s,query:r,src:e})))return n;throw new Error("Not support source type: unknown")}};return t})}();!function(){"use strict";var i=getDframework();i.define("imgtech.media.source.Quality",function(){var r=i.module("imgtech.media.source.SourceInfo");function t(t,e){if(t&&e){this.p=t;this.list=[];this.selected=null;this.currentIndex=this.index=0;this.parse(e)}}t.prototype={constructor:t,parse:function(t){if(!i.isArray(t))throw new Error("quality is not array.",t);if(!t.length)throw new Error("quality is empty",t);for(var e=0;e<t.length;e++)t[e]&&this.push(t[e]);this.index=null!==this.selected?this.selected:0},push:function(t){var e,i=this.list.length;if(t){if(!t.code||"string"!=typeof t.code)throw new Error("Not found quality code or Not string.");if(!t.src||"string"!=typeof t.src)throw new Error("Not found quality src or Not string.");if(t.label&&"string"!=typeof t.label)throw new Error("Quality label is not string.");(e=!(!t.select&&!t.selected))&&(this.selected=i);var n=new r(t.src,this.p.attr);this.list.push({code:t.code,sourceInfo:n,source:n.source,index:i,selected:e,label:t.label?t.label:t.code})}},setQuality:function(t){var e,i=this.index;switch(typeof t){case"number":case"integer":if(!(0<=t&&t<this.list.length))throw new Error("Not setting quality : max: "+this.list.length+", want: "+t);e=t;break;case"object":var n=!t.index&&0===t.index||0<t.index?t.index:-1;-1<n&&n<this.list.length&&(e=n)}if(e!==i){var r=this;this.index=e;setTimeout(function(){r.p.current({data:{currentTime:r.p.currentTime(),isPlaying:r.p.isPlaying()}})},1)}},current:function(){return this.get(this.currentIndex)},get:function(t){this.currentIndex=0===t||t?t:this.index;return this.list[this.currentIndex]},sourceInfo:function(t){return this.get(t).sourceInfo},source:function(t){return this.sourceInfo(t).source},isRTMP:function(t){return this.sourceInfo(t).isRTMP},isHLS:function(t){return this.sourceInfo(t).isHLS},className:function(t){return this.sourceInfo(t).className},deviceType:function(t){return this.sourceInfo(t).deviceType}};return t})}();!function(){"use strict";var u=getDframework();u.define("imgtech.media.Source",function(){var s=u.module("imgtech.media.source.Quality"),a=u.module("imgtech.media.source.Subtitle"),o=u.module("imgtech.media.source.SourceInfo");function t(t,e){if(t){this.p=e;this.input=t;this.sourceInfo=null;this.__isHLS=!1;this.quality=null;this.subtitle=null;this.switchSource=null;this.parse(t)}}t.prototype={constructor:t,autoplay:function(){var t;return!0===this.input.autoplay||!1!==this.input.autoplay&&((t=this.p.module("autoplay"))&&t.attr.use?t.getAutoPlay():!1!==this.p.attr.autoplay)},hasAD:function(){return!!this.ad},isAD:function(){return!!this.__isAD&&this.__isAD},hasVAST:function(){return!!this.vast},isVAST:function(){return!!this.__isVAST&&this.__isVAST},isSwitchSource:function(){return!!this.switchSource},isRTMP:function(t){return this.quality?this.quality.isRTMP(t):!!this.sourceInfo&&this.sourceInfo.isRTMP},isHLS:function(t){return this.quality?this.quality.isHLS(t):!!this.sourceInfo&&this.sourceInfo.isHLS},className:function(t){return this.quality?this.quality.className(t):this.sourceInfo?this.sourceInfo.className:null},source:function(t){return this.quality?this.quality.source(t):this.sourceInfo?this.sourceInfo.source:null},currentSourceInfo:function(){if(this.quality){var t=this.quality.current();return t?t.sourceInfo:null}return this.sourceInfo?this.sourceInfo:null},deviceType:function(t){return this.quality?this.quality.deviceType(t):this.sourceInfo?this.sourceInfo.deviceType:null},parse:function(t){if(!t)throw new TypeError("Empty source.");var e;if(t.ad){var i=u.module("imgtech.media.source.AD");this.ad=new i(this.p,t,this)}if(t.vast){var n=u.module("imgtech.media.source.VAST");this.vast=new n(this.p,t,this)}if(t.quality){this.quality=new s(this.p,t.quality);t.src&&("string"==typeof t.src?u.warn("Ignore input's src. because use quality. src: "+t.src):u.warn("Ignore input's src. because use quality. src: ",t.src))}else{if("string"==typeof t){if(!(e=t.trim()))throw new Error("Empty source.")}else{if(t.switchSource){var r=u.module("imgtech.media.source.SwitchSource");this.switchSource=new r(t,this.p);return}if(!t.src)throw new Error("Not found input's src.");if("string"!=typeof t.src)throw new Error("Input's src is not string.");if(!(e=t.src.trim()))throw new Error("Empty source.")}this.sourceInfo=new o(e,this.p.attr)}t.drm&&(this.drm=t.drm);t.subtitle&&(this.subtitle=new a(this,this.p,t.subtitle))},getQualityList:function(){return this.quality?this.quality.list:null},getQuality:function(t){return this.quality?this.quality.get(t):null},setQuality:function(t){this.quality&&this.quality.setQuality(t)},getSubtitleList:function(){return this.subtitle?this.subtitle.list:null},getSubtitle:function(t){if(this.subtitle)return this.subtitle.get(t)},setSubtitle:function(t){if(this.subtitle)return this.subtitle.setSubtitle(t)},stop:function(){if(this.subtitle)return this.subtitle.stop()},play:function(){if(this.subtitle)return this.subtitle.play()},setAutoContinueTime:function(t){this.input.autoContinueTime=t},setErrorContinueTime:function(t,e){this.errorContinueTime=t;this.errorIsPlaying=e}};return t})}();!function(){"use strict";var r=getDframework();r.define("imgtech.media.source.SwitchSource",function(){function t(t,e){if(t){this.input=t;this.p=e;this.modName=null;this.ss=[];this.selected=-1;this.parse(t)}}t.prototype={constructor:t,selectedSource:function(){if(this.selected<0)throw new Error("Not select switch source");if(this.selected>=this.ss.length)throw new Error("Overflow selected switch source");return this.ss[this.selected]},select:function(t){},isRTMP:function(t){return this.selectedSource().isRTMP(t)},className:function(t){return this.selectedSource().className(t)},source:function(t){return this.selectedSource().source(t)},currentSourceInfo:function(){return this.selectedSource().currentSourceInfo()},deviceType:function(t){return this.selectedSource().deviceType()},parse:function(t){var e,i,n=r.module("imgtech.media.Source");this.modName=t.switchModule?t.switchModule:"imgtech.media.module.SwitchSource";if("string"!=typeof this.modName)throw new Error("switch module name is empty !!!");if(!r.module(this.modName))throw new Error("Not found switch module. module: "+this.modName);if(!t.switchSource)throw new TypeError("Not found switchSource !!!",t);if(!r.isArray(t.switchSource))throw new TypeError("switchSource is array !!!",t);if(!t.switchSource.length)throw new TypeError("switchSource is empty !!!",t);for(e=0;e<t.switchSource.length;e++){if("object"!=typeof(i=t.switchSource[e]))throw new TypeError("switchSource element is not object !!!",t);if("string"!=typeof i.playerName||!i.playerName)throw new TypeError("switchSource element playerName is not string or empty playerName!!!",t);if("string"!=typeof i.src||!i.src)throw new TypeError("switchSource element src is not string or empty src!!!",t);this.ss.push(new n(i,this.p))}if(!this.ss.length)throw new TypeError("switchSource is empty !!!",t)},getQualityList:function(){return this.selectedSource().getQualityList()},getQuality:function(t){return this.selectedSource().getQuality(t)},setQuality:function(t){return this.selectedSource().setQuality(t)},getSubtitleList:function(){return this.selectedSource().getSubtitleList()},getSubtitle:function(t){return this.selectedSource().getSubtitle(t)},setSubtitle:function(t){return this.selectedSource().setSubtitle(t)},stop:function(){return this.selectedSource().stop()},play:function(){return this.selectedSource().play()}};return t})}();!function(){"use strict";var a=getDframework();a.define("imgtech.media.source.AD",function(){function t(t,e,i){if(t&&e){this.p=t;this.parse(e,i)}}t.createADSource=function(t,e){var i=new(a.module("imgtech.media.Source"))(t,e);i.__isAD=!0;return i};t.prototype={constructor:t,parse:function(t,e){function i(t){if(!t)return null;for(var e=[],i=a.isArray(t)?t:[t],n=0;n<i.length;n++){var r=new s(i[n],this.p);r.__isAD=!0;e.push(r)}return e.length?e:null}if(!(this.origin=t))throw new Error("Not found source");if(!(this.data=t.ad))throw new Error("Not found ad in source");var n=this.p.attr.module&&this.p.attr.module.ad,r=this.data,s=a.module("imgtech.media.Source");this.modName=n&&n.className;if("string"!=typeof this.modName)throw new Error("ad module name is empty !!!");if(!a.module(this.modName))throw new Error("Not found ad module. module: "+this.modName);r.start=i.call(this,r.start);r.middle=i.call(this,r.middle);r.end=i.call(this,r.end);r.origin=r.origin?new s(r.origin,this.p):e;r.origin.__isAD=!1}};return t})}();!function(){"use strict";var s=getDframework();s.define("imgtech.media.source.VAST",function(){function t(t,e,i){if(t&&e){this.p=t;this.parse(e,i)}}t.createSource=function(t,e,i){var n=new(s.module("imgtech.media.Source"))(t,e);n.__isVAST=i;return n};t.prototype={constructor:t,parse:function(t,e){function i(t){if(!t)return{size:0,used:0};t.size||(t.size=0);t.used||(t.used=0);return t}if(!(this.origin=t))throw new Error("Not found source");if(!(this.data=t.vast))throw new Error("Not found vast in source");var n=this.p.attr.module&&this.p.attr.module.vast,r=this.data;this.modName=n&&n.className;if("string"!=typeof this.modName)throw new Error("vast module name is empty !!!");if(!s.module(this.modName))throw new Error("Not found vast module. module: "+this.modName);r.start=i.call(this,r.start);r.middle=i.call(this,r.middle);r.end=i.call(this,r.end);r.origin=e;r.origin.__isVAST=!1;r.detailTime||(r.detailTime=0)}};return t})}();!function(){"use strict";var _=getDframework();_.define("imgtech.media.Player",function(){var v=_.module("imgtech.media.Media"),y=_.module("imgtech.media.Source"),n=_.module("imgtech.media.EventManager"),r=_.module("imgtech.media.extends.ElementManager"),o=v.CN,i=v.ERROR;function s(t,e){var i="object"==typeof t,n=i?t:{};n.type=e;!i&&t&&(n.data=t);this.callStateChange(n)}function t(t,e,i){if(t||e){e||(e={});e.debug||(e.debug={});e.module||(e.module={});!e.zIndex&&e.zindex&&(e.zIndex=e.zindex);if(e.element){delete e.element;_.warn("zonemediaplayer's element attribute is ignored !!!")}v.D_INSTALLED||v.install();v.D_MEDIA_LIST.push(this);this.b=_.b;this.isMobile=_.b.isMobile;this.attr=e;this.flag=i;this.uuid=_.guid("");this.guid=v.D_MEDIA_GUID_PREFIX+this.uuid;(window[this.guid]=this).skin=e.skin;this.skinName="skin-"+this.skin;this.ruleName="."+this.skinName+".mpv-runtime";this.watchTimeMods=null;(e.module.watermark&&e.module.watermark.use||e.module.zonechat&&e.module.zonechat.use)&&!e.zIndex&&(e.zIndex=1e3);if(!_.isElement(this.userElement=_.isElement(t)?t:_.query(t)))throw new TypeError("Not found element from qid : "+t);this.userElement.zonemediaplayer=this;_.addClass(this.userElement,this.skinName);_.addClass(this.userElement,"mpv-runtime");_.addClass(this.userElement,"mpv-fixed");e.disableUi&&_.ui.hide(this.userElement);if("string"!=typeof e.device)throw new TypeError("Not found device className");this.patchModule("device",{className:e.device,modType:"device"});this.controller=null;this.playlistIndex=-1;"string"==typeof e.src&&(e.src={src:e.src});this.src=this.createSource(e.src);this.hasAttributeSource=this.src.length;this.debug=e.debug;this.menus=[];this.sizeIndex=0;this.width=_.isArray(e.width)?e.width:e.width||0===e.width?[e.width]:["100%"];this.height=_.isArray(e.height)?e.height:e.height||0===e.height?[e.height]:["100%"];this.__old_size_change_width=-1;this.__old_size_change_height=-1;if(this.width.length!=this.height.length)throw new Error("Not equals width and height array length");this.elementManager=new r(this);this.eventManager=new n(this,this.attr);this.EVENT=v.EVENT;this.STATE=v.STATE;this.isBeforeFirstPlay=!1;this.__showmessagesbox=[];this.attr.autoPopup&&v.autoPopup();this.onDrawPlayer()}}t.prototype={constructor:t,createSource:function(t){function e(t,e,i){try{e instanceof y?t.push(e):t.push(new y(e,i))}catch(n){_.error(n)}}this.lastInputSource=t;var i,n=[];if(_.isArray(t))for(i=0;i<t.length;i++)t[i]&&e(n,t[i],this);else t&&e(n,t,this);return n},onDrawPlayer:function(){var t=this.attr,e=t.controller?t.controller:v.D_DEFAULT_CONTROLLER,i=typeof e,n="string"==i?_.module(e):"function"==i||"object"==i?e:null;this.log(" ## controller - className - "+("string"==i?e:"Function"));var r=n?new n(this):null;if(!(this.controller=r))throw new Error("Not found controller");this.controller.draw();this.log(" ## controller - drawed");try{this.onReady()}catch(s){_.error("onDrawPlayer::",s)}},currentMediaSource:function(){var t=this.device();return t?t.currentMediaSource():null},mediaSource:function(){return this.src},getPlayerType:function(){var t=this.device();return t?t.getPlayerType():null},module:function(t){var e=this.controller,i=e?e.m:null,n=i?i[t]:null;return t?e?i?n||this.warn("Not found "+t+" module"):this.warn("Not found controller module"):this.warn("Not found controller"):i},addWatchTimeModule:function(t){this.watchTimeMods||(this.watchTimeMods=[]);this.watchTimeMods.push(t)},device:function(){return this.module("device")},sizeModule:function(){return this.module("size")},rect:function(){return _.getBoundingClientRect(this.userElement)},isInnerRect:function(t){var e=this.rect();return e.left>=t.x&&t.x<=e.right&&e.top<=t.y&&e.bottom>=t.y},sendSizeChange:function(t){var e=this,i=this.rect(),n=i&&i.width(),r=i&&i.height();if(n||r){var s=!1;n&&this.__old_size_change_width!=n&&(s=!0);r&&this.__old_size_change_height!=r&&(s=!0);if(s){this.__old_size_change_width=n;this.__old_size_change_height=r;this.callStateChange({type:v.EVENT.SIZE_CHANGE,data:{width:n,height:r,index:-1}})}}else t||setTimeout(function(){e.sendSizeChange(!0)},1)},currentIndexSource:function(){return-1==this.playlistIndex?null:this.src&&this.src.length?this.src[this.playlistIndex]:null},getSwitchSourceData:function(){var t=this.currentIndexSource();if(t&&t.switchSource)return t.switchSource},getADData:function(){var t=this.device();return t&&t.getADData?t.getADData():null},getVASTData:function(){var t=this.device();return t&&t.getVASTData?t.getVASTData():null},getPlayerState:function(){var t=this.device();return t&&t.getPlayerState?t.getPlayerState():v.STATE.UNSTARTED},isPlaying:function(){return this.getPlayerState()===v.STATE.PLAYING},play:function(t){this.callStateChange({type:v.EVENT.PLAY_MEDIA,data:t})},pause:function(t){this.callStateChange({type:v.EVENT.PAUSE_MEDIA,data:t})},toggle:function(t){var e=this.isPlaying();return!0===e?this.pause(t):!1===e?this.play(t):void 0},stop:function(t){s.call(this,t,v.EVENT.STOP_MEDIA)},previous:function(t){s.call(this,t,v.EVENT.PREVIOUS_MEDIA)},next:function(t){s.call(this,t,v.EVENT.NEXT_MEDIA)},current:function(t){s.call(this,t,v.EVENT.CURRENT_MEDIA)},index:function(t){if(!this.src||!this.src.length)return this.code(i.NOT_FOUND_SOURCE);if(t===undefined)return this.playlistIndex;if("object"==typeof t){for(var e=0;e<this.src.length;e++)if(this.src[e]===t)return e;return-1}if(t<0||t>=this.src.length)return this.code(i.NOT_FOUND_SOURCE_INDEX,{index:t,size:this.src.length});this.callStateChange({type:v.EVENT.INDEX_MEDIA,data:t})},getVolume:function(){var t=this.device();return t&&t.getVolume?Math.floor(t.getVolume()):0},setVolume:function(t){t<v.MIN_VOLUME&&(t=v.MIN_VOLUME);100<t&&(t=100);if((t=Math.floor(t))<=v.MIN_VOLUME)return this.mute();this.isMuted()&&this.unMute();v.setSavedVolume(t);this.callStateChange({type:v.EVENT.SET_VOLUME,data:t})},mute:function(){v.setSavedMuted(!0);this.callStateChange({type:v.EVENT.MUTE_MEDIA,data:!0})},unMute:function(){v.setSavedMuted(!1);this.callStateChange({type:v.EVENT.MUTE_MEDIA,data:!1})},isMuted:function(){var t=this.device();return t&&t.isMuted?t.isMuted():null},toggleMute:function(){return this.isMuted()?this.unMute():this.mute()},duration:function(t){var e=this.device();return e&&e.duration?e.duration(t):0},currentTime:function(t){var e=this.device();return e&&e.currentTime?e.currentTime(t):0},getBuffering:function(){var t=this.device();return t&&t.getBuffering?t.getBuffering():0},_previousSeekTo:function(t,e){var i=this.watchTimeMods;if(i)for(var n in i)i[n]&&i[n]._previousSeekTo&&i[n]._previousSeekTo(t,e)},seekTo:function(t,e){if(!t&&0!==t||t&&t<0)return _.error("Not seekTo: value: "+t);var i=this.duration();this._previousSeekTo(t,e);i&&i<t&&(t=i);this.callStateChange({type:v.EVENT.SEEKTO_MEDIA,data:{value:t,seconds:e}})},seekToContinueTime:function(t,e){if(!t&&0!==t||t&&t<0)return _.error("Not seekTo: value: "+t);var i=this.duration();this._previousSeekTo(t);i&&i<t&&(t=i);this.callStateChange({type:v.EVENT.SEEKTO_CONTINUE_TIME,data:{value:t,isPlaying:e}})},getVirtualCurrentTime:function(t){var e=this.device();return e?e.virtualCurrentTime(t):t},getVirtualSeekToValue:function(t){var e=this.device();return e?e.virtualSeekToValue(t):t},getDefaultPlaybackRate:function(){var t=this.device();return t&&t.getDefaultPlaybackRate?t.getDefaultPlaybackRate():null},getSafePlaybackRate:function(t){var e,i,n=v.getRateValue(t),r=this.getAvailablePlaybackRates();for(e=0;e<r.length;e++)r[e].value==n.value&&(i=r[e]);return i},getPlaybackRate:function(){var t=this.device();return t&&t.getPlaybackRate?t.getPlaybackRate():null},setPlaybackRate:function(t){this.callStateChange({type:v.EVENT.SET_PLAYBACK_RATE,data:this.getSafePlaybackRate(t)})},getAvailablePlaybackRates:function(){var t=this.device();return t&&t.getAvailablePlaybackRates?t.getAvailablePlaybackRates():null},resetRate:function(){var t=this.getAvailablePlaybackRates();if(t&&t.length)for(var e=0;e<t.length;e++){var i=t[e];if(1==i.value)return this.setPlaybackRate(i)}},nextRate:function(){this.callStateChange({type:v.EVENT.SET_RATE,data:"increment"})},previousRate:function(){this.callStateChange({type:v.EVENT.SET_RATE,data:"decrement"})},getPlaybackQuality:function(t){var e=this.device();return e&&e.getPlaybackQuality?e.getPlaybackQuality(t):null},setPlaybackQuality:function(t){this.callStateChange({type:v.EVENT.SET_PLAYBACK_QUALITY,data:t})},getAvailableQualityLevels:function(){var t=this.device();return t&&t.getAvailableQualityLevels?t.getAvailableQualityLevels():null},getAvailableSubtitles:function(){var t=this.device();return t&&t.getAvailableSubtitles?t.getAvailableSubtitles():null},getPlaybackSubtitle:function(){var t=this.device();return t&&t.getPlaybackSubtitle?t.getPlaybackSubtitle():null},setPlaybackSubtitle:function(t){this.callStateChange({type:v.EVENT.SET_PLAYBACK_SUBTITLE,data:t})},fullscreen:function(t){this.callStateChange({type:v.EVENT.SET_FULLSCREEN,data:t})},exitFullscreen:function(t){this.callStateChange({type:v.EVENT.EXIT_FULLSCREEN,data:t})},toggleFullscreen:function(){this.isFullscreen()?this.exitFullscreen():this.fullscreen()},isFullscreen:function(){return this.sizeMod&&this.sizeMod.isFullscreen()},setSize:function(t,e,i){this.userElement&&this.callStateChange({type:v.EVENT.SET_SIZE,data:{width:t,height:e,index:0===i||i?i:-1}})},setWidth:function(t){this.setSize(t,undefined,-1)},setHeight:function(t){this.setSize(undefined,t,-1)},getVideoSize:function(){var t=this.device();return t&&t.getVideoSize?t.getVideoSize():null},source:function(t,e){this.playlistIndex=0;this.src=this.createSource(t);this.current(e)},reset:function(){this.callStateChange({type:v.EVENT.RESET})},userKey:function(t){this.keyMod&&this.keyMod.userKey(t)},setSphericalProperties:function(t){var e=this.device();return e&&e.setSphericalProperties?e.setSphericalProperties(t):null},getSphericalProperties:function(){var t=this.device();return t&&t.getSphericalProperties?t.getSphericalProperties():null},isSphericalProperties:function(){var t=this.device();return!(!t||!t.isSphericalProperties)&&t.isSphericalProperties()},isVR:function(){return this.isSphericalProperties()},isLive:function(){var t,e=this.attr;return!(!e.isLive&&!e.islive)||(t=this.currentMediaSource())&&t.input&&(t.input.isLive||t.input.islive)},isDVR:function(){var t,e=this.attr;return!(!e.isDVR&&!e.isdvr)||(t=this.currentMediaSource())&&t.input&&(t.input.isDVR||t.input.isdvr)},isDisableEvent:function(t){var e=this.device();return!(!e||!e.isDisableEvent)&&e.isDisableEvent(t)},callStateChange:function(t){this.eventManager&&this.eventManager.push(t)},isReady:function(){return!!this.__isReady},onReady:function(){var t=this;if(!(this.__isReady=!0)!==this.attr.resource){var e=this.sizeIndex;this.setSize(this.width[e],this.height[e],e)}this.olMod=this.module("openLayer");this.sizeMod=this.module("size");this.wideMod=this.module("wide");this.keyMod=this.module("key");setTimeout(function(){t.callStateChange({type:v.EVENT.ON_READY})})},onSync:function(){this.callStateChange({type:v.EVENT.ON_SYNC})},patchModule:function(t,e){var i,n=this.attr?this.attr:this.attr={},r=n.module?n.module:n.module={};if(t)if(r[t])for(i in e)r[t][i]=e[i];else r[t]=e;return this},isDestroy:function(){return this._is_destroy},destroy:function(){var t,e=this.device();e.destroy&&e.destroy();this._is_destroy=!0;this.stop();window[this.guid]=null;if(this.userElement&&_.isElement(this.userElement)){this.userElement.zonemediaplayer=null;this.userElement.innerText=""}if(this.eventManager){this.eventManager.destroy();this.eventManager=null}for(t=0;t<v.D_MEDIA_LIST.length;t++)if(v.D_MEDIA_LIST[t]===this){v.D_MEDIA_LIST.splice(t,1);break}this.watchTimeMods=null},stateLog:function(t,e,i,n){var r,s=this.attr,a=s.debug,o=v.EVENT,u="",l="log",h=t?t.source:null,c=!!h&&h instanceof y;if(t.type!=o.ON_SYNC&&a.use){if(a.disable&&a.disable.length)for(r=0;r<a.disable.length;r++)if(t.type==a.disable[r])return;if(a.displayType||a.displayClassName){var d,f,p=h?h.deviceType():null,m="youtube"!=p&&"video"!=p&&s.playerType?s.playerType:p;u+=a.displayType?"["+(m||"*")+"]":"";1===a.displayClassName&&-1!==(f=(d=t.device&&t.device.getClassName?t.device.getClassName():"").lastIndexOf("."))&&(d=d.substring(f+1));u+=a.displayClassName?"["+(d||"*")+"]":""}i||(i=1);if(i&&(i-=1))for(var g=0;g<i;g++)u+="    ";u+="start"==e?" --\x3e ":" <-- ";u+=v.getTypeName(t.type);u+=t.type==o.STATE_CHANGE?" ("+v.getStateName(t.data)+")":"";c&&(u+=a.displaySource?" ("+h.source()+")":"");if("start"===e){l="log"==a.startType?"log":"warn";if(a.special&&_.isArray(a.special))for(r=0;r<a.special.length;r++)if(t.type===a.special[r]){l="warn";break}}n&&(l="warn");switch(l){case"warn":t.data!==undefined?this.warn(u,t.data,t):this.warn(u);break;case"error":t.data!==undefined?this.error(u,t.data,t):this.error(u);break;case"fatal":t.data!==undefined?this.fatal(u,t.data,t):this.fatal(u);break;default:t.data!==undefined?this.log(u,t.data,t):this.log(u)}}},sendLog:function(t,e,i){var n=e[0],r=e[1],s="",a="",o=this.attr.debug,u=o&&o.url?o.url:i;function l(t){var e,i,n,r="";if(t){if(t instanceof Error||t instanceof TypeError)return t.stack?t.stack.replace(/\?updateid\=[0-9]+/gi,""):""+t;switch(typeof t){case"number":case"integer":case"float":case"double":case"string":return t+"";case"function":return"[function]";case"boolean":return"true"}n=!(r="{ ");for(e in t){i=l(t[e]);if(n)r+=", "+e+": "+i;else{n=!0;r+=e+": "+i}}return r+=" }"}return!1===t?"false":0===t?"0":null===t?"null":t===undefined?"undefined":""}(o.element||u)&&(s=l(n),a=l(r));if(o.element){if(!_.isElement(o.element)&&!_.isElement(o.element=_.query(o.element)))return;var h=document.createElement("div");switch(t){case"warn":h.style.color="#00FF00";break;case"error":case"fatal":h.style.color="#FF0000";break;default:h.style.color="#000000"}h.innerText+=a&&"undefined"!==a?"["+t+"] "+s+" - "+a:"["+t+"] "+s;o.element.appendChild(h)}u&&_.ajax({url:u+"?replaceTime="+(new Date).getTime(),type:"POST",data:{type:t,log:s,data:a},error:function(t){},success:function(t,e,i){}})},log:function(t){var i=this.attr,n=i&&i.debug;if(n&&n.use){try{_.log.apply(this,arguments)}catch(e){}try{this.sendLog("log",arguments)}catch(e){}}},warn:function(t){var i=this.attr,n=i&&i.debug;if(n&&n.use){try{_.warn.apply(this,arguments)}catch(e){}try{this.sendLog("warn",arguments)}catch(e){}}},error:function(t){var i=this.attr;i&&i.debug;try{_.error.apply(this,arguments)}catch(e){}try{this.sendLog("error",arguments)}catch(e){}},fatal:function(t){var i=this.attr,n=i&&i.debug;if(n&&n.use){try{_.error.apply(this,arguments)}catch(e){}try{this.sendLog("fatal",arguments)}catch(e){}}},code:function(t){var e=this.module("error");if(!e)return this.error("Not found error module for "+t+" exception code");e.code.apply(e,arguments)},targetElement:function(t){var e=this.attr&&(this.attr["native"]||this.attr.nativeFullscreen);if(e&&_.b.isMobile){var i,n;if(this.isNativePlayer(e)&&(i=this.device())&&(n=i.deviceInstance()))return n.zonemediaelement}return this.userElement},isNativePlayer:function(t){var e=t||this.attr["native"];if(e&&_.b.isMobile){if((e.iOS||e.ios)&&_.b.iOS)return!0;if(e.android&&_.b.android)return!0}return!1},isNativeFullscreen:function(){var t=this.attr.nativeFullscreen;if(t&&_.b.isMobile){if((t.iOS||t.ios)&&_.b.iOS)return!0;if(t.android&&_.b.android)return!0}return!1},screenshot:function(t,e){this.module("screenshot").shot(t,e)},screenshots:function(t,e){this.module("screenshot").start(t,e)},click:function(t){this.callStateChange({type:v.EVENT.CLICK_EVENT,data:t,event:null,parent:null})},displayControl:function(t){var e=this;setTimeout(function(){e.callStateChange({type:v.EVENT.CONTROL_EVENT,data:t})},1)},addMenu:function(t){if(t){for(var e=this.menus,i=0;i<e.length;i++)if(e[i]===t)return;e.push(t)}},removeMenu:function(t){if(t)for(var e=this.menus,i=e.length-1;0<=i;i--)e[i]===t&&e.splice(i,1)},closeAllMenu:function(t){for(var e,i=this.menus,n=0;n<i.length;n++)(e=i[n])&&e.closeMenu&&e.closeMenu(t)},getButton:function(t,e){return this.elementManager.getButton(t,e)},patchScreenClassName:function(){var t=this.userElement,e=document.body,i=this.module("size"),n=this.module("wide"),r=this.module("openLayer"),s=this.module("radio"),a=!1;_.removeClass(t,o.FULL_SCREEN);_.removeClass(e,this.skinName+"-fullscreen");_.removeClass(document.body,this.skinName+"-virtual-fullscreen");i&&i.resetStyle();n&&n.resetStyle();r&&r.resetStyle();s&&s.resetStyle();if(this.isFullscreen()){_.addClass(t,o.FULL_SCREEN);_.addClass(document.body,this.skinName+"-fullscreen");this.sizeMod.isVirtualFullscreen()&&_.addClass(document.body,this.skinName+"-virtual-fullscreen")}else{s&&s.isRadio()&&(a=!0);r&&r.isPatchScreenClassName()&&r.updateStyle();a?s.updateStyle():n&&n.isWide()?n.updateStyle():i&&i.updateStyle()}r&&r.updateLayoutAttribute()},isEnableSeekToFirst:function(){var t=this.attr,e=this.currentMediaSource();if(e&&e.input){if(e.input.disableSeekToFirst)return!1;if(!1===e.input.disableSeekToFirst)return!0}return!t||!t.disableSeekToFirst},isAutoplay:function(t){var e=this.device(),i=e&&e.deviceInstance(),n=t||this.currentMediaSource();return i&&i.canAutoPlay?i.canAutoPlay(n):!!n&&n.autoplay()},showMessage:function(t,e,i){i||(i={});i.player=this;i.addClass="mpv-show-message";var n=new(_.module("imgtech.media.extends.Alert"))(i);this.__showmessagesbox||(this.__showmessagesbox=[]);n.show(t,{isHtml:e});this.__showmessagesbox.push(n)},cleanMessage:function(){if(this.__showmessagesbox){for(var t=0;t<this.__showmessagesbox.length;t++){this.__showmessagesbox[t].hide()}this.__showmessagesbox=[]}},alert:function(t,e,i){i||(i={});i.player=this;var n=new(_.module("imgtech.media.extends.Alert"))(i);n.show(t,{isHtml:e});return n},confirm:function(t,e,i,n){i||(i={});i.player=this;var r=new(_.module("imgtech.media.extends.Confirm"))(i);r.show(t,{isHtml:e},n);return r}};return t})}();!function(){"use strict";var g=getDframework(),d=g.module("imgtech.media.Media"),u=d.CN,n=g.module("imgtech.media.ModuleInterface"),r=20,s=30;function a(t){this.parent=t;this.p=t.p;this.c=t.c;this.attr=t.attr;this.__osd=t.__osd;this.__disableLoading=!1;this.__osdLoadingBtn=this.p.getButton("osdLoadingBtn");this.__osdLoadingBtn.hideButton(this.attr.osdLoadingBtn);this.sizeMod=null;this.__osdToggleBtn=this.p.getButton("osdToggleBtn");this.__osdToggleBtn.hideButton(this.attr.osdToggleBtn);this.isUseOSD()||this.hideOSD();var e=this.p.userElement;this.__osdPlayBtn=g.queryAll(e,".mpv-osd-play-btn");this.__osdReloadBtn=g.queryAll(e,".mpv-osd-reload-btn");g.addClass(this.__osdPlayBtn,"mpv-hide");g.addClass(this.__osdReloadBtn,"mpv-hide")}a.prototype={constructor:a,onAddEvent:function(){var e=this;this.sizeMod=this.p.module("size");g.on(this.__osdPlayBtn,"click",function(t){e.p.play();return g.igEventAll(t)});g.on(this.__osdReloadBtn,"click",function(t){e.p.play();return g.igEventAll(t)})},onStateChange:function(t){var e=this.attr;switch(t.type){case d.EVENT.STATE_CHANGE:this.isUseOSD()?this.showOSD():this.hideOSD();t.data==d.STATE.SETSOURCE&&this.hideLoading();!this.isUseOSD()||t.data!=d.STATE.PLAYING&&t.data!=d.STATE.PAUSED||this.showOsdToggleBtn(t.data);if(e.osdPlayBtn)switch(t.data){case d.STATE.PLAYING:case d.STATE.SETSOURCE:g.addClass(this.__osdPlayBtn,"mpv-hide");break;case d.STATE.ENDED:g.removeClass(this.__osdPlayBtn,"mpv-hide")}switch(t.data){case d.STATE.PLAYING:case d.STATE.SETSOURCE:e.osdReloadBtn&&g.addClass(this.__osdReloadBtn,"mpv-hide");e.osdPlayBtn&&g.addClass(this.__osdPlayBtn,"mpv-hide");break;case d.STATE.PAUSED:e.osdPlayBtn&&g.removeClass(this.__osdPlayBtn,"mpv-hide");break;case d.STATE.ENDED:e.osdReloadBtn&&g.removeClass(this.__osdReloadBtn,"mpv-hide");e.osdPlayBtn&&g.addClass(this.__osdPlayBtn,"mpv-hide")}break;case d.EVENT.CAN_PLAY:this.hideLoading();break;case d.EVENT.WAITTING:t.data?this.showLoading():this.hideLoading()}},showOSD:function(){g.removeClass(this.__osd,"mpv-hide")},hideOSD:function(){g.addClass(this.__osd,"mpv-hide")},isUseOSD:function(){if(!this.__osd)return!1;var t=this.isUseYoutubeOSD();return!0!==t&&(!1===t||!this.attr.unused)},isUseYoutubeOSD:function(){var t,i=this.p;try{t=i&&i.device&&i.device()}catch(e){t=null}var n,r=t&&t.currentDevice?t.currentDevice.instance:t;if("youtube"==(r&&r.getPlayerType?r.getPlayerType():null)){var s=this.p.module("ad");if(s){if(!1===s.attr.useYoutubeOSD)return!1;if(!1===s.attr.useYoutubeOSD)return!0}if((n=i.attr)&&n.youtube&&n.youtube.useYoutubeOSD)return!0}return!1},enableLoading:function(){this.__disableLoading=!1},disableLoading:function(){this.__disableLoading=!0},showLoading:function(){if(this.__disableLoading)return this.hideLoading();var t=this.p.currentMediaSource(),e=this.p.device(),i=e&&e.deviceInstance();if(t&&t.___retryErrorLastCurrentTime)return this.hideLoading();if(i&&i.__disablePauseDisplayForStop){i.__disablePauseDisplayForStop=!1;return this.hideLoading()}this.__osdLoadingBtn.showButton(this.attr.osdLoadingBtn)},hideLoading:function(){this.__osdLoadingBtn.hideButton(this.attr.osdLoadingBtn)},showOsdToggleBtn:function(t){var e=this;if(this.attr.disableToggleOSD)return this.hideOsdToggleBtn();if(this.__osdToggleBtn){var i,n=this.p.currentMediaSource();if(n&&n.___retryErrorLastCurrentTime)return this.hideOsdToggleBtn();if(this.sizeMod&&this.sizeMod._beforeFullscreenHasReplaceElement)return this.hideOsdToggleBtn();if(t==d.STATE.PAUSED&&(i=this.p.device())&&(i=i.deviceInstance())&&i.__disablePauseDisplayForStop){i.__disablePauseDisplayForStop=!1;return this.hideOsdToggleBtn()}g.addClass(this.__osdToggleBtn.all,"mpv-transform-show");this.__osdToggleBtn.showButton(this.attr.osdToggleBtn);this.showToggleTimer&&clearInterval(this.showToggleTimer);this.showToggleTimerValue=(new Date).getTime();this.showToggleTimer=setInterval(function(){var t=e.showToggleTimerValue;if(400<=(new Date).getTime()-t){clearInterval(e.showToggleTimer);e.showToggleTimer=null;e.hideOsdToggleBtn()}},100)}},hideOsdToggleBtn:function(){g.removeClass(this.__osdToggleBtn.all,"mpv-transform-show");this.__osdToggleBtn.hideButton(this.attr.osdToggleBtn)}};function o(t){this.parent=t;this.p=t.p;this.c=t.c;this.attr=t.attr;this.__control=t.__control;this.__disableToggle=[];this.__clicklayout_timeId=null;this.__clicklayout_clicked=!1;var e=this.p.userElement;this.__sideDoubleTabLayout=g.query(e,".mpv-side-double-tab");this.__sideDoubleTabText=g.query(e,".mpv-side-double-tab-text");this.__sideDoubleTabHelper=g.query(e,".mpv-side-double-tab-helper");this._sideDoubleTab={id:!1};this.__touch_timeId=null;this.__touch_clicked=!1;this.__touch_dblclicked=!1;this.__sideDoubleTabLayout_width=null;this.__sideDoubleTabLayout_timer=null;this.__sideDoubleTabLayout_timeValue=0;var i=this.attr;0===i.clickTime||i.clickTime||(i.clickTime=400);i.clickTime<0&&(i.clickTime=400);i.progressBarTopOffset||(i.progressBarTopOffset=r);i.clickOffset||(i.clickOffset=s)}o.prototype={constructor:o,onAddEvent:function(){var e=this,t=this.c.resourceElement,i=this.p,n=this.attr;g.on(this.__control,"click",function(t){i.callStateChange({type:d.EVENT.CLICK_EVENT,data:"control"});return g.igEventAll(t)});g.on(this.__control,"dblclick",function(t){return g.igEventAll(t)});g.on(t,"click",function(t){e.onClickLayout(t)});0===n.clickTime&&g.on(t,"dblclick",function(t){e.onDblClickLayout(t)});this.setSideDoubleTab(this.attr.sideDoubleTab);function r(e){g.on(e,"click",function(t){i.callStateChange({type:d.EVENT.CLICK_EVENT,data:e,event:t,parent:null})})}var s,a=g.module("imgtech.media.Fullscreen");try{var o,u=(new a).getFullscreenParentIframes(),l=u&&u.fsElements;if(l&&l.length)for(var h=0;h<l.length;h++)if(o=(s=l[h].iframe).contentDocument||s.contentWindow&&s.contentWindow.document)try{r(o)}catch(c){g.error(c)}else s=null}catch(c){}s&&s.ownerDocument?r(s.ownerDocument):r(document)},onStateChange:function(t){},enableToggle:function(t){for(var e=this.__disableToggle.length-1;0<=e;e--)this.__disableToggle[e]===t&&this.__disableToggle.splice(e,1)},disableToggle:function(t){for(var e=this.__disableToggle.length-1;0<=e;e--)if(this.__disableToggle[e]===t)return;this.__disableToggle.push(t)},isDisableToggle:function(){return!!this.attr.disableToggle||!!this.__disableToggle.length},isUseDoubleClickOnclickTime:function(){var t=this.attr,e=t&&t.sideDoubleTab;return e&&e.useDoubleClickOnclickTime},___onDblClickLayout2:function(t){if(this.parent.isNoFullscreenEventOSD())return this.p.warn("Ignore event OSD: layout module attribute: noFullscreenEventOSD");if(this.parent.isNoEventOSD())return this.p.warn("Ignore event OSD: layout module attribute: noeventOSD");var e=this.p,i=e.device(),n=i?i.currentDevice:null;n&&n.type;this.parent.ignoreFullscreen()||e.toggleFullscreen()},onDblClickLayoutSeeked:function(t){function e(){var t=this.attr.sideDoubleTab;if(t&&0<=(new Date).getTime()-this.__sideDoubleTabLayout_timeValue-1e3*t.helperHideTimer)return function e(){var t=this.__sideDoubleTabLayout;this.__sideDoubleTabLayout_timer&&clearInterval(this.__sideDoubleTabLayout_timer);this.__sideDoubleTabLayout_timer=null;this.__sideDoubleTabLayout_timeValue=0;g.removeClass(t,"mpv-tab-left");g.removeClass(t,"mpv-tab-right");g.removeClass(t,"mpv-tab-on")}.call(this)}var i=this.__sideDoubleTabLayout,n=this;if(i){if(1==t){g.hasClass(i,"mpv-tab-right")&&g.removeClass(i,"mpv-tab-right");g.addClass(i,"mpv-tab-on");g.addClass(i,"mpv-tab-left")}else{if(2!=t)return;g.hasClass(i,"mpv-tab-left")&&g.removeClass(i,"mpv-tab-left");g.addClass(i,"mpv-tab-on");g.addClass(i,"mpv-tab-right")}this.__sideDoubleTabLayout_timeValue=(new Date).getTime();this.__sideDoubleTabLayout_timer||(this.__sideDoubleTabLayout_timer=setInterval(function(){e.call(n)},400))}},onDblClickLayoutPatched:function(t){var e=!1,i=this.attr.sideDoubleTab;if(i&&i.use){var n=this.p.currentMediaSource(),r=this.p.module("progress");if(3===t||n.isAD()||n.isVAST())this.___onDblClickLayout2(null);else if(1===t){e=!0;r&&r.previousSkip()}else if(2===t){e=!0;r&&r.nextSkip()}}else this.___onDblClickLayout2(null);if(e){g.text(this.__sideDoubleTabText,r.getSkipDepth()+i.helperUnitText);this.onDblClickLayoutSeeked(t)}},onDblClickLayout:function(t){var e,i=this.p.module("radio"),n=this.attr,r=this.parent.progressMod.rect();i&&i.isHideScreen()||r&&t.clientY>=r.top-n.progressBarTopOffset||(e=this.sideDoubleTabSeekWidth(t))&&this.onDblClickLayoutPatched(e)},___onClickLayout2:function(t){var e=this.p.module("volume");if(!(e&&e.__isDownUpForToggle||this.parent.isUseYoutubeOSD())){if(this.parent.isNoEventOSD())return this.p.warn("Ignore event OSD: layout module attribute: noeventOSD");for(var i=0;i<this.__disableToggle.length;i++){var n=this.__disableToggle[i];if(n.onClickLayout)try{n.onClickLayout()}catch(o){}}var r=this.p,s=this.attr,a=s.isOnlyToggleButton;if((!0===a||"function"==typeof a&&a.apply(this))&&!g.b.isMobile)return this.p.log("isOnlyToggleButton(no mobile): Not show control area.");s.enableHideControlOnClick&&(this.parent.__isOnMouseOver=!1);s.enableClickEventOnClick&&r.callStateChange({type:d.EVENT.CLICK_EVENT,data:"osd",event:t,parent:null});if(this.parent.isConfigShowControl()){if(!this.parent.isShowedControl||!g.hasClass(this.p.userElement,u.EXTEND_SCREEN))return this.parent.showControl()}else this.parent.showControl();if(!0===a||"function"==typeof a&&a.apply(this))return this.p.log("isOnlyToggleButton: Not toggle.");this.isDisableToggle()||r.toggle()}},clearDoubleClick:function(){this.__clicklayout_timeId&&clearTimeout(this.__clicklayout_timeId);this.__clicklayout_timeId=null;this.__clicklayout_clicked=!1},onClickLayout:function(t){function e(){this.__clicklayout_timeId=null;this.__clicklayout_clicked=!1;this.___onClickLayout2(t)}var i,n=this,r=this.p.module("radio"),s=this.attr,a=this.parent.progressMod.rect(),o=this.parent.mouseDownDataForClick;if(!(r&&r.isHideScreen()||a&&t.clientY>=a.top-s.progressBarTopOffset)){if(o){var u=o.event;if(Math.abs(u.clientX-t.clientX)>s.clickOffset||Math.abs(u.clientY-t.clientY)>s.clickOffset){this.parent.mouseDownDataForClick=null;return}}if(0===s.clickTime)return e.call(this);if(g.b.ie&&g.b.ie<9)return e.call(this);if(this.__touch_dblclicked)this.__touch_dblclicked=!1;else if(this.__clicklayout_timeId){if(this.__clicklayout_clicked){this.clearDoubleClick();this.isUseDoubleClickOnclickTime()?(i=this.sideDoubleTabSeekWidth(t))&&this.onDblClickLayoutPatched(i):this.___onDblClickLayout2(t)}}else{this.__clicklayout_clicked=!0;this.__clicklayout_timeId=setTimeout(function(){e.call(n)},s.clickTime)}}},sideDoubleTab:function(){function a(){o();u.oldType=0;u.round=0}function o(){u.id=!1;u.oldType=u.type;u.type=0;u.start=null;u.startTime=0}function e(t){var e=this,i=u.startTime,n=(new Date).getTime(),r=this.attr,s=this.p.module("radio");if(s&&s.isHideScreen())return a();if(!1===u.id)return a();if(i-n>r.clickTime)return a();if(u.round){if(this.__touch_clicked){this.__touch_dblclicked=!0;this.clearDoubleClick();this.__touch_timeId&&clearTimeout(this.__touch_timeId);this.__touch_timeId=null;this.__touch_clicked=!1;this.onDblClickLayoutPatched(u.type);a()}}else{o();u.round=1;this.__touch_clicked=!0;this.__touch_dblclicked=!1;this.__touch_timeId=setTimeout(function(){(function t(){this.__touch_timeId=null;this.__touch_clicked=!1;a()}).call(e)},r.clickTime)}}var t=this.c.resourceElement,i=this,u=this._sideDoubleTab,n=this.attr.sideDoubleTab,r=this.attr;n&&!n.helperHideTimer&&(n.helperHideTimer=1);if(0<r.clickTime){g.on(t,"touchstart",function(t){(function r(t){var e,i,n=this.p.module("radio");if(n&&n.isHideScreen())return a();if(!1===u.id&&(e=t.touches&&t.touches.length&&t.touches[0])){if(!(i=this.sideDoubleTabSeekWidth(e)))return a();u.round&&u.oldType!==i&&a();u.id=e.identifier;u.type=i;u.start=e;u.startTime=(new Date).getTime()}else a()}).call(i,t)});g.on(t,"touchmove",function(t){a()});g.on(t,"touchend",function(t){e.call(i,t)})}},setSideDoubleTab:function(t){this.attr.sideDoubleTab=t;var e=this.attr.sideDoubleTab;if(e){e.helperHideTimer||(e.helperHideTimer=1);0===e.progressHelperTimer||e.progressHelperTimer||(e.progressHelperTimer=2);e.ignoreFullscreen&&this.parent.disableFullscreenEventOSD(this,!0)}this.sideDoubleTab()},sideDoubleTabSeekWidth:function(t){var e=this.c.resourceElement,i=g.getBoundingClientRect(e),n=t&&t.pageX,r=0;if(i&&i.width()){var s=i.width()/3,a=i.left;t&&(r=n<s+a?1:2*s+a<n?2:3);var o=s;if(this.__sideDoubleTabLayout&&this.__sideDoubleTabLayout_width!==o){this.__sideDoubleTabLayout_width=o;this.__sideDoubleTabLayout.style.width=o+"px"}}return r},showSideDoubleTabHelper:function(){var e=this.attr.sideDoubleTab;if(e&&e.use&&e.progressHelperTimer){var t=this.__sideDoubleTabHelper,i=this;this.__sideDoubleTabHelperTimer=(new Date).getTime();if(this.__sideDoubleTabHelperTimerId)return;g.removeClass(t,"mpv-hide");this.__sideDoubleTabHelperTimerId=setInterval(function(){(function t(){(new Date).getTime()-this.__sideDoubleTabHelperTimer>=1e3*e.progressHelperTimer&&this.hideSideDoubleTabHelper()}).call(i)},500)}},hideSideDoubleTabHelper:function(){var t=this.__sideDoubleTabHelper;g.addClass(t,"mpv-hide");if(this.__sideDoubleTabHelperTimerId){clearInterval(this.__sideDoubleTabHelperTimerId);this.__sideDoubleTabHelperTimerId=null}}};function l(t){this.parent=t;this.p=t.p;this.c=t.c;this.attr=t.attr;this.id=!1;this.type="none";this.round=0;this.start=null;this.last=null;this.plMod=null;this.__disableMods=[];this.__helperEle=g.query(this.c.resourceElement,".mpv-touch-helper");if(this.__helperEle){this.nameEle=g.query(this.__helperEle,".mpv-touch-name");this.valueEle=g.query(this.__helperEle,".mpv-touch-value");g.addClass(this.__helperEle,"mpv-hide")}}l.S_PROGRESS="\uc9c4\ud589";l.S_VOLUM="\ubcfc\ub968";l.S_BRIGHTNESS="\ubc1d\uae30";l.prototype={constructor:l,onAddEvent:function(){var e=this,t=this.c.resourceElement;g.on(t,"touchstart",function(t){e.touchstart(t)});g.on(t,"touchmove",function(t){e.touchmove(t)});g.on(t,"touchend",function(t){e.touchend(t)});g.on(t,"touchcancel",function(t){e.touchcancel(t)});g.on(t,"pointercancel",function(t){e.touchcancel(t)});this.plMod=this.p.module("playlist")},onStateChange:function(t){switch(t.type){case d.EVENT.VOLUME_CHANGE:"volume"==this.type&&this.valueEle&&(t.data.muted?this.valueEle.innerText="0 %":this.valueEle.innerText=Math.floor(t.data.volume)+" %");break;case d.EVENT.CURRENT_TIME_CHANGE:}},enable:function(t){if(!t)throw new Error("Not found module parameter.");var e,i=this.__disableMods;for(e=i.length-1;0<=e;e--)i[e]===t&&i.splice(e,1)},disable:function(t){if(!t)throw new Error("Not found module parameter.");var e,i,n=this.__disableMods;for(e=n.length-1;0<=e;e--)if(n[e]===t){i=!0;break}i||n.push(t);this.reset()},isEnable:function(){var t;return!this.__disableMods.length&&("none"!=(t=this.computedUseType())&&("always"==t||!!this.p.isFullscreen()))},computedUseType:function(){var t,e=this.attr.touch,i=g.b.isMobile&&(t=e.mobile)&&t.useType?t.useType:e.useType;return i||"fullscreen"},touchName:function(t){function e(t){var e=this.attr,i=e&&e.touch&&e.touch.message;return i&&i[t]?i[t]:l[t]?l[t]:""}switch(t){case"progress":return e.call(this,"S_PROGRESS");case"brightness":return e.call(this,"S_BRIGHTNESS");case"volume":return e.call(this,"S_VOLUME")}return""},getActiveTouch:function(t){var e;if(!1!==this.id&&t.touches&&t.touches.length)for(e=0;e<t.touches.length;e++)if(t.touches[e].identifier===this.id)return t.touches[e];return null},touchProgress:function(t,e,i){var n=this.plMod;if(n&&n.isSliceTouch())return n.sliceTouch(t,e);var r=this.p.currentMediaSource();if(r&&!this.p.isLive()&&!this.p.isDVR()&&!r.isAD()&&!r.isVAST()){var s,a=t-e,o=Math.abs(a);s=40<o?50:35<o?30:30<o?20:25<o?10:20<o?3:10<o?2:6<o?1:3<o?.4:.2;var u=this.p.currentTime(),l=this.p.duration(),h=u+s*(0<a?1:-1),c=l<h?l:h<0?0:h;this.valueEle&&(this.valueEle.innerText=d.secondsToString(c));this.p.seekTo(c)}},touchVolume:function(t,e,i){var n=this.attr,r=n&&n.touch&&n.touch.rightCallback;if(r)return r(t,e,i);var s=100*(t-e)/window.screen.height*5,a=this.p.getVolume(),o=a-s,u=Math.floor(100<o?100:o<0?0:o);u!==a&&this.p.setVolume(u)},touchBrightness:function(t,e,i){var n=this.attr,r=n&&n.touch&&n.touch.leftCallback;if(r)return r(t,e,i)},touchstart:function(t){if(this.isEnable()){var e;if(!1===this.id&&(e=t.touches&&t.touches.length&&t.touches[0])){this.id=e.identifier;this.start=e;this.last=e}}},touchmove:function(t){if(this.isEnable()&&!1!==this.id){var e,i=this.getActiveTouch(t);if(i){var n=this.last,r=n.screenX,s=n.screenY,a=i.screenX,o=i.screenY,u=i.clientX;switch(this.type){case"none":if(this.round<2){this.round++;this.last=i;return}var l=this.c.resourceElement,h=g.getBoundingClientRect(l),c=(h.right-h.left)/2,d=this.start,f=d.screenX,p=d.screenY,m=Math.abs(a-f);if(Math.abs(o-p)<m){this.type="progress";(e=this.parent.iOSD)&&e.disableLoading();this.touchProgress(a,r,!0)}else if(u<c){this.type="brightness";this.touchBrightness(o,s,!0)}else{this.type="volume";this.touchVolume(o,s,!0)}if("none"!==this.type&&this.__helperEle){this.nameEle&&(this.nameEle.innerText=this.touchName(this.type));this.valueEle&&(this.valueEle.innerText="");g.removeClass(this.__helperEle,"mpv-hide")}break;case"progress":this.touchProgress(a,r,!1);break;case"volume":this.touchVolume(o,s,!1);break;case"brightness":this.touchBrightness(o,s,!1);break;default:this.p.warn("Not found touch status. type: "+this.type)}this.last=i}}},touchend:function(t){this.isEnable()&&!1!==this.id&&(this.getActiveTouch(t)||this.reset())},touchcancel:function(t){},reset:function(){var t;switch(this.type){case"progress":(t=this.parent.iOSD)&&t.enableLoading();var e=this.plMod;e&&e.isSliceTouch()&&e.sliceTouchReset()}this.id=!1;this.type="none";this.round=0;this.start=null;this.last=null;this.__helperEle&&g.addClass(this.__helperEle,"mpv-hide")}};function h(t){this.parent=t;this.p=t.p;this.c=t.c;this.attr=t.attr}h.prototype={constructor:h,onAddEvent:function(){var e=this,t=this.c.resourceElement;g.on(t,"dragover",function(t){t.preventDefault()});g.on(t,"drop",function(t){return e.onDrop(t)})},onStateChange:function(t){},onDrop:function(t){if(function r(t){var e;if(t){if((e=/https\:\/\/www.youtube.com\/watch\?v\=([\S]+)$/i.exec(t))&&1<e.length){var i=e[1].indexOf("&"),n=-1!==i?e[1].substring(0,i):e[1];if(n){this.p.source({src:"yt://"+n});return!0}return!1}if((e=/yt\:\/\/([\S]+)$/i.exec(t))&&1<e.length){if(e[1]){this.p.source({src:"yt://"+e[1]});return!0}return!1}if((e=/youtube\:\/\/([\S]+)$/i.exec(t))&&1<e.length){if(e[1]){this.p.source({src:"youtube://"+e[1]});return!0}return!1}if((e=/http\:\/\/([\S]+)$/i.exec(t))&&1<e.length){if(e[1]){this.p.source({src:"http://"+e[1]});return!0}return!1}if((e=/https\:\/\/([\S]+)$/i.exec(t))&&1<e.length){if(e[1]){this.p.source({src:"https://"+e[1]});return!0}return!1}}}.call(this,t.dataTransfer.getData("text")))return g.igEventAll(t)}};function i(t){n.apply(this,arguments);if(t){var e=this.p.userElement;this.__osd=g.query(e,".mpv-osd");this.__control=g.query(e,".mpv-control");this.__info=g.query(e,".mpv-info");this.__bottom=g.query(e,".mpv-bottom");this.__playerUi=g.query(e,".mpv-player");this.sizeMod=null;this.progressMod=null;this.volumeMod=null;this.state=d.STATE.PAUSED;this.__isOnMouseOver=!1;this.__is_show_user_control=!1;this.__is_no_auto_hide_first=!1;var i=this.attr;i.controlAutoHidePause=i.controlAutoHidePause?"hide":"show";i.controlAutoHide||this.p.warn("layout module attribute: has not controlAutoHide option.\nYou set alwaysControlNormal or alwaysControlFs option.");i.isAnimationControl&&g.addClass(this.__bottom,"mpv-ani");this.iTouch=new l(this);this.iOSD=new a(this);this.iEVENT=new o(this);this.iDragAndDrop=new h(this)}}g.extendClass(i,n,{onAddEvent:function(){var e=this,t=this.c.resourceElement,i=this.attr;this.sizeMod=this.p.module("size");this.progressMod=this.p.module("progress");this.volumeMod=this.p.module("volume");this.separateControl(this.isFullscreen());if(this.isDisableControl())this.hideControl();else if(i.controlAutoHide)if(i.controlAutoHideFirst)this.hideControl();else{this.__is_no_auto_hide_first=!0;this.showControl()}g.on(t,"mouseover",function(t){return e.onMouseOverLayout(t)});g.on(t,"mousedown",function(t){return e.onMouseDownLayout(t)});g.on(t,"mouseup",function(t){return e.onMouseUpLayout(t)});g.on(t,"mousemove",function(t){return e.onMouseMoveLayout(t)});g.on(t,"mouseout",function(t){return e.onMouseOutLayout(t)});this.iTouch.onAddEvent();this.iOSD.onAddEvent();this.iEVENT.onAddEvent();this.iDragAndDrop.onAddEvent()},onStateChange:function(t){var e=this.attr,i=this;switch(t.type){case d.EVENT.FULLSCREEN_CHANGE:setTimeout(function(){i.separateControl(t.data);i.showControl()},1);break;case d.EVENT.STATE_CHANGE:if("show"==e.controlAutoHidePause)switch(t.data){case d.STATE.PLAYING:this.state=d.STATE.PLAYING;break;case d.STATE.PAUSED:this.state=d.STATE.PAUSED;this.showControl()}}this.iTouch.onStateChange(t);this.iOSD.onStateChange(t);this.iEVENT.onStateChange(t);this.iDragAndDrop.onStateChange(t)},getBottomLayout:function(){return this.__bottom},getSeparate:function(){return this.isFullscreen()?this.attr.separateControlFs:this.attr.separateControlNormal},getPlayerUi:function(){return this.__playerUi},isUseYoutubeOSD:function(){return this.iOSD.isUseYoutubeOSD()},showLayout:function(){g.removeClass(this.__control,"mpv-hide");g.removeClass(this.__osd,"mpv-hide");g.removeClass(this.__info,"mpv-hide")},hideLayout:function(){g.addClass(this.__control,"mpv-hide");g.addClass(this.__osd,"mpv-hide");g.addClass(this.__info,"mpv-hide")},isAlwaysControl:function(){var t=this.attr;return this.isFullscreen()?t.alwaysControlFs:t.alwaysControlNormal},isDisableControl:function(){var t=this.attr;return this.isFullscreen()?t.disableControlFs:t.disableControlNormal},setAlwaysControlNormal:function(t){((this.attr.alwaysControlNormal=t)||this.isShowedControl)&&this.showControl()},separateControl:function(t){var e=this.attr.separateControlNormal,i=this.attr.separateControlFs,n=this.p.userElement,r="mpv-separate-control";if(n)return t?i?g.addClass(n,r):g.removeClass(n,r):e?g.addClass(n,r):g.removeClass(n,r)},setSeparateControlNormal:function(t){this.attr.separateControlNormal=t;this.separateControl(this.isFullscreen())},showUserControl:function(t){this.__is_show_user_control=!0;if(t){t.extend&&this.showExtendControl();(t.base||t.baisc)&&this.showRealControl()}else this.showRealControl()},hideUserControl:function(t){this.__is_show_user_control=!0;if(t){t.extend&&this.hideExtendControl();(t.base||t.baisc)&&this.hideRealControl()}else this.hideRealControl()},cancelUserControl:function(){this.__is_show_user_control=!1;(this.isShowedControl||g.hasClass(this.p.userElement,u.EXTEND_SCREEN))&&this.showControl()},isFullscreen:function(){return this.sizeMod&&this.sizeMod.isFullscreen()},ignoreFullscreen:function(){return this.sizeMod&&this.sizeMod.ignoreFullscreen()},isConfigShowControl:function(){var t=this.attr,e=t.isShowControl?t.isShowControl:!!t.isTouchControl&&t.isTouchControl;return!!e&&e.call(this)},isMouseOver:function(){var t=this.progressMod,e=this.volumeMod;return!!this.__isOnMouseOver||(!(!t||!t.isDownProgressHandler&&!t.isTouchProgressHandler)||!(!e||!e.isShowSlider||!e.isDownVolumeHandler&&!e.isTouchVolumeHandler))},onMouseOverLayout:function(t){this.onMouseMoveLayout_l(t);this.attr.playMouseOver&&this.p.play()},onMouseDownLayout:function(t){this.mouseDownDataForClick={event:t,time:(new Date).getTime()}},onMouseUpLayout:function(t){},onMouseOutLayout:function(t){this.__isOnMouseOver=!1;this.attr.pauseMouseOut&&this.p.pause()},onMouseMoveLayout:function(t){this.onMouseMoveLayout_l(t)},onMouseMoveLayout_l:function(t){if(!this.__is_no_auto_hide_first){this.__isOnMouseOver=!0;this.currentShowControl=(new Date).getTime();this.isConfigShowControl()||this.showControl()}}});g.define("imgtech.media.module.ActiveLayout",function(){function e(t){i.apply(this,arguments);if(t){this._enableHide=!0;this._disableHides=[];this._noFullscreenEventOSD=[]}}g.extendClass(e,i,{onAddEvent:function(){e.__super.onAddEvent.apply(this,arguments)},onStateChange:function(t){e.__super.onStateChange.apply(this,arguments)},isNoEventOSD:function(){return this.attr.noeventOSD},isNoFullscreenEventOSD:function(){return!!this.attr.noFullscreenEventOSD||!!this._noFullscreenEventOSD.length},disableFullscreenEventOSD:function(t,e){if("boolean"!=typeof e)return this.p.error("ERROR: disableFullscreenEventOSD arguments : "+e);for(var i=this._noFullscreenEventOSD,n=i.length-1;0<=n;n--){if(i[n].mod===t){e||i.splice(n,1);return}}e&&i.push({mod:t})},enableHide:function(t){this._enableHide=t},disableHide:function(t,e){if("boolean"!=typeof e)return this.p.error("ERROR: disableHide arguments : "+e);for(var i=this._disableHides,n=i.length-1;0<=n;n--){if(i[n].mod===t){e||i.splice(n,1);return}}e&&i.push({mod:t})},showRealControl:function(){var t=this.p.userElement;this.__is_no_auto_hide_first;this.isShowedControl=!0;g.removeClass(this.__control,"mpv-hide");g.addClass(t,"mpv-show-control");g.removeClass(t,"mpv-hide-control")},hideRealControl:function(){var t=this.p.userElement;this.isShowedControl=!1;this.__is_no_auto_hide_first=!1;g.addClass(this.__control,"mpv-hide");g.removeClass(t,"mpv-show-control");g.addClass(t,"mpv-hide-control")},hideControl:function(){var t=this.p.userElement,e=g.hasClass(t,"mpv-hide-control"),i=this,n=this.p.module("radio");this.currentShowControl=0;if(this.__is_show_user_control)return!0;if(!(this.isAlwaysControl()||n&&n.isHideScreen())){this.hideRealControl();e||setTimeout(function(){i.p.callStateChange({type:d.EVENT.CONTROL_EVENT,data:"hide"})},1)}},showControl:function(){var t=this,n=this.attr;function r(){this.__is_show_timer=!1}function s(){setTimeout(function(){e.call(t,!0)},200)}function e(t){if((t||!this.__is_show_timer)&&!this.__is_show_user_control){this.__is_show_timer=!0;if("show"==n.controlAutoHidePause&&this.state==d.STATE.PAUSED)return s.call(this);if(0<this._disableHides.length||!this._enableHide)return s.call(this);if(!1===n.controlAutoHideOver&&!g.b.isMobile&&this.isMouseOver()&&!this.isFullscreen())return s.call(this);if(!0===n.controlHideMouseOut&&!g.b.isMobile&&!this.isMouseOver()&&!this.__is_no_auto_hide_first){this.hideControl();return r.call(this)}var e=this.currentShowControl,i=(new Date).getTime();if(!e||i-e>1e3*n.controlAutoHide){this.hideControl();r.call(this)}else s.call(this)}}if(this.__is_show_user_control)return!0;(function i(){if(this.isDisableControl())return this.hideRealControl();this.currentShowControl=(new Date).getTime();this.showExtendControl();if(!this.isShowedControl){this.showRealControl();setTimeout(function(){t.p.callStateChange({type:d.EVENT.CONTROL_EVENT,data:"show"})},1)}}).call(this);e.call(this)}});return e});g.define("imgtech.media.module.LayoutEx",function(){var i=g.module("imgtech.media.module.ActiveLayout");function n(t){i.apply(this,arguments);if(t){var e=this.attr;this.__isLock=!1;this.__lockBtn=this.p.getButton("lockBtn");this.__lockBtn.initButton(e.lockBtn);this._orgLayoutAttr={};this.unlock()}}g.extendClass(n,i,{onAddEvent:function(){n.__super.onAddEvent.apply(this,arguments);var e=this;g.on(this.__lockBtn.all,"click",function(t){e.toggleLock();return g.igEventAll(t)})},onStateChange:function(t){n.__super.onStateChange.apply(this,arguments);var e=this.p.userElement;switch(t.type){case d.EVENT.ON_READY:g.addClass(e,u.STATE_PAUSED);g.removeClass(e,u.STATE_PLAYING);break;case d.EVENT.STATE_CHANGE:if(t.data==d.STATE.SETSOURCE){g.addClass(e,u.STATE_PAUSED);g.removeClass(e,u.STATE_PLAYING);if(this.p.isLive()){g.addClass(e,u.LIVE_SCREEN);g.removeClass(e,u.DVR_SCREEN)}else if(this.p.isDVR()){g.removeClass(e,u.LIVE_SCREEN);g.addClass(e,u.DVR_SCREEN)}else{g.removeClass(e,u.LIVE_SCREEN);g.removeClass(e,u.DVR_SCREEN)}}else if(t.data==d.STATE.PLAYING){g.addClass(e,u.STATE_PLAYING);g.removeClass(e,u.STATE_PAUSED)}else if(t.data==d.STATE.PAUSED){g.addClass(e,u.STATE_PAUSED);g.removeClass(e,u.STATE_PLAYING)}break;case d.EVENT.ON_BEFORE_PLAY:this.showControl()}},lock:function(){this.__isLock=!0;g.addClass(this.p.userElement,u.LOCK_SCREEN);this.iTouch.disable(this)},unlock:function(){this.__isLock=!1;g.removeClass(this.p.userElement,u.LOCK_SCREEN);this.iTouch.enable(this)},toggleLock:function(){this.isLock()?this.unlock():this.lock()},isLock:function(){return this.__isLock},enableToggle:function(t){this.iEVENT.enableToggle(t)},disableToggle:function(t){this.iEVENT.disableToggle(t)},hideExtendControl:function(){g.removeClass(this.p.userElement,u.EXTEND_SCREEN)},hideControl:function(){n.__super.hideControl.apply(this,arguments)||this.hideExtendControl()},showExtendControl:function(){g.addClass(this.p.userElement,u.EXTEND_SCREEN)}});return n})}();!function(){"use strict";var a=getDframework(),s=a.module("imgtech.media.Media");a.define("imgtech.media.module.Config",function(){var n=a.module("imgtech.media.ModuleInterface"),i=a.module("imgtech.media.extends.Menu"),r=a.module("imgtech.media.extends.ElementManager").NAME;function t(t){n.apply(this,arguments);if(t){var e=this.p.userElement,i=this.attr;this.__modList=[];this.__configLayout=a.query(e,"."+r.configLayout);this.__configBtn=this.p.elementManager.getButton("configBtn");this.__configBtn.initButton(i.configBtn)}}a.extendClass(t,n,{onAddEvent:function(){var e=this,t=this.p.userElement;a.on(this.__configBtn.all,"click",function(t){e.toggleMenu();return a.igEventAll(t)});new i(this,{player:this.p,invalidate:!0,disableControl:!0,button:[this.__configBtn],friend:[this.__configLayout],element:a.query(t,"."+r.configMenu)}).patchOverwrite()},onStateChange:function(t){var e=this;switch(t.type){case s.EVENT.CLICK_EVENT:this.attr.closeOnClick&&!0===this.isCloseAllSubModule()&&this.closeMenu();break;case s.EVENT.STATE_CHANGE:t.data==s.STATE.SETSOURCE&&setTimeout(function(){e.isOpenMenu()&&e.openMenu()},1)}},invalidate:function(){this.isOpenMenu()&&this.openMenu()},getSampleMenuList:function(){var t=this.attr.list;return t&&t.length?t:[{name:"\uc790\ub9c9",id:"subtitle"},{name:"\ud654\uc9c8",id:"quality"},{name:"\uc7ac\uc0dd\uc18d\ub3c4",id:"rate"},{name:"\ucc45\uac08\ud53c",id:"bookmark"},{name:"\uad6c\uac04\ubc18\ubcf5",id:"repmark"},{name:"\ud50c\ub808\uc774\ub9ac\uc2a4\ud2b8",id:"playlist"},{name:"\ud50c\ub808\uc774\uc5b4",id:"switchSource"}]},getMenuList:function(){function t(t){for(var e=0;e<n.length;e++){var i=n[e];if(i.id===t)return i}}for(var n=[],e=this.getSampleMenuList(),i=[],r=0;r<e.length;r++){var s=e[r],a=t(s.id);if(a)s=a;else try{s.module=this.p.module(s.id);s.module&&s.module.isEnableMenu&&s.module.isEnableMenu()?s.module.addOwnerModule(this):s=null}catch(o){this.p.warn(o);s=null}s&&i.push(s)}return i},closeAllSubModule:function(){for(var t=this.getMenuList(),i=0;i<t.length;i++){var n=t[i]&&t[i].module;if(n&&n.closeMenu)try{n.closeMenu()}catch(e){a.error(e)}}},isCloseAllSubModule:function(){for(var t=this.getMenuList(),e=0;e<t.length;e++){var i=t[e]&&t[e].module;if(i&&i.isOpenMenu&&i.isOpenMenu())return!1}return!0},drawMenu:function(t,i){var n=this,e=i.module,r=a.query(t,".mpv-view-name"),s=a.query(t,".mpv-view-value");if(r){r.setAttribute("cid",i.id);r.innerText=i.name}s&&(s.innerHTML=e&&e.currentValue?e.currentValue():"&nbsp;");a.on(t,"click",function(t){var e=i.module;if(e&&e.openMenu){n.closeAllSubModule();!0===e.openMenu({caller:n})&&s&&(s.innerHTML=e&&e.currentValue?e.currentValue():"&nbsp;")}return a.igEventAll(t)})}});return t})}();!function(){"use strict";var l=getDframework(),r=l.module("imgtech.media.Media");l.define("imgtech.media.module.Quality",function(){var n=l.module("imgtech.media.ModuleInterface"),i=l.module("imgtech.media.extends.Menu");function t(t){n.apply(this,arguments);if(t){var e=this.attr,i=this.p.userElement;this.__qualityLayout=l.query(i,".mpv-quality-layout");this.__qualityHelper=l.queryAll(i,".mpv-quality-helper");this.__qualityBtn=this.p.getButton("qualityBtn");this.__qualityBtn.initButton(e.qualityBtn)}}l.extendClass(t,n,{onAddEvent:function(){var e=this,t=this.p.userElement;this.layoutMod=this.p.module("layout");l.on(this.__qualityBtn.all,"click",function(t){e.toggleMenu();return l.igEventAll(t)});new i(this,{player:this.p,invalidate:!0,disableControl:!0,button:[],friend:[],element:l.query(t,".mpv-quality-menu")}).patchOverwrite()},onStateChange:function(t){var e,i=this.p;switch(t.type){case r.EVENT.CLICK_EVENT:this.closeMenu();break;case r.EVENT.STATE_CHANGE:if(t.data==r.STATE.SETSOURCE){this.cleanMenu();this.closeMenu("clear");if(e=i.getPlaybackQuality()){this.setCurrentQualityLabel(e.label);this.showButton()}else{this.setCurrentQualityLabel(null);this.hideButton()}}break;case r.EVENT.QUALITY_CHANGE:this.setCurrentQualityLabel(t.data.label)}},currentValue:function(){var t=this.p.getPlaybackQuality();return t?t.label?t.label:t.code:""},isEnableMenu:function(){var t=this.p.getAvailableQualityLevels();return!(!t||!t.length)},isSubMenu:function(){return!0},showButton:function(){this.__qualityBtn.showButton(this.attr.qualityBtn)},hideButton:function(){this.__qualityBtn.hideButton(this.attr.qualityBtn)},setCurrentQualityLabel:function(t){l.text(this.__qualityHelper,t||"");this.invalidateOwner()},getMenuList:function(){return this.p.getAvailableQualityLevels()},drawMenu:function(t,n){var e,i,r=this.p.getPlaybackQuality(!0),s=this,a=n.label?n.label:n.code,o=l.query(t,".mpv-view-checked"),u=l.query(t,".mpv-view-text");if("line"==n.view)return l.addClass(t,"mpv-view-line");if(r&&r.length)for(e=0;e<r.length;e++)if((i=r[e])&&i.code===n.code){l.addClass(t,"mpv-option-selected");o&&l.attr(o,"checked",!0);break}u&&(u.innerText=a);l.on(t,"click",function(t){var e=s.p.getPlaybackQuality();if(n!==e){try{var i=s.p.module("watchTime");i&&i.changeSource()}catch(t){}s.p.setPlaybackQuality(n)}s.closeMenu();return l.igEventAll(t)})}});return t})}();!function(){"use strict";var f=getDframework(),p=f.module("imgtech.media.Media");function e(t){return f.igEventAll(t)}f.define("imgtech.media.module.Volume",function(){var n=f.module("imgtech.media.ModuleInterface");function t(t){n.apply(this,arguments);if(t){this.layoutMod=null;this.isDownVolumeHandler=!1;this.isTouchVolumeHandler=!1;this.isShowSlider=null;this.sliderType=null;var e=this.attr,i=this.p.userElement;e.hideTimer||(e.hideTimer=1);this.type=e.type?e.type:"vertical";this.__volumeSliderLayout=f.query(i,".mpv-volume-slider-layout");this.__volumeHandler=f.query(i,".mpv-volume-handler");this.__volumeLayout=f.query(i,".mpv-volume-layout");this.__muteToggleBtn=f.query(i,".mpv-mute-toggle-btn");this.__volumeBackground=f.query(i,".mpv-volume-background");this.__volumeForeground=f.query(i,".mpv-volume-foreground");e.isAnimationControl&&f.addClass(this.__volumeSliderLayout,"mpv-ani");e.volumeStep||(e.volumeStep=10);this.init()}}f.extendClass(t,n,{onAddEvent:function(){var e=this;this.layoutMod=this.p.module("layout");this.isDiable()&&f.addClass(this.__volumeLayout,"mpv-hide");this.isDisableVolume()&&f.addClass(this.__volumeSliderLayout,"mpv-volume-disable");f.on(this.__volumeLayout,"mouseover",function(t){return e.onMouseOverLayout(t)});f.on(this.__volumeLayout,"mouseout",function(t){return e.onMouseOutLayout(t)});f.on(this.__volumeLayout,"wheel",function(t){return e.onWheelLayout(t)});f.on(this.__muteToggleBtn,"click",function(t){return e.onClickVolumeButton(t)});f.on(this.__muteToggleBtn,"mouseover",function(t){return e.onMouseOverMuteToggleBtn()});f.on(this.__volumeHandler,"mouseover",function(t){e.onMouseOverLayout(t);e.mouseoverHandler(t)});f.on(this.__volumeHandler,"mouseout",function(t){e.onMouseOutLayout(t);e.mouseoutHandler(t)});f.on(this.__volumeHandler,"mousedown",function(t){e.mousedownHandler(t)});f.on(document,"mouseup",function(t){e.mouseupHandler(t)});f.on(document,"mousemove",function(t){e.mousemoveHandler(t)});f.on(this.__volumeHandler,"touchstart",function(t){e.onTouchStartHandler(t)});f.on(this.__volumeHandler,"touchmove",function(t){e.onTouchMoveHandler(t)});f.on(this.__volumeHandler,"touchend",function(t){e.onTouchEndHandler(t)});f.on(this.__volumeSliderLayout,"click",function(t){e.selectVolume(t);return f.igEventAll(t)})},isDiable:function(){var t,e=this.attr;if(e.disable)for(t in e.disable)switch(e.disable[t]){case"android":if(f.b.android)return!0;break;case"iOS":if(f.b.iOS)return!0}return!1},isDisableVolume:function(){var t,e=this.attr;if(e.disableVolume)for(t in e.disableVolume)switch(e.disableVolume[t]){case"android":if(f.b.android)return!0;break;case"iOS":if(f.b.iOS)return!0}return!1},volumeStep:function(){return this.attr.volumeStep},plus:function(){var t=this.p,e=t.getVolume()+this.volumeStep();e>p.MIN_VOLUME&&(t.isMuted()?t.unMute():t.setVolume(e))},minus:function(){var t=this.p,e=t.getVolume()-this.volumeStep();e<=p.MIN_VOLUME?t.isMuted()||t.mute():t.setVolume(e)},isMouseOutLayoutConfig:function(){var t=this.attr.isMouseOutLayout;return!0===t||!1!==t&&(1===t?1:!!t&&t.apply(this))},onMouseOverLayout:function(t){this.isMouseOverVolumeLayout=!0},onMouseOutLayout:function(t){this.isMouseOverVolumeLayout=!1},onWheelLayout:function(t){var e=t.wheelDelta;if(e){0<e?this.plus():this.minus();return f.igEventAll(t)}},onMouseOverMuteToggleBtn:function(){this.attr.disableMouseOver||this.showSlider()},setDisableMouseOver:function(t){this.attr.disableMouseOver=t},onStateChange:function(t){var e;this.attr;switch(t.type){case p.EVENT.CLICK_EVENT:this.isAutoHide()&&this.hideSlider();break;case p.EVENT.ON_BEFORE_PLAY:(e=this.p.currentMediaSource())&&e.input&&e.input.mute&&this.p.mute();break;case p.EVENT.VOLUME_CHANGE:if(this.isDownVolumeHandler||this.isTouchVolumeHandler)return;var i=this.__volumeSliderLayout;if(!0===this.attr.enableAutoControl){var n,r=this.p.device(),s=this.layoutMod;if(!r||!(n=r.deviceInstance()))return this.p.error("Not found device and device object on volume change");if(n.__isCompleteInitVolume){if(!n.__isCompleteInitMute){if(n.__isSetInitMute){n.__isCompleteInitMute=!0;if(s&&s.isShowedControl){s.currentShowControl=(new Date).getTime();this.drawVolume(t.data.volume,t.data.muted)}return}if(i&&f.hasClass(i,"mpv-hide")||this.isVertical()&&!this.isShowSlider)return}}else{n.__isSetInitVolume&&(n.__isCompleteInitVolume=!0);if(i&&f.hasClass(i,"mpv-hide")||this.isVertical()&&!this.isShowSlider)return}s&&(s.isShowedControl?s.currentShowControl=(new Date).getTime():s.showControl());if(i)return this.showSlider()}i&&f.hasClass(i,"mpv-hide")?this.drawVolume(this.p.getVolume(),this.p.isMuted()):this.showSlider();break;case p.EVENT.CONTROL_EVENT:if("show"==t.data){if(this.isDownVolumeHandler||this.isTouchVolumeHandler)return;this.drawVolume(this.p.getVolume(),this.p.isMuted())}break;case p.EVENT.FULLSCREEN_CHANGE:this.isAutoHide()&&this.hideSlider()}},onClickVolumeButton:function(t){this.isShowSlider||this.isDisableVolume()?this.p.toggleMute():this.showSlider();return f.igEventAll(t)},isVertical:function(){return"vertical"==this.type},isAutoHide:function(){return!(!this.isVertical()&&!this.attr.autoHide)},setVertical:function(){this.type="vertical";this.init()},setHorizontal:function(t){this.type="horizontal";!0!==t&&!1!==t||(this.attr.autoHide=t);this.init()},init:function(){if(this.isVertical()){f.addClass(this.__volumeLayout,"mpv-up-vertical");f.removeClass(this.__volumeLayout,"mpv-horizontal")}else{f.removeClass(this.__volumeLayout,"mpv-up-vertical");f.addClass(this.__volumeLayout,"mpv-horizontal")}this.isAutoHide()&&this.hideSlider()},selectVolume:function(t){var e,i,n,r=this.p,s=this.__volumeBackground&&f.getBoundingClientRect(this.__volumeBackground),a=t.clientX,o=t.clientY,u=r.isMuted();i=this.isVertical()?(e=s.height()-(o-s.top),s.height()):(e=a-s.left,s.width());(n=Math.floor(e/i*100))<p.MIN_VOLUME?n=p.MIN_VOLUME:100<n&&(n=100);if(n<=p.MIN_VOLUME)u||r.mute();else{u&&r.unMute();r.getVolume()!=n&&r.setVolume(n)}},completeHandler:function(t){this.isDownVolumeHandler=!1;this.isTouchVolumeHandler=!1;f.off(document,"selectstart",e)},mouseoverHandler:function(t){this.isVertical()&&this.setIsShowSlider()},mouseoutHandler:function(t){},mousedownHandler:function(t){this.isVertical()&&this.setIsShowSlider();this.isDownVolumeHandler=!0;f.on(document,"selectstart",e)},mouseupHandler:function(t){var e=this.isDownVolumeHandler,i=this;this.completeHandler(t);if(e){this.__isDownUpForToggle=!0;setTimeout(function(){i.__isDownUpForToggle=!1},1)}},mousemoveHandler:function(t){var e,i,n,r,s=this.p,a={x:t.clientX,y:t.clientY};if(this.isDownVolumeHandler||this.isTouchVolumeHandler){t.dataTransfer&&(t.dataTransfer.effectAllowed="pointer");if(this.isVertical())i=(e=this.__volumeBackground&&f.getBoundingClientRect(this.__volumeBackground)).height()-(a.y-e.top),n=e.height(),r=Math.floor(i/n*100);else{e=this.__volumeBackground&&f.getBoundingClientRect(this.__volumeBackground);i=a.x-e.left,n=e.width(),r=Math.floor(i/n*100)}r<p.MIN_VOLUME?r=p.MIN_VOLUME:100<r&&(r=100);var o=r<=p.MIN_VOLUME,u=s.isMuted(),l=s.getVolume();this.setIsShowSlider();o!==u&&(o?s.mute():s.unMute());o||l==r||s.setVolume(r);this.drawVolume(r,o)}else if(this.isShowSlider){var h=this.__volumeSliderLayout&&f.getBoundingClientRect(this.__volumeSliderLayout).contains(a),c=f.getBoundingClientRect(this.__muteToggleBtn).contains(a),d=this.isMouseOutLayoutConfig();if(null===this.sliderType)h?this.sliderType=1:c||!0!==d||this.hideSlider({isMouseOut:!0});else if(1===this.sliderType&&!h){this.sliderType=null;d&&this.hideSlider({isMouseOut:!0})}}},onTouchStartHandler:function(t){f.on(document,"selectstart",e);t.dataTransfer&&(t.dataTransfer.effectAllowed="pointer");this.isTouchVolumeHandler=!0},onTouchMoveHandler:function(t){var e=t.changedTouches;if(e.length){var i=e[0],n={x:i.pageX,y:i.pageY};this.mousemoveHandler(n)}},onTouchEndHandler:function(t){return this.completeHandler(t)},onTouchCancelHandler:function(t){},setIsShowSlider:function(){this.isShowSlider=(new Date).getTime();this.layoutMod&&(this.layoutMod.currentShowControl=(new Date).getTime())},clearIsShowSlider:function(){this.isShowSlider=0},drawVolume:function(t,e){var i=e?0:Math.floor(t),n=this.__volumeForeground,r=this.__volumeHandler;this.__volumeSliderLayout&&!f.hasClass(this.__volumeSliderLayout,"mpv-hide")&&this.setIsShowSlider();if(this.isVertical()){if(n){n.style.width="";n.style.height=i+"%"}if(r){r.style.top=100-i+"%";r.style.left=""}}else{if(n){n.style.width=i+"%";n.style.height=""}if(r){r.style.top="";r.style.left=i+"%"}}if(e){f.addClass(this.__muteToggleBtn,"mpv-muted");f.removeClass(this.__muteToggleBtn,"mpv-unmuted")}else{f.removeClass(this.__muteToggleBtn,"mpv-muted");f.addClass(this.__muteToggleBtn,"mpv-unmuted")}},showSlider:function(){var t=this.p.getVolume(),e=this.p.isMuted();function r(){if(this.showSliderTimer){window.clearInterval(this.showSliderTimer);this.showSliderTimer=null}}var i=this;if(this.__volumeSliderLayout){f.removeClass(this.__volumeSliderLayout,"mpv-hide");this.drawVolume(t,e);this.setIsShowSlider();if(this.isAutoHide()){this.showSliderTimer&&r.call(this);this.showSliderTimer=setInterval(function(){(function n(){if((f.b.isMobile||!this.isMouseOverVolumeLayout)&&!this.isDownVolumeHandler){var t=(new Date).getTime(),e=this.isShowSlider,i=this.attr;if(!e)return r.call(this);if(t-e>1e3*i.hideTimer){this.hideSlider();return r.call(this)}}}).call(i)},200)}}},hideSlider:function(t){f.addClass(this.__volumeSliderLayout,"mpv-hide");this.clearIsShowSlider()}});return t})}();!function(){"use strict";var l=getDframework(),u=l.module("imgtech.media.Media"),r=u.CN;l.define("imgtech.media.module.Size",function(){var i=l.module("imgtech.media.ModuleInterface"),n=l.module("imgtech.media.Fullscreen");function t(t){i.apply(this,arguments);if(t){var e=this.attr;this.__fullscreenBtn=this.p.elementManager.getButton("fullscreenBtn");this.__sizeBtn=this.p.elementManager.getButton("sizeBtn");this.__style={};this.fs=new n(this.attr,this.p);this.saveheight=null;this.LANDSCAPE_VAL=null;this.__fullscreenBtn.initButton(e.fullscreenBtn);this.__sizeBtn.initButton(e.sizeBtn)}}l.extendClass(t,i,{onOrientationChange:function(t){},onAddEvent:function(){var e=this,i=this.p,t=this.p.userElement;l.on(this.__sizeBtn.all,"click",function(){e.next()});if(t){if(l.b.firefox){l.on(document,"mozfullscreenchange",function(t){e.setOnFullscreenChange(t)});l.on(t,"fullscreenchange",function(t){e.setOnFullscreenChange(t)})}else if(l.b.ie)l.on(document,"MSFullscreenChange",function(t){e.setOnFullscreenChange(t)});else{l.on(t,"fullscreenchange",function(t){e.setOnFullscreenChange(t)});l.on(t,"webkitfullscreenchange",function(t){e.setOnFullscreenChange(t)});l.on(t,"ofullscreenchange",function(t){e.setOnFullscreenChange(t)})}this.fs.fullscreenchange=function(t){e.setOnFullscreenChange(t)}}l.on(this.__fullscreenBtn.all,"click",function(t){e.ignoreFullscreen()||i.toggleFullscreen()});l.b.isMobile&&l.on(window,"orientationchange",function(t){e.onOrientationChange(t)})},onStateChange:function(t){var e,i,n,r,s=this.p.userElement,a=this.p;switch(t.type){case u.EVENT.ON_READY:if(this.LANDSCAPE_VAL!==this.isLandscape()){this.LANDSCAPE_VAL=this.isLandscape();this.patchOrientation()}this.p.patchScreenClassName();break;case u.EVENT.ON_SYNC:a.sendSizeChange();break;case u.EVENT.STATE_CHANGE:t.data==u.STATE.SETSOURCE&&(1<a.width.length||1<a.height.length?this.__sizeBtn.showButton(this.attr.sizeBtn):this.__sizeBtn.hideButton(this.attr.sizeBtn));break;case u.EVENT.VIDEO_SIZE_DATA:(r=this.p.currentMediaSource())&&r.input.autoHeight&&this.patchVideoSizeData();break;case u.EVENT.RESIZE_WINDOW:if(this.LANDSCAPE_VAL!==this.isLandscape()){this.LANDSCAPE_VAL=this.isLandscape();this.patchOrientation()}(r=this.p.currentMediaSource())&&r.input.autoHeight&&r.input.autoHeightResizeable&&this.patchVideoSizeData();break;case u.EVENT.FULLSCREEN_CHANGE:(r=this.p.currentMediaSource())&&r.input.autoHeight&&this.patchVideoSizeData();break;case u.EVENT.OPENLAYER_CHANGE:!t.data&&(r=this.p.currentMediaSource())&&r.input.autoHeight&&this.patchVideoSizeData();break;case u.EVENT.SIZE_CHANGE:this.setSizeClass();break;case u.EVENT.SET_SIZE:if(s){e=t.data.width,i=t.data.height,n=t.data.index;e&&u.updateStyle(this,{width:u.getStyleNumberValue(e)});i&&u.updateStyle(this,{height:u.getStyleNumberValue(i)});if(-1!=n&&this.__sizeBtn){if(a.attr.width.length)for(var o=0;o<a.attr.width.length;o++)l.removeClass(this.__sizeBtn.all,"mpv-sel"+o);l.addClass(this.__sizeBtn.all,"mpv-sel"+n)}a.sendSizeChange();(e||i)&&this.p.patchScreenClassName()}break;case u.EVENT.SET_FULLSCREEN:this.setFullscreen(t);break;case u.EVENT.EXIT_FULLSCREEN:this.exitFullscreen()}},resetStyle:function(){var t=this.p.userElement;t.style.width="";t.style.height="";l.removeClass(t,r.NORMAL_SCREEN)},updateStyle:function(){var t=this.__style,e=this.p.userElement;for(var i in t)e.style[i]=t[i];l.addClass(e,r.NORMAL_SCREEN)},isLandscape:function(){return window.innerWidth>window.innerHeight},patchOrientation:function(){var t=this.p.userElement;if(this.isLandscape()){l.addClass(t,"mpv-landscape");l.removeClass(t,"mpv-portrait")}else{l.removeClass(t,"mpv-landscape");l.addClass(t,"mpv-portrait")}this.p.callStateChange({type:u.EVENT.ORIENTATION_CHANGE,data:this.isLandscape()?"landscape":"portrait"})},patchVideoSizeData:function(){var t=this,i=this.p.userElement;l.hasClass(i,r.NORMAL_SCREEN)&&setTimeout(function(){(function e(){var t;if(l.hasClass(i,r.NORMAL_SCREEN)&&(t=u.GetAutoHeight.call(this.p))){u.updateStyle(this,{height:t+"px"});this.p.patchScreenClassName()}}).call(t)},1)},setSizeClass:function(){},next:function(){var t=this.p,e=t.sizeIndex;e=t.width.length-1==e?t.sizeIndex=0:++t.sizeIndex;t.setSize(t.width[e],t.height[e],e)},exitFullscreen:function(){if(!this.p.isNativePlayer()){if(this.ignoreFullscreen())return l.warn("ignore fullscreen.");if(this.isLockFullscreen)throw new Error("Lock fullscreen");this.isFullscreen()&&(this._exit()?this.__exit_real_fullscreen=!0:this.sendFullscreenChangeEvent(!1))}},_exit:function(t){if(this.p.isNativePlayer())return l.warn("This is native player on exited fullscreen.");var e=this.fs.exit(t);this.__fullscreenLandscape&&(this.__fullscreenLandscape=!1);try{this.p.module("app").exitFullscreen()}catch(n){}var i=this.p.targetElement();i!==this.p.userElement&&(this.p.isNativePlayer()||i.removeAttribute("controls"));return e},setFullscreen:function(t){var e=this.attr;if(this.p.isNativePlayer())return l.warn("This is native player. so not goto fullscreen");if(this.ignoreFullscreen())return l.warn("ignore fullscreen.");if(this.isLockFullscreen)throw new Error("Lock fullscreen");if(!this.isFullscreen()){var i,n=this.p.targetElement(),r=t?t.data:null;this.p.isPlaying();if(this.p.isNativeFullscreen()){var s;if((i=this.p.device())&&(s=i.deviceInstance())&&(n=s.zonemediaelement)){if(n.webkitEnterFullscreen)return n.webkitEnterFullscreen();if(n.enterFullscreen)return n.enterFullscreen()}return}this.__exit_real_fullscreen=!1;try{this.p.module("app").useVirtualScreen()&&(r=!1)}catch(u){}var a=this.fs.fullscreen(n,r);a&&e.fullscreenLandscape&&(this.__fullscreenLandscape=!0);try{this.p.module("app").fullscreen()}catch(u){}this.fs_fullscreen_saved=this.fs.saved;a||this.sendFullscreenChangeEvent(!0);var o=this.p.targetElement();o!==this.p.userElement&&o.setAttribute("controls","true")}},lockFullscreen:function(t){this.isLockFullscreen=t},isFullscreen:function(){return this.fs.isFullscreen()},isVirtualFullscreen:function(){return this.fs.isVirtualFullscreen()},isWindowFullscreen:function(){return this.fs.isWindowFullscreen(this.p.targetElement())},sendFullscreenChangeEvent:function(t){this.p.patchScreenClassName();this.p.callStateChange({type:u.EVENT.FULLSCREEN_CHANGE,data:t})},setOnFullscreenChange:function(t){if(!this.p.isNativePlayer()){var e=t.target||t.srcElement,i=this.p.targetElement();if(e!==i){if(!l.b.ie)return this.p.warn("This not zonehtml5mediaplayer fullscreen.",t);if(this.fs.realElement!==i&&11!==l.b.ie)return this.p.warn("This not real fullscreen.",t)}if(this.fs.isRealFullscreen())return this.sendFullscreenChangeEvent(!0);this.__exit_real_fullscreen||this._exit(!0);return this.sendFullscreenChangeEvent(!1)}},ignoreFullscreen:function(){var t=this.attr;if(!0===t.ignoreFullscreen||!1===t.ignoreFullscreen)return t.ignoreFullscreen;try{if(t.ignoreFullscreen&&t.ignoreFullscreen.apply(this))return!0}catch(e){}return!1}});return t})}();!function(){"use strict";var n=getDframework(),r=n.module("imgtech.media.Media"),s=r.CN;n.define("imgtech.media.module.Wide",function(){var i=n.module("imgtech.media.ModuleInterface");function t(t){i.apply(this,arguments);if(t){var e=this.attr;this.__style={};this.__wideBtn=this.p.elementManager.getButton("wideBtn");this.state="normal";this.__wideBtn.initButton(e)}}n.extendClass(t,i,{onAddEvent:function(){var t=this;n.on(this.__wideBtn.all,"click",function(){t.toggle()});this.sizeMod=this.p.module("size")},onStateChange:function(t){var e=this.attr;switch(t.type){case r.EVENT.FULLSCREEN_CHANGE:t.data||"wide"!=this.state||"auto"!=e.height||this.patchVideoSizeData();break;case r.EVENT.WIDE_CHANGE:case r.EVENT.OPENLAYER_CHANGE:case r.EVENT.RESIZE_WINDOW:case r.EVENT.VIDEO_SIZE_DATA:"wide"==this.state&&"auto"==e.height&&this.patchVideoSizeData()}},resetStyle:function(){var t=this.p.userElement;t.style.width="";t.style.height="";n.removeClass(t,s.WIDE_SCREEN);n.removeClass(document.body,this.p.skinName+"-wide")},updateStyle:function(){var t=this.__style,e=this.p.userElement;for(var i in t)e.style[i]=t[i];n.addClass(e,s.WIDE_SCREEN);n.addClass(document.body,this.p.skinName+"-wide")},patchVideoSizeData:function(){var t=this,i=this.p.userElement;n.hasClass(i,s.WIDE_SCREEN)&&setTimeout(function(){(function e(){var t;if(n.hasClass(i,s.WIDE_SCREEN)&&(t=r.GetAutoHeight.call(this.p))){r.updateStyle(this,{height:t+"px"});this.p.patchScreenClassName()}}).call(t)},1)},isWide:function(){return"wide"==this.state},wide:function(){var t=this.attr,e=this;this.state="wide";n.removeClass(this.__wideBtn.all,"mpv-sel0");n.addClass(this.__wideBtn.all,"mpv-sel1");"auto"==t.height?this.patchVideoSizeData():t.height&&r.updateStyle(this,{height:t.height+"px"});this.p.patchScreenClassName();setTimeout(function(){e.p.callStateChange({type:r.EVENT.WIDE_CHANGE,data:e.state})},1)},normal:function(){var t=this;this.state="normal";this.p.patchScreenClassName();n.addClass(this.__wideBtn.all,"mpv-sel0");n.removeClass(this.__wideBtn.all,"mpv-sel1");setTimeout(function(){t.p.callStateChange({type:r.EVENT.WIDE_CHANGE,data:t.state})},1)},toggle:function(){this.isWide()?this.normal():this.wide()}});return t})}();!function(){"use strict";var b=getDframework(),T=b.module("imgtech.media.Media"),S=T.CN;function c(t){return b.igEventAll(t)}b.define("imgtech.media.module.Progress",function(){var s=b.module("imgtech.media.ModuleInterface"),a=b.module("imgtech.media.extends.LibProgress");function t(t){s.apply(this,arguments);if(t){var e=this.attr,i=e&&e.timestamp,n=this.p.userElement,r=b.query(n,".mpv-progress");this.progress=new a(this);this.progress.setUi({root:r,total:b.query(r,".mpv-total-progress"),buffer:b.query(r,".mpv-buffer-progress"),over:b.query(r,".mpv-over-progress"),current:b.query(r,".mpv-current-progress")});this.__tsBox=b.query(n,".mpv-timestamp-box");this.__tsText=b.query(n,".mpv-timestamp-text");this.__tsLayout=b.query(r,".mpv-timestamp-layout");this.__tsItemHTML=this.__tsLayout.innerHTML;this.__tsLayout.innerHTML="";this.__progressHandler=b.query(r,".mpv-progress-handler");this.__previousSkipBtn=this.p.getButton("previousSkipBtn");this.__nextSkipBtn=this.p.getButton("nextSkipBtn");this.__skipInput=this.p.getButton("skipInput");this.__currentTimeText=this.p.getButton("currentTimeText");this.__durationText=this.p.getButton("durationText");this.__introSkipBtn=this.p.getButton("introSkipBtn");this.repMod=null;this.linkedThumbnailMod=null;this.linkedThumbnailModData=null;this.__eventMods=[];this.__disSeekable=[];this.isDownProgressHandler=!1;this.isTouchProgressHandler=!1;this._progressTime=!1;this._progressConfig=null;this._isPreviewStart=!1;this._isPreviewEnd=!1;this.isTimeStamp=!1;this.timeStamps=[];this.__previousSkipBtn.initButton(e.previousSkipBtn);this.__nextSkipBtn.initButton(e.nextSkipBtn);this.__skipInput.initButton(e.skipInput);this.__currentTimeText.initButton(e.currentTimeText);this.__durationText.initButton(e.durationText);(e.skipInputValue?e.skipInputValue:e.skipInputValue=10)&&this.setSkipDepth(e.skipInputValue);(!e.touchOffset||e.touchOffset<5)&&(e.touchOffset=10);(!e.downOffset||e.downOffset<5)&&(e.downOffset=5);(!e.overOffset||e.overOffset<7)&&(e.overOffset=7);i&&i.prefixAlways&&b.addClass(this.__tsLayout,"mpv-prefix-always");!function(e){e.__self_onseekto=function(t){return e.onClickProgressBar(t)};e.setProgressEvent(!0)}(this)}}b.extendClass(t,s,{setProgressEvent:function(t){var e=this.p.userElement,i=this.progress.rootUi;if(t){b.on(e,"click",this.__self_onseekto);b.on(i,"click",this.__self_onseekto)}else{b.off(e,"click",this.__self_onseekto);b.off(i,"click",this.__self_onseekto)}},onAddEvent:function(){this.repMod=this.p.module("repeat");var e=this,t=this.__progressHandler,i=this.attr,n=this.p.userElement;if(t){b.on(document.body,"mousemove",function(t){return e.onMouseMoveHandler(t)});b.on(document.body,"mouseup",function(t){e.onMouseUpHandler(t)})}if(t&&!0!==i.disableDrag){b.on(n,"mousedown",function(t){return e.onMouseDownHandler(t)});b.on(n,"touchstart",function(t){return e.onTouchStartHandler(t)});b.on(n,"touchmove",function(t){return e.onTouchMoveHandler(t)});b.on(n,"touchend",function(t){return e.onTouchEndHandler(t)})}b.on(n,"mousemove",function(t){return e.onMouseMoveProgress(t)});b.on(n,"mouseover",function(t){return e.onMouseMoveProgress(t)});b.on(n,"mouseout",function(t){return e.onMouseMoveProgress(t)});b.on(this.progress.rootUi,"wheel",function(t){e.onWheelProgress(t)});b.on(this.__previousSkipBtn.all,"click",function(t){return e.previousSkip(t)});b.on(this.__nextSkipBtn.all,"click",function(t){return e.nextSkip(t)});b.on(this.__introSkipBtn.all,"click",function(t){return e.toIntroTime(t)});b.on(this.__tsBox,"click",function(t){return e.onClickTsBox(t)});i.disableOverBar&&b.addClass(this.progress.rootUi,"disable-overbar");if(i.eventMods)for(var r=0;r<i.eventMods.length;r++){var s=this.p.module(i.eventMods[r]);s&&this.__eventMods.push(s)}},onStateChange:function(t){var e,i,n,r,s,a,o,u,l,h,c,d=this,f=this.attr,p=t.data,m=this.p.userElement;switch(t.type){case T.EVENT.ON_READY:break;case T.EVENT.ON_BEFORE_PLAY:(r=this.p.currentMediaSource())&&(o=r.input)&&o.introTime?b.addClass(m,S.INTRO_SCREEN):b.removeClass(m,S.INTRO_SCREEN);break;case T.EVENT.RESET:b.text(this.__currentTimeText.all,"00:00");b.text(this.__durationText.all,"00:00");break;case T.EVENT.STATE_CHANGE:if(p==T.STATE.SETSOURCE){if((r=this.p.currentMediaSource())&&(o=r.input)&&(s=o.progressTime)){var g=o.autoContinueTime,v=o.continueTime,y=g&&v?v<g?g:0:g||(v||0);this._progressTime=!0!==s?s:y||0;this._progressConfig=!!s}else{this._progressTime=!1;this._progressConfig=null}o&&(a=o.preview)?b.addClass(m,S.PREVIEW_SCREEN):b.removeClass(m,S.PREVIEW_SCREEN);a&&a.data&&a.data.sort(function(t,e){return t.start===e.start?t.end-e.end:t.start-e.start});o.timestamp?this.timeStampReady(r):this.timeStampReady(null);b.text(this.__durationText.all,T.secondsToString(0));this.updateProgressBar(0,0)}break;case T.EVENT.DURATION_CHANGE:this.progress.durationChange(p.duration);b.text(this.__durationText.all,T.secondsToString(p.duration));break;case T.EVENT.CURRENT_TIME_CHANGE:if(this.isDownProgressHandler||this.isTouchProgressHandler)return;i=p.currentTime;e=this.repMod;if((r=this.p.currentMediaSource())&&r.input.introTime&&r.input.introTime<i){r.input.introTime=null;b.removeClass(m,S.INTRO_SCREEN)}if(!1!==this.previewCurrentTimeChange(i))return;e.repaireCurrentTime(i);if(!e.enableSeekTo(i)){if(i>=e.endValue()&&!e.isRepeat())return this.p.stop();var _=e.startValue();this.__safedStartValue?this.__safedStartValue++:this.__safedStartValue=1;u=_+this.__safedStartValue;return setTimeout(function(){d.seekTo(u)},1)}this.updateProgressBar(i,p.duration);this.__safedStartValue=null;!1!==this._progressTime&&i>this._progressTime&&(this._progressTime=i);break;case T.EVENT.BUFFERING_CHANGE:this.updateBufferingBar(t.data);break;case T.EVENT.SEEKTO_MEDIA:case T.EVENT.SEEKTO_CONTINUE_TIME:e=this.repMod;if(!(n=this.p.device()))return this.p.error("Not found device.");l=p.value;h=p.seconds;c=this._progressTime;if(e&&!e.enableSeekTo(l))if(e.isRepeatWatchTimeSeekable()){h=undefined;l=e.endValue()}else{h=undefined;l=e.startValue()}!1!==c&&c<l&&(l=c);if(f.ignoreSeekTime&&Math.abs((i=this.p.currentTime())-l)<f.ignoreSeekTime)return this.p.warn("Ignore seek: current="+i+", seekTo="+l);l=this.previewSeekTo(l);n.seekTo(l,h);if(t.type==T.EVENT.SEEKTO_CONTINUE_TIME){var E=this.p.module("continueTime");E&&E.afterSeekTo(t.data.isPlaying)}break;case T.EVENT.CONTROL_EVENT:"show"==t.data&&this.redraw();break;case T.EVENT.RESIZE_WINDOW:this.redraw()}},setLinkedThumbnail:function(t){this.linkedThumbnailMod=t},timeStampReady:function(t){var e=this.p.userElement,i=t&&t.input&&t.input.timestamp&&t.input.timestamp.data;this.timeStamps=[];this.__tsLayout.innerHTML="";if(i){this.timeStampDraw(i);b.addClass(e,S.TIMESTAMP_SCREEN);this.isTimeStamp=!0}else{b.removeClass(e,S.TIMESTAMP_SCREEN);this.isTimeStamp=!1}},timeStampDraw:function(t){this.timeStamps=[];this.__tsLayout.innerHTML="";if(t){t.sort(function(t,e){return t.seconds-e.seconds});for(var e=0;e<t.length;e++){var i=t[e],n=b.element(this.__tsItemHTML),r=new a(this);r.setUi({root:n,total:b.query(n,".mpv-total-timestamp"),buffer:b.query(n,".mpv-buffer-timestamp"),over:b.query(n,".mpv-over-timestamp"),current:b.query(n,".mpv-current-timestamp"),prefix:b.query(n,".mpv-prefix-timestamp"),timestamp:i});b.append(this.__tsLayout,n);this.timeStamps.push(r)}}this.progress.setTimeStamps(this.timeStamps)},getTimeStampStep:function(t){for(var e=0;e<this.timeStamps.length;e++){var i=this.timeStamps[e];if(i.tsData.seconds<=t&&t<=i.endSeconds)return i}},onWheelProgress:function(t){var e=t.wheelDelta;if(e){0<e?this.nextSkip():this.previousSkip();return b.igEventAll(t)}},onMouseMoveProgress:function(t){var e,i,n,r,s,a,o,u,l=!1,h={x:t&&t.clientX,y:t&&t.clientY},c=this.progress.rect(),d=this.attr.timestamp,f={active:!1,handler:t&&(this.isDownProgressHandler||this.isTouchProgressHandler),time:!1,event:t,x:h.x,y:h.y,TS:this.timeStamps,selectedTS:null,isHandlerTS:!1};function p(t,e,i){return e&&e.top-i<=t.y&&t.y<=e.bottom+i&&e.left<=t.x&&t.x<=e.right}t&&(f.handler?f.active=!0:p(h,c,this.attr.overOffset)&&(f.active=!0));if(f.active){e=!0;b.addClass(this.progress.rootUi,"hover");(f.time=this.eventToTime(t))||(f.time=0);this.progress.updateOverUi(f.time,this.p.duration())}else{e=!1;b.removeClass(this.progress.rootUi,"hover")}this.linkedThumbnailModData=null;for(var m=0;m<this.timeStamps.length;m++){i=this.timeStamps[m];var g=!1;b.removeClass(i.rootUi,"hover");b.removeClass(i.rootUi,"prefixover");if(e||f.handler){c=i.rect();if(f.handler){l=!0;c&&(g=m===this.timeStamps.length-1?(o=h,(u=c)&&u.left<=o.x):0===m?(s=h,(a=c)&&s.x<=a.right):(n=h,(r=c)&&r.left<=n.x&&n.x<=r.right))}else c&&(g=p(h,c,this.attr.overOffset));if(c&&g){if(g){f.selectedTS=i;this.linkedThumbnailModData={text:i.tsData.name,time:i.tsData.seconds}}c.left<=h.x&&c.left+d.prefixPixel>=h.x&&b.addClass(i.rootUi,"prefixover");b.addClass(i.rootUi,"hover");var v=b.getBoundingClientRect(this.__progressHandler),y=v&&{x:v.left+(v.right-v.left)/2,y:v.top+(v.bottom-v.top)/2};l=y&&c.top<=y.y&&y.y<=c.bottom&&c.left<=y.x&&y.x<=c.right}}}if(l){f.isHandlerTS=!0;b.addClass(this.__progressHandler,"onts")}else b.removeClass(this.__progressHandler,"onts");this.sendEventMods("move",f)},sendEventMods:function(t,i){for(var n=0;n<this.__eventMods.length;n++){var r=this.__eventMods[n];try{r.eventMods&&r.eventMods(t,i)}catch(e){this.p.error(e)}}},getLinkedThumbnailData:function(t){return this.getLinkedThumbnail(t)},getLinkedThumbnail:function(t){return this.linkedThumbnailModData},toIntroTime:function(t){var e=this.p.currentMediaSource(),i=this.p.userElement;if(e.input.introTime){this.p.seekTo(e.input.introTime);e.input.introTime=null}b.removeClass(i,S.INTRO_SCREEN);return b.igEventAll(t)},progressTime:function(t){if(t!==undefined)if(!1===t){this._progressTime=!1;this._progressConfig=null}else{!0===t&&(t=0);this._progressTime=t;this._progressConfig=!0}return this._progressTime},setSkipDepth:function(t){b.val(this.__skipInput.all,t);this.attr.skipDepth=t},getSkipDepth:function(){var t,e=10;if(this.__skipInput.all&&this.__skipInput.all.length)try{(t=parseInt(this.__skipInput.all[0].value+""))&&(e=t)}catch(i){}else if(this.attr.skipDepth)return this.attr.skipDepth;return e},repairSkipValue:function(t){var e=this.getSkipDepth(),i=this.p,n=this.repMod,r=i.currentTime();if(0===r||r){0<t?r+=e:t<0&&(r-=e);r<0&&(r=0);n&&!n.enableSeekTo(r)&&(r=n.getEnableValue(r));return r}return!1},nextSkip:function(t){var e;if(this.isSeekable()&&!1!==(e=this.repairSkipValue(1))){this.callActionModule({type:"progressChange",data:e,from:"nextSkip"});this.p.seekTo(e)}return b.igEventAll(t)},previousSkip:function(t){var e;if(this.isSeekable()&&!1!==(e=this.repairSkipValue(-1))){this.callActionModule({type:"progressChange",data:e,from:"previousSkip"});this.p.seekTo(e)}return b.igEventAll(t)},onClickTsBox:function(t){var e=this.attr,i=e&&e.timestamp;i&&i.callback&&i.callback.call(this,{event:t,type:"click"})},rect:function(){return this.progress.rect()},previewCurrentTimeChange:function(t){var e,i,n,r,s=this.attr.preview,a=this;if(!((e=this.p.currentMediaSource())&&(i=e.input)&&(n=i.preview)&&(r=n.data)&&r.length))return this.___called_preview_callback=!1;for(var o=0;o<r.length;o++){var u=r[o];if(u.start>t)return setTimeout(function(){a.seekTo(u.start)},1);if(u.end+1>t)return!1}this.p.pause();if(s.alwaysRequest||!this.___called_preview_callback){this.___called_preview_callback=!0;setTimeout(function(){s&&s.callback&&s.callback.call(a,"end",i)})}s.gotoFirst&&this.p.seekTo(0)},previewSeekTo:function(t){var e,i,n,r;if((e=this.p.currentMediaSource())&&(i=e.input)&&(n=i.preview)&&(r=n.data)&&r.length){for(var s,a=0;a<r.length;a++){if((s=r[a]).start>t)return s.start;if(s.end+1>t)return t}return s.end}return t},unsetPreview:function(t){var e=this.p.currentMediaSource(),i=e&&e.input,n=this.p.userElement;b.removeClass(n,S.PREVIEW_SCREEN);if(i&&i.preview){i.previewSaved=i.preview;i.preview=null}t&&this.p.play()},redraw:function(){var i=this.p,n=this;setTimeout(function(){var t=n.p.currentMediaSource(),e=t&&t.input&&t.input.timestamp&&t.input.timestamp.data;n.timeStampDraw(e);n.progress.drawTimeStamps();n.updateProgressBar(i.currentTime(),i.duration());n.updateBufferingBar(i.getBuffering())},1)},isSeekable:function(){if(this.__disSeekable&&this.__disSeekable.length)return!1;var t=this.p.currentMediaSource(),e=t&&t.input;return!e||!e.disableSeekable},enSeekable:function(t){if(this.__disSeekable.length){for(var e=0;e<this.__disSeekable.length;e++)if(this.__disSeekable[e]===t){this.__disSeekable.splice(e,1);break}this.__disSeekable.length||this.setProgressEvent(!0)}},disSeekable:function(t){for(var e=!this.__disSeekable.length,i=0;i<this.__disSeekable.length;i++)if(this.__disSeekable[i]===t)return;this.__disSeekable.push(t);e&&this.setProgressEvent(!1)},updateRepeat:function(){var t=this.p.currentTime(),e=this.repMod;e.enableSeekTo(t)||this.seekTo(e.startValue())},updateBufferingBar:function(t){this.progress.updateBufferUi(t)},timeToPixel:function(t){return this.progress.timeToPixel(t,this.p.duration())},updateProgressBar:function(t,e){var i=e?t/e*100:0,n=this.progress.updateCurrentUi(t,e);b.text(this.__currentTimeText.all,T.secondsToString(t));n.rect&&this.setProgressHandler(i*n.rect.width()/100,t)},onClickProgressBar:function(t){this.onSeekTo(t);this.onMouseMoveProgress(null);return b.igEventAll(t)},onSeekTo:function(t,e){if(this.isSeekable()){var i=this.rect(),n=i?i.width():0,r={x:t.clientX,y:t.clientY},s=this.attr.timestamp;if(n){var a;if(r.x<i.left-15||r.x>i.right+15||r.y<i.top-15||r.y>i.bottom+15)return;var o=this.p,u=((r.x<i.left?i.left:r.x>i.right?i.right:r.x)-i.left)/n*o.duration();if(s&&s.prefixPixel){var l=this.getTimeStampStep(u);if(l){var h=l.tsData.seconds,c=l.rect();c&&c.left+s.prefixPixel>=r.x&&(u=h)}}this.callActionModule({type:"progressChange",data:u,from:"click"});this.seekTo(u);(a=this.p.module("layout"))&&a.iEVENT&&a.iEVENT.showSideDoubleTabHelper();return b.igEventAll(t)}}},drawSeekHandler:function(t){var e,i=t.clientX,n=(t.clientY,this.rect()),r=n?i-n.left:0,s=n?n.width():0;s<r?r=s:r<0&&(r=0);(e=this.p.module("layout"))&&(e.currentShowControl=(new Date).getTime());if(n){var a=this.pixelToTime(r),o=this.repMod;if(o&&!o.enableSeekTo(a))!1!==(a=o.getEnableValue(a))&&this.updateProgressBar(a,this.p.duration());else{this.progress.updateCurrentUi(a,this.p.duration());this.setProgressHandler(r,a)}"touch"==t.type&&this.onMouseMoveProgress(t)}this.callActionModule({type:"progressChange",data:a,from:"mousemove"})},setProgressHandler:function(t,e){this.__progressHandler&&(this.__progressHandler.style.left=t+"px");var i=this.getTimeStampStep(e);i&&i.tsData?b.text(this.__tsText,i.tsData.name):b.text(this.__tsText,"")},onMouseMoveHandler:function(t){this.isSeekable()&&this.isDownProgressHandler&&this.__progressHandler&&this.drawSeekHandler({clientX:t.clientX,clientY:t.clientY,type:"mouse"})},eventToTime:function(t){var e=this.rect(),i=e?e.width():0,n={x:t.clientX,y:t.clientY};return((n.x<e.left?e.left:n.x>e.right?e.right:n.x)-e.left)/i*this.p.duration()},pixelToTime:function(t){if(!t)return!1;var e=this.rect(),i=e?e.width():0,n=this.p.duration();return!!e&&(i?t/i*n:0)},seekTo:function(t){var e=this.repMod,i=this.p;if(e&&!e.enableSeekTo(t)){if(!1===(t=e.getEnableValue(t)))return;this.updateProgressBar(t,i.duration())}i.seekTo(t)},setIsDownProgressHandler:function(){this.isDownProgressHandler=!0},clearIsDownProgressHandler:function(){this.isDownProgressHandler=!1},setIsTouchProgressHandler:function(){this.isTouchProgressHandler=!0},clearIsTouchProgressHandler:function(){this.isTouchProgressHandler=!1},onCompleteHandler:function(){if(this.isSeekable()&&(this.isDownProgressHandler||this.isTouchProgressHandler)&&this.__progressHandler){var t=this.pixelToTime(parseFloat(this.__progressHandler.style.left));if(!1!==t){this.callActionModule({type:"progressChange",data:t,from:"completeHandler"});this.seekTo(t)}}this.onMouseMoveProgress(null);this.clearIsDownProgressHandler();this.clearIsTouchProgressHandler();b.off(document,"selectstart",c)},onMouseDownHandler:function(t){if(this.isSeekable()){b.on(document,"selectstart",c);var e=b.getBoundingClientRect(this.__progressHandler);if(e){var i=this.attr,n=e.left-i.downOffset,r=e.right+i.downOffset,s=e.top-i.downOffset,a=e.bottom+i.downOffset,o=t.clientX,u=t.clientY;n<=o&&o<=r&&s<=u&&u<=a&&this.setIsDownProgressHandler()}}},onMouseUpHandler:function(t){if(this.isDownProgressHandler)return this.onCompleteHandler()},onMouseOutHandler:function(t){},onTouchStartHandler:function(t){if(this.isSeekable()){b.on(document,"selectstart",c);var e=t.changedTouches,i=b.getBoundingClientRect(this.__progressHandler);if(i){var n=this.attr,r=e[0],s=i.left-n.touchOffset,a=i.right+n.touchOffset,o=i.top-n.touchOffset,u=i.bottom+n.touchOffset,l=r.clientX,h=r.clientY;s<=l&&l<=a&&o<=h&&h<=u&&this.setIsTouchProgressHandler()}}},onTouchMoveHandler:function(t){var e=t.changedTouches;if(this.isSeekable()&&this.isTouchProgressHandler&&e.length&&this.__progressHandler){var i=e[0];this.drawSeekHandler({clientX:i.pageX,clientY:i.pageY,type:"touch"})}},onTouchEndHandler:function(t){return this.onCompleteHandler()},onTouchCancelHandler:function(t){},setListener:function(t,e){}});return t})}();!function(){"use strict";var d=getDframework(),f=d.module("imgtech.media.Media");d.define("imgtech.media.module.ProgressHelper",function(){var i=d.module("imgtech.media.ModuleInterface");function t(t){i.apply(this,arguments);if(t){var e=this.p.userElement;this.layoutMod=null;this.__totalProgress=d.query(e,".mpv-total-progress");this.__bufferProgress=d.query(e,".mpv-buffer-progress");this.__currentProgress=d.query(e,".mpv-current-progress");this.helperLayout=d.query(e,".mpv-progress-helper-layout");this.helperUi=d.query(e,".mpv-progress-helper");this.textLayout=d.query(e,".mpv-bookmark-text-layout");this.attr.offset===undefined&&(this.attr.offset=2)}}d.extendClass(t,i,{onAddEvent:function(){function t(t){if(t){d.on(t,"mouseover",function(t){e.showHelper(t)});d.on(t,"mousemove",function(t){e.showHelper(t)});d.on(t,"mouseout",function(t){e.hideHelper(t)})}}var e=this;t(this.__totalProgress);t(this.__bufferProgress);t(this.__currentProgress);this.layoutMod=this.p.module("layout")},onStateChange:function(t){switch(t.type){case f.EVENT.STATE_CHANGE:t.data==f.STATE.SETSOURCE&&this.hideHelper()}},showHelper:function(t){var a=this.__totalProgress?d.getBoundingClientRect(this.__totalProgress):null,e=a?a.width():0,i={x:t.clientX,y:t.clientY},o=this.attr,u=this;if(e){if(i.x<a.left-10||i.x>a.right+10||i.y<a.top-10||i.y>a.bottom+10)return;var n=this.p,l=parseInt(i.x<a.left?a.left:i.x>a.right?a.right:i.x),r=(l-a.left)/e*n.duration(),s=parseInt(r),h=this.helperLayout,c=this.helperUi;if(h&&c){c.innerText=f.secondsToString(s);d.removeClass(h,"mpv-hide");setTimeout(function(){if(u.textLayout&&!d.hasClass(u.textLayout,"mpv-hide"))return u.hideHelper();var t,e=d.getBoundingClientRect(h),i=e&&e.right?e.right-e.left:0,n=parseInt(i/2),r=l-n,s=l+i;t=a&&a.right&&a.right<=s?a.right-i-o.offset:a&&(a.left||0===a.left)&&r<=a.left?a.left+o.offset:r;h.style.left=t+"px"},1)}}this.layoutMod&&this.layoutMod.disableHide(this,!0)},hideHelper:function(){var t=this.helperLayout,e=this.helperUi;if(t&&e&&!d.hasClass(t,"mpv-hide")){d.addClass(t,"mpv-hide");e.innerText=""}this.layoutMod&&this.layoutMod.disableHide(this,!1)}});return t})}();!function(){"use strict";var l=getDframework(),n=l.module("imgtech.media.Media");l.define("imgtech.media.module.Repeat",function(){var r=l.module("imgtech.media.ModuleInterface"),i=l.module("imgtech.media.module.Moveable");function s(t){r.apply(this,arguments);if(t){var e=this,i=this.attr,n=this.p.userElement;this.__totalProgress=l.query(n,".mpv-total-progress");this.__bufferProgress=l.query(n,".mpv-buffer-progress");this.__currentProgress=l.query(n,".mpv-current-progress");this.__repeatBtn=this.p.getButton("repeatBtn");this.__repeatStart=l.query(n,".mpv-repeat-start-marker");this.__repeatEnd=l.query(n,".mpv-repeat-end-marker");this.progressMod=null;i.depthSeconds||(i.depthSeconds=5);this.init();l.removeClass(this.__repeatBtn.all,"mpv-repeat-on");l.addClass(this.__repeatBtn.all,"mpv-repeat-off");this.setIsShowRepeatMarker(!1);this.updateMarker();this.__repeatBtn.initButton(i.repeatBtn);l.on(window,"scroll",function(t){e.onScroll(t)})}}s.EVENT={SHOW:"repeat-toggle",CHANGE_MIN:"repeat-change-min",CHANGE_MAX:"repeat-change-max",DEPTH_SECONDS_2:"repeat-depth_seconds_2",IS_LOGIN:"repeat-is-login"};l.extendClass(s,r,{EVENT:s.EVENT,setIsShowRepeatMarker:function(t){l.removeClass(this.__repeatBtn.all,"on off on1 on2");!0===(this.isShowRepeatMarker=t)?l.addClass(this.__repeatBtn.all,"on"):!1===t?l.addClass(this.__repeatBtn.all,"off"):1==t?l.addClass(this.__repeatBtn.all,"on1"):2==t&&l.addClass(this.__repeatBtn.all,"on2")},init:function(t){var e=this;this.__isUsed=!1;this.__isDuration=!1;this.lastDuration=0;this.setIsShowRepeatMarker(!1);this.minValue=0;this.maxValue=0;if(this.startMoveable)this.startMoveable.init();else if(this.__repeatStart){if(!t){this.startMoveable=new i(this,this.__repeatStart);this.startMoveable.setOuterElement(this.__totalProgress);this.startMoveable.setChangeListener(function(t){return e.changeStartPoint(t)})}l.addClass(this.__repeatStart,"mpv-hide")}if(this.endMoveable)this.endMoveable.init();else if(this.__repeatEnd){if(!t){this.endMoveable=new i(this,this.__repeatEnd);this.endMoveable.setOuterElement(this.__totalProgress);this.endMoveable.setChangeListener(function(t){return e.changeEndPoint(t)})}l.addClass(this.__repeatEnd,"mpv-hide")}},onAddEvent:function(){var n=this;this.progressMod=this.p.module("progress");l.on(this.__repeatBtn.all,"click",function(t){var e,i=!0;if(n.attr.isLogin&&!0!==(e=n.attr.isLogin())){i=!1;n.p.callStateChange({type:s.EVENT.IS_LOGIN,data:e})}!1!==i&&n.toggle();return l.igEventAll(t)})},onStateChange:function(t){var e=this;switch(t.type){case n.EVENT.STATE_CHANGE:if(t.data==n.STATE.SETSOURCE){this.init(!0);l.removeClass(this.__currentProgress,"mpv-hide");l.removeClass(this.__bufferProgress,"mpv-hide");this.updateMarker(!0);l.remove(this.__progressUi)}break;case n.EVENT.DURATION_CHANGE:t.data.duration&&(this.__isDuration=!0);this.setDuration(t.data.duration);break;case n.EVENT.CONTROL_EVENT:"show"==t.data&&this.drawMarker();break;case n.EVENT.SIZE_CHANGE:case n.EVENT.RESIZE_WINDOW:this.drawMarker();break;case n.EVENT.FULLSCREEN_CHANGE:setTimeout(function(){e.drawMarker()},1);break;case s.EVENT.SHOW:if(t.data){this.setIsShowRepeatMarker(t.data);1===t.data?this.min(t.ctime?t.ctime:0):2===t.data&&this.max(t.ctime?t.ctime:0)}else{this.setIsShowRepeatMarker(!1);l.remove(this.__progressUi)}this.updateMarker(!0);break;case s.EVENT.CHANGE_MIN:case s.EVENT.CHANGE_MAX:this.drawMarker()}},onScroll:function(){this.drawMarker()},toggle:function(t){var e=this.isShowRepeatMarker;if(2===e||!0===e)this.hide();else if(1===e)this.show(t);else{this.show(t);if(!this.__isUsed||this.attr.alwaysCurrentTime){this.__isUsed=!0;this.min(this.p.currentTime())}}},show:function(t){var e=!0,i=null,n=this.limitSeconds();if(!t&&2===this.attr.type)if(!1===this.isShowRepeatMarker){e=1;i=this.p.currentTime()}else{e=2;i=this.p.currentTime();if(!0!==this.attr.ignoreDepth&&this.minValue+this.attr.depthSeconds>i)return this.p.callStateChange({type:s.EVENT.DEPTH_SECONDS_2,data:e,ctime:i,limitTime:n})}this.p.callStateChange({type:s.EVENT.SHOW,data:e,ctime:i})},hide:function(){this.p.callStateChange({type:s.EVENT.SHOW,data:!1})},min:function(t){var e=this.startMoveable,i=this.endMoveable,n=this.limitSeconds();if(e&&i){var r=t+n<i.value?t:i.value-n;this.minValue=r;i.setMin(r);e.setValue(r);this.drawMarker();this.p.callStateChange({type:s.EVENT.CHANGE_MIN,data:r});return r}},max:function(t){var e=this.startMoveable,i=this.endMoveable,n=this.limitSeconds();if(e&&i){var r=t-n>e.value?t:e.value+n;this.maxValue=r;e.setMax(r);i.setValue(r);this.drawMarker();this.p.callStateChange({type:s.EVENT.CHANGE_MAX,data:r});return r}},drawMarker:function(){this.isShowRepeatMarker&&this.__drawMarker()},__drawMarkerProgress:function(){var t,e=this,i=this.startMoveable,n=this.endMoveable,r=this.isShowRepeatMarker;if(this.attr.progressUi&&this.__bufferProgress&&this.__totalProgress){var s=l.getBoundingClientRect(this.__totalProgress);if(s&&(s.width()||s.height())){l.addClass(this.__currentProgress,"mpv-hide");l.addClass(this.__bufferProgress,"mpv-hide");if(2===r||!0===r){if(t=this.__progressUi)l.after(this.__bufferProgress,t);else{t=this.__progressUi=document.createElement("div");l.addClass(t,"mpv-repeat-progressbar");l.addClass(t,"mpv-progressbar");l.after(this.__bufferProgress,t)}if((0===i.value||i.value)&&n.value){var a=i.mineElement.style.left,o=n.mineElement.style.left,u=parseInt(o)-parseInt(a);t.style.left=a;t.style.width=u+"px"}}}else setTimeout(function(){e.__drawMarker()},100)}},__drawMarker:function(){var t=this.startMoveable,e=this.endMoveable,i=this.isShowRepeatMarker;t&&t.draw();2!==i&&!0!==i||e&&e.draw();this.__drawMarkerProgress()},setDuration:function(t){var e=this.startMoveable,i=this.endMoveable,n=this.p.currentMediaSource(),r=n&&n.input;this.lastDuration=t;this.sourceAttr=null;if(e&&i){e.setFixed(!1);e.setMin(0);e.setMax(t);e.setTotal(t);e.setValue(0);this.minValue=0;i.setFixed(!1);i.setMin(0);i.setMax(t);i.setTotal(t);i.setValue(t);this.maxValue=t;if(r){var s=!1,a=!1;0===r.repeatEnd&&(r.repeatEnd=1);if(0===r.repeatStart||r.repeatStart){s=!0;this.min(r.repeatStart)}if(r.repeatEnd){a=!0;this.max(r.repeatEnd)}if(r.repeatFix){e.setFixed(!0);i.setFixed(!0)}if(s&&a){this.setIsShowRepeatMarker(!0);this.updateMarker(!0)}}}},updateMarker:function(t){if(this.__repeatStart&&this.__repeatEnd){l.removeClass(this.__repeatBtn.all,"mpv-repeat-on mpv-repeat-on1 mpv-repeat-off");if(1===this.isShowRepeatMarker){this.max(this.lastDuration);l.removeClass(this.__repeatStart,"mpv-hide");l.addClass(this.__repeatBtn.all,"mpv-repeat-on1")}else if(2===this.isShowRepeatMarker){l.removeClass(this.__repeatEnd,"mpv-hide");l.addClass(this.__repeatBtn.all,"mpv-repeat-on")}else if(!0===this.isShowRepeatMarker){l.removeClass(this.__repeatStart,"mpv-hide");l.removeClass(this.__repeatEnd,"mpv-hide");l.addClass(this.__repeatBtn.all,"mpv-repeat-on")}else{l.addClass(this.__repeatStart,"mpv-hide");l.addClass(this.__repeatEnd,"mpv-hide");l.addClass(this.__repeatBtn.all,"mpv-repeat-off")}}t&&this.drawMarker()},isShowStartMarker:function(){return!l.hasClass(this.__repeatStart,"mpv-hide")},isShowEndMarker:function(){return!l.hasClass(this.__repeatEnd,"mpv-hide")},getStartMarkerTime:function(){var t=this.progressMod.rect(),e=this.__repeatStart?l.getBoundingClientRect(this.__repeatStart):null,i=t?t.width():0,n=e?e.width()/2:0;return n?n*this.p.duration()/i:0},getEndMarkerTime:function(){var t=this.progressMod.rect(),e=this.__repeatEnd?l.getBoundingClientRect(this.__repeatEnd):null,i=t?t.width():0,n=e?e.width()/2:0;return n?n*this.p.duration()/i:0},changeDest:function(t,e){var i=this;if("down"==t.type||"touchstart"==t.type);else{if("up"==t.type||"touchend"==t.type){setTimeout(function(){i.progressMod.updateRepeat()},1);return e.apply(this,arguments)}if("move"==t.type||"touchmove"==t.type)return e.apply(this,arguments)}},startValue:function(){return this.startMoveable.value},endValue:function(){return this.endMoveable.value},limitSeconds:function(){return this.getStartMarkerTime()+this.attr.depthSeconds},changeStartPoint:function(n){return this.changeDest(n,function r(){var t=this.endMoveable,e=this.limitSeconds(),i=n.value+e<t.value?n.value:t.value-e;"up"!=n.type&&"touchend"!=n.type||(this.minValue=i);t.setMin(i);this.callActionModule({type:"repeatMarkerChange",data:i,from:"start"});this.p.callStateChange({type:s.EVENT.CHANGE_MIN,data:i});return i})},changeEndPoint:function(n){return this.changeDest(n,function r(){var t=this.startMoveable,e=this.limitSeconds(),i=n.value-e>t.value?n.value:t.value+e;"up"!=n.type&&"touchend"!=n.type||(this.maxValue=i);t.setMax(i);this.callActionModule({type:"repeatMarkerChange",data:i,from:"end"});this.p.callStateChange({type:s.EVENT.CHANGE_MAX,data:i});return i})},isRepeatWatchTimeSeekable:function(){var t=this.p.currentMediaSource();return t&&t.input&&t.input.repeatWatchTimeSeekable},repaireCurrentTime:function(t){this.p.currentMediaSource();if(this.isRepeatWatchTimeSeekable()){this.endValue()<t&&this.max(t)}},enableSeekTo:function(t){var e=this.isShowRepeatMarker;if(1===e){if(this.minValue>t)return!1}else if(2===e||!0===e){if(this.minValue>t)return!1;if(this.maxValue<t)return!1}return!0},getEnableValue:function(t){var e=this.isShowRepeatMarker;if(1===e){if(this.minValue>t)return this.minValue}else if(2===e||!0===e){if(this.minValue>t)return this.minValue;if(this.maxValue<t)return this.maxValue}return t},enableRepeat:function(t){l.error("This is deprecate function (enableRepeat) !!!")},showButton:function(){this.__repeatBtn.showButton(this.attr.repeatBtn)},hideButton:function(){this.__repeatBtn.hideButton(this.attr.repeatBtn)},isRepeat:function(t){(!t&&!1===t||t)&&(this.attr.isRepeat=t);var e=this.attr.isRepeat;return!(!e&&!1===e)}});return s})}();!function(){"use strict";var o=getDframework(),u=o.module("imgtech.media.Media");o.define("imgtech.media.module.Rate",function(){var n=o.module("imgtech.media.ModuleInterface");o.module("imgtech.media.extends.Menu");function t(t){n.apply(this,arguments);if(t){var e=this.attr,i=this.p.userElement;this.__rateLayout=o.query(i,".mpv-rate-layout");this.__rateHelper=o.queryAll(i,".mpv-rate-helper");this.__rateBtn=this.p.getButton("rateBtn");this.__rateDownBtn=this.p.getButton("rateDownBtn");this.__rateUpBtn=this.p.getButton("rateUpBtn");this.__rateText=this.p.getButton("rateText");this.setUseTypeClass();this.__rateBtn.initButton(e.rateBtn);this.__rateDownBtn.initButton(e.rateDownBtn);this.__rateUpBtn.initButton(e.rateUpBtn);this.__rateText.initButton(e.rateText)}}o.extendClass(t,n,{onAddEvent:function(){var e=this,i=this.p,t=this.p.userElement;this.layoutMod=this.p.module("layout");o.on(this.__rateDownBtn.all,"click",function(t){i.previousRate();return o.igEventAll(t)});o.on(this.__rateUpBtn.all,"click",function(t){i.nextRate();return o.igEventAll(t)});o.on(this.__rateBtn.all,"click",function(t){e.toggleMenu();return o.igEventAll(t)});new(o.module("imgtech.media.extends.Menu"))(this,{player:this.p,invalidate:!0,disableControl:!0,button:[this.__rateBtn],friend:[this.__rateLayout],element:o.query(t,".mpv-rate-menu")}).patchOverwrite();this.initRateValue()},onStateChange:function(t){var e,i=this.p;this.attr;switch(t.type){case u.EVENT.CLICK_EVENT:this.closeMenu();break;case u.EVENT.STATE_CHANGE:if(t.data==u.STATE.SETSOURCE){this.cleanMenu();this.closeMenu("clear");this.setUseTypeClass()}break;case u.EVENT.ON_BEFORE_PLAY:(e=i.getAvailablePlaybackRates())&&e.length&&!this.p.isLive()&&!this.p.isDVR()?this.showButton():this.hideButton();var n=i.getDefaultPlaybackRate();n?this.invalidate(n):this.invalidate();break;case u.EVENT.SET_RATE:var r,s=i.getPlaybackRate(),a=i.getAvailablePlaybackRates();if(a)switch(t.data){case"increment":for(r=0;r<a.length;r++)if(s<a[r].value)return i.setPlaybackRate(a[r]);break;case"decrement":for(r=a.length-1;0<=r;r--)if(s>a[r].value)return i.setPlaybackRate(a[r])}break;case u.EVENT.RATE_CHANGE:this.invalidate(t.data);break;case u.EVENT.SET_PLAYBACK_RATE:this.setPlaybackRate(t.data)}},setPlaybackRate:function(t){var e=this.attr,i=this.p.device(),n=this.p.currentMediaSource();return n.isAD()||n.isVAST()||!1===e.use?null:i?i.setPlaybackRate(t):null},currentValue:function(){var t,e,i=this.p,n=i.getAvailablePlaybackRates(),r=i.getPlaybackRate();if(n&&r)for(t=0;t<n.length;t++)if((e=n[t]).value===r)return e.cvalue?e.cvalue:e.context?e.context:e.value;return"1.0"},isEnableMenu:function(){var t,e=this.p;return!e.isLive()&&!e.isDVR()&&!(!(t=e.getAvailablePlaybackRates())||!t.length)},isSubMenu:function(){return!0},setUseTypeClass:function(){if("button"==this.attr.useType){o.removeClass(this.__rateLayout,"mpv-rate-type-list");o.addClass(this.__rateLayout,"mpv-rate-type-button")}else{o.addClass(this.__rateLayout,"mpv-rate-type-list");o.removeClass(this.__rateLayout,"mpv-rate-type-button")}},invalidate:function(t){t&&o.text(this.__rateHelper,(t.cvalue?t.cvalue:t.value)+"");this.isOpenMenu()&&this.openMenu();this.invalidateOwner()},showButton:function(){var t=this.attr;this.__rateBtn.showButton(t.rateBtn);this.__rateDownBtn.showButton(t.rateDownBtn);this.__rateUpBtn.showButton(t.rateUpBtn)},hideButton:function(){var t=this.attr;this.__rateBtn.hideButton(t.rateBtn);this.__rateDownBtn.hideButton(t.rateDownBtn);this.__rateUpBtn.hideButton(t.rateUpBtn)},initRateValue:function(){var t,e,i=this.attr.rateInfo;if(i)for(var n=0;n<i.length;n++)if(1==(t=u.getRateValue(i[n])).value){e=t;break}e&&this.invalidate(e)},getMenuList:function(){return this.p.getAvailablePlaybackRates()},drawMenu:function(t,e){var i=this,n=o.query(t,".mpv-view-checked"),r=o.query(t,".mpv-view-text"),s=e.cvalue?e.cvalue:e.context?e.context:e.value,a=this.p.getPlaybackRate();o.attr(t,"value",e.value);if(a&&e.value===a){o.addClass(t,"mpv-option-selected");n&&o.attr(n,"checked",!0)}r&&(r.innerText=s);"line"==e.view?o.addClass(t,"mpv-view-line"):o.on(t,"click",function(t){i.p.setPlaybackRate(e.value);i.closeMenu()})}});return t})}();!function(){"use strict";var y=getDframework(),o=y.module("imgtech.media.Media");y.define("imgtech.media.module.PlaylistInput",function(){var n=y.module("imgtech.media.ModuleInterface"),i=y.module("imgtech.media.extends.Popup");function t(t){n.apply(this,arguments);if(t){var e=this.p.userElement,i=this.attr;this.__parent=null;this.__inputLayout=y.query(e,".mpv-playlist-input-layout");this.__inputBox=y.query(this.__inputLayout,".mpv-playlist-box");this.__inputTitleLayout=y.query(this.__inputLayout,".mpv-playlist-title");this.__inputImageLayout=y.query(this.__inputLayout,".mpv-playlist-image");this.__inputTextLayout=y.query(this.__inputLayout,".mpv-playlist-text");this.__inputTitle=y.query(this.__inputLayout,".mpv-playlist-title-input");this.__inputSrc=y.query(this.__inputLayout,".mpv-playlist-src-input");this.__inputImage=y.query(this.__inputLayout,".mpv-playlist-image-input");this.__inputText=y.query(this.__inputLayout,".mpv-playlist-text-input");this.__inputConfirmBtn=y.query(this.__inputLayout,".mpv-playlist-confirm-btn");this.__inputCloseBtn=y.query(this.__inputLayout,".mpv-playlist-close-btn");y.addClass(this.__inputTitleLayout,i.useName?"mpv-with-name":"mpv-hide");y.addClass(this.__inputImageLayout,i.useImage?"mpv-with-image":"mpv-hide");y.addClass(this.__inputTextLayout,i.useText?"mpv-with-text":"mpv-hide")}}y.extendClass(t,n,{onAddEvent:function(){var e=this,t=this.attr.input;this.keyMod=this.p.module("key");if(this.__inputBox){y.on(this.__inputBox,"click",function(t){return y.igEventAll(t)});y.on(this.__inputBox,"dblclick",function(t){return y.igEventAll(t)})}y.attr(this.__inputTitle,"maxlength",t&&t.nameLength?t.nameLength:30);t&&t.srcLength&&y.attr(this.__inputSrc,"maxlength",t.srcLength);t&&t.imageLength&&y.attr(this.__inputImage,"maxlength",t.imageLength);t&&t.textLength&&y.attr(this.__inputText,"maxlength",t.textLength);y.on(this.__inputConfirmBtn,"click",function(t){e.confirmInput();return y.igEventAll(t)});y.on(this.__inputCloseBtn,"click",function(t){e.closeMenu();return y.igEventAll(t)});new i(this,{player:this.p,disableControl:!0,button:[],friend:[],element:this.__inputLayout}).patchOverwrite()},alertUi:function(t,e){this.__parent.alertUi(t,e)},__openMenu:function(){var t=this.__inputTitle,e=this.__inputSrc,i=this.__inputImage,n=this.__inputText;t&&(t.value="");e&&(e.value="");i&&(i.value="");n&&(n.value="");this.__inputLayout&&this.keyMod&&this.keyMod.disable()},__closeMenu:function(){this.__inputLayout&&this.keyMod&&this.keyMod.enable()},confirmInput:function(){var t=this.attr,e=t.input,i=this.__inputTitle,n=this.__inputSrc,r=this.__inputImage,s=this.__inputText,a=i&&i.value&&i.value.trim(),o=n&&n.value&&n.value.trim(),u=r&&r.value&&r.value.trim(),l=s&&s.value&&s.value.trim();if(!a&&t&&t.useName)return this.alertUi(this.__parent.MESSAGE.M0002);if(!o)return this.alertUi(this.__parent.MESSAGE.M0003);if(!u&&t&&"need"==t.useImage)return this.alertUi(this.__parent.MESSAGE.M0004);if(!l&&t&&"need"==t.useText)return this.alertUi(this.__parent.MESSAGE.M0011);if(this.__parent.addPlaylistData({name:a,src:o,image:u,text:l})){e&&!1!==e.hideAfterAppend&&this.closeMenu();this.alertUi(this.__parent.MESSAGE.M0006)}}});return t});y.define("imgtech.media.module.Playlist",function(){var n=y.module("imgtech.media.ModuleInterface"),s=y.module("imgtech.media.extends.Menu"),r=y.module("imgtech.media.module.PlaylistInput"),a=y.module("imgtech.media.Source");function t(t){n.apply(this,arguments);if(t){this.__sliceCanvas=null;var e=this.p.userElement,i=this.attr;this.MESSAGE={M0001:"\ubbf8\ub514\uc5b4\uac00 \uc874\uc7ac \ud558\uc9c0 \uc54a\uac70\ub098 \uc7ac\uc0dd\uc2dc\uac04\uc744 \uc54c \uc218 \uc5c6\ub294 \ubbf8\ub514\uc5b4 \uc785\ub2c8\ub2e4.",M0002:"\uc774\ub984\uc774 \uc874\uc7ac \ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",M0003:"\ubbf8\ub514\uc5b4 \uc8fc\uc18c\uac00 \uc874\uc7ac \ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",M0004:"\uc774\ubbf8\uc9c0\uac00 \uc874\uc7ac \ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",M0005:"\uc601\uc0c1\uc774 \uc5c6\uac70\ub098, \ub4f1\ub85d \uc2dc\uac04\uc774 \ucc98\uc74c \ud639\uc740 \uc885\ub8cc \uad6c\uac04\uc5d0 \uc18d\ud558\uc5ec \ucc45\uac08\ud53c\ub97c \ub4f1\ub85d \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",M0006:"\ud50c\ub808\uc774 \ub9ac\uc2a4\ud2b8\uc5d0 \ub4f1\ub85d \ub418\uc5c8\uc2b5\ub2c8\ub2e4.",M0008:"{_name} \ubbf8\ub514\uc5b4\ub97c \uc0ad\uc81c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",M0009:"\uc601\uc0c1\uc774 \uc5c6\uac70\ub098 \ud50c\ub808\uc774 \uc2dc\uac04\uc744 \ud655\uc778 \ud560 \uc218 \uc5c6\uc5b4 \ubd81\ub9c8\ud06c\ub97c \ub4f1\ub85d \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",M0010:"\ud50c\ub808\uc774\ub9ac\uc2a4\ud2b8\ub294 \ucd5c\ub300 {maxSize}\uac1c\ub97c \ucd08\uacfc \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",M0011:"\uc124\uba85\uc774 \uc874\uc7ac \ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."};this.setMessage(this.attr.message);this.__playlistLayout=y.query(e,".mpv-playlist-layout");this.__previousBtn=this.p.getButton("previousBtn");this.__nextBtn=this.p.getButton("nextBtn");this.__playlistAddBtn=this.p.getButton("playlistAddBtn");this.__playlistMenuBtn=this.p.getButton("playlistMenuBtn");this.__previousBtn.initButton(i.previousBtn);this.__nextBtn.initButton(i.nextBtn);this.__playlistAddBtn.initButton(i.addBtn);this.__playlistMenuBtn.initButton(i.menuBtn);y.removeClass(this.__playlistLayout,"mpv-hide");this.inputMod=new r(this.p,this.c,i);(this.inputMod.__parent=this).__slices=[];this.__slicesIndex=-1;this.__sliceNextSource=null;this.__playerLayout=y.query(e,".mpv-player");this.__deviceLayout=y.query(e,".mpv-device");this.__sliceElement=document.createElement("div");y.addClass(this.__sliceElement,"mpv-device-slice");this.__slice_touch_next_source=undefined}}y.extendClass(t,n,{onAddEvent:function(){var e=this,t=this.p.userElement,i=y.module("imgtech.media.extends.Confirm"),n=y.module("imgtech.media.extends.Alert");this.inputMod.onAddEvent();this.confirm=new i({player:this.p});this.alert=new n({player:this.p});y.on(this.__previousBtn.all,"click",function(t){e.previous();return y.igEventAll(t)});y.on(this.__nextBtn.all,"click",function(t){e.next();return y.igEventAll(t)});(function r(t){function e(e){var i=this,n=this.attr.input;y.on(e,"click",function(t){i.inputMod.isOpenMenu()?i.inputMod.closeMenu():i.isOpenMenu()&&(y.hasClass(e,"mpv-in-box")||n&&n.linkControlBtn)?i.addCurrentPlaylist():i.addCurrentPlaylist({clear:!0});return y.igEventAll(t)})}if(y.isArray(t))for(var i=0;i<t.length;i++)e.call(this,t[i]);else e.call(this,t)}).call(this,this.__playlistAddBtn.all);y.on(this.__playlistMenuBtn.all,"click",function(t){e.inputMod.closeMenu();e.toggleMenu();return y.igEventAll(t)});y.on(this.__sliceElement,"animationend",function(t){e.sliceAnimationEnd(t)});new s(this,{player:this.p,invalidate:!0,disableControl:!0,button:[],friend:[],element:y.query(t,".mpv-playlist-menu")}).patchOverwrite()},onStateChange:function(t){var e,i,n,r=this.attr,s=r.input,a=this;switch(t.type){case o.EVENT.CLICK_EVENT:this.inputMod.isOpenMenu()?s&&s.closeOnClick&&this.inputMod.closeMenu():r.closeOnClick&&this.closeMenu();break;case o.EVENT.STATE_CHANGE:if(t.data==o.STATE.SETSOURCE){this.__slice_touch_next_source=undefined;this.__slice_touch_last_source_time_change=0;this.isOpenMenu()&&this.openMenu();if(7===y.b.ie){y.removeClass(this.__playlistLayout,"mpv-hide");y.removeClass(this.__playlistLayout,"mpv-1btn");y.removeClass(this.__playlistLayout,"mpv-2btn");r.addBtn&&r.addBtn.hideButton&&r.menuBtn&&r.menuBtn.hideButton?y.addClass(this.__playlistLayout,"mpv-hide"):r.addBtn&&!r.addBtn.hideButton&&r.menuBtn&&!r.menuBtn.hideButton?y.addClass(this.__playlistLayout,"mpv-2btn"):(r.addBtn&&!r.addBtn.hideButton||r.menuBtn&&!r.menuBtn.hideButton)&&y.addClass(this.__playlistLayout,"mpv-1btn")}this.showButton()}else t.data==o.STATE.ENDED&&setTimeout(function(){a.isSliceTouch()?a.sliceLeft():a.p.next()},1);break;case o.EVENT.CURRENT_TIME_CHANGE:if(this.isSliceTouch()&&(e=this.p.currentMediaSource())){i=t.data.currentTime;if(0===(n=this.__slice_touch_last_source_time_change)||2<=Math.abs(i-n)){this.__slice_touch_last_source_time_change=i;this.p.screenShot(function(t){e.playlistScreenShotData=t})}}}},previous:function(){var t=this.p,e=this.attr;e.previous?e.previous.call(t):t.previous()},next:function(){var t=this.p,e=this.attr;e.next?e.next.call(t):t.next()},currentValue:function(){var t=this.attr,e=!!t.useConfigList,i=t.unitName?t.unitName:" \uac1c",n=this.p.mediaSource();return e&&n&&n.length?n.length+i:"0"+i},isEnableMenu:function(){var t=!!this.attr.useConfigList,e=this.p.mediaSource();return!!(t&&e&&e.length)},isSubMenu:function(){return!0},showButton:function(){var t=this.attr;this.__playlistAddBtn.showButton(t.addBtn);this.__playlistMenuBtn.showButton(t.menuBtn)},hideButton:function(){var t=this.attr;this.__playlistAddBtn.hideButton(t.addBtn);this.__playlistMenuBtn.hideButton(t.menuBtn)},setMessage:function(t){for(var e in t)this.MESSAGE[e]=t[e]},alertUi:function(t,e){var i=this.attr,n=this.alert,r=this.regexp2string(t,e);return i.message.alertAutoHide?n.show(r,{autohide:i.message.alertAutoHide}):n.show(r)},regexp2string:function(t,e){var i,n,r=t,s=r.match(/\{[\s\S]+?\}/g);if(!s||s&&!s.length)return r;e._name=e?e.name?e.name:e.src?e.src:"":"";for(var a=0;a<s.length;a++)if((i=s[a])&&(n=i.substring(1,i.length-1).trim())){var o=e[n]+"";(o=o&&o.trim())&&(r=r.replace(i,o))}return r},maxSize:function(){var t=this.attr;return t.size?t.size:0===t.size?0:10},addCurrentPlaylist:function(t){t&&t.clear&&this.p.closeAllMenu("clear");return this.inputMod.openMenu(this.isOpenMenu()?{caller:this}:undefined)},addPlaylistData:function(t){var e=this.attr,i=e.input,n=this.maxSize(),r=this.p.mediaSource();if(r){if(n&&n<=r.length)return this.alertUi(this.MESSAGE.M0010,{maxSize:n});r.push(new a(t,this.p));(this.isOpenMenu()||i&&!0===i.showAfterAppend)&&this.openMenu();e.add&&e.add.call(this.p,t);return!0}},removeData:function(t){var e=this.p.mediaSource();if(e&&e.length)for(var i=0;i<e.length;i++)if(e[i]===t)return e.splice(i,1)},getMenuList:function(){var t=this.p.mediaSource();return t&&t.length?t:null},drawMenu:function(i,n){var r=this,s=this.attr,t=y.query(i,".mpv-playlist-menu-nm"),e=y.query(i,".mpv-playlist-menu-del-btn"),a=y.query(i,".mpv-view-checked"),o=n.input,u=this.p.index(n),l=this.p.currentMediaSource(),h=this.p.getSwitchSourceData();if(l===n||h&&h===n){y.addClass(i,"mpv-option-selected");a&&y.attr(a,"checked",!0)}y.text(t,o.name?o.name:o.src?o.src:"-");y.on(e,"click",function(t){var e=r.regexp2string(r.MESSAGE.M0008,o);r.confirm.show(e,function(t){if(t){r.removeData(n);y.remove(i);s.remove&&s.remove.call(r.p,o)}});return y.igEventAll(t)});y.b.ie&&y.b.ie<9?y.on(t,"click",function(t){-1!==u&&r.p.index(u);return y.igEventAll(t)}):y.on(i,"click",function(t){-1!==u&&r.p.index(u);return y.igEventAll(t)})},isSliceTouch:function(){var t=this.attr,e=t&&t.slice;return!y.b.ie&&e&&e.useSlice&&e.useSliceTouch},sliceAnimationEnd:function(t){var e=this.__deviceLayout,i=this.__sliceElement;y.remove(i);y.removeClass(e,"animate-left");y.removeClass(i,"animate-left");y.removeClass(e,"animate-right");y.removeClass(i,"animate-right");this.__sliceING=!1},sliceLeft:function(e){if(this.isSliceTouch()&&!this.__sliceING){this.__sliceING=!0;var i=this,n=this.p,r=this.__deviceLayout,s=this.__sliceElement;n.pause();y.remove(s);n.screenShot(function(t){i.patchSliceAutoContinueTime();s.style.backgroundImage="url("+t.dataUrl+")";y.addClass(r,"animate-left");y.addClass(s,"animate-left");y.after(r,s);e?n.source(e):n.next()})}},sliceRight:function(e){if(!this.isSliceTouch())return this.p.previous();if(!this.__sliceING){this.__sliceING=!0;var i=this,n=this.p,r=this.__deviceLayout,s=this.__sliceElement;n.pause();y.remove(s);n.screenShot(function(t){i.patchSliceAutoContinueTime();s.style.backgroundImage="url("+t.dataUrl+")";y.addClass(r,"animate-right");y.addClass(s,"animate-right");y.after(r,s);e?n.source(e):n.previous()})}},sliceTouch:function(t,e){function i(){var t=this.__slice_touch_next_source;t&&(t.playlistScreenShotData?u.style.backgroundImage="url("+t.playlistScreenShotData.dataUrl+")":t.input&&t.input.playlistScreenShotPoster&&(u.style.backgroundImage="url("+t.input.playlistScreenShotPoster+")"));f+=m;p+=m;if("left"==this.__touch_slice_type){if((c=h+p)<0)return;u.style.left=c+"px"}else if("right"==this.__touch_slice_type){if(0<(c=-h+p))return;u.style.left=c+"px"}o.style.left=f+"px";this.__touch_slice_rx_device=f;this.__touch_slice_rx_space=p}if(this.isSliceTouch()){var n=this.attr,r=n&&n.slice,s=this,a=this.__playerLayout,o=this.__deviceLayout,u=this.__sliceElement,l=y.getBoundingClientRect(a),h=l?l.width():0;if(h){var c,d=this.__touch_slice_type,f=this.__touch_slice_rx_device,p=this.__touch_slice_rx_space,m=t-e;f||(f=0);p||(p=0);if(d)return i.call(this);if(m<0)this.__touch_slice_type="left";else{if(!(0<m))return y.warn("Not found touch slice type at playlist module. dx: "+m);this.__touch_slice_type="right"}if(r&&r.startDragCallback)return r.startDragCallback.call(this,{type:this.__touch_slice_type,currentMediaSource:this.p.currentMediaSource()},function(t){var e=s.p.createSource(t)[0];if(!1!==(s.__slice_touch_next_source=e)){y.remove(u);y.after(o,u);return i.call(s)}});y.remove(u);y.after(o,u);i.call(this)}}},patchSliceAutoContinueTime:function(){var t=this.attr,e=t&&t.slice,i=e&&e.limitContinueTime,n=this.p.currentMediaSource();if(n)if("front"==i)n.input.autoContinueTime=0;else if(i){var r=this.p.currentTime(),s=this.p.duration();n.input.autoContinueTime=s-i<r?0:r}},sliceTouchReset:function(){var a=20,o=this,t=this.attr,e=t&&t.slice,i=e&&e.slicePercent,n=i||.5,r=this.__playerLayout,u=this.__deviceLayout,l=this.__sliceElement,s=y.getBoundingClientRect(r),h=s.width(),c=h?s.right-h*n:null,d=h?h*n+s.left:null,f=y.getBoundingClientRect(l),p=this.__touch_slice_type;function m(){y.b.ie?u.style.left="auto":u.style.left="initial";y.remove(l)}function g(r){setTimeout(function(){!function n(){var t=h/20,e=parseInt(u.style.left),i=parseInt(l.style.left);if("left"==r){0<(e+=t)&&(e=0);i+=t;u.style.left=e+"px";l.style.left=i+"px";if(0<=e)return setTimeout(function(){m()},a)}else if("right"==r){(e-=t)<0&&(e=0);i-=t;u.style.left=e+"px";l.style.left=i+"px";if(e<=0)return setTimeout(function(){m()},a)}setTimeout(function(){n()},a)}()},a)}function v(r){function s(){this.patchSliceAutoContinueTime();var t=this.__slice_touch_next_source;t?this.p.source(t):"left"==r?this.p.next():this.p.previous();!function e(){y.b.ie?u.style.left="auto":u.style.left="initial";y.remove(l)}()}setTimeout(function(){!function n(){var t=h/20,e=parseInt(u.style.left),i=parseInt(l.style.left);if("left"==r){e-=t;(i-=t)<0&&(i=0);u.style.left=e+"px";l.style.left=i+"px";if(i<=0)return setTimeout(function(){s.call(o)},a)}else if("right"==r){e+=t;0<(i+=t)&&(i=0);u.style.left=e+"px";l.style.left=i+"px";if(0<=i)return setTimeout(function(){s.call(o)},a)}setTimeout(function(){n()},a)}()},a)}if(!this.isSliceTouch())return m();if(!p)return m();c&&d&&("left"==p?f.left<c?v(p):g(p):"right"==p&&(f.right>d?v(p):g(p)));this.__touch_slice_type=undefined;this.__touch_slice_rx_device=undefined;this.__touch_slice_rx_space=undefined}});return t})}();!function(){"use strict";var l=getDframework(),s=l.module("imgtech.media.Media");l.define("imgtech.media.module.Subtitle",function(){var n=l.module("imgtech.media.ModuleInterface"),r=l.module("imgtech.media.extends.Menu");function t(t){n.apply(this,arguments);if(t){var e=this.attr,i=this.p.userElement;this.__subtitleDisplay=l.query(i,".mpv-subtitle-display");this.__subtitleHelper=l.queryAll(i,".mpv-subtitle-helper");this.__subtitleBtn=this.p.getButton("subtitleBtn");this.__subtitleBtn.initButton(e.subtitleBtn)}}l.extendClass(t,n,{onAddEvent:function(){var e=this,t=this.p,i=this.attr,n=t.userElement;this.layoutMod=this.p.module("layout");l.on(this.__subtitleBtn.all,"click",function(t){if(!1!==t.isTrusted){i.toggle?e.toggle():e.toggleMenu();return l.igEventAll(t)}});new r(this,{player:this.p,invalidate:!0,disableControl:!0,button:[this.__subtitleBtn],friend:[],element:l.query(n,".mpv-subtitle-menu")}).patchOverwrite()},onStateChange:function(t){var e,i=this.p;switch(t.type){case s.EVENT.CLICK_EVENT:this.closeMenu();break;case s.EVENT.SET_PLAYBACK_SUBTITLE:this.hideContent();break;case s.EVENT.STATE_CHANGE:switch(t.data){case s.STATE.SETSOURCE:this.reset()}break;case s.EVENT.CURRENT_TIME_CHANGE:if(e=i.getPlaybackSubtitle()){e.instance&&e.instance.setCurrentTime&&e.instance.setCurrentTime(t.data);this.setCurrentSubtitle(e);if(!i.isPlaying()){var n=this.current();n&&n.instance&&n.instance.running(!0)}}break;case s.EVENT.SUBTITLE_EVENT:this.onSubtitleEvent(t)}},reset:function(){var t,e,i=this.p,n=!1;this.cleanMenu();this.closeMenu("clear");if(this.attr.use&&(t=i.getPlaybackSubtitle())&&!i.isLive()&&!i.isDVR()){n=!0;l.addClass(i.userElement,"mpv-on-subtitle");l.removeClass(i.userElement,"mpv-off-subtitle");this.setCurrentSubtitle(t);(e=i.device().currentMediaSource())&&e.setSubtitle();this.attr.hideButton||this.showButton()}if(!n){l.addClass(i.userElement,"mpv-off-subtitle");l.removeClass(i.userElement,"mpv-on-subtitle");this.setCurrentSubtitle(null);this.hideButton()}this.hideContent()},currentValue:function(){var t=this.p.getPlaybackSubtitle();return t?t.label?t.label:t.code:""},isEnableMenu:function(){var t,e=this.p;return!e.isLive()&&!e.isDVR()&&!(!(t=e.getAvailableSubtitles())||!t.length)},isSubMenu:function(){return!0},onSubtitleEvent:function(t){var e,i,n=this.p;if("loaded"==t.data){this.hideContent();if(e=n.getPlaybackSubtitle()){this.setCurrentSubtitle(e);t.subtitle&&t.subtitle.running(!0);(i=n.device().currentMediaSource())&&i.play()}else this.p.error("Not found playback subtitle : ",t)}else if("show"==t.data){this.hideContent();if(t.subdata){var r,s,a=[];if(l.isArray(t.subdata.contents))for(r=0;r<t.subdata.contents.length;r++)(s=(s=t.subdata.contents[r])?s.trim():"")&&a.push(s);else(s=(s=t.subdata.contents)?s.trim():"")&&a.push(s);var o=document.createElement("div");l.addClass(o,"mpv-subtitle-content");for(r=0;r<a.length;r++){var u=document.createElement("div");l.addClass(u,"mpv-subtitle-text");u.innerHTML=a[r];this.attr.onlyText&&(u.innerText=u.innerText.trim());o.appendChild(u)}l.append(this.__subtitleDisplay,o);l.text(this.__subtitleDisplay).trim()?this.showContent():this.hideContent()}}else"hide"==t.data&&this.hideContent()},showContent:function(){l.removeClass(this.__subtitleDisplay,"mpv-hide");l.addClass(this.__subtitleBtn.all,"cont_on");l.removeClass(this.__subtitleBtn.all,"cont_off")},hideContent:function(){l.text(this.__subtitleDisplay,"");l.addClass(this.__subtitleDisplay,"mpv-hide");l.removeClass(this.__subtitleBtn.all,"cont_on");l.addClass(this.__subtitleBtn.all,"cont_off")},showButton:function(){this.__subtitleBtn.showButton(this.attr.subtitleBtn)},hideButton:function(){this.__subtitleBtn.hideButton(this.attr.subtitleBtn)},setCurrentSubtitleLabel:function(t){l.text(this.__subtitleHelper,t||"")},setCurrentSubtitle:function(t){this.setCurrentSubtitleLabel(t?t.label:null);this.isOpenMenu()&&this.openMenu()},current:function(){var t=this.index();return null!==t?this.getSubtitle(t):null},index:function(){var t,e=this.p,i=e.getAvailableSubtitles(),n=e.getPlaybackSubtitle();if(i&&i.length)for(t=0;t<i.length;t++)if(i[t].code===n.code)return t;return null},getSubtitle:function(t){var e=this.p.getAvailableSubtitles(),i=e&&e.length;if(i&&0<=t&&t<i)return e[t]},setSubtitle:function(t){var e,i=this.p,n=i.getAvailableSubtitles(),r=i.getPlaybackSubtitle(),s=-1;if(n&&n.length){for(e=0;e<n.length;e++)if(n[e].code===r.code){s=e;break}s!==t&&(s=t);s>=n.length&&(s=0);i.setPlaybackSubtitle(n[s])}},toggle:function(){var t,e=this.p,i=e.getAvailableSubtitles(),n=e.getPlaybackSubtitle(),r=-1;if(i&&i.length){for(t=0;t<i.length;t++)if(i[t].code===n.code){r=t;break}++r>=i.length&&(r=0);e.setPlaybackSubtitle(i[r]);this.update()}},getMenuList:function(){return this.p.getAvailableSubtitles()},drawMenu:function(t,e){var i=this,n=this.p,r=e.label?e.label:e.code,s=n.getPlaybackSubtitle(),a=l.query(t,".mpv-view-checked"),o=l.query(t,".mpv-view-text");if("line"==e.view)return l.addClass(t,"mpv-view-line");l.attr(t,"code",e.code);if(s&&e.code===s.code){l.addClass(t,"mpv-option-selected");a&&a.setAttribute("checked",!0)}o&&l.text(o,r);l.on(t,"click",function(t){e!==n.getPlaybackSubtitle()&&i.p.setPlaybackSubtitle(e);i.closeMenu();i.update()})},update:function(){var t=this;setTimeout(function(){(function n(){var t=this.p;if(t.getPlaybackSubtitle()&&!t.isPlaying()){var e=this.current(),i=e?e.instance:null;i&&i.running&&i.running(!0)}}).call(t)},1)}});return t})}();!function(){"use strict";var a=getDframework(),e=a.module("imgtech.media.Media");a.define("imgtech.media.module.Version",function(){var i=a.module("imgtech.media.ModuleInterface");function t(t){i.apply(this,arguments);if(t){var e=this.p.userElement;this.__isShow=!1;this.__device=a.query(e,".mpv-device")}}function n(t){if(this.__isShow)return a.igEventAll(t);var e=this.getName(),i=this.getVersion(),n=this.attr,r=n&&"number"==typeof n.wait&&1e3<n.wait?n.wait:2e3,s=this;this.element=a.element("<div class='mpv-version-box mpv-zindex'>\n  <div class='mpv-version-ibox'>\n    <div class='mpv-version-text'></div>\n  </div>\n</div>\n");this.showVersion(e,i);this.__isShow=!0;setTimeout(function(){s.hideVersion()},r);return n.ignoreEvent?a.igEventAll(t):void 0}a.extendClass(t,i,{onAddEvent:function(){var e=this;a.on(this.c.resourceElement,"contextmenu",function(t){return n.call(e,t)});a.on(this.__device,"contextmenu",function(t){return n.call(e,t)})},onStateChange:function(t){},getName:function(){return"zone@html5player"},getVersion:function(){return e.version},hideVersion:function(){a.remove(this.element);this.__isShow=!1},showVersion:function(t,e){var i,n=this.attr;try{n&&n.callback&&(i=n.callback(t,e))}catch(r){this.p.error(r)}a.isElement(i)?this.element=i:a.html(a.query(this.element,".mpv-version-text"),t+" ("+e+")<br> by IMGTech");a.append(this.c.resourceElement,this.element)}});return t})}();!function(){"use strict";var l=getDframework();l.module("imgtech.media.Media");l.define("imgtech.media.module.Key",function(){var i=l.module("imgtech.media.ModuleInterface");function s(t){i.apply(this,arguments);if(t){var r=this.attr,e=this.p.userElement;this.__device=l.query(e,".mpv-device");this.__osd=l.query(e,".mpv-osd");this.__control=l.query(e,".mpv-control");this._pauseImage=l.query(e,".mpv-pause-image");this._recommend=l.query(e,".mpv-recommend-layer");this.isFocus=!1;this._enableStatus=!0;this.__disableMods=[];this.keys={};this.keyvalues={};!function(t){var e,i;for(e in s.KEYS)t.keys[e]=s.KEYS[e];if(r.keys)for(e in r.keys)t.keys[e]=r.keys[e];for(e in t.keys){i=t.keys[e];for(var n in i)i[n]&&(t.keyvalues[i[n]]=e)}}(this)}}s.KEYS={EXIT_FS:[27],TOGGLE:[32,83],SEEK_MINUS:[37],SEEK_PLUS:[39],VOLUME_PLUS:[38],VOLUME_MINUS:[40],TOGGLE_FS:[70],TOGGLE_MUTE:[77],SIZE:[78],NEXT_RATE:[107,187,61,43],PREVIOUS_RATE:[109,189,45,95],TAB:[19],ENTER:[13]};l.extendClass(s,i,{onAddEvent:function(){this.repMod=this.p.module("repeat");this.progressMod=this.p.module("progress");this.volumeMod=this.p.module("volume");var i=this;this.focusElements=[this.__device,this.__osd,this.__control,this._pauseImage,this._recommend];this.focusElements.forEach(function(t){!function e(t){if(t){l.on(t,"click",function(t){i.focus(t)});l.on(t,"mouseover",function(t){i.focus(t)})}}(t)});l.on(document,"click",function(t){i.clickDocument(t)});l.on(document,"keydown",function(t){if(!t){l.error("Not found keydown event !!!");t=window.event}i.onKeyDown(t)})},onStateChange:function(t){},enable:function(){this._enableStatus=!0},disable:function(){this._enableStatus=!1},disableMod:function(t){if(!t)throw new Error("Not found module parameter.");var e,i,n=this.__disableMods;for(e=n.length-1;0<=e;e--)if(n[e]===t){i=!0;break}i||n.push(t)},enableMod:function(t){if(!t)throw new Error("Not found module parameter.");var e,i=this.__disableMods;for(e=i.length-1;0<=e;e--)i[e]===t&&i.splice(e,1)},userKey:function(t){this.enableUserKey=t},clickDocument:function(t){var e=t.target||t.srcElement;(function n(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1})(this.focusElements,e)||this.focus(!1)},focus:function(t){this.isFocus=t},isEnable:function(){return!!this._enableStatus&&(!this.__disableMods.length&&("boolean"==typeof this.enableUserKey?this.enableUserKey:this.isFocus))},deleteKey:function(t){for(var e in this.keyvalues)e==t&&delete this.keyvalues[e]},deleteAllCode:function(t){for(var e in this.keyvalues)this.keyvalues[e]===t&&delete this.keyvalues[e]},addKey:function(t,e,i){i&&this.deleteAllCode(e);if(l.isArray(t))for(var n in t)this.keyvalues[t[n]]=e;else this.keyvalues[t]=e},getKey:function(t){return this.keyvalues[t.which||t.keyCode]},ignoreFullscreen:function(){var t=this.attr;if(!0===t.ignoreFullscreen)return!0;try{if(t.ignoreFullscreen.apply(this))return!0}catch(e){}var i=this.p.module("layout");return!(!i||!i.ignoreFullscreen())},onKeyDown:function(t,e){if(this.attr.use&&this.isEnable()){var i,n=this.p,r=this.getKey(t),s=!0,a=this.attr,o=a.ignoreKey||a.ignoreKeys;if(!o||!o[r]){switch(r){case"RESET_RATE":n.resetRate();break;case"EXIT_FS":(i=this.getModuleObject("size"))&&i.isWindowFullscreen()&&n.exitFullscreen();break;case"TOGGLE":n.toggle();break;case"SEEK_MINUS":this.progressMod&&this.progressMod.previousSkip();break;case"SEEK_PLUS":this.progressMod&&this.progressMod.nextSkip();break;case"VOLUME_PLUS":this.volumeMod&&this.volumeMod.plus();break;case"VOLUME_MINUS":this.volumeMod&&this.volumeMod.minus();break;case"TOGGLE_FS":if(this.ignoreFullscreen())return l.igEventAll(t);var u=!0;l.b.ie&&11==l.b.ie&&a.disableFullscreenIe11&&(u=!1);u&&n.toggleFullscreen();break;case"TOGGLE_MUTE":n.toggleMute();break;case"SIZE":(i=this.getModuleObject("size"))&&i.next();break;case"NEXT_RATE":n.nextRate();break;case"PREVIOUS_RATE":n.previousRate();break;default:s=!1}return s?l.igEventAll(t):void 0}}}});return s})}();!function(){"use strict";var c=getDframework(),s=c.module("imgtech.media.Media"),a=s.ERROR;c.define("imgtech.media.module.SwitchSource",function(){var i=c.module("imgtech.media.ModuleInterface"),n=c.module("imgtech.media.extends.Menu");function r(t){i.apply(this,arguments);if(t){var e=this.p.userElement;this.__lastSelectedSwichSource=null;this.__switchSourceLayout=c.query(e,".mpv-switchsource-layout");this.__switchSourceHelper=c.queryAll(e,".mpv-switchsource-helper");this.__switchSourceBtn=this.p.getButton("switchSourceBtn");this.__switchSourceBtn.initButton(this.attr.switchSourceBtn)}}r.ERROR_CODE={E2001:"IE10 \uc774\uc0c1\uc5d0\uc11c \uc720\ud29c\ube0c\uc601\uc0c1\uc744 \uc7ac\uc0dd \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."};c.extendClass(r,i,{getErrorMessage:function(t){var e;if((e=this.attr.errorCode)&&e[t])return e[t];if((e=r.ERROR_CODE)&&e[t])return e[t];throw new Error("Not found error message (code: "+t+")")},onAddEvent:function(){var e=this,t=this.p.userElement;c.on(this.__switchSourceBtn.all,"click",function(t){e.toggleMenu();return c.igEventAll(t)});new n(this,{player:this.p,invalidate:!0,disableControl:!0,button:[],friend:[],element:c.query(t,".mpv-switchsource-menu")}).patchOverwrite()},onStateChange:function(t){var e,n,i,r=this;switch(t.type){case s.EVENT.CLICK_EVENT:this.attr.closeOnClick&&this.closeMenu();break;case s.EVENT.STATE_CHANGE:if(t.data==s.STATE.SETSOURCE){e=this.p.getSwitchSourceData();n=this.p.currentMediaSource();!e&&(i=n&&n.input)&&i.switchSource&&i.switchSource.length&&i.quality&&i.quality.length&&this.p.code(a.USAGE_SWITCH_SOURCE_QUALITY);e?this.showButton():this.hideButton();c.text(this.__switchSourceHelper,this.currentValue())}break;case s.EVENT.ON_BEFORE_PLAY:setTimeout(function(){var t=r.userSelectedSource,e=r.attr;if(r.userSelectedSource&&!e.async){if((n=r.p.currentMediaSource()).__isAD||n.__isVAST)return;if(n===t.source){r.p.setVolume(t.currentVolume);t.currentMuted?r.p.mute():r.p.unMute();r.p.setPlaybackRate(t.currentRate);var i=Math.floor(t.currentTime);i&&setTimeout(function(){r.p.seekTo(i)},50)}r.userSelectedSource=null}},1);break;case s.EVENT.ON_ERROR:this.errorSwitchSource(t)}},currentValue:function(){var t=this.__lastSelectedSwichSource;return t&&t.input&&t.input.playerName?t.input.playerName:"*"},isEnableMenu:function(){var t=this.getMenuList();return!!(t&&1<t.length)},isSubMenu:function(){return!0},hideButton:function(){this.__switchSourceBtn.hideButton(this.attr.switchSourceBtn)},showButton:function(){this.__switchSourceBtn.showButton(this.attr.switchSourceBtn)},invalidate:function(){c.text(this.__switchSourceHelper,this.currentValue());this.isOpenMenu()&&this.openMenu({lastSelectedSwichSource:this.__lastSelectedSwichSource});this.invalidateOwner()},errorSwitchSource:function(i){var t;if(i&&i.source&&(t=this.p.getSwitchSourceData())){var n=t.ss;if(!(n.length<2)){var e=function(){for(var t=0;t<n.length;t++){var e=n[t];if(e.__is_failed_count);else{if(e!==i.source)return e;e.__is_failed_count?e.__is_failed_count++:e.__is_failed_count=1}}return null}();if(!e)return c.error("Not found enable switch source !!!!");for(var r=0;r<n.length;r++){n[r].input.select=!1}e.input.select=!0;this.p.current()}}},patchSelectSource:function(t){var e=t.switchSource,n=e&&e.ss;(t=function(){if(!n)return null;for(var t=0;t<n.length;t++){var e=n[t];if(!0===e.input.select){if(!(c.b.ie&&c.b.ie<10&&"youtube"===e.deviceType()))return e;for(var i=0;i<n.length;i++)if("youtube"!==n[i].deviceType())return n[i];return null}}}())||(t=n&&n[0]);return this.__lastSelectedSwichSource=t},getMenuList:function(){var t=this.p.getSwitchSourceData();return t&&t.ss},drawMenu:function(t,r,e){var i=this,s=this.p.getSwitchSourceData(),n=r.input,a=this.p.currentMediaSource(),o=e&&e.lastSelectedSwichSource?e.lastSelectedSwichSource===r:a===r,u=c.query(t,".mpv-view-checked"),l=c.queryAll(t,".mpv-view-text");n&&n.patchClassName&&c.addClass(t,n.patchClassName);c.text(l,n.playerName);if(o){c.addClass(t,"mpv-option-selected");u&&c.attr(u,"checked",!0)}var h=c.b.ie&&c.b.ie<10&&"youtube"===r.deviceType();h&&c.addClass(t,"mpv-option-noselecting");c.on(t,"click",function(t){(function n(){if(h)alert(this.getErrorMessage("E2001"));else if(!o){for(var t=s.ss,e=0;e<t.length;e++){var i=t[e];i.input&&(i.input.select=!1)}r.input.select=!0;this.userSelectedSource={currentTime:this.p.currentTime(),currentRate:this.p.getPlaybackRate(),currentVolume:this.p.getVolume(),currentMuted:this.p.isMuted(),source:r};this.p.stop();this.p.current()}this.closeMenu()}).call(i);return c.igEventAll(t)})}});return r})}();!function(){"use strict";var f=getDframework(),h=f.module("imgtech.media.Media");f.define("imgtech.media.module.ContinueTime",function(){var i=f.module("imgtech.media.ModuleInterface");function t(t){i.apply(this,arguments)}f.extendClass(t,i,{onAddEvent:function(){},onStateChange:function(e){var i=this.p,n=this.attr,r=this;switch(e.type){case h.EVENT.CONTINUE_TIME:if(e.isAuto)return this.continueTime(e.data,e.isPlaying);var t=i.currentMediaSource(),s=n.message,a=s&&"string"!=typeof s?s(e.data):s;a||(a="\uc774\uc5b4\ubcf4\uae30 ( "+h.secondsToTimeString(e.data)+" )\ub97c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?");if(t){if(t.__reSourceCount){if(n.confirmRetry){var o=n.confirmRetry.call(this,t);return"number"==typeof o?this.continueTime(o,e.isPlaying):o?this.continueTime(e.data,e.isPlaying):this.continueTime(0,e.isPlaying)}if(n.autoRetry){f.error("Deprecate: autoRetry on continueTime module is deprecate. Use confirmRetry option.");return this.continueTime(e.data,e.isPlaying)}if(n.ignoreRetry){f.error("Deprecate: ignoreRetry on continueTime module is deprecate. Use confirmRetry option.");return this.continueTime(0,e.isPlaying)}}var u=getDframework().module("imgtech.media.extends.Confirm"),l=u&&new u({player:i});l?l.show(a,function(t){t?r.continueTime(e.data,e.isPlaying||n.autoplay):(r.p.isAutoplay()||n.autoplay)&&i.play()}):window.confirm(a)?this.continueTime(e.data,e.isPlaying||n.autoplay):(this.p.isAutoplay()||n.autoplay)&&i.play();this.countResource()}}},countResource:function(){var t=this.p.currentMediaSource();if(t){t.__reSourceCount||(t.__reSourceCount=0);t.__reSourceCount++}},continueTime:function(n,r){var s,a,o,u,l,h=this.p,c=(h.device(),!1),d=!1;setTimeout(function(){try{!function i(){if((s=h.currentMediaSource())&&(a=s.input)&&(o=a.preview)&&(u=o.data)&&u.length){for(var t=0;t<u.length;t++){if((l=u[t]).start>n){c=l.start;break}if(l.end<n){d=l.end-2;l.start>d&&(d=l.start)}}!1!==c?n=c:!1!==d&&(n=d)}a&&(a.autoContinueTime=a.continueTime=undefined);h.seekToContinueTime(n,r)}()}catch(e){f.error(e)}},1)},afterSeekTo:function(t){var e=this.p;e.callStateChange({type:h.EVENT.ON_BEFORE_PLAY});return!0===t?!e.isPlaying()&&e.play():!1===t?e.isPlaying()&&e.pause():e.isAutoplay()?e.play():void 0}});return t})}();!function(){"use strict";var s=getDframework(),n=s.module("imgtech.media.Media"),e=n.CN;s.define("imgtech.media.module.UI",function(){var r=s.module("imgtech.media.ModuleInterface");function t(t){r.apply(this,arguments);if(t){var e,i=this.attr,n=this.p.userElement;this.__toggleBtn=this.p.getButton("toggleBtn");this.__stopBtn=this.p.getButton("stopBtn");this.__popupBtn=this.p.getButton("popupBtn");this.__titleTextBtn=this.p.getButton("titleTextBtn");this.__titleText=this.p.getButton("titleText");this.__flashBtn=this.p.getButton("flashBtn");this.__rotateBtn=this.p.getButton("rotateBtn");this.__poster=s.query(n,".mpv-poster");this.__toggleBtn.initButton(i.toggleBtn);this.__stopBtn.initButton(i.stopBtn);this.__popupBtn.initButton(i.popupBtn);this.__titleTextBtn.initButton(i.titleText);this.__rotateBtn.initButton(i.rotateBtn);this.__disableToggle=[];this.hidePosterTime=i&&i.hidePosterTime?i.hidePosterTime:.1;this.____rotate_screen=0;(e=this.getPosterUrl())?this.showPoster(e):this.hidePoster()}}s.extendClass(t,r,{onAddEvent:function(){var e=this,i=this.p,t=s.module("imgtech.media.extends.Alert");this.alert=new t({player:this.p});s.on(this.__toggleBtn.all,"click",function(t){e.toggle();return s.igEventAll(t)});s.on(this.__stopBtn.all,"click",function(t){e.stop();return s.igEventAll(t)});s.on(this.__popupBtn.all,"click",function(t){i.popup();return s.igEventAll(t)});s.on(this.__flashBtn.all,"click",function(t){e.toggleFlashHelper();return s.igEventAll(t)});s.on(this.__titleTextBtn.all,"click",function(t){return s.igEventAll(t)});s.on(this.__rotateBtn.all,"click",function(t){e.rotate();return s.igEventAll(t)});this.updatePause()},onStateChange:function(t){var e,i;switch(t.type){case n.EVENT.STATE_CHANGE:if(t.data==n.STATE.SETSOURCE){this.hideTitle();if((e=this.p.currentMediaSource())&&e.input&&e.input.title){this.setTitle(e.input.title);this.showTitle()}(i=this.getPosterUrl())?this.showPoster(i):this.hidePoster()}switch(t.data){case n.STATE.PLAYING:this.updatePlaying();break;case n.STATE.CUED:case n.STATE.PAUSED:case n.STATE.ENDED:this.updatePause()}break;case n.EVENT.CURRENT_TIME_CHANGE:t.data.currentTime>this.hidePosterTime&&this.hidePoster()}},enableToggle:function(t){for(var e=this.__disableToggle.length-1;0<=e;e--)this.__disableToggle[e]===t&&this.__disableToggle.splice(e,1)},disableToggle:function(t){for(var e=this.__disableToggle.length-1;0<=e;e--)if(this.__disableToggle[e]===t)return;this.__disableToggle.push(t)},toggle:function(){this.__disableToggle.length||this.p.toggle()},stop:function(){this.__disableToggle.length||this.p.stop()},setTitle:function(t){s.text(this.__titleText.all,t)},hideTitle:function(){this.__titleTextBtn.hideButton(this.attr.titleText)},showTitle:function(){this.__titleTextBtn.showButton(this.attr.titleText)},updatePlaying:function(){s.addClass(this.__toggleBtn.all,"mpv-play");s.removeClass(this.__toggleBtn.all,"mpv-pause")},updatePause:function(){s.removeClass(this.__toggleBtn.all,"mpv-play");s.addClass(this.__toggleBtn.all,"mpv-pause")},popup:function(){},toggleFlashHelper:function(){},getPosterUrl:function(){var t=this.p.currentMediaSource(),e=this.p.attr;return t&&t.input&&t.input.poster?t.input.poster:e&&e.poster},showPoster:function(t){if(this.__poster)if(s.b.ie&&s.b.ie<9){var e=document.createElement("img");e.src=t;e.style.width="100%";e.style.height="100%";this.__poster.appendChild(e)}else this.__poster.style.backgroundImage="url('"+t+"')";s.removeClass(this.__poster,"mpv-hide")},hidePoster:function(){s.addClass(this.__poster,"mpv-hide")},rotate:function(){s.removeClass(this.p.userElement,e.ROTATE_SCREEN);s.removeClass(this.p.userElement,e.ROTATE_SCREEN1);s.removeClass(this.p.userElement,e.ROTATE_SCREEN2);s.removeClass(this.p.userElement,e.ROTATE_SCREEN3);switch(this.____rotate_screen){case 0:s.addClass(this.p.userElement,e.ROTATE_SCREEN);s.addClass(this.p.userElement,e.ROTATE_SCREEN1);this.____rotate_screen=1;break;case 1:s.addClass(this.p.userElement,e.ROTATE_SCREEN);s.addClass(this.p.userElement,e.ROTATE_SCREEN2);this.____rotate_screen=2;break;case 2:s.addClass(this.p.userElement,e.ROTATE_SCREEN);s.addClass(this.p.userElement,e.ROTATE_SCREEN3);this.____rotate_screen=3;break;case 3:this.____rotate_screen=0}}});return t})}();!function(){"use strict";var s=getDframework(),r=s.module("imgtech.media.Media"),a=r.ERROR_TYPE;s.define("imgtech.media.module.MediaError",function(){var i=s.module("imgtech.media.ModuleInterface");function n(t){i.apply(this,arguments);if(t){this.lastCurrentTime=0;var e=this.attr;e.maxRetryCount||(e.maxRetryCount=n.MAX_RETRY_COUNT);e.depthRetrySeconds||(e.depthRetrySeconds=n.DEPTH_RETRY_SECONDS)}}n.MAX_RETRY_COUNT=10;n.DEPTH_RETRY_SECONDS=1;n.ERROR={ES0003:"\uc601\uc0c1\uc5d0 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc5ec 3\ucd08\ud6c4\uc774\ud6c4 \uc601\uc0c1\uc744 \uc7ac\uc2dc\ub3c4 \ud569\ub2c8\ub2e4."};s.extendClass(n,i,{onAddEvent:function(){var t=s.module("imgtech.media.extends.Confirm"),e=s.module("imgtech.media.extends.Alert");this.__confirm=new t({player:this.p});this.__alert=new e({player:this.p})},onStateChange:function(t){switch(t.type){case r.EVENT.STATE_CHANGE:t.data==r.STATE.SETSOURCE&&(this.lastCurrentTime=0);break;case r.EVENT.CURRENT_TIME_CHANGE:var e=this.p.currentMediaSource(),i=e?e.___retryErrorLastCurrentTime:null;this.lastCurrentTime=t.data.currentTime;i&&i<this.lastCurrentTime&&(e.___retryErrorLastCurrentTime=0);break;case r.EVENT.ON_ERROR:this.retryError(t)}},retryError:function(t){var e,i,n,r=this.p.currentMediaSource();if(s.b.chrome&&t.data&&t.device&&r){i=(e=t.data.srcElement||t.data.target)&&e.error;if(e)if(i){if(3===i.code){s.error(i);if(r.___retryErrorLastCurrentTime){r.___retryError++;n=r.input.autoContinueTime}else{r.___retryError=1;n=this.lastCurrentTime}if(r.input.retryError>this.attr.maxRetryCount)return;n||(n=0);n+=this.attr.depthRetrySeconds;s.error("Retry error. autoContinueTime: "+n+", retryCount: "+r.___retryError);r.setAutoContinueTime(n);r.___retryErrorLastCurrentTime=n;this.p.current()}}else s.error("Not found event target error data on retryError.");else s.error("Not found event target on retryError.")}},regexp2string:function(t,e){var i,n,r=t,s=r.match(/\{[\s\S]+?\}/g);if(!s||s&&!s.length)return r;for(var a=0;a<s.length;a++)if(n=(i=s[a]).substring(1,i.length-1).trim()){var o=e[n]+"";(o=o&&o.trim())&&(r=r.replace(i,o))}return r},alert:function(t,e,i){var n=i&&1<i.length&&i[1]?this.regexp2string(e,i[1]):e;this.__alert.show(n);if(t.fatal){i&&this.p.error(" ## FATAL ERROR ("+n+"): ",i);throw new Error(n)}},code:function(t){var e=r.getErrorInfo(t);if(!e)return this.p.error("Not found exception code. code: "+t,arguments);switch(e.type){case a.LIB:return this.alert(e,"[LIB] "+e.code+": \n"+e.message,arguments);case a.DEV:return this.alert(e,"[DEV] "+e.code+": \n"+e.message,arguments);case a.USR:return this.alert(e,e.code+": \n"+e.message,arguments)}}});return n})}();!function(){"use strict";var s=getDframework();s.module("imgtech.media.Media");s.define("imgtech.media.module.App",function(){var e=s.module("imgtech.media.ModuleInterface");function t(t){e.apply(this,arguments);if(t){this.__exitBtn=this.p.getButton("exitBtn");s.addClass(this.__exitBtn.all,"mpv-hide")}}s.extendClass(t,e,{onAddEvent:function(){var t,e=this;s.on(this.__exitBtn.all,"click",function(t){e.dissmiss();return s.igEventAll(t)});(t=this.exitBtn())&&this.__exitBtn.showButton(t)},onStateChange:function(t){},proc:function(t,e,i){var n;if(t){if(!(n=t[e]))return s.error("Not found seconds attribute name");if(!n.apply)return s.error("Seconds attribute name is not function");try{return i?n.apply(t):n.apply(t,i)}catch(r){return null}}return null},_applyAttribute:function(t,e){var i;if(this.attr&&(i=this.attr[t]))if(i.apply)try{return e?i.apply(this,e):i.apply(this)}catch(n){}else this.p.error("Not found "+t+" function at app attribute");return null},appName:function(){return this._applyAttribute("appName")},isApp:function(){return this._applyAttribute("isApp")},isMobileApp:function(){return this._applyAttribute("isMobileApp")},dissmiss:function(){return this._applyAttribute("dissmiss")},fullscreen:function(){return this._applyAttribute("fullscreen")},exitFullscreen:function(){return this._applyAttribute("exitFullscreen")},stateChange:function(){},useVirtualScreen:function(){return this._applyAttribute("useVirtualScreen")},exitBtn:function(){return this._applyAttribute("exitBtn")}});return t})}();!function(){"use strict";var l=getDframework(),h=l.module("imgtech.media.Media"),c=h.CN;l.define("imgtech.media.module.AD",function(){var i=l.module("imgtech.media.ModuleInterface");l.module("imgtech.media.Source");function t(t){i.apply(this,arguments);if(t){var e=this.attr;this.progressTime=!1;this.__lastSelectingData=null;this.__endADCount=0;this.__detailBtn=this.p.getButton("adDetailBtn");this.__skipBtn=this.p.getButton("adSkipBtn");this.__detailBtn.initButton(e.detailBtn);this.__skipBtn.initButton(e.skipBtn)}}l.extendClass(t,i,{onAddEvent:function(){var e,i=this.attr,n=this,r=this.p;l.on(this.__detailBtn.all,"click",function(t){if((e=r.currentMediaSource())&&e.isAD())if(i.detailBtn&&i.detailBtn.click)i.detailBtn.click.call(n,e);else if(e.input.url){r.pause();window.open(e.input.url)}return l.igEventAll(t)});l.on(this.__skipBtn.all,"click",function(t){if((e=r.currentMediaSource())&&e.isAD())if(i.skipBtn&&i.skipBtn.click)i.skipBtn.click.call(n,e);else if(e.____userEnableSkip){r.pause();n.skip(e)}return l.igEventAll(t)})},onStateChange:function(t){var e=this.p.getADData(),i=e&&this.p.currentMediaSource(),n=i&&i.isAD(),r=this,s=this.attr;switch(t.type){case h.EVENT.PREVIOUS_MEDIA:case h.EVENT.NEXT_MEDIA:case h.EVENT.INDEX_MEDIA:this.progressTime=!1;this.__lastSelectingData=null;this.__endADCount=0;return;case h.EVENT.SELECT_AD:return this.selectAd(t.data);case h.EVENT.SELECTED_AD:this.__lastSelectingData=null;return;default:if(!e)return}switch(t.type){case h.EVENT.CURRENT_TIME_CHANGE:i&&!i.isAD()&&!1!==this.progressTime&&this.selectMiddleAd(t.data.currentTime);break;case h.EVENT.STATE_CHANGE:if(t.data==h.STATE.SETSOURCE){var a=this.p.module("progress"),o=this.p.module("layout");a&&a.enSeekable(this);o&&o.enableToggle(this);i&&!n&&!1===this.progressTime&&(this.progressTime=0);if(n){if(!i.input.progressTime&&!i.input.disableSeekable){var u=this.attr.progressTime;!0===u?a&&a.progressTime(0):"disable"==u&&a&&a.disSeekable(this)}o&&!1!==s.clickLayout&&(s.clickLayout||i.input.url)&&o.disableToggle(this);l.addClass(this.p.userElement,c.AD_SCREEN)}else l.removeClass(this.p.userElement,c.AD_SCREEN)}else t.data==h.STATE.SYSTEM_ENDED&&setTimeout(function(){r.selectEndAd(r.p.getADData(),!0)},1);break;case h.EVENT.ON_BEFORE_PLAY:if(i.__willbeAdSendedEnd)return setTimeout(function(){i.input.autoplay=i.__willbeAdSendedEnd.autoplay;delete i.__willbeAdSendedEnd;return r.sendEnded()},1);setTimeout(function(){var t=r.userSelectedSource;if(r.userSelectedSource){if(r.p.currentMediaSource()===t.source){r.p.setVolume(t.currentVolume);t.currentMuted?r.p.mute():r.p.unMute();r.p.setPlaybackRate(t.currentRate)}r.userSelectedSource=null}},1)}n&&this.adStateChange(t)},detailTime:function(){var t=this.attr,e=this.p.currentMediaSource(),i=e&&e.input,n=i?i.detailTime:null;return i&&e.isAD()&&n?n:t.detailTime},skipTime:function(){var t=this.attr,e=this.p.currentMediaSource(),i=e&&e.input,n=i?i.skipTime:null;if(i&&e.isAD()&&null!==n&&(!1===n||n))return n;t.skipTime||!1===t.skipTime||(t.skipTime=10);return t.skipTime},sendEnded:function(){this.p.callStateChange({type:h.EVENT.STATE_CHANGE,data:h.STATE.ENDED})},adStateChange:function(t){var e=this.attr;e.adStateChange&&e.adStateChange.call(this,t);if(t.type==this.p.EVENT.ON_BEFORE_PLAY||t.type==this.p.EVENT.CURRENT_TIME_CHANGE){var i=this.p.currentMediaSource();if(i){var n,r=this.skipTime(),s=this.detailTime();if(s)if(t.type==this.p.EVENT.ON_BEFORE_PLAY)i.____userEnableDetail?this.__detailBtn.coercionShowButton("all"):this.__detailBtn.coercionHideButton("all");else if(t.type==this.p.EVENT.CURRENT_TIME_CHANGE){n=Math.floor(t.data.currentTime);if(i.____userEnableDetail);else if(s<=n){i.____userEnableDetail=!0;this.__detailBtn.coercionShowButton("all")}else this.__detailBtn.coercionHideButton("all")}if(!0===r){i.____userEnableSkip=!0;l.text(this.__skipBtn.all,"SKIP >")}else if(!1!==r)if(t.type==this.p.EVENT.ON_BEFORE_PLAY)i.____userEnableSkip?l.text(this.__skipBtn.all,"SKIP >"):l.text(this.__skipBtn.all,r+"\ucd08 \ud6c4 SKIP");else if(t.type==this.p.EVENT.CURRENT_TIME_CHANGE){n=Math.floor(t.data.currentTime);if(i.____userEnableSkip);else if(r<=n){i.____userEnableSkip=!0;l.text(this.__skipBtn.all,"SKIP >")}else l.text(this.__skipBtn.all,r-n+"\ucd08 \ud6c4 SKIP")}}}},onClickLayout:function(){var t=this.p.currentMediaSource(),e=t&&t.isAD(),i=this.attr;if(e)if(!0===i.clickLayout&&t.input.url){this.p.pause();window.open(t.input.url)}else i.clickLayout&&i.clickLayout.call(this,t)},__autoStartAd:function(t,e){var i=t.ad,n=null,r=this.attr,s=this;if(i.data.start){var a=i.__startIndex?i.__startIndex:0;i.data.start.length>a&&(n=i.data.start[a])&&(n.__adType="start")}if(!n){if(r.start)return r.start.call(this,t,function(t){if(t){t=l.module("imgtech.media.source.AD").createADSource(t,s.p)}else i.__status="ing";e(t)});i.__status="ing"}e(n)},__autoEndAd:function(t,e){var i=t.ad,n=null,r=this.attr,s=this;if(i.data.end){var a=i.__endIndex?i.__endIndex:0;i.data.end.length>a&&(n=i.data.end[a])&&(n.__adType="end")}if(!n){if(r.end)return r.end.call(this,t,function(t){if(t){this.__endADCount++;t=l.module("imgtech.media.source.AD").createADSource(t,s.p)}else i.__status="finish";e(t)});i.__status="finish"}n&&this.__endADCount++;e(n)},finish:function(t,e){function i(t){var e;if(t)for(var i=0;i<t.length;i++)if(e=t[i]){e.__adType!==undefined&&delete e.__adType;e.____userEnableSkip===undefined||s.isEnableSkipAgainAd||delete e.____userEnableSkip;e.____userEnableDetail===undefined||s.isEnableDetailAgainAd||delete e.____userEnableDetail;e.__adUsed!==undefined&&delete e.__adUsed}}var n=t.ad,r=this,s=this.attr;if(s.finish)try{s.finish.call(this)}catch(a){}n&&n.__status!==undefined&&delete n.__status;this.progressTime=!1;n&&n.data&&n.data.origin&&n.data.origin.input&&(n.data.origin.input.continueTime=n.data.origin.input.autoContinueTime=null);if(s.againAD){if(n&&n.data){i(n.data.start);i(n.data.end);i(n.data.middle)}if(n){n.__startIndex!==undefined&&delete n.__startIndex;n.__endIndex!==undefined&&delete n.__endIndex}this.__endADCount=0;this.__lastSelectingData=null}e.isAD?setTimeout(function(){n.data.origin.input.autoplay=!1;n.data.origin.__willbeAdSendedEnd={autoplay:n.data.origin.input.autoplay};r.selectedADData(n.data.origin,t,!0)},1):this.sendEnded()},selectMiddleAd:function(i){var n=this.p.getADData(),t=n.ad,e=t&&t.data&&t.data.middle,r=this,s=this.attr;if(e&&e.length)for(var a=0;a<e.length;a++){var o=e[a];if(!o.__adUsed&&o.input.adTime<=i){this.p.pause();this.progressTime=i;o.__adType="mid";return setTimeout(function(){r.selectedADData(o,n,!0)},1)}}s.currentTime&&s.currentTime.call(this,n,i,function(t){if(t){var e=l.module("imgtech.media.source.AD");t=e.createADSource(t,r.p);r.p.pause();r.progressTime=i;setTimeout(function(){r.selectedADData(t,n,!0)},1)}})},selectEndAd:function(e,i){if(!e)return this.p.error("Not found select ad data !!!");var n=this,t=e.ad,r=t.__status?t.__status:t.__status="start",s=t.data.origin,a=this.p.currentMediaSource();if(!a||!a.isAD()){t.__status="end";return this.__autoEndAd(e,function(t){return t?n.selectedADData(t,e,!0):n.finish(e,{isAD:!1,ended:i})})}if(i&&this.attr.adStateChange)try{this.attr.adStateChange.call(this,{type:h.EVENT.STATE_CHANGE,data:h.STATE.ENDED})}catch(o){}this.usedSource(a,t);if("start"==r)return this.__autoStartAd(e,function(t){return t?n.selectedADData(t,e,!0):n.selectedADData(s,e,!0)});if("ing"!=r)return"end"==r?this.__autoEndAd(e,function(t){return t?n.selectedADData(t,e,!0):n.finish(e,{isAD:!0,ended:i})}):void 0;s.input.autoContinueTime=this.progressTime;return this.selectedADData(s,e,!0)},selectAd:function(e){var i=this;if(!e)return this.p.error("Not found select ad data !!!");this.__autoStartAd(e,function(t){if(t)return i.selectedADData(t,e,!1);i.selectedADData(e.ad.data.origin,e,!1)})},selectedADData:function(t,e,i){var n=this;if(this.__lastSelectingData)return this.p.error("Already selecting ad source.");i&&(this.userSelectedSource={currentTime:this.p.currentTime(),currentRate:this.p.getPlaybackRate(),currentVolume:this.p.getVolume(),currentMuted:this.p.isMuted(),source:t});this.__lastSelectingData=t;this.p.stop();setTimeout(function(){n.p.callStateChange({type:h.EVENT.SELECTING_AD,data:{src:t,originData:e}})},100)},usedSource:function(t,e){"start"==t.__adType?e.__startIndex?e.__startIndex++:e.__startIndex=1:"end"==t.__adType?e.__endIndex?e.__endIndex++:e.__endIndex=1:"mid"==t.__adType&&(t.__adUsed=!0)},skip:function(t){if(t===this.p.currentMediaSource()&&t.isAD()&&t.____userEnableSkip){this.p.pause();this.selectEndAd(this.p.getADData())}}});return t})}();!function(){"use strict";var y=getDframework(),m=y.module("imgtech.media.Media"),g=m.CN;y.define("imgtech.media.module.VAST",function(){var i=y.module("imgtech.media.ModuleInterface");function t(t){i.apply(this,arguments);if(t){var e=this.attr;this.vastUrl=null;this.progressTime=!1;this.__lastSelectingData=null;this.userSelectedSource=null;this.__detailBtn=this.p.getButton("adDetailBtn");this.__skipBtn=this.p.getButton("adSkipBtn");this.__detailBtn.initButton(e.detailBtn);this.__skipBtn.initButton(e.skipBtn)}}y.extendClass(t,i,{onAddEvent:function(){var e,i=this.attr,n=this,r=this.p;y.on(this.__detailBtn.all,"click",function(t){if((e=r.currentMediaSource())&&e.isVAST()){i.detailBtn&&i.detailBtn.click&&i.detailBtn.click.call(n,e);n.goVastUrl()}return y.igEventAll(t)});y.on(this.__skipBtn.all,"click",function(t){if((e=r.currentMediaSource())&&e.isVAST()){i.skipBtn&&i.skipBtn.click&&i.skipBtn.click.call(n,e);if(e.____userEnableSkip){r.pause();n.skip(e)}}return y.igEventAll(t)})},onStateChange:function(t){var e=this.p.getVASTData(),i=e&&this.p.currentMediaSource(),n=i&&i.isVAST(),r=n,s=this,a=this.attr;switch(t.type){case m.EVENT.PREVIOUS_MEDIA:case m.EVENT.NEXT_MEDIA:case m.EVENT.INDEX_MEDIA:this.progressTime=!1;this.__lastSelectingData=null;return;case m.EVENT.SELECT_VAST:return this.selectVast(t.data);case m.EVENT.SELECTED_VAST:this.__lastSelectingData=null;return;default:if(!e)return}switch(t.type){case m.EVENT.DURATION_CHANGE:if(a.duration&&!n&&t.data.duration&&!i.__calledDurationChange){i.__calledDurationChange=!0;a.duration.call(this,t.data.duration)}break;case m.EVENT.CURRENT_TIME_CHANGE:var o=t.data.currentTime,u=t.data.duration;i&&!n&&!1!==this.progressTime&&this.selectMiddleVast(o);if(i&&n){!r.__sendstart&&0<o&&this.sendAdAjax("start");!r.__send14&&.25*u<=o&&this.sendAdAjax("firstQuartile",{value:.25*u,duration:u,currentTime:o});!r.__send24&&.5*u<=o&&this.sendAdAjax("midpoint",{value:.5*u,duration:u,currentTime:o});!r.__send34&&.75*u<=o&&this.sendAdAjax("thirdQuartile",{value:.75*u,duration:u,currentTime:o});if(!r.__sendProgress){var l,h;(l=this.getTrackingUrl(n.ad.creatives[0].trackingEvents,"progress"))&&((h=this.stringToSeconds(l.offset))<=o||u-.5<o)&&this.sendAdAjax("progress",{offset:h,duration:u,currentTime:o})}}break;case m.EVENT.STATE_CHANGE:if(t.data==m.STATE.SETSOURCE){var c=this.p.module("progress"),d=this.p.module("layout"),f=this.p.module("ui");c&&c.enSeekable(this);d&&(a.toggle||!n?d.enableToggle(this):d.disableToggle(this));f&&(a.toggle||!n?f.enableToggle(this):f.disableToggle(this));i&&!n&&!1===this.progressTime&&(this.progressTime=0);if(n){if(!i.input.progressTime&&!i.input.disableSeekable){var p=this.attr.progressTime;!0===p?c&&c.progressTime(0):"disable"==p&&c&&c.disSeekable(this)}y.addClass(this.p.userElement,g.VAST_SCREEN)}else y.removeClass(this.p.userElement,g.VAST_SCREEN)}else if(t.data==m.STATE.SYSTEM_ENDED){n&&this.sendAdAjax("complete");setTimeout(function(){s.selectEndVast(s.p.getVASTData(),!0)},1)}break;case m.EVENT.ON_BEFORE_PLAY:n?this.p.setPlaybackRate(1):setTimeout(function(){var t=s.userSelectedSource;if(t){if(s.p.currentMediaSource()===t.source){s.p.setVolume(t.currentVolume);t.currentMuted?s.p.mute():s.p.unMute();s.p.setPlaybackRate(t.currentRate)}s.userSelectedSource=null}if(i.__willbeAdSendedEnd){i.input.autoplay=i.__willbeAdSendedEnd.autoplay;i.__willbeAdSendedEnd=null;delete i.__willbeAdSendedEnd;s.sendEnded()}},1)}n&&this.vastStateChange(t)},onClickLayout:function(){var t=this.attr,e=this.p.currentMediaSource(),i=e&&e.isVAST();if(this.p.isPlaying())i.__isPlay=!0;else if(!i.__isPlay){this.p.play();i.__isPlay=!0;return}t.clickLayout&&this.goVastUrl()},addMiddleVast:function(t){var e=this.p.getVASTData().vast;e.data||(e.data={});e.data.middle||(e.data.middle={});e.data.middle.size||(e.data.middle.size=0);e.data.middle.timeIndex||(e.data.middle.timeIndex=0);e.data.middle.times||(e.data.middle.times=[]);e.data.middle.times.push({time:t})},goVastUrl:function(){var t=this.getClickUrl();if(t){this.p.pause();t.clickThrough&&window.open(t.clickThrough);this.sendTracking("clickTracking",t.clickTracking)}},getClickUrl:function(){var t,e,i,n,r=this.p.currentMediaSource();if((t=r&&r.isVAST())&&(e=t.ad)&&(i=e.creatives)&&i[0]&&(n=i[0].videoClicks)){var s=n.clickThrough?n.clickThrough.url:null,a=n.clickTracking?n.clickTracking.url:null;if(s||a)return{clickThrough:s,clickTracking:a}}return null},sendEnded:function(){this.p.callStateChange({type:m.EVENT.STATE_CHANGE,data:m.STATE.ENDED})},getTrackingUrl:function(t,e){for(var i=0;i<t.length;i++)if(t[i].event===e)return t[i];return null},sendTracking:function(t,e,i){var n=this.attr,r=e;if(e){this.p.log(" ## Send "+t+" tracking event url("+r+").",i);(new Image).src=r}else this.p.error(" ## Not found "+t+" tracking event url("+e+").",i);n.sendTracking&&n.sendTracking(t,r,i)},sendAdAjax:function(t,e){var i,n=this.p.currentMediaSource(),r=n&&n.isVAST(),s=r?r.ad:null,a=s?s.impression:null,o=s?s.creatives[0]:null,u=o?o.trackingEvents:null,l=u?this.getTrackingUrl(u,t):null;if(r)switch(t){case"start":if(!r.__sendstart){r.__sendstart=!0;this.sendTracking("impression",a&&a.url,e);this.sendTracking("start",l&&l.url,e)}break;case"skip":this.sendTracking("skip",l&&l.url,e);break;case"complete":i=l&&l.url;r.__sendProgress||this.sendAdAjax("progress");this.sendTracking("complete",i,e);break;case"progress":if(!r.__sendProgress){r.__sendProgress=!0;this.sendTracking("progress",l&&l.url,e)}break;case"firstQuartile":if(!r.__send14){r.__send14=!0;this.sendTracking("firstQuartile",l&&l.url,e)}break;case"midpoint":if(!r.__send24){r.__send24=!0;this.sendTracking("midpoint",l&&l.url,e)}break;case"thirdQuartile":if(!r.__send34){r.__send34=!0;this.sendTracking("thirdQuartile",l&&l.url,e)}}},stringToSeconds:function(t){var e,i,n=0;if(-1!==(e=t.lastIndexOf("."))){i=t.substring(0,e);n=parseFloat("0."+t.substring(e+1))}else i=t;var r=i.split(":"),s=parseInt(r[0]),a=parseInt(r[1]);return parseInt(r[2])+60*a+3600*s+n},skip:function(t){if(t===this.p.currentMediaSource()&&t.isVAST()&&t.____userEnableSkip){this.p.pause();this.selectEndVast(this.p.getVASTData());this.sendAdAjax("skip")}},skipTime:function(){var t=this.p.currentMediaSource().isVAST(),e=t&&t.ad&&t.ad.creatives?t.ad.creatives[0].skipoffset:null;return e?this.stringToSeconds(e):0},detailTime:function(){this.attr;var t=this.p.currentMediaSource().isVAST().ad.creatives[0].duration,e=this.stringToSeconds(t),i=this.p.getVASTData(),n=i&&i.input&&i.input.vast&&i.input.vast.detailTime;n?e-5<n&&(n=0):n=0;return n},vastStateChange:function(t){var e,i,n=this.attr;if(n.vastStateChange)try{n.vastStateChange.call(this,t)}catch(l){y.error(l)}t.type!=this.p.EVENT.ON_BEFORE_PLAY&&t.type!=this.p.EVENT.CURRENT_TIME_CHANGE||(i=(e=this.p.currentMediaSource()).isVAST());if(t.type==this.p.EVENT.ON_BEFORE_PLAY){var r=this.getClickUrl();if(!r||!r.clickThrough){i.__clickThrough=!1;this.__detailBtn.coercionHideButton("all")}}if((t.type==this.p.EVENT.ON_BEFORE_PLAY||t.type==this.p.EVENT.CURRENT_TIME_CHANGE)&&e){var s,a=this.skipTime(),o=this.detailTime(),u=this.p.duration();if(i&&!1!==i.__clickThrough)if(o){if(t.type==this.p.EVENT.ON_BEFORE_PLAY)e.____userEnableDetail?this.__detailBtn.coercionShowButton("all"):this.__detailBtn.coercionHideButton("all");else if(t.type==this.p.EVENT.CURRENT_TIME_CHANGE){s=Math.floor(t.data.currentTime);if(e.____userEnableDetail);else if(o<=s){e.____userEnableDetail=!0;this.__detailBtn.coercionShowButton("all")}else this.__detailBtn.coercionHideButton("all")}}else t.type==this.p.EVENT.ON_BEFORE_PLAY&&this.__detailBtn.coercionShowButton("all");u<=a&&(a=0);if(a){if(t.type==this.p.EVENT.ON_BEFORE_PLAY)e.____userEnableSkip?y.text(this.__skipBtn.all,"SKIP >"):y.text(this.__skipBtn.all,a+"\ucd08 \ud6c4 SKIP");else if(t.type==this.p.EVENT.CURRENT_TIME_CHANGE){s=Math.floor(t.data.currentTime);if(e.____userEnableSkip);else if(a<=s){e.____userEnableSkip=!0;y.text(this.__skipBtn.all,"SKIP >")}else y.text(this.__skipBtn.all,a-s+"\ucd08 \ud6c4 SKIP")}}else if(t.type==this.p.EVENT.ON_BEFORE_PLAY){this.p.error("Not found skip time of vast.");this.__skipBtn.coercionHideButton("all")}}},usedSource:function(){},selectVast:function(e){if(!e)return this.p.error("Not found select vast data !!!");var t=this.attr.requestUrl.url,i=this;this.vastUrl=t;this.__autoStartVast(e,function(t){if(t)return i.selectedSource(t,e,!1);i.selectedSource(e.vast.data.origin,e,!1)})},selectEndVast:function(e,i){var n=this,t=e.vast,r=t.__status?t.__status:t.__status="start",s=t.data.origin,a=this.p.currentMediaSource();if(!a||!a.isVAST()){t.__status="end";return this.__autoEndVast(e,function(t){return t?n.selectedSource(t,e,!0):n.finish(e,{isAD:!1,ended:i})})}if(i&&this.attr.vastStateChange)try{this.attr.vastStateChange.call(this,{type:m.EVENT.STATE_CHANGE,data:m.STATE.ENDED})}catch(o){y.error(o)}this.usedSource(a,t);if("start"==r)return this.__autoStartVast(e,function(t){return t?n.selectedSource(t,e,!0):n.selectedSource(s,e,!0)});if("ing"!=r)return"end"==r?this.__autoEndVast(e,function(t){return t?n.selectedSource(t,e,!0):n.finish(e,{isAD:!0,ended:i})}):void 0;s.input.autoContinueTime=this.progressTime;return this.selectedSource(s,e,!0)},selectMiddleVast:function(t){var e=this.p.getVASTData(),i=e.vast,n=i&&i.data&&i.data.middle,r=this;if(n.times&&n.times.length){n.timeIndex||(n.timeIndex=0);if(!(n.timeIndex>=n.times.length)){var s=n.times[n.timeIndex];if(!s.used&&t>=s.time){s.used=!0;this.p.pause();this.ajax(this.vastUrl,{type:"get"},function(t){n.timeIndex++;n.used++;if(t){r.progressTime=s.time;r.selectedSource(t,e,!0)}else r.p.play()})}}}},finish:function(t,e){var i=t.vast,n=this,r=this.attr;if(r.finish)try{r.finish.call(this)}catch(a){}i&&i.__status!==undefined&&delete i.__status;this.progressTime=!1;i&&i.data&&i.data.origin&&i.data.origin.input&&(i.data.origin.input.continueTime=i.data.origin.input.autoContinueTime=null);if(r.againAD){this.__lastSelectingData=null;i.data.start&&(i.data.start.used=0);if(i.data.middle){i.data.middle.used=0;i.data.middle.timeIndex=0;if(i.data.middle.times)for(var s=0;s<i.data.middle.times.length;s++){i.data.middle.times[s].used=!1}}i.data.end&&(i.data.end.used=0)}e.isAD?setTimeout(function(){i.data.origin.input.autoplay=!1;i.data.origin.__willbeAdSendedEnd={autoplay:i.data.origin.input.autoplay};n.selectedSource(i.data.origin,t,!0)},1):this.sendEnded()},__autoStartVast:function(t,e){var i=t.vast,n=i.data.start;if(n.used>=n.size){i.__status="ing";return e(null)}this.ajax(this.vastUrl,{type:"get"},function(t){t||(i.__status="ing");n.used++;e(t)})},__autoEndVast:function(t,e){var i=t.vast.data.end;if(i.used>=i.size)return e(null);this.ajax(this.vastUrl,{type:"get"},function(t){i.used++;e(t)})},selectedSource:function(t,e,i){var n=this,r=this.p.currentMediaSource();if(this.__lastSelectingData)return this.p.error("Already selecting vast source.");r&&!r.isVAST()&&t.isVAST()&&(this.userSelectedSource={currentTime:this.p.currentTime(),currentRate:this.p.getPlaybackRate(),currentVolume:this.p.getVolume(),currentMuted:this.p.isMuted(),source:r});this.__lastSelectingData=t;this.p.stop();setTimeout(function(){n.p.callStateChange({type:m.EVENT.SELECTING_VAST,data:{src:t,originData:e}})},100)},ajax:function(t,e,n){var r=this;function s(t){if(t.error){r.p.error(" ## Error VAST: "+t.error);return n(null)}if(t.data){var e,i=r.parseVastXml(t.data);if(i.error){r.p.error(" ## Error VAST: ",i.error);return n(null)}if(e=i.ad.creatives[0].mediaFiles[0].url){e=y.module("imgtech.media.source.VAST").createSource(e,r.p,i);return n(e)}r.p.error(" ## Error VAST: Has vast but not bound url");return n(null)}r.p.error(" ## Error VAST: No recv data!");return n(null)}y.b.ie&&y.b.ie<9?s({error:"Not support vast for ie8"}):y.ajax({responseType:"xml",type:e.type?e.type:"get",url:t,error:function(){s({error:"status: "+this.status})},success:function(t,e,i){s({data:t})}})},parseVastXml:function(t){function e(t){s.error=t;return s}var i,n,r,s={};if(!(s.version=t.getAttribute("version")))return e("Not found version attribute of vast tag.");s.ad={};if(!(i=y.query(t,"Ad")))return e("Not found ad tag");if(!(s.ad.id=i.getAttribute("id")))return e("Not found id attribute of ad tag.");if(!(s.ad.sequence=i.getAttribute("sequence")))return e("Not found sequence attribute of ad tag.");if(!(i=r=y.query(i,"InLine")))return e("Not found inline tag");if(!(i=y.query(i,"Error")))return e("Not found error tag");s.ad.error=i.textContent.trim();if(!(i=y.query(r,"Impression")))return e("Not found Impression tag");s.ad.impression={};if(!(s.ad.impression.id=i.getAttribute("id")))return e("Not found sequence attribute of ad tag.");s.ad.impression.url=i.textContent.trim();if(!(i=y.query(r,"Creatives")))return e("Not found Creatives tag");s.ad.creatives=[];if(!(n=y.queryAll(i,"Creative")))return e("Not found Creative tag");for(var a=0;a<n.length;a++){i=n[a];var o={};if(!(i=y.query(i,"Linear")))return e("Not found Linear tag");if(!(o.skipoffset=i.getAttribute("skipoffset")))return e("Not found skipoffset attribute of linear tag.");var u,l=i;if(!(i=y.query(l,"Duration")))return e("Not found Duration tag");o.duration=i.textContent.trim();if(!(i=y.query(l,"TrackingEvents")))return e("Not found TrackingEvents tag");o.trackingEvents=[];if(!(u=y.queryAll(i,"Tracking")))return e("Not found Tracking tag");for(var h=0;h<u.length;h++){var c={},d=u[h];if(!(c.event=d.getAttribute("event")))return e("Not found event attribute of Tracking tag.");if("progress"==c.event&&!(c.offset=d.getAttribute("offset")))return e("Not found offset attribute of Tracking(progress) tag.");c.url=d.textContent.trim();o.trackingEvents.push(c)}if(!(i=y.query(l,"VideoClicks")))return e("Not found VideoClicks tag");o.videoClicks={};var f,p=i;if(i=y.query(p,"ClickThrough")){o.videoClicks.clickThrough={};o.videoClicks.clickThrough.id=i.getAttribute("id");o.videoClicks.clickThrough.url=i.textContent.trim()}if(i=y.query(p,"ClickTracking")){o.videoClicks.clickTracking={};o.videoClicks.clickTracking.id=i.getAttribute("id");o.videoClicks.clickTracking.url=i.textContent.trim()}if(!(i=y.query(l,"MediaFiles")))return e("Not found MediaFiles tag");o.mediaFiles=[];if(!(f=y.queryAll(i,"MediaFile")))return e("Not found mediaFile tag");if(!f.length)return e("Not found mediaFile tag");for(var m=0;m<f.length;m++){var g=f[m],v={};v.id=g.getAttribute("id");v.type=g.getAttribute("type");v.width=g.getAttribute("width");v.height=g.getAttribute("height");v.delivery=g.getAttribute("delivery");v.scalable=g.getAttribute("scalable");v.maintainAspectRatio=g.getAttribute("maintainAspectRatio");if(!(v.url=g.textContent.trim()))return e("Not found url attribute of mediaFile tag");o.mediaFiles.push(v)}s.ad.creatives.push(o)}return s}});return t})}();!function(){"use strict";var n=getDframework(),r=n.module("imgtech.media.Media"),s=r.CN;n.define("imgtech.media.module.Radio",function(){var i=n.module("imgtech.media.ModuleInterface");function t(t){i.apply(this,arguments);if(t){var e=this.p.userElement;this.__deviceUi=n.query(e,".mpv-device");this.backgroundElement=null;this._radioLayoutAttr={separateControlNormal:!1,alwaysControlNormal:!0};this._orgLayoutAttr={};this.__updatedLayoutAttr="org"}}n.extendClass(t,i,{onAddEvent:function(){},onStateChange:function(t){switch(t.type){case r.EVENT.STATE_CHANGE:switch(t.data){case r.STATE.SETSOURCE:this.patchRadioClassName()}break;case r.EVENT.FULLSCREEN_CHANGE:this.patchRadioClassName()}},patchRadioClassName:function(){var t,e=this.p.module("volume"),i=this.p.userElement;(t=this.backgroundImage())?this.showBackground(t):this.hideBackground();this.isRadio()?n.addClass(i,s.RADIO_SCREEN):n.removeClass(i,s.RADIO_SCREEN);if(this.isHideScreen()){n.hasClass(i,s.RADIO_HIDE_SCREEN)||n.addClass(i,s.RADIO_HIDE_SCREEN);e&&e.setHorizontal()}else{n.hasClass(i,s.RADIO_HIDE_SCREEN)&&n.removeClass(i,s.RADIO_HIDE_SCREEN);e&&"vertical"==e.attr.type&&e.setVertical()}this.p.patchScreenClassName()},isRadio:function(){var t,e=this.p.currentMediaSource();if(e&&(t=e.input))return t.radio},isHideScreen:function(){var t,e,i,n=this.p.module("size");return(!n||!n.isFullscreen())&&((t=this.p.currentMediaSource())&&(e=t.input)&&(i=e.radio)?i.hideScreen:void 0)},getSize:function(){var t,e=this.attr;if(e.size)try{t=e.size()}catch(i){t=e.size}t&&t.height||(t={width:t&&(t.width||0===t.width)?t.width:undefined,height:50});return t},resetStyle:function(){},updateStyle:function(){if(this.isHideScreen()){var t=this.getSize();t&&t.height&&(this.p.userElement.style.height=r.getStyleNumberValue(t.height));t&&t.width&&(this.p.userElement.style.width=r.getStyleNumberValue(t.width))}else{var e=this.p.module("size");e&&e.updateStyle()}},backgroundImage:function(){var t,e,i,n;if((t=this.p.currentMediaSource())&&(e=t.input)&&(i=e.radio)){if(i.backgroundImage)return i.backgroundImage;if((n=this.attr).backgroundImage)return n.backgroundImage}},showBackground:function(t){var e=document.createElement("div");if(!t)return n.error("Not found background image url.");n.addClass(e,"mpv-radio-background-image mpv-screen");if(n.b.ie&&n.b.ie<9){var i=document.createElement("img");i.src=t;i.style.width="100%";i.style.height="100%";e.appendChild(i)}else e.style.backgroundImage="url('"+t+"')";this.hideBackground();this.backgroundElement=e;this.__deviceUi&&n.after(this.__deviceUi,e)},hideBackground:function(){if(this.backgroundElement){n.remove(this.backgroundElement);this.backgroundElement=null}}});return t})}();!function(){"use strict";var n=getDframework();n.module("imgtech.media.Media");n.define("imgtech.media.module.Autoplay",function(){var e=n.module("imgtech.media.ModuleInterface"),i="ZONEMEDIA_AUTOPLAY";function t(t){e.apply(this,arguments)}n.extendClass(t,e,{onAddEvent:function(){},onStateChange:function(t){},getAutoPlay:function(){var t=this.attr,e=document.cookie.match("(^|;) ?"+i+"=([^;]*)(;|$)");null===(e="true"===(e=e&&e.length&&e[2])||"false"!==e&&null)&&(!t||!0!==t.devalutValue&&!1!==t.devalutValue?this.setAutoPlay(e=t.devalutValue=!0):this.setAutoPlay(e=t.devalutValue));return e},setAutoPlay:function(t){document.cookie=i+"="+(!0===t?"true":"false")},isEnableMenu:function(){var t=this.attr;return!(!t||!0!==t.use)},currentValue:function(){var t=this.getAutoPlay();return null===t?"\uc124\uc815\uc5c6\uc74c":t?"<div class='mpv-autoplay-item mpv-autoplay-true'></div>":"<div class='mpv-autoplay-item mpv-autoplay-false'></div>"},openMenu:function(){!0===this.getAutoPlay()?this.setAutoPlay(!1):this.setAutoPlay(!0);return!0}});return t})}();!function(){"use strict";var d=getDframework(),i=d.module("imgtech.media.Media"),l=i.CN,n=window.io?window.io:null,t={HELLO_OK:"\ucc44\ub110\uc5d0 \uc785\uc7a5\ud558\uc600\uc2b5\ub2c8\ub2e4.",HELLO_DENY:"\ucc44\ub110\uc5d0 \uc785\uc7a5\ud558\uc9c0 \ubabb\ud558\uc600\uc2b5\ub2c8\ub2e4. ({subId})",NONE_SOCKETIO:"\ucc44\ub110 \uc5f0\uacb0 \uc2e4\ud328(NONE_SOCKETIO). \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4 \ud558\uc5ec \uc8fc\uc138\uc694.",ON_DISCONNECTED:"\uc5f0\uacb0\uc774 \uc885\ub8cc \ub418\uc5c8\uc2b5\ub2c8\ub2e4.",CHANNEL_JOIN:"{userNick}\ub2d8\uc774 \uc785\uc7a5\ud558\uc600\uc2b5\ub2c8\ub2e4.",CHANNEL_EXIT:"{userNick}\ub2d8\uc774 \ud1f4\uc7a5\ud558\uc600\uc2b5\ub2c8\ub2e4.",NOT_FOUND_URL:"URL\uc774 \uc874\uc7ac \ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",SPECIAL_NICKNAME:"\ud2b9\uc218\ubb38\uc790 \ud639\uc740 \uacf5\ubc31\uc774 \ud3ec\ud568\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.",NONE_NICKNAME:"\ub300\ud654\uba85\uc744 \uc785\ub825\ud574\uc57c \ud569\ub2c8\ub2e4.",FAIL_UPDATE_NICKNAME:"\ub300\ud654\uba85\uc744 \ubcc0\uacbd\ud558\uc9c0 \ubabb\ud558\uc600\uc2b5\ub2c8\ub2e4.\n{error}",OK_UPDATE_NICKNAME:"\ub300\ud654\uba85\uc744 {oldNick}\uc5d0\uc11c {userNick}\uc73c\ub85c \ubcc0\uacbd \ud558\uc600\uc2b5\ub2c8\ub2e4.",OK_UPDATE_NICKNAME2:"\ub300\ud654\uba85\uc744 \ubcc0\uacbd \ud558\uc600\uc2b5\ub2c8\ub2e4.",FAIL_UPDATE_FACE:"\ub300\ud45c \uc544\uc774\ucf58\uc744 \ubcc0\uacbd\ud558\uc9c0 \ubabb\ud558\uc600\uc2b5\ub2c8\ub2e4.\n{error}",OK_UPDATE_FACE:"\ub300\ud45c \uc544\uc774\ucf58\uc744 \ubcc0\uacbd \ud558\uc600\uc2b5\ub2c8\ub2e4.",NOT_FOUND_FACE_ICON:"\ub300\ud45c \uc544\uc774\ucf58\uc744 \uc120\ud0dd\ud558\uc138\uc694.",NOT_FOUND_SERVER_INFO:"\uc11c\ubc84 \ubaa9\ub85d\uc744 \uc5bb\uc9c0 \ubabb\ud558\uc600\uc2b5\ub2c8\ub2e4.",NOT_FOUND_ALL_SERVER:"\ubaa8\ub4e0 \uc11c\ubc84\uc5d0 \uc5f0\uacb0 \ud558\uc9c0 \ubabb\ud558\uc600\uc2b5\ub2c8\ub2e4."};d.define("imgtech.media.module.Chat",function(){var o=d.module("imgtech.media.ModuleInterface"),s={HELLO:1e3,HELLO_DENY:1001,HELLO_OK:1002,HELLO_DENY_SUB:{NOT_FOUND_CHANNEL_ID:1001,NOT_FOUND_CHANNEL:1002,DB_ERROR:1003},CHANNEL_JOIN:3010,CHANNEL_EXIT:3020,CHANNEL_MSG:3030,DB_LOGIN:8001,DB_LOGIN_NAME:"LOGIN",DB_LOGOUT:8002,DB_LOGOUT_NAME:"LOGOUT",USER_UPDATE_NICK:8510,USER_UPDATE_FACE:8520,ADMIN_CREATE_CHANNEL:9e3,ADMIN_CREATE_CHANNEL_FAIL:9001,ADMIN_CREATE_CHANNEL_OK:9002,ADMIN_STOP_CHANNEL:9010,ADMIN_STOP_CHANNEL_FAIL:9011,ADMIN_STOP_CHANNEL_OK:9012,ADMIN_DROP_CHANNEL:9020,ADMIN_DROP_CHANNEL_FAIL:9021,ADMIN_DROP_CHANNEL_OK:9022};function u(t){o.apply(this,arguments);if(t){this.attr||(this.attr=t);var e=this,i=this.p,n=this.attr,r=(i=this.p).userElement;if(n.alone){i||(i={});if(!n.alone.uid)throw new TypeError("Not found chat element.");if(!n.alone.resourceText)throw new TypeError("Not found chat resource text.");i.userElement=d.query(n.alone.uid);i.innerElement=r=i.userElement;i.resourcElement=d.element(n.alone.resourceText);d.addClass(r,n.skinName?n.skinName:"skin-catvod");d.append(r,i.resourcElement)}this.currentServerNo=!1;this.isconnected=!1;this.isdenylogin=!1;this.islogin=!1;this.userCallbacks={};this.userCallbackNo=0;this.message={};for(var s in u.MESSAGE)this.message[s]=u.MESSAGE[s];if(n.message)for(s in n.message)this.message[s]=n.message[s];this.__layer=d.query(r,".mpv-chat");if(this.__layer){d.remove(this.__layer);d.append(i.innerElement,this.__layer);n.useFace&&d.addClass(this.__layer,"mpv-chat-useface")}n.use?d.addClass(r,l.CHAT_SCREEN):d.removeClass(r,l.CHAT_SCREEN);this.__title=d.query(r,".mpv-chat-title-text");this.__display=d.query(r,".mpv-chat-display");this.__menuLayer=d.query(r,".mpv-chat-menu-layer");this.__menu=d.query(r,".mpv-chat-menu-icon");this.__closeMenu=d.query(r,".mpv-chat-menu-close-btn");this.__updateNickMenu=d.query(r,".mpv-chat-menu-update-nick-btn");this.__updateFaceMenu=d.query(r,".mpv-chat-menu-update-face-btn");this.__row=d.query(r,".mpv-chat-row");if(this.__row){this.__rowHtml=this.__row.outerHTML;d.remove(this.__row)}this.__lv1=d.query(r,".mpv-chat-lv1");if(this.__lv1){this.__lv1Html=this.__lv1.outerHTML;d.remove(this.__lv1)}this.__form=d.query(r,".mpv-chat-form");this.__inputBtn=d.query(r,".mpv-chat-input-btn");if(this.__input=d.query(r,".mpv-chat-input")){var a=this.__input.getAttribute("type");a&&"input"==a.toLowerCase()&&(this.__inputType="input")}this.updateNickLayer=d.query(r,".mpv-chat-update-nick-layer");this.updateNickForm=d.query(r,".mpv-chat-update-nick-form");this.updateNickInput=d.query(r,".mpv-chat-update-nick-input");this.updateNickBtn=d.query(r,".mpv-chat-update-nick-btn");this.updateNickCancelBtn=d.query(r,".mpv-chat-update-nick-cancel-btn");this.updateFaceLayer=d.query(r,".mpv-chat-update-face-layer");this.updateFaceBtnOk=d.query(r,".mpv-chat-update-face-btn-ok");this.updateFaceBtnCancel=d.query(r,".mpv-chat-update-face-btn-cancel");this.updateFaceRows=d.query(r,".mpv-chat-update-face-rows");this.updateFaceRow=d.query(r,".mpv-chat-update-face-row");this.updateFaceRows&&(this.updateFaceRows.innerText="");this.updateFaceRow&&(this.updateFaceHtml=this.updateFaceRow.outerHTML);this.faceElements=[];if(n.alone){this.onAddEvent();setTimeout(function(){n&&n.callback&&n.callback.call(e,{type:"READY"})},1)}}}u.MESSAGE=t;d.extendClass(u,o,{onAddEvent:function(){var s=this,a=this.attr;function o(t){d.on(t,"click",function(){s.selectedFaceIcon(t)})}this.__inputBtn&&d.on(this.__inputBtn,"click",function(){s.sendChatMessage()});this.__form&&d.on(this.__form,"submit",function(t){s.sendChatMessage();return d.igEventAll(t)});if(this.__input){d.on(this.__input,"focus",function(){(function e(){if(!a.alone){var t=this.p.module("key");t&&t.disableMod(this)}}).call(s)});d.on(this.__input,"blur",function(){(function e(){if(!a.alone){var t=this.p.module("key");t&&t.enableMod(this)}}).call(s)});this.attr.focus&&this.__input.focus()}this.__menu&&d.on(this.__menu,"click",function(t){s.openMenu()});this.__closeMenu&&d.on(this.__closeMenu,"click",function(t){s.closeMenu()});this.updateNickForm&&d.on(this.updateNickForm,"submit",function(t){s.updateNickSubmit();return d.igEventAll(t)});this.updateNickBtn&&d.on(this.updateNickBtn,"click",function(t){s.updateNickSubmit();return d.igEventAll(t)});this.updateNickCancelBtn&&d.on(this.updateNickCancelBtn,"click",function(t){s.updateNickCancel();return d.igEventAll(t)});this.__updateNickMenu&&d.on(this.__updateNickMenu,"click",function(){s.showUpdateNick()});this.__updateFaceMenu&&d.on(this.__updateFaceMenu,"click",function(){s.showUpdateFace()});this.updateFaceBtnOk&&d.on(this.updateFaceBtnOk,"click",function(t){s.updateFaceSubmit();return d.igEventAll(t)});this.updateFaceBtnCancel&&d.on(this.updateFaceBtnCancel,"click",function(t){s.updateFaceCancel();return d.igEventAll(t)});var u,l,h=a.face&&a.face.baseUrl;(l=this.updateFaceRows)&&(u=this.updateFaceHtml)&&function(){var t,e;if((t=a.face&&a.face.icons)&&t.length&&h)for(var i=0;i<t.length;i++){var n=t[i];if(!(e=d.element(u)))return d.error("Not parse html element. "+u);var r=d.query(e,".mpv-chat-update-face-image");if(!r)return d.error("Not found mpv-chat-update-face-image className.");r.style.backgroundImage="url("+h+"/"+n+")";e.icon=n;d.append(l,e);s.faceElements.push(e);o(e)}}()},onStateChange:function(t){var e=this.attr;switch(t.type){case i.EVENT.ON_READY:if(e.callback)return e.callback.call(this,{type:"READY"});e.url&&this.open(e.url)}},setTitle:function(t){this.__title&&(this.__title.innerText=t)},regexp2string:function(t,e){var i,n,r=t,s=r.match(/\{[\s\S]+?\}/g);if(!s||s&&!s.length)return r;for(var a=0;a<s.length;a++)if((i=s[a])&&(n=i.substring(1,i.length-1).trim())){var o=e&&e[n]?e[n]+"":"****";(o=o&&o.trim())&&(r=r.replace(i,o))}return r},appendDisplayElement:function(t){var e=this.__display;if(e){d.append(e,t);e.scrollTop=e.scrollHeight}},getLv1Message:function(t,e){return this.regexp2string(this.message[t],e)},appendLv1Message:function(t,e){var i;if(i=this.__lv1Html){var n,r=d.element(i);if(n=d.query(r,".mpv-chat-lv-message")){n.innerText=this.getLv1Message(t,e);this.appendDisplayElement(r)}}},alertLv1Message:function(t,e){var i=this.getLv1Message(t,e);if(i)return alert(i)},log:function(t){var e=this.attr;if(e.log&&e.log.info){d.log(" ## CHAT >> "+t);for(var i=1;i<arguments.length;i++)d.log("         >> ",arguments[i])}},error:function(t){var e=this.attr;if(e.log&&e.log.error){d.error(" ## CHAT >> "+t);for(var i=1;i<arguments.length;i++)d.error("         >> ",arguments[i])}},close:function(){if(this.socket){if(this.socket.close)try{this.socket.close()}catch(t){}if(this.socket.conn&&this.socket.conn.close)try{this.socket.conn.close()}catch(t){}this.socket=null}},open:function(t){var s=this;this.currentServerNo=!1;if(!t&&!(t=this.attr.url))return this.appendLv1Message("NOT_FOUND_URL");if(!n)return this.appendLv1Message("NONE_SOCKETIO");function a(t){this.log(">> connect: "+t);var e=this.socket=n.connect(t);e.on("connect",function(){s.onconnected()});e.on("disconnect",function(t){s.ondisconnected(t)});e.on("message",function(t,e){s.onmessage(e)});e.on("error",function(t){d.error(">> error",t)})}var e=this.attr;e.title&&this.setTitle(e.title);0===t.indexOf("ws://")?a.call(this,t):d.ajax({url:t,error:function(){return s.appendLv1Message("NOT_FOUND_SERVER_INFO")},success:function(t){var e,i;try{e=JSON.parse(t)}catch(n){s.error(n);return s.appendLv1Message("NOT_FOUND_SERVER_INFO")}if(!e.success)return s.appendLv1Message("NOT_FOUND_SERVER_INFO");if(!(i=e.data))return s.appendLv1Message("NOT_FOUND_SERVER_INFO");if(!i.length)return s.appendLv1Message("NOT_FOUND_SERVER_INFO");(function r(t,e){if(e>=t.length)return s.appendLv1Message("NOT_FOUND_ALL_SERVER");var i=t[e];this.currentServerNo=e;var n="ws://"+i.ip+":"+i.port;a.call(this,n)}).call(s,i,0)}})},sendChatMessage:function(){var t,e=this.__input;if(e){if("input"==this.__inputType){t=e&&e.value;e.value=""}else{e.innerText="";t=e&&e.innerText}e.focus()}if(t&&(t=t.trim())){if(200<t.length)return alert("\ubb38\uc790\uae38\uc774\uac00 200\uc744 \ucd08\uacfc\ud558\uc600\uc2b5\ub2c8\ub2e4.");this.sendData({command:s.CHANNEL_MSG,message:t})}},sendData:function(t){if(this.socket){this.log("send",t);this.socket.send(t)}},onconnected:function(){this.isconnected=!0;this.log("connected")},ondisconnected:function(){this.isconnected=!1;this.appendLv1Message("ON_DISCONNECTED");this.log("disconnected")},onmessage:function(t){switch(t.command){case s.HELLO:return this.sendLoginData();case s.HELLO_DENY:return this.helloDeny(t);case s.HELLO_OK:return this.helloOk(t);case s.CHANNEL_JOIN:return this.channelJoin(t);case s.CHANNEL_MSG:return this.channelMsg(t);case s.USER_UPDATE_NICK:this.updateNickCancel();return this.appendLv1Message(t.success?"OK_UPDATE_NICKNAME":"FAIL_UPDATE_NICKNAME",t);case s.USER_UPDATE_FACE:this.updateFaceCancel();return this.appendLv1Message(t.success?"OK_UPDATE_FACE":"FAIL_UPDATE_FACE",t);case s.ADMIN_CREATE_CHANNEL_OK:case s.ADMIN_CREATE_CHANNEL_FAIL:case s.ADMIN_STOP_CHANNEL_FAIL:case s.ADMIN_STOP_CHANNEL_OK:case s.ADMIN_DROP_CHANNEL_FAIL:case s.ADMIN_DROP_CHANNEL_OK:return this.userCallbackError(t)}},sendLoginData:function(){var t=this.attr,e={};for(var i in t.login)e[i]=t.login[i];e.command=s.HELLO;this.sendData(e)},helloDeny:function(t){this.isdenylogin=!0;this.close();this.appendLv1Message("HELLO_DENY",{subId:t.sub});this.log("deny login: ",t)},helloOk:function(t){this.islogin=!0;this.appendLv1Message("HELLO_OK");this.log("login ok: ",t);this.userId=t.userId;this.userNick=t.userNick;this.userFace=t.userFace},channelJoin:function(t){this.appendLv1Message("CHANNEL_JOIN",t)},channelMsg:function(t){var e,i,n=this.attr,r=this.dateFormat(new Date(t.time)),s=t.userId===this.userId;if(n.channelMsg)e=n.channelMsg.call(this,t,s);else if(i=this.__rowHtml){e=d.element(i);var a=d.query(e,".mpv-chat-icon"),o=d.query(e,".mpv-chat-user"),u=d.query(e,".mpv-chat-time"),l=d.query(e,".mpv-chat-message");o.innerText=t.userNick;u.innerText=r;l.innerText=t.message;var h=n.face&&n.face.baseUrl,c=n.face&&n.face.defaultIcon;a&&(t.userFace?a.style.backgroundImage="url("+h+"/"+t.userFace+")":a.style.backgroundImage="url("+h+"/"+c+")")}if(e){s?d.addClass(e,"mpv-chat-mine"):d.addClass(e,"mpv-chat-other");this.appendDisplayElement(e)}},getServerUrl:function(){var t=this.attr.url,e=t.indexOf("ws://");return-1==e?null:t.substring(e+"ws://".length)},dateFormat:function(t){function e(t){var e=t+"";return e.length<2?"0"+e:2<e.length?e.substring(e.length-2):e}var i=this.attr,n=i.dateFormat?i.dateFormat:"dd HH:mm:ss",r=t;return n.replace(/(yyyy|yy|MM|dd|E|hh|mm|ss|a\/p)/gi,function(t){switch(t){case"yyyy":return r.getFullYear();case"yy":return e(r.getFullYear()%1e3);case"MM":return e(r.getMonth()+1);case"dd":return e(r.getDate());case"E":return weekName[r.getDay()];case"HH":return e(r.getHours());case"hh":return e((h=r.getHours()%12)?h:12);case"mm":return e(r.getMinutes());case"ss":return e(r.getSeconds());case"a/p":return r.getHours()<12?"\uc624\uc804":"\uc624\ud6c4";default:return t}})},getUserCallback:function(t){var e=++this.userCallbackNo;this.userCallbacks[e]=t;return e},userCallbackError:function(t){var e=t.cn,i=this.userCallbacks[e];if(!i)return this.error("Not found callback.",t);delete this.userCallbacks[e];i(t)},createChannel:function(t,e){var i=this;function n(t){i.error(t);e(t)}if(!t)return n("Not found data.");if(!t.channelName)return n("Not found channel name.");if(!t.userId)return n("Not found user id.");var r=this.getUserCallback(e);this.sendData({command:s.ADMIN_CREATE_CHANNEL,cn:r,data:t})},stopChannel:function(t,e){var i=this;function n(t){i.error(t);e(t)}if(!t)return n("Not found data.");if(!t.channelId)return n("Not found channel id.");if(!t.userId)return n("Not found user id.");var r=this.getUserCallback(e);this.sendData({command:s.ADMIN_STOP_CHANNEL,cn:r,data:t})},openMenu:function(){this.__menuLayer&&d.removeClass(this.__menuLayer,"mpv-hide")},closeMenu:function(){this.__menuLayer&&d.addClass(this.__menuLayer,"mpv-hide")},showUpdateNick:function(){if(!this.updateNickLayer)return this.error("Not found create nick html.");d.removeClass(this.updateNickLayer,"mpv-hide");this.updateNickInput&&this.updateNickInput.focus();this.closeMenu()},updateNickSubmit:function(){if(this.isUpdateNickSubmit)return this.error("running update nick submit !!");if(!this.updateNickInput)return this.error("Not found create nick input tag.");var t=this.attr,e=this.updateNickInput.value.trim(),r=this,i=t.nick;if(!e)return this.alertLv1Message("NONE_NICKNAME");if(!i||"auto"!=i.type){this.isUpdateNickSubmit=!1;return t&&t.createNick&&t.createNick.call(this,e)}var n={jwt:t.login.jwt?t.login.jwt:"",userId:t.login.userId?t.login.userId:"",userNick:e};if(!i.updateUrl)return this.alertLv1Message("NOT_FOUND_URL");if(/[`~!@#$%^&*|\\\'\"\s;:\/?]/gi.test(e))return this.alertLv1Message("SPECIAL_NICKNAME");this.isUpdateNickSubmit=!0;this.islogin?this.sendData({command:s.USER_UPDATE_NICK,data:n}):d.ajax({url:i.updateUrl,data:n,error:function(){r.isUpdateNickSubmit=!1;r.alertLv1Message("FAIL_UPDATE_NICKNAME")},success:function(t){r.isUpdateNickSubmit=!1;var e;try{e=JSON.parse(t)}catch(i){return r.error(i)}(function n(t){this.isUpdateNickSubmit=!1;var e=this.attr.nick;if(!t.success)return this.alertLv1Message("FAIL_UPDATE_NICKNAME",t);this.alertLv1Message("OK_UPDATE_NICKNAME2");this.updateNickLayer&&d.addClass(this.updateNickLayer,"mpv-hide");e&&e.callback&&e.callback.call(this,{type:"UPDATE_NICK_OK"})}).call(r,e)}})},updateNickCancel:function(){this.isUpdateNickSubmit=!1;this.attr.updateNick;this.updateNickInput&&(this.updateNickInput.value="");this.updateNickLayer&&d.addClass(this.updateNickLayer,"mpv-hide")},showUpdateFace:function(){if(!this.updateFaceLayer)return this.error("Not found update face html.");this.closeMenu();d.removeClass(this.updateFaceLayer,"mpv-hide")},selectedFaceIcon:function(t){this.selectedFaceIconName=t.icon;for(var e=this.faceElements,i=0;i<e.length;i++){var n=e[i];d.removeClass(n,"selected")}d.addClass(t,"selected")},updateFaceSubmit:function(){if(this.isUpdateFaceSubmit)return this.error("running update face submit !!");var t=this.attr,r=this,e=t.face,i=this.selectedFaceIconName;if(!e||"auto"!=e.type){this.isUpdateFaceSubmit=!1;return t&&t.createFace&&t.createFace.call(this,i)}var n={jwt:t.login.jwt?t.login.jwt:"",userId:t.login.userId?t.login.userId:"",userFace:i};if(!e.updateUrl)return this.alertLv1Message("NOT_FOUND_URL");if(!i)return this.alertLv1Message("NOT_FOUND_FACE_ICON");r.isUpdateFaceSubmit=!0;this.islogin?this.sendData({command:s.USER_UPDATE_FACE,data:n}):d.ajax({url:e.updateUrl,data:n,error:function(){r.isUpdateFaceSubmit=!1;r.alertLv1Message("FAIL_UPDATE_FACE")},success:function(t){r.isUpdateFaceSubmit=!1;var e;try{e=JSON.parse(t)}catch(i){return r.error(i)}(function n(t){this.isUpdateFaceSubmit=!1;var e=this.attr.face;if(!t.success){d.error(t);return this.alertLv1Message("FAIL_UPDATE_FACE",t)}this.alertLv1Message("OK_UPDATE_FACE");this.updateFaceLayer&&d.addClass(this.updateFaceLayer,"mpv-hide");e&&e.callback&&e.callback.call(this,{type:"UPDATE_FACE_OK"})}).call(r,e)}})},updateFaceCancel:function(){this.isUpdateFaceSubmit=!1;this.attr.updateFace;this.updateFaceLayer&&d.addClass(this.updateFaceLayer,"mpv-hide")}});u.CommandType=s;return u})}();!function(){"use strict";var i=getDframework();i.module("imgtech.media.Media");i.define("imgtech.media.module.MultiLanguage",function(){var e=i.module("imgtech.media.ModuleInterface");function t(t){e.apply(this,arguments);if(t)this.attr,this.p.userElement}i.extendClass(t,e,{onAddEvent:function(){},onStateChange:function(t){}});return t})}();!function(){"use strict";var u=getDframework(),o=u.module("imgtech.media.Media");u.define("imgtech.media.Controller",function(){var e=u.module("imgtech.media.ControllerInterface");function i(t){e.apply(this,arguments);if(t){this.p=t;this.attr=t.attr;this.userElement=this.p.userElement;this.innerElement=null;this.resourceElement=null;this.e={};this.m={};this.currentCssPath;this.__MODULE={};!function n(t,e){for(var i in e)if("object"==typeof e[i]){"object"!=typeof t[i]&&(t[i]={});n(t[i],e[i])}else t[i]=e[i]}(this.__MODULE,i.MODULE)}}i.MODULE={volume:{className:"imgtech.media.module.Volume"},progress:{className:"imgtech.media.module.Progress"},playlist:{className:"imgtech.media.module.Playlist"},size:{className:"imgtech.media.module.Size"},layout:{className:"imgtech.media.module.LayoutEx"},version:{className:"imgtech.media.module.Version"},continueTime:{className:"imgtech.media.module.ContinueTime"},switchSource:{className:"imgtech.media.module.SwitchSource"},ui:{className:"imgtech.media.module.UI"},radio:{className:"imgtech.media.module.Radio"},error:{className:"imgtech.media.module.MediaError"},thumbnail:{className:"imgtech.media.module.Thumbnail"},screenshot:{className:"imgtech.media.module.Screenshot"}};u.extendClass(i,e,{__addGlobalClass:function(t){u.addClass(this.userElement,t)},private_draw_l:function(t){var e=document.createElement("div"),i=!!(u.b.ie&&u.b.ie<9);this.p;u.addClass(e,"mpv-inner-player");e.appendChild(t);this.p.innerElement=this.innerElement=e;this.resourceElement=t;this.userElement.appendChild(e);u.b.isWindows&&this.__addGlobalClass("mpv-os-windows");u.b.isMacosx&&this.__addGlobalClass("mpv-os-macosx");u.b.isLinux&&this.__addGlobalClass("mpv-os-linux");if(u.b.isMobile){this.__addGlobalClass("mpv-os-mobile");if(u.b.android)this.__addGlobalClass("mpv-os-android");else if(u.b.iOS){this.__addGlobalClass("mpv-os-ios");u.b.iphone?this.__addGlobalClass("mpv-os-iphone"):u.b.ipad&&this.__addGlobalClass("mpv-os-ipad")}}if(u.b.ie){this.__addGlobalClass("mpv-b-ie");7==u.b.ie?this.__addGlobalClass("mpv-b-ie7"):8==u.b.ie?this.__addGlobalClass("mpv-b-ie8"):9==u.b.ie?this.__addGlobalClass("mpv-b-ie9"):10==u.b.ie?this.__addGlobalClass("mpv-b-ie10"):11==u.b.ie&&this.__addGlobalClass("mpv-b-ie11");"xp"==u.b.osAlias&&this.__addGlobalClass("mpv-os-xp")}i?this.__addGlobalClass("mpv-b-under-ie8"):this.__addGlobalClass("mpv-b-html5");u.b.chrome&&this.__addGlobalClass("mpv-b-chrome");u.b.whale&&this.__addGlobalClass("mpv-b-whale");u.b.safari&&this.__addGlobalClass("mpv-b-safari");u.b.firefox&&this.__addGlobalClass("mpv-b-firefox");u.b.opera&&this.__addGlobalClass("mpv-b-opera");this.attr.addClass&&this.__addGlobalClass(this.attr.addClass)},private_link_module_l:function(){var t,e,i,n,r=this.attr.module,s=this.__MODULE,a={};this.m={};for(e in s)a[e]=s[e];for(e in r)if(a[e]&&!1!==r[e]){if(r[e])for(i in r[e])a[e][i]=r[e][i]}else a[e]=r[e];for(e in a)if(t=a[e])try{if(t.className){if(!(n=u.module(t.className)))throw new Error("Not found control "+e+" module : "+t.className);this.m[e]=new n(this.p,this,t)}}catch(o){u.error(o)}else this.m[e]=!1;for(e in this.m)if(this.m[e].onAddEvent)try{this.m[e].onAddEvent()}catch(o){u.error(" ## Exception at "+e+"'s onAddEvent");u.error(o)}},draw:function(){function r(){this.private_link_module_l();var t,e=this.p.module("app");if(e&&e.isApp()){this.__addGlobalClass("mpv-zoneplayer-app");"string"==typeof(t=e.appName())&&this.__addGlobalClass("mpv-zoneplayer-"+t+"-app")}(function n(){var t=this.p.attr.zIndex;if(t){var e=this.p.userElement,i=u.query(e,".mpv-device");t+=2;u.zIndex(e,t);u.zIndex(i,t)}}).call(this)}if(null===this.userElement)return r.call(this);o.parseResource(this.attr);var t=this.attr,e=t.namespace;if(!t.resourceText)throw new Error("Not found resourceText");t.resourceText&&function s(t,e,i,n){i&&this.private_draw_l(i);r.call(this)}.call(this,e,t,u.element(t.resourceText),!0)},onStateChange:function(t){var e,i,n=this;for(e in this.m)if((i=this.m[e]).onStateChange)try{i.onStateChange(t)}catch(a){u.error(a)}switch(t.type){case o.EVENT.ON_READY:if(this.userElement){var r=u.queryAll(this.userElement,"button");u.on(r,"focus",function(){var t=n.p.module("key");t&&t.focus(!0)})}break;case o.EVENT.STATE_CHANGE:if(t.data==o.STATE.ENDED){var s=this.p.getPlayerType();"flash"==s||"flash2"==s||setTimeout(function(){n.p.pause();n.p.isEnableSeekToFirst()&&n.p.seekTo(0)},1)}}}});return i})}();!function(){"use strict";var a=getDframework(),o=a.module("imgtech.media.Media");o.ERROR;a.define("imgtech.media.module.Device",function(){var i=a.module("imgtech.media.ModuleInterface");function s(t){var e=this.p;if(!e.isBeforeFirstPlay){e.callStateChange({type:o.EVENT.ON_BEFORE_ONCE_PLAY,source:this.currentMediaSource(),device:this,parent:t});e.isBeforeFirstPlay=!0}if(!this.isBeforeFirstDevicePlay){e.callStateChange({type:o.EVENT.ON_BEFORE_DEVICE_PLAY,source:this.currentMediaSource(),device:this,parent:t});this.isBeforeFirstDevicePlay=!0}if(!this.isReadyPlay){this.isReadyPlay=!0;this.__readyPlay()}}function t(t){i.apply(this,arguments);if(t){var e=this.p.userElement;this.__device=a.query(e,".mpv-device");this.__activeStatus="create";this.isBeforeFirstDevicePlay=!1;this.lastVolume=0;this.lastMuted=!1;this.__disablePauseDisplayForStop=!1;this.clear()}}a.extendClass(t,i,{currentMediaSource:function(){throw new Error("currentMediaSource is abstract method.")},getClassName:function(){throw new Error("getClassName is abstract method.")},getPlayerType:function(){throw new Error("getPlayerType is abstract method.")},clear:function(){this.lastState=-1;this.lastStateText="";this.lastDuration=-1;this.lastCurrentTime=0;this.lastBuffering=0;this.__disablePauseDisplayForStop=!1},onAddEvent:function(){},onCurrentTimeSync:function(){var t=this,e=this.p,i=(e.attr,this.currentTime()),n=this.duration();if(n&&this.lastDuration!=n){if(this.is_temporary_removal)return 0<n?setTimeout(function(){t.stop()},1):void 0;this.lastDuration=n;e.callStateChange({type:o.EVENT.DURATION_CHANGE,data:{duration:n||0,currentTime:i||0},source:this.currentMediaSource(),device:this})}if(this.lastCurrentTime!=i){if(this.is_temporary_removal)return 0<i?setTimeout(function(){t.stop()},1):void 0;this.lastCurrentTime=i;e.callStateChange({type:o.EVENT.CURRENT_TIME_CHANGE,data:{duration:n||0,currentTime:i||0},source:this.currentMediaSource(),device:this})}if(0<this.lastDuration&&this.lastDuration<=this.lastCurrentTime&&this.virtualTime()){this.stop();setTimeout(function(){e.callStateChange({type:o.EVENT.STATE_CHANGE,data:o.STATE.SYSTEM_ENDED})},1)}},onBufferingSync:function(){var t=this,e=this.p,i=this.getBuffering();if(this.lastBuffering!=i){if(this.is_temporary_removal)return 0<i?setTimeout(function(){t.stop()},1):void 0;this.lastBuffering=i;e.callStateChange({type:o.EVENT.BUFFERING_CHANGE,data:i,source:this.currentMediaSource(),device:this})}},onVolumeSync:function(){if(!this.is_temporary_removal){var t,e,i=this.p;if(this.lastVolume!=(t=this.getVolume())||this.lastMuted!=(e=this.isMuted())){this.lastVolume=t||0;this.lastMuted=e||!1;var n=this;setTimeout(function(){i.callStateChange({type:o.EVENT.VOLUME_CHANGE,data:{volume:n.lastVolume,muted:n.lastMuted},source:n.currentMediaSource(),device:n})},1)}}},onSync:function(){var t=this.p.attr;t.useUpdateTimeSync&&this.onCurrentTimeSync();t.useBufferingSync&&this.onBufferingSync();t.useVolumeSync&&this.onVolumeSync()},onStateChange:function(t){this.p;var e,i,n,r=t.data;switch(t.type){case o.EVENT.ON_SYNC:return this.onSync();case o.EVENT.ON_BEFORE_DEVICE_PLAY:this.setInitVolume({volume:o.getSavedVolume(),mute:o.getSavedMuted()});return;case o.EVENT.CAN_PLAY:return s.call(this,t);case o.EVENT.STATE_CHANGE:this.lastState=t.data;this.lastStateText=o.getStateName(t.data);t.data!==o.STATE.PAUSED&&(this.__disablePauseDisplayForStop=!1);switch(t.data){case o.STATE.SETSOURCE:this.clear();break;case o.STATE.PLAYING:case o.STATE.PAUSED:s.call(this,t)}return;case o.EVENT.PLAY_MEDIA:return(e=this.currentMediaSource())&&e.input&&(i=e.input.preview)&&(0===(n=this.p.currentTime())||n)&&n>i.end+1?this.p.warn("This is not play. because of this media is preview !!!"):this.play(t);case o.EVENT.PAUSE_MEDIA:return this.pause(t);case o.EVENT.STOP_MEDIA:return this.stop();case o.EVENT.PREVIOUS_MEDIA:return this.previous();case o.EVENT.NEXT_MEDIA:return this.next();case o.EVENT.CURRENT_MEDIA:return this.current(t);case o.EVENT.INDEX_MEDIA:return this.index(t.data);case o.EVENT.MUTE_MEDIA:return r?this.mute():this.unMute();case o.EVENT.SET_VOLUME:return this.setVolume(r);case o.EVENT.SEEKTO_MEDIA:return;case o.EVENT.SET_PLAYBACK_QUALITY:return this.setPlaybackQuality(r);case o.EVENT.SET_PLAYBACK_SUBTITLE:return this.setPlaybackSubtitle(r)}},setADData:function(t){this.__ADData=t||null},getADData:function(){return this.__ADData},setVASTData:function(t){this.__VASTData=t||null},getVASTData:function(){return this.__VASTData},isPlaying:function(){switch(this.getPlayerState()){case o.STATE.PLAYING:case o.STATE.BUFFERING:return!0}return!1},getPlayerState:function(){throw new Error("getPlayerState is abstract method.")},player:function(){throw new Error("player is abstract method.")},source:function(){},__readyBeforePlay:function(){this.p.isAutoplay()?this.play():this.pause();this.p.callStateChange({type:o.EVENT.ON_BEFORE_PLAY,source:this.currentMediaSource(),device:this})},__readyContinueTime:function(){var t=this.p,e=this.currentMediaSource(),i=!0,n=!1,r=null,s=e&&e.currentSourceAttribute;if(e){if(!this.p.isLive()&&!this.p.isDVR()){if(e.errorContinueTime){n=e.errorContinueTime;r=e.errorIsPlaying}else if(s&&s.data&&s.data.currentTime){n=s.data.currentTime;var a=s.data.isPlaying;r=!0===a||!1===a?a:e.errorIsPlaying}else if(e.input&&e.input.autoContinueTime)n=e.input.autoContinueTime;else if(e.input&&e.input.continueTime){n=e.input.continueTime;i=!1}if(n){t.callStateChange({type:o.EVENT.CONTINUE_TIME,data:n,isAuto:i,isPlaying:r});return}}this.__readyBeforePlay()}},__readyPlay:function(){if(!this.p.isLive()&&!this.p.isDVR()){this.pause();if(this.virtualTime()){this.seekTo(0);var t=this;return setTimeout(function(){t.__readyContinueTime()},1)}}this.__readyContinueTime()},play:function(){throw new Error("play is abstract method.")},pause:function(){throw new Error("pause is abstract method.")},stop:function(){throw new Error("stop is abstract method.")},patchStopForSeekToFirst:function(){this.p.isEnableSeekToFirst()&&this.seekTo(0)},beforeStop:function(){var t=!this.p.attr.enableStopDisplay;this.__disablePauseDisplayForStop=t},info:function(t){if((t=t||0)<0)throw new Error("source index > 0. index: "+t);var e=this.p;return a.isArray(e.src)&&e.src.length&&e.src.length>t?e.src[t]:null},previous:function(){var t,e,i,n=this.p,r=!1;if(a.isArray(n.src)&&n.src.length){if(0<n.playlistIndex)t=n.src[--n.playlistIndex];else if(-1!=n.playlistIndex){(e=n.module("playlist"))&&(i=e.attr)&&(!1===i.enableRotatePrevious||!0===i.enableRotatePrevious&&(r=!0));if(r)t=n.src[n.playlistIndex=n.src.length-1];else{n.warn("## Not rotate previous source.");t=null}}t&&this.source(t)}},next:function(){var t,e,i,n=this.p,r=!1;if(a.isArray(n.src)&&n.src.length){if(-1==n.playlistIndex)t=n.src[++n.playlistIndex];else if(n.src.length>n.playlistIndex+1)t=n.src[++n.playlistIndex];else if(n.src.length>n.playlistIndex){(e=n.module("playlist"))&&(i=e.attr)&&(!1===i.enableRotateNext||!0===i.enableRotateNext&&(r=!0));if(r)t=n.src[n.playlistIndex=0];else{n.warn("## Not rotate next source.");t=null}}else t=n.src[n.playlistIndex=n.src.length-1];t&&this.source(t)}},current:function(t){var e,i=this.p;if(a.isArray(i.src)&&i.src.length){var n=i.playlistIndex;n<0?n=i.playlistIndex=0:0<=n&&n<i.src.length||(n=i.playlistIndex=0);e=i.src[n];this.source(e,t)}},index:function(t){if("number"!=typeof t)throw new Error("index argument is not number.");var e,i=this.p;if(!a.isArray(i.src)||!i.src.length)throw new Error("Not found source.");if(i.src.length<=t||t<0)throw new Error("Not found source. srclength: "+i.src.length+", index: "+t);i.playlistIndex=t;e=i.src[t];this.source(e)},isMuted:function(){throw new Error("isMuted is abstract method.")},mute:function(){throw new Error("mute is abstract method.")},unMute:function(){throw new Error("unMute is abstract method.")},getVolume:function(){throw new Error("getVolume is abstract method.")},setVolume:function(t){throw new Error("setVolume is abstract method.")},setInitVolume:function(t){this.__isSetInitVolume=!0;this.__isSetInitMute=!0;this.setVolume(t.volume);this.p.attr.enableInitMute&&t.mute?this.mute():this.unMute()},duration:function(){throw new Error("duration is abstract method.")},currentTime:function(){throw new Error("currentTime is abstract method.")},getBuffering:function(){throw new Error("getBuffering is abstract method.")},seekTo:function(){throw new Error("seekTo is abstract method.")},getPlaybackRate:function(){throw new Error("getPlaybackRate is abstract method.")},getAvailablePlaybackRates:function(){var t=this.p.module("rate"),e=t&&t.attr.rateInfo;return e&&a.isArray(e)&&e.length?e:null},setPlaybackRate:function(){throw new Error("setPlaybackRate is abstract method.")},getPlaybackQuality:function(t){var e=this.currentMediaSource(),i=e?e.getQuality():null;return t&&i?[i]:i},getAvailableQualityLevels:function(){var t=this.currentMediaSource();return t?t.getQualityList():null},setPlaybackQuality:function(t){var e=this.currentMediaSource(),i=this.p.module("quality");if(i&&!i.attr.use)return this.p.warn("Setting not use quality.");e.setQuality(t)},getAvailableSubtitles:function(){var t=this.currentMediaSource();return t?t.getSubtitleList():null},getPlaybackSubtitle:function(){var t=this.currentMediaSource();return t?t.getSubtitle():null},setPlaybackSubtitle:function(t){var e=this.currentMediaSource(),i=this.p.module("subtitle");if(i&&!i.attr.use)return this.p.warn("Setting not use subtitle.");e&&e.setSubtitle(t)},temporary_removal:function(){this.is_temporary_removal=!0},untemporary_removal:function(){this.is_temporary_removal=!1},virtualTime:function(){var t,e=this.p;return e.isLive()||e.isDVR()?null:(t=e.currentMediaSource())&&t.input&&t.input.virtualTime},virtualCurrentTime:function(t){var e=this.virtualTime();if(e){(t=t||0)<e.start?t=e.start:t>e.end&&(t=e.end);return t-e.start}return t||0},virtualSeekToValue:function(t){var e=this.virtualTime();if(e){t=t||0;if((t+=e.start)>e.end)return e.end}return t},setSphericalProperties:function(t){throw new Error("setSphericalProperties is abstract method.")},getSphericalProperties:function(){return null},isSphericalProperties:function(){return!1}});return t})}();!function(){"use strict";var a=getDframework(),o=a.module("imgtech.media.Media");a.define("imgtech.media.VideoPlayer",function(){var i=a.module("imgtech.media.module.Device");a.module("imgtech.media.Source");function n(t){i.apply(this,arguments);if(t){var e=this.p.attr;this.guid=this.getPlayerType()+"_"+a.guid("");this.currentVideoSource=null;this.firstVideoPlayForLive=!1;this.usePauseBtn=!1;this.usePlaybackRate=1;e&&a.b.iOS&&(e.useVolumeSync=!0)}}a.extendClass(n,i,{currentMediaSource:function(){return this.currentVideoSource},getClassName:function(){return"imgtech.media.VideoPlayer"},getPlayerType:function(){return"video"},destroy:function(){this.reset()},onReady:function(t){if(this.__device){var e=this.p;if(a.b.safari&&a.b.isWindows){var i="Not supported safari (video/hls).";"hls"==this.getPlayerType()&&(i+=" You can use flash for hls(m3u8) !!!");e.error(i);throw new Error(i)}var n=this.vp=document.createElement("video"),r=(t&&t.source&&t.source.source(),e.attr&&e.attr["native"]);n.style.width="100%";n.style.height="100%";n.style.margin="0px 0px";n.style.padding="0px 0px";n.style.textAlign="center";n.style.verticalAlign="middle";e.attr.zIndex&&(n.style.zIndex=e.attr.zIndex);n.setAttribute("webkit-playsinline",!0);n.setAttribute("webkitplaysinline",!0);n.setAttribute("playsinline",!0);e.attr.crossOrigin&&n.setAttribute("crossorigin",e.attr.crossOrigin);n.setAttribute("autoplay","false");r&&a.b.isMobile&&((r.iOS||r.ios)&&a.b.iOS&&a.b.safari?n.setAttribute("controls","true"):r.android&&a.b.android&&n.setAttribute("controls","true"));var s=this.p.module("rate");(!s||s&&!s.attr.use)&&Object.defineProperty(n,"playbackRate",{writable:!1});n.setAttribute("id",this.guid);n.setAttribute("playerType",this.getPlayerType());n.setAttribute("playerClassName",this.getClassName());this.__device.appendChild(n);this.zonemediaelement=n;this.onReadyPatchEvent();return t&&t.callback?t.callback():this.next()}},onStateChange:function(t){this.p;switch(t.type){case o.EVENT.ON_READY:return this.onReady(t)}n.__super.onStateChange.apply(this,arguments)},getPlayerState:function(){var t=this.vp;return t?t.ended?o.STATE.ENDED:0===t.readyState?o.STATE.UNSTARTED:t.readyState<t.HAVE_FUTURE_DATA?o.STATE.CUED:t.paused?o.STATE.PAUSED:o.STATE.PLAYING:o.STATE.UNSTARTED},reset:function(){var t=this.vp;if(t){try{t.pause()}catch(e){}try{t.removeAttribute("src");t.load()}catch(e){}}if(this.currentVideoSource){this.currentVideoSource.stop();this.currentVideoSource=null}},source:function(t){var e=this.vp,i=this.p,n=this;if(e&&t){this.clear();this.reset();this.isReadyPlay=!1;this.usePlaybackRate=1;setTimeout(function(){n.currentVideoSource=t;a.b.ie&&9==a.b.ie?e.setAttribute("src",t.source()):e.src=t.source();i.callStateChange({type:o.EVENT.STATE_CHANGE,data:o.STATE.SETSOURCE,source:t,device:n})},1)}},play:function(){var t=this.vp,e=this.p,i=this;if(!this.currentVideoSource)return e.warn("Not play: no source");if(e.isLive())if(e.isPlaying())t&&t.play?t.play():e.warn(" ## play: not play. Becase play function.");else if(this.__has_not_play||this.usePauseBtn)e.current();else{this.__has_not_play=!0;t.play()}else if(t&&t.play){t.play();setTimeout(function(){i.usePauseBtn&&a.b.ie&&1!==i.usePlaybackRate&&(t.playbackRate=i.usePlaybackRate)},1)}else e.warn(" ## play: not play. Becase play function.")},pause:function(){var t=this.vp;if(t&&t.pause){this.usePauseBtn=!0;try{t.pause()}catch(e){a.error("Error at pause !!!");a.error(e)}}},stop:function(){var t=this;setTimeout(function(){(function e(){var t=this.vp;if(t&&t.pause){n.__super.beforeStop.apply(this,arguments);this.pause();this.patchStopForSeekToFirst()}}).call(t)})},isMuted:function(){var t=this.vp;return!!t&&t.muted},mute:function(){var t=this.vp;t&&(t.muted=!0)},unMute:function(){var t=this.vp;t&&(t.muted=!1)},getVolume:function(){var t=this.vp;return t&&t.volume?100*t.volume:0},setVolume:function(t){var e=this.vp;if(e){t=(5<t?t:5)/100;e.volume=t}},duration:function(t){var e=this.vp,i=e&&e.duration?e.duration:0;return t?i||0:this.virtualCurrentTime(i)},currentTime:function(t){var e=this.vp,i=e&&e.currentTime?e.currentTime:0;return t?i||0:this.virtualCurrentTime(i)},getBuffering:function(){var t=this.vp,e=this.duration(),i=this.currentTime(),n=t.buffered;if(n&&n.length&&n.end&&e)for(var r=0;r<n.length;r++){var s=n.start(r),a=n.end(r);if(s<=i&&i<=a)return this.virtualCurrentTime(a)/e}return 0},seekTo:function(t){var i=this.vp;if(i&&!this.p.isLive())try{i.currentTime=this.virtualSeekToValue(t)}catch(e){a.error(e)}},getDefaultPlaybackRate:function(){var t,e=this.getAvailablePlaybackRates();if(e)for(t=0;t<e.length;t++)if(1==e[t].value)return e[t];return null},getPlaybackRate:function(){var t=this.vp,e=t&&t.playbackRate?t.playbackRate:1;if(a.b.ie&&9==a.b.ie){var i=e.toFixed(2);return 1.29==i?1.3:parseFloat?parseFloat(i):i}return e},setPlaybackRate:function(t){var e,i=this.vp,n=this.p,r=o.getRateValue(t),s=this.currentVideoSource,a=this.p.module("rate");if(!a)return this.p.warn("Setting not rate module.");if(a&&!a.attr.use)return this.p.warn("Setting not use rate.");if(i&&(e=i.playbackRate)!=r.value){i.playbackRate=r.value;this.usePlaybackRate=r.value;e!=i.playbackRate&&n.callStateChange({type:o.EVENT.RATE_CHANGE,data:r,source:s,device:this,parent:null})}},getVideoSize:function(){var t=this.vp;return{width:t.videoWidth,height:t.videoHeight}},__applyErrorEvent:function(){var n=this.p,r=this.vp,s=this;a.on(r,"error",function(t){if(a.b.ie&&r&&r.error){a.error("Create error event : "+r.error.code);try{for(var e in r.error)r.error[e]==r.error.code&&a.error("ErrorName: "+e)}catch(i){}a.error(r.error)}else{a.error("Create error event : ");a.error(t)}n.callStateChange({type:o.EVENT.ON_ERROR,data:t,source:s.currentMediaSource(),device:s})})},__applyPlayEvent:function(){var e=this.p,t=this.vp,i=this;a.on(t,"play",function(t){if(i.is_temporary_removal)return setTimeout(function(){i.stop()},1);e.callStateChange({type:o.EVENT.STATE_CHANGE,data:o.STATE.PLAYING,source:i.currentVideoSource,device:i,parent:null})})},__applyPauseEvent:function(){var e=this.p,t=this.vp,i=this;a.on(t,"pause",function(t){if(i.is_temporary_removal)return setTimeout(function(){i.stop()},1);e.callStateChange({type:o.EVENT.STATE_CHANGE,data:o.STATE.PAUSED,source:i.currentVideoSource,device:i,parent:null})})},__applyTimeUpdateEvent:function(){this.p;var t=this.vp,e=this;a.on(t,"timeupdate",function(t){if(e.is_temporary_removal)return setTimeout(function(){e.stop()},1);e.onCurrentTimeSync()})},__applyProgressEvent:function(){this.p;var t=this.vp,e=this;a.on(t,"progress",function(t){if(e.is_temporary_removal)return setTimeout(function(){e.stop()},1);e.onCurrentTimeSync();e.onBufferingSync()})},__applyVolumeChangeEvent:function(){this.p;var t=this.vp,e=this;a.on(t,"volumechange",function(t){e.is_temporary_removal||e.onVolumeSync()})},__applyCanPlayEvent:function(){var e=this.p,t=this.vp,i=this;a.on(t,"canplay",function(t){if(i.is_temporary_removal)return setTimeout(function(){i.stop()},1);e.callStateChange({type:o.EVENT.CAN_PLAY,stype:"canplay",source:i.currentVideoSource,device:i,parent:null})})},__applyLoadStartEvent:function(){var e=this.p,t=this.vp,i=this;a.on(t,"loadstart",function(t){i.is_temporary_removal||e.callStateChange({type:o.EVENT.WAITTING,stype:"loadstart",data:!0,source:i.currentVideoSource,device:i,parent:null})})},__applyWaitingEvent:function(){var e=this.p,t=this.vp,i=this;a.on(t,"waiting",function(t){i.is_temporary_removal||e.attr.wait&&e.attr.wait.disable&&a.b.isWindows&&a.b.edge||a.b.ie||e.callStateChange({type:o.EVENT.WAITTING,stype:"waiting",data:!0,source:i.currentVideoSource,device:i,parent:null})})},__applySeekingEvent:function(){var e=this.p,t=this.vp,i=this;a.on(t,"seeking",function(t){i.is_temporary_removal||e.callStateChange({type:o.EVENT.WAITTING,stype:"seeking",data:!0,source:i.currentVideoSource,device:i,parent:null})})},__applySeekedEvent:function(){var e=this.p,t=this.vp,i=this;a.on(t,"seeked",function(t){i.is_temporary_removal||e.callStateChange({type:o.EVENT.WAITTING,stype:"seeked",data:!1,source:i.currentVideoSource,device:i,parent:null})})},__applyEndedEvent:function(){var e=this.p,t=this.vp,i=this;a.on(t,"ended",function(t){i.is_temporary_removal||e.callStateChange({type:o.EVENT.STATE_CHANGE,data:o.STATE.SYSTEM_ENDED,source:i.currentVideoSource,device:i,parent:null})})},__applyLoadDataEvent:function(){var i=this.p,t=this.vp,n=this;a.on(t,"loadeddata",function(t){if(!n.is_temporary_removal){var e=n.getVideoSize();e.width&&e.height&&i.callStateChange({type:o.EVENT.VIDEO_SIZE_DATA,data:n.getVideoSize(),source:n.currentVideoSource,device:n,parent:null})}})},onReadyPatchEvent:function(){this.__applyErrorEvent();this.__applyPlayEvent();this.__applyPauseEvent();this.__applyTimeUpdateEvent();this.__applyProgressEvent();this.__applyVolumeChangeEvent();this.__applyCanPlayEvent();this.__applyLoadStartEvent();this.__applyWaitingEvent();this.__applySeekingEvent();this.__applySeekedEvent();this.__applyEndedEvent();this.__applyLoadDataEvent()}});return n})}();!function(){"use strict";var i=getDframework(),o=i.module("imgtech.media.Media");i.define("imgtech.media.HlsPlayer",function(){var e=i.module("imgtech.media.VideoPlayer"),a=i.module("imgtech.media.Source");function t(t){e.apply(this,arguments);t&&(this.guid="hls_"+i.guid(""))}i.extendClass(t,e,{getClassName:function(){return"imgtech.media.HlsPlayer"},getPlayerType:function(){return"hls"},source:function(t){if(!(t instanceof a))throw new TypeError("src is not instanceof Source");var e=this.vp,i=this.p,n=(this.hls,this),r=this.p.attr.hls,s=r&&r.playerVars;if(t)if(Hls.isSupported()){this.clear();this.reset();this.isReadyPlay=!1;this.hls=s?new window.Hls(s):new window.Hls;this.hls.attachMedia(e);this.hls.on(Hls.Events.MEDIA_ATTACHED,function(){n.currentVideoSource=t;n.hls.loadSource(t.source());i.callStateChange({type:o.EVENT.STATE_CHANGE,data:o.STATE.SETSOURCE,source:t,device:n})});this.hls.on(Hls.Events.ERROR,function(t,e){i.callStateChange({type:o.EVENT.ON_ERROR,event:t,data:e,device:n})})}else i.error(new Error("Not supported HLS !!!"))}});return t})}();!function(){"use strict";var o=getDframework(),u=o.module("imgtech.media.Media");o.define("imgtech.media.StreamPlayer",function(){var i=o.module("imgtech.media.VideoPlayer"),a=o.module("imgtech.media.Source");function t(t){i.apply(this,arguments);t&&(this.guid="stream_"+o.guid(""))}o.extendClass(t,i,{getClassName:function(){return"imgtech.media.StreamPlayer"},getPlayerType:function(){return"stream"},canAutoPlay:function(t){return this.box.isEqualSource?this.box.isEqualSource=!1:!!t&&t.autoplay()},reset:function(){t.__super.reset.apply(this,arguments)},source:function(t){if(!(t instanceof a))throw new TypeError("src is not instanceof Source");var e=this.vp,i=this.p,n=this.p.attr,r=o.module("imgtech.media.MP4Player"),s=n.stream;if(t){this.clear();this.reset();this.isReadyPlay=!1;if(!this.box){this.box=new r(s);this.box.attachVideo(e)}this.currentVideoSource=t;this.box.source(t);i.callStateChange({type:u.EVENT.STATE_CHANGE,data:u.STATE.SETSOURCE,source:t,device:this})}},seekTo:function(t){var i=this.vp;if(i&&!this.p.isLive()){if(this.box.isSetLastSegmentBuffer)return this.p.warn("Disable seekTo by maxLimitedDuration. maxLimitedDuration: "+this.box.maxLimitedDuration);try{i.currentTime=this.virtualSeekToValue(t)}catch(e){o.error(e)}}}});return t})}();!function(){"use strict";var d=getDframework(),a=d.module("imgtech.media.Media"),i=a.CN;d.define("imgtech.Flash",function(){function t(){}t.installPageElement=function(t){var e=t&&t.getnewflash?t.getnewflash:"getnewflash.png",i=document.createElement("div");d.addClass(i,"mpv-getnewflash");var n="<table><tr><td align='center' valign='middle'>\n<div>\n<a href='http://www.adobe.com/go/getflashplayer'>\n<img class='mpv-getnewflash-image' src='"+e+"' alt='Get Adobe Flash player'></a>\n</div>\n</td></tr></table>\n";i.innerHTML=n;return i};t.isInstalled=function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(e){if(navigator.mimeTypes["application/x-shockwave-flash"]!==undefined)return!0}return!1};t.getFlashParameters=function(t){t||(t={});return{allowFullscreen:t.allowFullscreen?t.allowFullscreen:"true",allowNetworking:t.allowNetworking?t.allowNetworking:"all",allowScriptAccess:t.allowScriptAccess?t.allowScriptAccess:"always",quality:t.quality?t.quality:"high",wmode:t.wmode?t.wmode:"transparent",flashvars:t.flashvars?t.flashvars:"",movie:t.movie}};t.getFlashVars=function(t){t||(t={});if(!t.id)throw new Error("Not found flash id.");return{autoPlay:!1,continuerTime:t.continuerTime?t.continuerTime:0,debugMode:!!t.debugMode,domain:t.domain?t.domain:"",id:t.id,isLive:t.isLive,poster:t.poster?t.poster:"",skipInterval:t.skipInterval?t.skipInterval:5,source:t.source?t.source:"",tastingTime:t.tastingTime?t.tastingTime:0,useShortcuts:!0===t.useShortcuts||"true"==t.useShortcuts,volume:t.volume?t.volume:.5}};t.getFlashVarString=function(t){var e,i,n="";for(e in t){i=t[e];n+=n?"&"+e+"="+i:e+"="+i}return n};return t});d.define("imgtech.media.FlashPlayer",function(){var e=d.module("imgtech.media.module.Device"),h=d.module("imgtech.media.Source"),c=d.module("imgtech.Flash");function n(t){e.apply(this,arguments);if(t){this.currentFlashSource=null;this.guid="flash_"+d.guid("");this.isFlashFirstLoading=!1;this.isCalledFlashReady=!1;this.lastFlashState=a.STATE.UNSTARTED;this.lastFlashMuted=!1;this.lastFlashVolume=50;this.lastFlashCurrentTime=0;this.lastFlashDuration=0;this.lastFlashBuffering=0}}d.extendClass(n,e,{currentMediaSource:function(){return this.currentFlashSource},getClassName:function(){return"imgtech.media.FlashPlayer"},getPlayerType:function(){return"flash"},repairFlashFirstLoading:function(){if(!this.isFlashFirstLoading){this.isFlashFirstLoading=!0;d.removeClass(this.p.userElement,i.INSTALL_FLASH_SCREEN)}},onStateChange:function(t){var e=this.p,i=n.__super.onStateChange;switch(t.type){case a.EVENT.ON_READY:return this.onReady(t);case a.EVENT.ON_BEFORE_DEVICE_PLAY:i.apply(this,arguments);this.isMuted()&&this.p.mute();return;case a.EVENT.STATE_CHANGE:switch(t.data){case a.STATE.PLAYING:this.repairFlashFirstLoading();e.callStateChange({type:a.EVENT.CAN_PLAY,stype:"playing",where:"flash",source:this.currentFlashSource,device:this,parent:t});break;case a.STATE.PAUSED:this.repairFlashFirstLoading();e.callStateChange({type:a.EVENT.CAN_PLAY,stype:"paused",where:"flash",source:this.currentFlashSource,device:this,parent:t})}break;case a.EVENT.WAITTING:t.data&&this.repairFlashFirstLoading()}i.apply(this,arguments)},getPlayerState:function(){return this.lastFlashState},reset:function(){this.lastFlashState=a.STATE.UNSTARTED;this.currentFlashSource=null},source:function(t){if(!(t instanceof h))throw new TypeError("source is not instanceof Source");var e=this.getFlashObject(),i=this.p;if(e&&e.setSource){this.clear();this.isReadyPlay=!1;this.lastFlashCurrentTime=0;this.lastFlashDuration=0;this.lastFlashBuffering=0;this.lastFlashState=a.STATE.SETSOURCE;this.currentFlashSource&&this.currentFlashSource.stop();this.currentFlashSource=t;i.callStateChange({type:a.EVENT.STATE_CHANGE,data:a.STATE.SETSOURCE,source:this.currentFlashSource,device:this,parent:null});e.setSource(t.source())}},play:function(){var t=this.getFlashObject(),e=this.p,i=this.currentFlashSource;if(this.lastFlashState==a.STATE.UNSTARTED||!i)return e.warn("Not play: unstarted or no source");if(t&&t.togglePlay)if(this.isPlaying())e.warn(" ## current playing");else if(!i.isRTMP()&&e.isLive()){e.warn(" ## retry current source. rtmp: "+i.isRTMP());this.source(i)}else if(e.isLive()){e.log(" ## toggle flash. rtmp: "+i.isRTMP());this.source(i)}else{e.log(" ## toggle flash. rtmp: "+i.isRTMP()+", source: "+i.source());t.togglePlay()}else e.warn(" ## Not found play function.")},pause:function(){var t=this.getFlashObject(),e=this.p,i=this.currentFlashSource;t&&t.togglePlay?(!i.isRTMP()&&e.isLive(),t.togglePlay()):e.warn(" ## Not found pause function.")},stop:function(){var t=this;setTimeout(function(){(function i(){var t=this.getFlashObject(),e=this.lastFlashState;if(t&&t.playerstop)if(e==a.STATE.PLAYING){n.__super.beforeStop.apply(this,arguments);this.pause();this.patchStopForSeekToFirst()}else e==a.STATE.PAUSED&&this.patchStopForSeekToFirst()}).call(t)},1)},isMuted:function(){return this.lastFlashMuted},mute:function(){var t=this.getFlashObject();t&&t.toggleMute&&t.toggleMute()},unMute:function(){var t=this.getFlashObject();t&&t.toggleMute&&t.toggleMute()},getVolume:function(){return this.lastFlashVolume},setVolume:function(t){var e=this.getFlashObject();e&&e.setvolume&&e.setvolume((5<t?t:5)/100)},duration:function(t){var e=this.lastFlashDuration;return t?e||0:this.virtualCurrentTime(e)},currentTime:function(t){var e=this.lastFlashCurrentTime;return t?e||0:this.virtualCurrentTime(e)},getBuffering:function(){return this.lastFlashBuffering},seekTo:function(t){var e=this.getFlashObject(),i=this.p,n=this.currentFlashSource;e&&e.seek&&n&&(i.isLive()||(n.isRTMP()&&!this.isPlaying()?i.error(" ## Not seek on pause. because this source is vod rtmp."):e.seek(this.virtualSeekToValue(t))))},getPlaybackRate:function(){this.getFlashObject();return 1},getAvailablePlaybackRates:function(){return[]},setPlaybackRate:function(t){var e=this.getFlashObject(),i=this.p.module("rate");if(!i)return this.p.warn("Setting not rate module.");if(i&&!i.attr.use)return this.p.warn("Setting not use rate.");e&&e.playbackRate},getVideoSize:function(){return{width:300,height:200}},onDrawIe8:function(t){if(!this.__device)throw new Error("Not found player element.");var e,i,n,r;this.p;e="<object";for(r in this.flashObjectAttribute)e+=" "+r+'="'+this.flashObjectAttribute[r]+'"';e+=">";n="";for(r in this.flashParameters)n+='<param name="'+r+'" value="'+this.flashParameters[r]+'"></param>';i="<embed";for(r in this.flashEmbedAttribute)i+=" "+r+'="'+this.flashEmbedAttribute[r]+'"';var s=e+(i+="></embed>")+n+"</object>";t.innerHTML=s},__getStaticSwfName:function(){return"flashplayer.swf"},__getSwfPath:function(){if(this.p.attr.flashpath)return this.p.attr.flashpath;for(var t,e=d.queryAll("script"),i="js/source/source.js",n=0;n<e.length;n++){var r=e[n].src,s=r.lastIndexOf("?");-1!==s&&(r=r.substring(0,s));if(-1!==(s=r.lastIndexOf(a.filename))){if(r.substring(s)===a.filename)return r.substring(0,s)+this.__getStaticSwfName()}else if(t=/mediaplayer-[0-9\.]+\.min\.js/.exec(r)){s=r.lastIndexOf(t[0]);if(r.substring(s)===t[0])return r.substring(0,s)+this.__getStaticSwfName()}else if(-1!==(s=r.lastIndexOf(i))&&r.substring(s)===i)return r.substring(0,s)+"contrib/"+this.__getStaticSwfName()}d.error("## Not found "+this.__getStaticSwfName()+". Set flashpath !!!")},__getIsDebug:function(){var t=this.p.attr.debug;return!!(t&&t.use&&t.flash)},getFlashObject:function(){return this.flash},onDraw:function(t){if(!this.__device)throw new Error("Not found player element.");if(!(t.source instanceof h))throw new Error("e.source is not instanceof Source");var e=d.b,i=this.p,n=this.guid,r=this.__getSwfPath(),s=this.__getIsDebug();this.flashObjectAttribute={data:r,id:n,name:n,width:"100%",height:"100%",type:"application/x-shockwave-flash"};this.flashEmbedAttribute={allowfullscreen:"true",pluginspage:"http://www.macromedia.com/go/getflashplayer",quality:"high",src:r,type:"application/x-shockwave-flash"};this.flashVars=c.getFlashVars({domain:i.attr.domain,id:n,debugMode:s,autoPlay:!1,isLive:this.p.isLive()});this.flashVarString=c.getFlashVarString(this.flashVars);this.flashParameters=c.getFlashParameters({movie:r,flashvars:this.flashVarString});var a=document.createElement("div");a.setAttribute("playerType","flash");a.setAttribute("playerClassName",this.getClassName());a.style.visibility="visible";a.style.position="absolute";a.style.display="block";a.style.width="100%";a.style.height="100%";a.style.margin="0px 0px";a.style.padding="0px 0px";this.p.attr.zIndex&&(a.style.zIndex=this.p.attr.zIndex);if(e.isWindows&&e.ie&&e.ie<9){this.flashObjectAttribute.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";this.onDrawIe8(a);this.flash=d.query(a,"object");this.__device.appendChild(a);this.onReadyPatchEvent(t)}else{var o,u,l=document.createElement("object");for(u in this.flashObjectAttribute)l.setAttribute(u,this.flashObjectAttribute[u]);for(u in this.flashParameters){(o=document.createElement("param")).setAttribute("name",u);o.setAttribute("value",this.flashParameters[u]);l.appendChild(o)}a.appendChild(l);this.__device.appendChild(a);this.flash=l;this.onReadyPatchEvent(t)}this.zonemediaelement=a;d.addClass(this.flash,"mpv_video")},onReady:function(t){this.p;var e=this.p.userElement;if(d.b.isMobile||c.isInstalled()){this.onDraw(t);d.removeClass(e,i.INSTALL_FLASH_SCREEN)}else{d.error("Not installed flash !!!");d.addClass(e,i.INSTALL_FLASH_SCREEN)}},onReadyPatchEvent:function(t){var e=this.p,i=this.getFlashObject();if(!i)throw new Error("Not found flash player.");d.on(i,"error",function(t){e.error(" ## flash-error",t)});var n=this.__flashHandler(t);i.player=n},onFlashMediaPlayerStateChange:function(t){var e=this,i=this.p;if(this.is_temporary_removal)return"ready"===t||"buffering"===t||"playing"===t?setTimeout(function(){e.stop()},1):void 0;switch(t){case"loading":i.callStateChange({type:a.EVENT.WAITTING,data:!0,stype:"loading/flash",source:this.currentFlashSource,device:this,parent:null});break;case"ready":this.lastFlashState=a.STATE.CUED;i.callStateChange({type:a.EVENT.STATE_CHANGE,data:a.STATE.CUED,source:this.currentFlashSource,device:this,parent:null});i.callStateChange({type:a.EVENT.CAN_PLAY,stype:"ready",where:"flash",source:e.currentFlashSource,device:e});break;case"buffering":var n=this.duration(),r=this.currentTime();(0===n||3<n-r)&&i.callStateChange({type:a.EVENT.WAITTING,data:!0,stype:"buffering/flash",source:this.currentFlashSource,device:this,parent:null});break;case"playing":this.lastFlashState=a.STATE.PLAYING;i.callStateChange({type:a.EVENT.STATE_CHANGE,data:a.STATE.PLAYING,source:this.currentFlashSource,device:this,parent:null});break;case"paused":this.lastFlashState=a.STATE.PAUSED;i.callStateChange({type:a.EVENT.STATE_CHANGE,data:a.STATE.PAUSED,source:this.currentFlashSource,device:this,parent:null});break;case"end":i.callStateChange({type:a.EVENT.STATE_CHANGE,data:a.STATE.SYSTEM_ENDED,source:this.currentFlashSource,device:this,parent:null})}},__flashHandler:function(t){var i=this,e=this.p;return{flashPlayer:{onMediaError:function(t){d.error(t);e.callStateChange({type:a.EVENT.ON_ERROR,data:t,source:i.currentMediaSource(),device:i})},onMediaPlayerEnd:function(){i.is_temporary_removal||e.callStateChange({type:a.EVENT.STATE_CHANGE,data:a.STATE.SYSTEM_ENDED,source:i.currentFlashSource,device:i,parent:null})},onMediaPlayerStateChange:function(t){if(d.isArray(t))for(var e in t)i.onFlashMediaPlayerStateChange(t[e]);else i.onFlashMediaPlayerStateChange(t)},onDurationChange:function(t){if(!i.is_temporary_removal){i.lastFlashDuration=Number(t);i.onCurrentTimeSync()}},onTimeUpdate:function(t){if(i.is_temporary_removal)return setTimeout(function(){i.pause()},1);i.lastFlashCurrentTime=Number(t);i.onCurrentTimeSync()},onBufferingChange:function(t){if(!i.is_temporary_removal){i.lastFlashBuffering=t||0;i.onBufferingSync()}},onMuteChange:function(t){if(!i.is_temporary_removal){d.isArray(t)&&(t=t[0]);i.lastFlashMuted=t;setTimeout(function(){e.callStateChange({type:a.EVENT.VOLUME_CHANGE,data:{volume:i.lastFlashVolume,muted:i.lastFlashMuted,where:"mutechange/flash",source:i.currentFlashSource,device:i,parent:null}})},1)}},onVolumeChange:function(t){if(!i.is_temporary_removal){i.lastFlashVolume=100*t;setTimeout(function(){e.callStateChange({type:a.EVENT.VOLUME_CHANGE,data:{volume:i.lastFlashVolume,muted:i.lastFlashMuted,where:"volumechange/flash",source:i.currentFlashSource,device:i,parent:null}})},1)}},isReady:function(){e.log("## isReady on flash");if(i.is_temporary_removal)return!1;if(i.isCalledFlashReady)return!0;i.isCalledFlashReady=!0;setTimeout(function(){t&&t.callback?t.callback():e.next()},1);return!0},canPlay:function(){if(!i.is_temporary_removal)return!0},canPause:function(){if(!i.is_temporary_removal)return!0},statusPlaying:function(){e.log("## statusPlaying on flash");if(i.is_temporary_removal)return!1;return!0},statusTime:function(){e.log("## statusTime on flash");return 0}}}}});return n})}();!function(){"use strict";var o=getDframework(),u=o.module("imgtech.media.Media"),l=u.ERROR;o.define("imgtech.media.FlashPlayer2",function(){o.module("imgtech.Flash");var n=o.module("imgtech.media.Source"),e=o.module("imgtech.media.FlashPlayer");function r(t){e.apply(this,arguments)}function s(t,e,i){var n=this.isPseudo(t);n&&this.p.log(" ## pseudo source: "+t.source());this.flash.flashSource(t.source(),n,e,i)}o.extendClass(r,e,{getClassName:function(){return"imgtech.media.FlashPlayer2"},getPlayerType:function(){return"flash"},onStateChange:function(t){return r.__super.onStateChange.apply(this,arguments)},isPseudo:function(t){var e=this.p.attr,i=!t.input||!1!==t.input.isPseudo&&!0!==t.input.isPseudo?null:t.input.isPseudo,n=!1===e.isPseudo||!0===e.isPseudo?e.isPseudo:null,r=null!==i?i:null!==n?n:null;if(null===r&&!this.p.isLive()){if(!this.__ispseudo_message){this.__ispseudo_message=!0;var s=new(o.module("imgtech.media.extends.Alert"))({player:this.p}),a=u.getErrorInfo(l.NEED_IS_PSEUDO).message;if(a){s.show(a);o.error(a)}}r=!1}this.p.warn(" ## pseudo (src) : "+i);this.p.warn(" ## pseudo (config) : "+n);this.p.warn(" ## pseudo (used) : "+r);return r},flashReconnected:function(){var t=this.currentFlashSource;if(!(t instanceof n))throw new TypeError("currentFlashSource is not instanceof Source");var e=this.flash,i=this.p;if(e&&e.flashSource){i.warn(" ## Flash reconnected");s.call(this,t,!0,this.lastFlashCurrentTime)}else i.error(" ## Flash reconnect failed !!!")},source:function(t){if(!(t instanceof n))throw new TypeError("source is not instanceof Source");var e=this.flash,i=this.p;if(!e){o.error("Has not flash object.");throw new Error("Has not flash object.")}if(!e.flashSource){o.error("Not found source method on flash");throw new Error("Not found source method on flash")}if(e&&e.flashSource){this.clear();this.isReadyPlay=!1;this.lastFlashCurrentTime=0;this.lastFlashDuration=0;this.lastSendVideoSizeData=!1;this.lastFlashState=u.STATE.SETSOURCE;this.currentFlashSource&&this.currentFlashSource.stop();this.currentFlashSource=t;i.callStateChange({type:u.EVENT.STATE_CHANGE,data:u.STATE.SETSOURCE,source:this.currentFlashSource,device:this,parent:null});s.call(this,t,!1,0)}},appVersion:function(){var t=this.flash;if(t&&t.flashAppVersion)return t.flashAppVersion()},play:function(){var t=this.flash,e=this.p,i=this.currentFlashSource;if(t&&t.flashPlay)if(this.isPlaying())e.warn(" ## current playing");else if(e.isLive()&&this.isFlashPaused&&!this.isFlashReconnected){e.log(" ## play (source)");this.source(i);this.lastFlashCurrentTime=0;this.isFlashReconnected=!0}else{e.log(" ## play (play)");this.isFlashReconnected=!1;t.flashPlay()}else e.warn(" ## Not found play function.")},pause:function(){var t=this.flash,e=this.p;this.currentFlashSource;if(t&&t.flashPause){this.isFlashPaused=!0;t.flashPause()}else e.warn(" ## Not found pause function.")},stop:function(){var t=this;setTimeout(function(){(function n(){var t=this.flash,e=this.p,i=this.lastFlashState;this.currentFlashSource;if(t&&t.flashStop){e.log(" ## stop flash player");if(this.virtualTime())if(i==u.STATE.PLAYING){r.__super.beforeStop.apply(this,arguments);this.pause();this.patchStopForSeekToFirst()}else i==u.STATE.PAUSED&&this.patchStopForSeekToFirst();else if(i==u.STATE.PLAYING||i==u.STATE.PAUSED){r.__super.beforeStop.apply(this,arguments);this.pause();this.patchStopForSeekToFirst()}}}).call(t)},1)},setVolume:function(t){var e=this.flash;e&&e.flashVolume&&e.flashVolume((5<t?t:5)/100)},mute:function(){var t=this.flash;t&&t.flashMute&&t.flashMute()},unMute:function(){var t=this.flash;t&&t.flashUnmute&&t.flashUnmute()},seekTo:function(t){var e=this.flash,i=this.p,n=this.currentFlashSource;e&&e.flashSeek&&n&&(i.isLive()||(n.isRTMP()&&!this.isPlaying()?i.error(" ## Not seek on pause. because this source is vod rtmp."):e.flashSeek(this.virtualSeekToValue(t))))},canPlay:function(){var t=this.flash;if(t&&t.flashCanPlay)return t.flashCanPlay()},canPause:function(){var t=this.flash;if(t&&t.flashCanPause)return t.flashCanPause()},canSeek:function(t){var e=this.flash;if(e&&e.flashCanSeek)return e.flashCanSeek(t)},getVideoSize:function(){var t=this.flash;return t&&t.flashMediaWidth&&t.flashMediaHeight?{width:t.flashMediaWidth(),height:t.flashMediaHeight()}:{width:0,height:0}},__getStaticSwfName:function(){return"flashplayer2.swf"},onReadyPatchEvent:function(t){},onDraw:function(t){var e=this,i=this.__flashHandler(t).flashPlayer,n=this.p;delete i.statusPlaying;delete i.statusTime;delete i.isReady;i.start=function(){n.log("## start on flash");if(e.isCalledFlashReady){e.flashReconnected();return!0}e.isCalledFlashReady=!0;if((!t||t&&!t.callback)&&e.is_temporary_removal)return!0;setTimeout(function(){t&&t.callback?t.callback():n.next()},1);return!0};window[this.guid]={flash:i};return r.__super.onDraw.call(this,t)},onFlashMediaPlayerStateChange:function(t){var e=this,i=this.p;if(0!==t.indexOf("seeked:")){if(!this.lastSendVideoSizeData){var n=this.getVideoSize();if(n.width&&n.height){this.repairFlashFirstLoading();this.lastSendVideoSizeData=!0;i.callStateChange({type:u.EVENT.VIDEO_SIZE_DATA,data:this.getVideoSize(),source:this.currentFlashSource,device:this,parent:null})}}return r.__super.onFlashMediaPlayerStateChange.apply(this,arguments)}this.repairFlashFirstLoading();if(!this.isPlaying()){this.play();setTimeout(function(){e.pause()},1)}}});return r})}();!function(t){"use strict";var l=window.getDframework(),h=l.module("imgtech.media.Media");l.define("imgtech.media.Youtube",function(){var r=!1;var s=l.module("imgtech.media.module.Device"),i=t.onYouTubeIframeAPIReady,a=[],o=!1,u=function(t){switch(t){case YT.PlayerState.UNSTARTED:return h.STATE.UNSTARTED;case YT.PlayerState.ENDED:return h.STATE.ENDED;case YT.PlayerState.PLAYING:return h.STATE.PLAYING;case YT.PlayerState.PAUSED:return h.STATE.PAUSED;case YT.PlayerState.BUFFERING:return h.STATE.BUFFERING;case YT.PlayerState.CUED:return h.STATE.CUED;default:return h.STATE.NONE}};t.onYouTubeIframeAPIReady=function(){o=!0;try{i&&i()}catch(e){l.error(e)}for(var t=0;t<a.length;t++)a[t].onYoutubeApiReady()};function c(t){s.apply(this,arguments);if(!r){r=!0;!function n(){var t=document.createElement("script"),e=document.getElementsByTagName("script")[0];t.src="https://www.youtube.com/iframe_api";e.parentNode.insertBefore(t,e)}()}if(t){a.push(this);this.guid="youtube_"+l.guid("");this.__isLoadCaptionsModule=!1;var e;if(e=this.p.attr){e.youtube||(e.youtube={});e.useUpdateTimeSync=!0;e.useBufferingSync=!0;e.useVolumeSync=!0;e.youtube.use_youtube_control&&(e.no_controls=!0);this.youtube=e.youtube;this.playerVars=e.youtube.playerVars?e.youtube.playerVars:{};!function(t){t.autoplay=0;t.rel||(t.rel=0);1!==t.iv_load_policy&&(t.iv_load_policy=3);t.controls||(t.controls=0);t.showinfo||(t.showinfo=0);t.modestbranding=1}(this.playerVars)}this.isYoutubeAutoPlayLoaded=!1;this.currentYoutubeSource=null;this.youtubeDeviceElement=null;this.__pauseImageTime=0;this.__pauseImage=l.query(this.p.userElement,".mpv-pause-image");i=this,o&&setTimeout(function(){i.onYoutubeApiReady()},1)}var i}c.qualityLabel=[{code:"hd2160",label:"4K \ud574\uc0c1\ub3c4"},{code:"hd1440",label:"2K \ud574\uc0c1\ub3c4"},{code:"hd1080",label:"FullHD"},{code:"hd720",label:"HD"},{code:"480p",label:"large"},{code:"360p",label:"medium"},{code:"240p",label:"small"},{code:"hd7auto20",label:"\uc790\ub3d9"}];c.rateLabel=[{code:.25,label:"0.25 \ubc30\uc18d"},{code:.5,label:"0.5 \ubc30\uc18d"},{code:.75,label:"0.75 \ubc30\uc18d"},{code:1,label:"\uc77c\ubc18 \ubc30\uc18d"},{code:1.25,label:"1.25 \ubc30\uc18d"},{code:1.5,label:"1.5 \ubc30\uc18d"},{code:1.75,label:"1.75 \ubc30\uc18d"},{code:2,label:"2 \ubc30\uc18d"}];c.subtitleNoLabel={code:!1,label:"\ubb34\uc790\ub9c9"};l.extendClass(c,s,{currentMediaSource:function(){return this.currentYoutubeSource},getClassName:function(){return"imgtech.media.Youtube"},getPlayerType:function(){return"youtube"},setBreakYoutubeOSD:function(){},isUseYoutubeOSD:function(){var t=this.p.module("layout");if(t)return t.isUseYoutubeOSD()},onReady:function(t){this.___called_onready=t||!0;this.___called_onyoutubeapiready&&this.___called_onready&&this.onYoutubeInit(t)},onYoutubeApiReady:function(){this.___called_onyoutubeapiready=!0;this.___called_onyoutubeapiready&&this.___called_onready&&this.onYoutubeInit(this.___called_onready)},showControlInYoutubeOSD:function(){var t=this.p.module("layout");t&&this.isUseYoutubeOSD()&&t.showControl()},onStateChange:function(t){var e,i=this.p,n=i.attr,r=n&&n.youtube;t.data;switch(t.type){case h.EVENT.ON_READY:return this.onReady(t);case h.EVENT.STATE_CHANGE:switch(t.data){case h.STATE.PLAYING:this.showControlInYoutubeOSD();if(!this.youtube.use_youtube_playlist&&!this.isYoutubeAutoPlayLoaded){this.isYoutubeAutoPlayLoaded=!0;if(i.attr.autoplay)i.warn(" ## autoplay: maybe playing");else{i.log(" ## autoplay: call pause");i.pause()}}i.callStateChange({type:h.EVENT.CAN_PLAY,stype:"playing",where:"youtube",source:this.currentMediaSource(),device:this,parent:t});break;case h.STATE.PAUSED:this.showControlInYoutubeOSD();break;case h.STATE.SETSOURCE:if(this.__pauseImage){e=this.__pauseImage;if(r&&r.pauseImage){l.addClass(e,"mpv-used");e.style.backgroundImage="url('"+r.pauseImage+"')"}else{l.removeClass(e,"mpv-used");e.style.backgroundImage=""}if(r.pauseImageTime){e=this.__pauseImage;i.currentTime()<=r.pauseImageTime?l.addClass(e,"mpv-previous-ctime"):l.removeClass(e,"mpv-previous-ctime")}}i.callStateChange({type:h.EVENT.VIDEO_SIZE_DATA,data:this.getVideoSize(),source:this.currentVideoSource,device:this,parent:null})}break;case h.EVENT.ON_BEFORE_PLAY:this.unloadCaptionsModule();break;case h.EVENT.CURRENT_TIME_CHANGE:if(this.__pauseImage&&r.pauseImageTime){e=this.__pauseImage;i.currentTime()<=r.pauseImageTime?l.addClass(e,"mpv-previous-ctime"):l.removeClass(e,"mpv-previous-ctime")}}c.__super.onStateChange.apply(this,arguments)},getPlayerState:function(){return this.yp?u(this.yp.getPlayerState()):h.STATE.UNSTARTED},patchSourceId:function(t){var e=t.source(),i=e?e.toLowerCase():null;return i?0===i.indexOf("yt://")?e.substring("yt://".length):0===i.indexOf("youtube://")?e.substring("youtube://".length):e:null},loadVideoById:function(t){var e=this.yp,i=this.patchSourceId(t),n=this.p,r=this;if(e&&e.loadVideoById){this.isReadyPlay=!1;setTimeout(function(){r.currentYoutubeSource=t;e.loadVideoById(i);n.callStateChange({type:h.EVENT.STATE_CHANGE,data:h.STATE.SETSOURCE,source:t,device:r})},1)}},reset:function(){this.currentYoutubeSource=null},source:function(t){this.clear();this.loadVideoById(t)},play:function(){var t=this.yp,e=this.p;if(!this.currentYoutubeSource)return e.warn("Not play: unstarted or no source");t&&t.playVideo&&t.playVideo()},pause:function(){var t=this.yp;t&&t.pauseVideo&&t.pauseVideo()},stop:function(){var t=this.p,e=this.yp;if(e&&e.stopVideo){c.__super.beforeStop.apply(this,arguments);this.pause();this.patchStopForSeekToFirst();t.callStateChange({type:h.EVENT.WAITTING,data:!1,stype:"stop/youtube",source:this.currentMediaSource(),device:this})}},previous:function(){var t=this.p,e=this.yp;if(e&&l.isArray(t.src)){if(this.youtube.use_youtube_playlist&&e.previousVideo)return e.previousVideo();c.__super.previous.apply(this)}},next:function(){var t=this.p,e=this.yp;if(e&&l.isArray(t.src)){if(this.youtube.use_youtube_playlist&&e.nextVideo)return e.nextVideo();c.__super.next.apply(this)}},current:function(){var t=this.p;if(this.yp&&l.isArray(t.src)){if(this.youtube.use_youtube_playlist)return;c.__super.next.apply(this)}},isMuted:function(){var t=this.yp;return t&&t.isMuted?t.isMuted():null},mute:function(){var t=this.yp;t&&t.mute&&t.mute()},unMute:function(){var t=this.yp;t&&t.unMute&&t.unMute()},getVolume:function(){var t=this.yp;return t&&t.getVolume?t.getVolume():0},setVolume:function(t){var e=this.yp;e&&e.setVolume&&e.setVolume(5<t?t:5)},duration:function(t){var e=this.yp,i=e&&e.getDuration?e.getDuration():0;return t?i||0:this.virtualCurrentTime(i)},currentTime:function(t){var e=this.yp,i=e&&e.getCurrentTime?e.getCurrentTime():0;return t?i||0:this.virtualCurrentTime(i)},getBuffering:function(){var t=this.yp,e=t&&t.getVideoLoadedFraction?t.getVideoLoadedFraction():0;return e||0},seekTo:function(t,e){var i=this.yp,n=this.currentMediaSource();i&&i.seekTo&&n&&i.seekTo(this.virtualSeekToValue(t),e)},getPatchPlaybackRateLabel:function(t){var e,i=this.p.attr.youtube,n=i&&i.rateLabel,r=c.rateLabel;if(n)for(e=0;e<n.length;e++)if(n[e].code+""==t+"")return n[e].label;for(e=0;e<r.length;e++)if(r[e].code+""==t+"")return r[e].label;return t},getPlaybackRate:function(){var t=this.yp,e=t&&t.getPlaybackRate?t.getPlaybackRate():null;return e||1},setPlaybackRate:function(t){var e=this.yp,i=this.p.module("rate");if(!i)return this.p.warn("Setting not rate module.");if(i&&!i.attr.use)return this.p.warn("Setting not use rate.");e&&e.setPlaybackRate&&t&&t.value&&e.setPlaybackRate(t.value)},getAvailablePlaybackRates:function(){var t,e=this.yp,i=e&&e.getAvailablePlaybackRates?e.getAvailablePlaybackRates():null,n=[];if(i)for(t=0;t<i.length;t++){var r=this.getPatchPlaybackRateLabel(i[t]);n.push({value:i[t],cvalue:r,context:r})}return n},getPatchPlaybackQualityLabel:function(t){var e,i=this.p.attr.youtube,n=i&&i.qualityLabel,r=c.qualityLabel;if(n)for(e=0;e<n.length;e++)if(n[e].code+""==t+"")return n[e].label;for(e=0;e<r.length;e++)if(r[e].code+""==t+"")return r[e].label;return t},getPatchPlaybackQualityData:function(t){return{code:t,label:this.getPatchPlaybackQualityLabel(t)}},getPlaybackQuality:function(t){var e,i=this.p.attr.youtube,n=!i||(!i.quality||("all"==i.quality||"youtube"==i.quality)),r=!i||(!i.quality||("all"==i.quality||"source"==i.quality)),s=this.yp,a=[];if(n&&s&&s.getPlaybackQuality&&(e=s.getPlaybackQuality())){e=this.getPatchPlaybackQualityData(e);if(!t)return e;a.push(e)}if(r){e=c.__super.getPlaybackQuality.call(this);if(!t)return e;e&&a.push(e)}return a.length?a:null},getAvailableQualityLevels:function(t){var e=this.p.attr.youtube,i=!!e&&(!!e.quality&&("all"==e.quality||"youtube"==e.quality)),n=!!e&&(!!e.quality&&("all"==e.quality||"source"==e.quality)),r=this.yp,s=[];if(i&&r&&r.getAvailableQualityLevels){var a,o=r.getAvailableQualityLevels();if(o)for(a in o)o[a]&&s.push(this.getPatchPlaybackQualityData(o[a]))}if(!t&&n){var u=c.__super.getAvailableQualityLevels.call(this);if(u&&u.length){s.length&&s.push({view:"line"});for(var l=0;l<u.length;l++)u[l]&&s.push(u[l])}}return s},setPlaybackQuality:function(t){var e=this.p.attr.youtube,i=!!e&&(!!e.quality&&("all"==e.quality||"youtube"==e.quality)),n=!!e&&(!!e.quality&&("all"==e.quality||"source"==e.quality)),r=this.yp,s=!1,a=this.p.module("quality");if(a&&!a.attr.use)return this.p.warn("Setting not use quality.");if(t&&t.code&&i){var o=this.getAvailableQualityLevels(!0);if(o&&o.length)for(var u=0;u<o.length;u++)o[u].code===t.code&&(s=!0)}s?r&&r.setPlaybackQuality&&r.setPlaybackQuality(t.code):n&&c.__super.setPlaybackQuality.call(this,t)},_getAvailableSubtitle:function(t){return{code:t.languageCode,label:t.displayName?t.displayName:t.languageName?t.languageName:t.languageCode,view:t.view,youtubeData:t}},getPlaybackSubtitleNoLabel:function(){var t=this.p.attr.youtube;return t&&t.subtitleNoLabel?t.subtitleNoLabel:c.subtitleNoLabel},getAvailableSubtitles:function(t){var e,i,n,r=this.p.attr.youtube,s=!!r&&(!!r.subtitle&&("all"==r.subtitle||"youtube"==r.subtitle)),a=!!r&&(!!r.subtitle&&("all"==r.subtitle||"source"==r.subtitle)),o=this.getOptions("captions"),u=o?this.getOption("captions","tracklist"):null,l=[],h=!1;if(s&&u&&u.length)for(n=0;n<u.length;n++){l.push(this._getAvailableSubtitle(u[n]));h=!0}if(!t&&a)if((i=c.__super.getAvailableSubtitles.call(this))&&i.length){h&&l.length&&l.push({view:"line"});for(n=0;n<i.length;n++)i[n]&&l.push(i[n])}else a=!1;if(s&&r.autoLanguage&&(e=o&&this.getOption("captions","translationLanguages"))&&e.length){h&&l.push({view:"line"});for(n=0;n<e.length;n++){l.push(this._getAvailableSubtitle(e[n]));h=!0}}!a&&l.length&&l.push(this.getPlaybackSubtitleNoLabel());return l},getPlaybackSubtitle:function(){var t,e=this.p.attr.youtube,i=!!e&&(!!e.subtitle&&("all"==e.subtitle||"youtube"==e.subtitle)),n=!!e&&(!!e.subtitle&&("all"==e.subtitle||"source"==e.subtitle)),r=i?this.getOption("captions","track"):null;return i&&r?this.__isLoadCaptionsModule?this._getAvailableSubtitle(r):n&&(t=c.__super.getPlaybackSubtitle.call(this))?t:this.getPlaybackSubtitleNoLabel():n?c.__super.getPlaybackSubtitle.call(this):null},setPlaybackSubtitle:function(t){var e,i=this.p.attr.youtube,n=!!i&&(!!i.subtitle&&("all"==i.subtitle||"youtube"==i.subtitle)),r=!!i&&(!!i.subtitle&&("all"==i.subtitle||"source"==i.subtitle)),s=t&&!t.code,a=this.p.module("subtitle");if(a&&!a.attr.use)return this.p.warn("Setting not use subtitle.");if(n){if(t&&t.youtubeData){this.__isLoadCaptionsModule||this.loadCaptionsModule();(e=this.currentMediaSource())&&e.stop();return this.setOption("captions","track",t.youtubeData)}s&&this.__isLoadCaptionsModule&&this.unloadCaptionsModule()}if(r){n&&this.__isLoadCaptionsModule&&this.unloadCaptionsModule();c.__super.setPlaybackSubtitle.call(this,t)}},loadCaptionsModule:function(){this.loadModule("captions")&&(this.__isLoadCaptionsModule=!0)},unloadCaptionsModule:function(){this.unloadModule("captions")&&(this.__isLoadCaptionsModule=!1)},loadModule:function(t){return this.yp&&this.yp.loadModule?this.yp.loadModule(t):null},unloadModule:function(t){return this.yp&&this.yp.unloadModule?this.yp.unloadModule(t):null},getOptions:function(t){if(!this.yp||!this.yp.getOptions)return null;var e,i=this.yp.getOptions();if(i&&i.length)for(e=0;e<i.length;e++)if(i[e]==t)return this.yp.getOptions(t);return null},getOption:function(t,e){if(!this.yp||!this.yp.getOption)return null;try{return this.yp.getOption(t,e)}catch(i){return null}},setOption:function(t,e,i){return this.yp&&this.yp.setOption?this.yp.setOption(t,e,i):null},getVideoData:function(){return this.yp&&this.yp.getVideoData?this.yp.getVideoData():null},getTitle:function(){var t=this.getVideoData();return t&&t.title?t.title:""},getVideoSize:function(){var t=this.p.attr.youtube;return{width:t&&t.width?t.width:1280,height:t&&t.height?t.height:720}},setSphericalProperties:function(t){return this.yp&&this.yp.setSphericalProperties?this.yp.setSphericalProperties(t):null},getSphericalProperties:function(){return this.yp&&this.yp.getSphericalProperties?this.yp.getSphericalProperties():null},isSphericalProperties:function(){var t=this.getSphericalProperties();return!(!t||t.fov===undefined)},onYoutubeReady:function(t){var e,i=this.p;if(l.isArray(i.src)&&this.youtube.use_youtube_playlist){e={playlist:i.src};this.playerVars.autoplay?this.yp.loadPlaylist(e):this.yp.cuePlaylist(e)}if(t&&!0!==t&&t.callback)return t.callback()},onYoutubeInit:function(e){var i=this,n=this.p;this.attr;if(!this.yp){if(!this.__device)throw new Error("Not found controller device element");var t=document.createElement("div");t.style.width="100%";t.style.height="100%";var r={id:this.guid,playerType:"youtube",playerClassName:this.getClassName(),src:"about:blank",width:"100%",height:"100%",frameborder:"0"};if(l.b.safari){r.allowFullscreen=!1;r.webkitallowFullscreen=!1;this.playerVars.allowFullScreen=0;this.playerVars.webkitallowFullScreen=0}else{r.allowFullScreen=0;r.webkitallowFullScreen=0;this.playerVars.allowFullScreen=0;this.playerVars.webkitallowFullScreen=0}var s=document.createElement("div");s.style.width="100%";s.style.height="100%";s.setAttribute("id",this.guid);s.setAttribute("playerType","youtube");s.setAttribute("playerClassName",this.getClassName());s.setAttribute(h.D_MEDIA_GUID_ATTR,this.guid);this.p.attr.zIndex&&(s.style.zIndex=this.p.attr.zIndex);s.appendChild(t);this.__device.appendChild(s);this.zonemediaelement=s;this.p.log(" ## playerVars: ",this.playerVars);this.yp=new YT.Player(t,{height:"100%",width:"100%",videoId:l.isArray(n.src)?"":n.src,playerVars:this.playerVars,events:{onReady:function(){var t=l.query(s,"iframe");if(l.b.safari){t.allowFullscreen=!1;t.webkitallowFullscreen=!1}else{t.removeAttribute("allowFullscreen",0);t.removeAttribute("webkitallowFullscreen",0);t.removeAttribute("webkitAllowFullscreen",0)}t.setAttribute("playsinline",1);i.ytiframe=t;i.p.ytiframe=t;i.onYoutubeReady(e)},onStateChange:function(t){var e=u(t.data);if(i.is_temporary_removal)return e===h.STATE.PLAYING?setTimeout(function(){i.stop()},1):void 0;e==h.STATE.ENDED&&(e=h.STATE.SYSTEM_ENDED);n.callStateChange({type:h.EVENT.STATE_CHANGE,data:e,source:i.currentMediaSource(),device:i})},onPlaybackQualityChange:function(t){if(!i.is_temporary_removal){var e=i.p.attr.youtube;(!e||(!e.quality||("all"==e.quality||"youtube"==e.quality)))&&n.callStateChange({type:h.EVENT.QUALITY_CHANGE,data:i.getPatchPlaybackQualityData(t.data),source:i.currentMediaSource(),device:i})}},onPlaybackRateChange:function(t){i.is_temporary_removal||n.callStateChange({type:h.EVENT.RATE_CHANGE,data:n.getSafePlaybackRate(t.data),source:i.currentMediaSource(),device:i})},onError:function(t){l.error(t);n.callStateChange({type:h.EVENT.ON_ERROR,data:t,source:i.currentMediaSource(),device:i})},onApiChange:function(t){}}});var a=this.p.module("rate");(!a||a&&!a.attr.use)&&(this.yp.setPlaybackRate=function(){})}}});return c})}(window||this);!function(){"use strict";var n=getDframework(),r=n.module("imgtech.media.Media");n.define("imgtech.media.SelfPlayer",function(){var e=n.module("imgtech.media.module.Device");function i(t){e.apply(this,arguments);if(t){this.p.attr&&(this.currentVideoSource=null)}}n.extendClass(i,e,{currentMediaSource:function(){return this.currentVideoSource},getClassName:function(){return"imgtech.media.SelfPlayer"},getPlayerType:function(){return"self"},destroy:function(){this.reset()},onReady:function(t){return t&&t.callback?t.callback():this.next()},onStateChange:function(t){this.p;switch(t.type){case r.EVENT.ON_READY:return this.onReady(t)}i.__super.onStateChange.apply(this,arguments)},getPlayerState:function(){},reset:function(){},source:function(t){var e=this,i=this.p;this.clear();this.isReadyPlay=!1;t.input.thumbnail=!1;this.currentVideoSource=t;i.callStateChange({type:r.EVENT.STATE_CHANGE,data:r.STATE.SETSOURCE,source:t,device:e});setTimeout(function(){i.callStateChange({type:r.EVENT.VIDEO_SIZE_DATA,data:e.getVideoSize(),source:e.currentVideoSource,device:e,parent:null});setTimeout(function(){i.callStateChange({type:r.EVENT.CAN_PLAY,source:e.currentVideoSource,device:e,parent:null})},1)},10)},play:function(){},pause:function(){},stop:function(){},isMuted:function(){},mute:function(){},unMute:function(){},getVolume:function(){},setVolume:function(t){},duration:function(t){},currentTime:function(t){},getBuffering:function(){},seekTo:function(t){},getDefaultPlaybackRate:function(){},getPlaybackRate:function(){},setPlaybackRate:function(t){},getVideoSize:function(){var t=this.p.controller;if(t&&t.resourceElement){var e=n.getBoundingClientRect(t.resourceElement);if(e.width()||e.height())return{width:e.width(),height:e.height()}}return{width:0,height:0}},onReadyPatchEvent:function(){}});return i})}();!function(){"use strict";var T=getDframework(),S=T.module("imgtech.media.Media"),w=S.ERROR;T.define("imgtech.media.MediaPlayer",function(){var i=T.module("imgtech.media.module.Device"),b=T.module("imgtech.media.Source");function s(t){i.apply(this,arguments);if(t){this.use_first_source=!1;this.currentDevice=null;this.currentSource=null;var n=[];this.getUsedDevices=function(){var t,e=[];for(t=0;t<n.length;t++)e.push(n[t]);return e};this.getUsedDevice=function(t){var e,i;for(e=0;e<n.length;e++)if((i=n[e]).className==t)return i;return null};this.addUsedDevice=function(t){if(!t)return this.p.code(w.NOT_FOUND_USED_DEVICE);if(!t.className)return this.p.code(w.NOT_FOUND_USED_DEVICE_CLASSNAME);if(this.getUsedDevice(t.className))return this.p.code(w.EXIST_USED_DEVICE,t);n.push(t)};this.destroyUsedDevice=function(){var t,i;for(t=0;t<n.length;t++)if((i=n[t]).instance&&i.instance.destroy)try{i.instance.destroy()}catch(e){}n=[]}}}T.extendClass(s,i,{getClassName:function(){return"imgtech.media.MediaPlayer"},getPlayerType:function(){var t=this.deviceInstance();if(t&&t.getPlayerType)return t.getPlayerType()},onReady:function(){var t=this,e=this.p;if(!this.info(0))return e.log(" ## onready: empty next media data");e.hasAttributeSource&&setTimeout(function(){e.next({device:t})},1)},deviceInstance:function(){var t=this.currentDevice;return t?t.instance:null},destroy:function(){this.destroyUsedDevice()},activeDevice:function(i,s,a){function o(t,i,n){var r=this;setTimeout(function(){r.__is_active_device_src=null;r.__is_active_device_timer=null},1);i&&(this.currentDevice=t);if(n)try{n()}catch(e){T.error(e)}}var t=this.__is_active_device_timer,n=this.__is_active_device_src,u=this,l=this.p,r=this.currentDevice;if(!(i instanceof b))return this.p.code(w.NOT_SOURCE_OBJECT,i);if(n)return n===i?this.p.warn("Ignore current source"):this.p.code(w.EXIST_ACTIVE_SOURCE,n);if(t)return this.p.code(w.EXIST_ACTIVE_SOURCE_TIMER,t);var h=i.className(),c=h?T.module(h):null,d=i.deviceType(),f=d;if("video"==d){if(T.b.ie&&T.b.ie<9)return this.p.code(w.NOT_SUPPORT_VIDEO_IE8)}else if("youtube"==d){if(T.b.ie&&T.b.ie<10)return this.p.code(w.NOT_SUPPORT_YOUTUBE_BROWSER)}else if(("flash"==d||"flash2"==d)&&T.b.isMobile)return this.p.code(w.NOT_SUPPORT_FLASH_ON_MOBILE);if(!c)return this.p.code(w.NOT_FOUND_PLAYER_CLASSNAME,{className:h});this.__is_active_device_src=i;var p,m,g,v,y=this.getUsedDevice(h),_=this.getUsedDevices();if(y&&"create"==y.instance.__activeStatus)return this.p.warn("Ignore:: current device is created.");if(y){p=y.instance;l.log(" ## device (exist) - className: "+h+", devType: "+f+", type: "+d)}else{p=new c(l,this.c,this.attr);(y={deviceType:f,type:d,className:h,instance:p,status:"create"}).instance.__activeStatus="create";this.addUsedDevice(y);l.log(" ## device (create) - className: "+h+", devType: "+f+", type: "+d+", source: "+i.source())}this.__is_active_device_holder=null;p.untemporary_removal();if(r){var E=r.instance;if(r!==y){this.__is_active_device_holder=r;E.temporary_removal();E.stop()}}for(m=0;m<_.length;m++)(g=_[m])&&(v=g&&g.instance?g.instance.zonemediaelement:null)&&(y===g?T.ui.show(v):T.ui.hide(v));setTimeout(function(){if("create"==y.status){var t={type:S.EVENT.ON_READY,source:i,callback:function(){y.status="ready";y.instance.__activeStatus="ready";o.call(u,y,s,a)},device:y.instance};l.stateLog(t,"start",1);y.instance.onStateChange(t);l.stateLog(t,"end",1)}else if("flash"==y.type){var n=(new Date).getTime(),r=y.instance.getPlayerState();u.__is_active_device_timer&&l.error(" ## device has timer !!!!!!");l.log(" ## start wait flash. time: "+n+", state: "+r);u.__is_active_device_timer=setInterval(function(){var t=(new Date).getTime(),e=y.instance,i=e?e.getPlayerState():null;if(null===i||i!==r||1500<t-n||!n){l.log(" ## end wait flash. state: "+i+", ctime: "+t+", otime: "+n+", dtime: "+(t-n));clearInterval(u.__is_active_device_timer);return o.call(u,y,s,a)}},100)}else o.call(u,y,s,a)},1)},isDisableEvent:function(t){var e=this.__is_active_device_holder;if(e&&e.instance&&e.instance===t.device)switch(t.type){case S.EVENT.STATE_CHANGE:case S.EVENT.RATE_CHANGE:case S.EVENT.DURATION_CHANGE:case S.EVENT.CURRENT_TIME_CHANGE:case S.EVENT.BUFFERING_CHANGE:case S.EVENT.VOLUME_CHANGE:case S.EVENT.PLAY_MEDIA:case S.EVENT.PAUSE_MEDIA:case S.EVENT.STOP_MEDIA:case S.EVENT.MUTE_MEDIA:case S.EVENT.WAITTING:case S.EVENT.CAN_PLAY:var i=e.className,n=i.lastIndexOf(".");return"Ignore ["+(-1!==n?i.substring(n+1):i)+"] "+S.getTypeName(t.type)+" event."}return!1},onStateChange:function(t){var e,i=s.__super.onStateChange,n=this.p;switch(t.type){case S.EVENT.RESET:this.reset();break;case S.EVENT.ON_READY:return this.onReady();case S.EVENT.STATE_CHANGE:t.data==S.STATE.SETSOURCE?(e=this.p.module("layout"))&&e.isUseYoutubeOSD()?T.addClass(n.userElement,"mpv-youtube-osd"):T.removeClass(n.userElement,"mpv-youtube-osd"):t.data==S.STATE.SYSTEM_ENDED&&this.__systemEnded();break;case S.EVENT.ON_BEFORE_PLAY:break;case S.EVENT.PREVIOUS_MEDIA:case S.EVENT.NEXT_MEDIA:case S.EVENT.CURRENT_MEDIA:case S.EVENT.INDEX_MEDIA:return i.apply(this,arguments);case S.EVENT.SELECTING_AD:return this.selectingAD(t.data);case S.EVENT.SELECTING_VAST:return this.selectingVAST(t.data)}var r=this.deviceInstance();return r&&r.onStateChange?r.onStateChange(t):i.apply(this,arguments)},getPlayerState:function(){var t=this.deviceInstance();return t&&t.getPlayerState?t.getPlayerState():null},sourceCallback:function(t,e,i){var n,r=this.deviceInstance(),s=this.currentDevice,a=this.p,o=a.attr;if(r){this.isReadyPlay=!1;(this.currentSource=t).currentSourceAttribute=e;a.log(" ## source: "+t.source());a.log(" ## isLive: "+a.isLive());a.log(" ## isDVR: "+a.isDVR());a.log(" ## configure: ",o);i&&(i.ssd?r.setSwitchSourceData(i.ssd):i.ad?r.setADData(i.ad):i.vast&&r.setVASTData(i.vast));r.source(t);if(n=a.userElement){T.removeClass(n,"mpv-device-video");T.removeClass(n,"mpv-device-hls");T.removeClass(n,"mpv-device-flash");T.removeClass(n,"mpv-device-youtube");T.removeClass(n,"mpv-device-player");T.addClass(n,"mpv-device-"+s.type)}i&&(i.ad?this.p.callStateChange({type:S.EVENT.SELECTED_AD,data:i.ad}):i.vast&&this.p.callStateChange({type:S.EVENT.SELECTED_VAST,data:i.vast}))}},getADData:function(){var t=this.deviceInstance();return t?t.getADData():null},getVASTData:function(){var t=this.deviceInstance();return t?t.getVASTData():null},selectingAD:function(t){var e=this,i=t.src,n=this.deviceInstance();n&&n.clear();this.activeDevice(i,!0,function(){e.sourceCallback(i,t.event,{ad:t.originData})})},selectingVAST:function(t){var e=this,i=t.src,n=this.deviceInstance();n&&n.clear();this.activeDevice(i,!0,function(){e.sourceCallback(i,t.event,{vast:t.originData})})},__systemEnded:function(){var t=this.deviceInstance();(t?t.getADData()||t.getVASTData():null)||this.p.callStateChange({type:S.EVENT.STATE_CHANGE,data:S.STATE.ENDED,source:this.p.currentMediaSource(),device:this.deviceInstance()})},currentMediaSource:function(){var t=this.deviceInstance();return t?t.currentMediaSource():null},reset:function(){var t,e,i,n=this.getUsedDevices();try{this.stop()}catch(r){}this.__is_active_device_src=null;for(t=0;t<n.length;t++)if((e=n[t])&&(i=e&&e.instance?e.instance.zonemediaelement:null)){try{e.instance.reset()}catch(r){}try{T.ui.hide(i)}catch(r){}}},source:function(t,e){var i=this,n=this.deviceInstance();n&&n.clear();if(t){if(!(t instanceof b))return this.p.code(w.NOT_SOURCE_OBJECT);var r=this.p.currentMediaSource();r&&r.subtitle&&r.subtitle.stop();this.p.reset();t.currentSourceAttribute=e;if(t.isSwitchSource()){var s=this.p.module("switchSource");if(!s)return T.error("Not found switchSource module.");t=s.patchSelectSource(t)}t.hasVAST()?this.p.callStateChange({type:S.EVENT.SELECT_VAST,data:t}):t.hasAD()?this.p.callStateChange({type:S.EVENT.SELECT_AD,data:t}):this.activeDevice(t,!0,function(){i.sourceCallback(t,e)})}},isPlaying:function(){switch(this.getPlayerState()){case S.STATE.PLAYING:case S.STATE.BUFFERING:return!0}return!1},beforePlay:function(){var t=this.deviceInstance();return t&&t.beforePlay?t.beforePlay():null},play:function(t){var e=this.deviceInstance();return e&&e.play?e.play(t):null},pause:function(t){var e=this.deviceInstance();return e&&e.pause?e.pause(t):null},stop:function(){var t=this.deviceInstance();return t&&t.stop?t.stop():null},isMuted:function(){var t=this.deviceInstance();return t&&t.isMuted?t.isMuted():null},mute:function(){var t=this.deviceInstance();return t&&t.mute?t.mute():null},unMute:function(){var t=this.deviceInstance();return t&&t.unMute?t.unMute():null},getVolume:function(){var t=this.deviceInstance();return t&&t.getVolume?t.getVolume():0},setInitVolume:function(t){var e=this.deviceInstance();e&&e.setInitVolume&&e.setInitVolume(t)},setVolume:function(t){var e=this.deviceInstance();e&&e.setVolume&&e.setVolume(t)},duration:function(t){var e=this.deviceInstance();return e&&e.duration?e.duration(t):0},currentTime:function(t){var e=this.deviceInstance();return e&&e.currentTime?e.currentTime(t):0},getBuffering:function(){var t=this.deviceInstance();return t&&t.getBuffering?t.getBuffering():0},seekTo:function(t,e){var i=this.deviceInstance();return i&&i.seekTo?i.seekTo(t,e):null},getVideoSize:function(){var t=this.deviceInstance();return t&&t.getVideoSize?t.getVideoSize():null},getDefaultPlaybackRate:function(){var t=this.deviceInstance();return t&&t.getDefaultPlaybackRate?t.getDefaultPlaybackRate():null},getPlaybackRate:function(){var t=this.deviceInstance();return t&&t.getPlaybackRate?t.getPlaybackRate():null},getAvailablePlaybackRates:function(){var t=this.deviceInstance();return t&&t.getAvailablePlaybackRates?t.getAvailablePlaybackRates():null},setPlaybackRate:function(t){var e=this.deviceInstance();return e&&e.setPlaybackRate?e.setPlaybackRate(t):null},getPlaybackQuality:function(t){var e=this.deviceInstance();return e&&e.getPlaybackQuality?e.getPlaybackQuality(t):null},getAvailableQualityLevels:function(){var t=this.deviceInstance();return t&&t.getAvailableQualityLevels?t.getAvailableQualityLevels():null},setPlaybackQuality:function(t){var e=this.deviceInstance();return e&&e.setPlaybackQuality?e.setPlaybackQuality(t):null},getAvailableSubtitles:function(){var t=this.deviceInstance();return t&&t.getAvailableSubtitles?t.getAvailableSubtitles():null},getPlaybackSubtitle:function(){var t=this.deviceInstance();return t&&t.getPlaybackSubtitle?t.getPlaybackSubtitle():null},setPlaybackSubtitle:function(t){var e=this.deviceInstance();return e&&e.setPlaybackSubtitle?e.setPlaybackSubtitle(t):null},setSphericalProperties:function(t){var e=this.deviceInstance();return e&&e.setSphericalProperties?e.setSphericalProperties(t):null},getSphericalProperties:function(){var t=this.deviceInstance();return t&&t.getSphericalProperties?t.getSphericalProperties():null},isSphericalProperties:function(){var t=this.deviceInstance();return!(!t||!t.isSphericalProperties)&&t.isSphericalProperties()},onCurrentTimeSync:function(){var t=this.deviceInstance();t&&donCurrentTimeSync&&t.onCurrentTimeSync()},onBufferingSync:function(){var t=this.deviceInstance();t&&t.onCurrentTimeSync&&t.onBufferingSync()},onVolumeSync:function(){var t=this.deviceInstance();t&&t.onCurrentTimeSync&&t.onVolumeSync()}});return s})}();!function(){"use strict";var a=getDframework(),s=a.module("imgtech.media.Media"),r=s.CN;a.define("imgtech.media.module.OpenLayer",function(){var i=a.module("imgtech.media.ModuleInterface");function t(t){i.apply(this,arguments);if(t){var e=this.attr;this.__isDisabled=!1;this.__showOpenLayer=!1;this._openLayoutAttr={controlAutoHide:2.5,controlAutoHidePause:!1,controlAutoHideFirst:!1,controlAutoHideOver:!0,separateControlNormal:!1,separateControlFs:!1,alwaysControlNormal:!1,alwaysControlFs:!1};this._orgLayoutAttr={};this.__updatedLayoutAttr="org";this.__usedOpenBtn=!1;this.__openBtn=this.p.elementManager.getButton("openLayerBtn");this.__rollbackBtn=this.p.elementManager.getButton("openLayerRollbackBtn");this.__closeBtn=this.p.elementManager.getButton("openLayerCloseBtn");this.__openBtn.initButton(e.openLayerBtn);this.__rollbackBtn.initButton(e.rollbackBtn);this.__closeBtn.initButton(e.closeBtn)}}a.extendClass(t,i,{onAddEvent:function(){var e=this,t=this.attr,i=t.target?t.target():window,n=this.c.resourceElement;a.on(i,"scroll",function(t){e.onScroll(t)});a.b.safari||a.b.chrome||a.b.whale||a.b.isMobile;a.on(n,"transitionend",function(t){e.patchVideoSizeData("end")});a.on(this.__closeBtn.all,"click",function(t){return e.onClickCloseBtn(t)});a.on(this.__rollbackBtn.all,"click",function(t){return e.rollback(t)});a.on(this.__openBtn.all,"click",function(t){return e.open(t)});this.sizeMod=this.p.module("size");this.wideMod=this.p.module("wide");this.layoutMod=this.p.module("layout");this.volumeMod=this.p.module("volume");this.appMod=this.p.module("app")},onStateChange:function(t){var e=this.c.resourceElement;switch(t.type){case s.EVENT.FULLSCREEN_CHANGE:if(!t.data&&this.__has_fullscreen_landscape_classname){this.__has_fullscreen_landscape_classname=!1;a.removeClass(e,r.OPENLAYER_FULLSCREEN_SCREEN)}this.patchVideoSizeData();break;case s.EVENT.ORIENTATION_CHANGE:this.patchOrientationChange(t);this.patchVideoSizeData();break;case s.EVENT.RESIZE_WINDOW:case s.EVENT.OPENLAYER_CHANGE:case s.EVENT.WIDE_CHANGE:case s.EVENT.VIDEO_SIZE_DATA:this.patchVideoSizeData()}},isLandscape:function(){return this.sizeMod.isLandscape()},patchOrientationChange:function(t){var e=this,i=this.c.resourceElement,n=this.configSize();if(a.b.isMobile&&this.isLandscape()&&"none"==n.landscape){this.__has_none_landscape_classname=!0;a.addClass(i,r.OPENLAYER_NONE_SCREEN);this.isOpenLayer()&&this.closeOpenLayer()}else if(this.__has_none_landscape_classname){this.__has_none_landscape_classname=!1;a.removeClass(i,r.OPENLAYER_NONE_SCREEN)}else if(a.b.isMobile&&this.isLandscape()&&"fullscreen"==n.landscape&&!this.p.isFullscreen()){this.__has_fullscreen_landscape_classname=!0;this.__has_fullscreen_landscape_scrollY=a.scrollTop();this.isOpenLayer()&&this.closeOpenLayer();this.p.fullscreen(!1);a.addClass(i,r.OPENLAYER_FULLSCREEN_SCREEN)}else if(this.__has_fullscreen_landscape_classname){this.__has_fullscreen_landscape_classname=!1;this.p.isFullscreen()&&this.p.exitFullscreen();a.removeClass(i,r.OPENLAYER_FULLSCREEN_SCREEN);setTimeout(function(){a.scrollTop(e.__has_fullscreen_landscape_scrollY)},1)}},patchVideoSizeData:function(){function t(){if(this.hasOpenLayerClassName()){var t,e,i=this.configSize();"auto"==i.width&&"auto"==i.height&&(i.width=undefined);i.width&&"auto"!=i.width&&(t=s.getStyleNumberValue(i.width));"auto"==i.height?a.b.isMobile&&this.isLandscape()?e="100%":setTimeout(function r(t){var e=this.p.module("radio");if(!e||e&&!e.isHideScreen()){var i=this.c.resourceElement,n=s.GetAutoHeight.call(this.p,i);if(n){n+="px";s.updateStyle(this,{height:n})}}this.p.patchScreenClassName()}.bind(this,t),100):i.height&&(e=s.getStyleNumberValue(i.height));t&&e?s.updateStyle(this,{width:t,height:e}):t?s.updateStyle(this,{width:t}):e&&s.updateStyle(this,{height:e});(t||e)&&this.p.patchScreenClassName()}}var e=this;this.hasOpenLayerClassName()&&setTimeout(function(){t.call(e)},1)},resetStyle:function(){var t=this.p.controller.resourceElement;t.style.width="";t.style.height="";a.removeClass(t,r.OPENLAYER_SCREEN);a.removeClass(this.p.userElement,r.OPENLAYER_ROOT_SCREEN)},updateStyle:function(){var t=this.__style,e=this.p.controller.resourceElement;for(var i in t)e.style[i]=t[i];a.addClass(e,r.OPENLAYER_SCREEN);a.addClass(this.p.userElement,r.OPENLAYER_ROOT_SCREEN)},setDisable:function(t){if(!(this.__isDisabled=t))return this.onScroll();this.__showOpenLayer&&this.closeOpenLayer()},isDisable:function(){return this.__isDisabled},type:function(){var t=this.attr;return a.b.isMobile&&t.mobile?"bottom"==t.mobile.type?"bottom":"top":"bottom"},configSize:function(){var t=this.attr,e=undefined,i=undefined,n=undefined;if(a.b.isMobile&&t.mobile){t.mobile.width&&(e=t.mobile.width);t.mobile.height&&(i=t.mobile.height);t.mobile.landscape&&(n=t.mobile.landscape)}e===undefined&&t.width&&(e=t.width);i===undefined&&t.height&&(i=t.height);var r=this.p.module("radio");if(r&&r.isHideScreen()){var s=r.getSize();if(s){s.landscape=n;return s}}return{width:e,height:i,landscape:n}},isOpenLayer:function(){return this.__showOpenLayer},isPatchScreenClassName:function(){return this.isOpenLayer()},hasOpenLayerClassName:function(){return a.hasClass(this.c.resourceElement,r.OPENLAYER_SCREEN)},onClickCloseBtn:function(t){if(this.__showOpenLayer){this.is_onclick_close_openlayer_btn=!0;this.closeOpenLayer()}return a.igEventAll(t)},onScroll:function(){function t(){return"top"==e?0<i.top:0<i.bottom}var e,i,n=this.attr;if(n.use){if(!this.p.isDestroy()&&!(this.sizeMod.isFullscreen()||this.isDisable()||this.__usedOpenBtn||a.b.isMobile&&!1===n.mobile)){i=a.getBoundingClientRect(this.p.userElement);e=this.type();if(this.__showOpenLayer)t()&&this.closeOpenLayer(!1);else{if(this.is_onclick_close_openlayer_btn){if(n.hideOnClose)return;t()&&(this.is_onclick_close_openlayer_btn=!1);return}(function r(){return"top"==e?i.top<0:i.bottom<0})()&&this.openOpenLayer()}}}else this.__showOpenLayer&&this.closeOpenLayer()},openOpenLayer:function(){var t=this.configSize();if(this.attr.use){if(!a.b.isMobile||!this.isLandscape()||"none"!=t.landscape&&"fullscreen"!=t.landscape){this.__showOpenLayer=!0;this.defaultElements();this.p.patchScreenClassName();this.patchVideoSizeData(!!(a.b.safari||a.b.chrome||a.b.isMobile));this.p.callStateChange({type:s.EVENT.OPENLAYER_CHANGE,data:this.__showOpenLayer})}}else this.__showOpenLayer&&this.closeOpenLayer()},open:function(){this.__isDisabled=!0;this.__usedOpenBtn=!0;this.__showOpenLayer||this.openOpenLayer();return a.igEventAll(e)},closeOpenLayer:function(){this.__showOpenLayer=!1;this.defaultElements();this.p.patchScreenClassName();if(this.__usedOpenBtn){this.__isDisabled=!1;this.__usedOpenBtn=!1}this.p.callStateChange({type:s.EVENT.OPENLAYER_CHANGE,data:this.__showOpenLayer})},rollback:function(t){this.onClickCloseBtn();window.scroll(0,function i(t){var e=0;if(t.offsetParent){for(;e+=t.offsetTop,t=t.offsetParent;);return e}return 0}(this.p.userElement)-10);return a.igEventAll(t)},defaultElements:function(){this.volumeMod&&this.volumeMod.isAutoHide()&&this.volumeMod.hideSlider()},__convertLayoutAttribute:function(t,e,i){var n;t.controlAutoHide=e.controlAutoHide;t.controlAutoHidePause=e.controlAutoHidePause;t.controlAutoHideFirst=e.controlAutoHideFirst;t.controlAutoHideOver=e.controlAutoHideOver;t.separateControlNormal=e.separateControlNormal;t.separateControlFs=e.separateControlFs;t.alwaysControlNormal=e.alwaysControlNormal;t.alwaysControlFs=e.alwaysControlFs;if(i&&(n=this.p.module("layout"))){n.separateControl();n.showControl()}},updateLayoutAttribute:function(){if(this.hasOpenLayerClassName()){if("open"!=this.__updatedLayoutAttr){this.__updatedLayoutAttr="open";this.__convertLayoutAttribute(this._orgLayoutAttr,this.layoutMod.attr);this.__convertLayoutAttribute(this.layoutMod.attr,this._openLayoutAttr,!0)}}else if("org"!=this.__updatedLayoutAttr){this.__updatedLayoutAttr="org";this.__convertLayoutAttribute(this.layoutMod.attr,this._orgLayoutAttr,!0)}return 0}});return t})}();!function(){"use strict";var w=getDframework(),n=w.module("imgtech.media.Media"),C=w.module("imgtech.media.module.Matrix"),A=C.Rectangle,k=w.math.DuiRect;function r(){this.index=-1;this.position=null;this.seconds=0}r.prototype={constructor:r};function s(t,e){this.name=t;this.seconds=e}s.prototype={constructor:s};function a(){this.list=[]}a.prototype={constructor:a,size:function(){return this.list.length},get:function(t){return this.list[t]},push:function(t){this.list.push(t)},hasPosition:function(t){for(var e=this.list.length,i=0;i<e;i++){if(this.get(i).position===t.position)return!0}return!1},computedClone:function(){for(var t=new a,e=0;e<this.size();e++){var i=this.get(e);i.seconds--;0<i.seconds&&t.push(i)}return t}};function o(t){if(t){this.attr=t;this.alpha;this.color;this.font;this.lineHeight;this.letterSpacing;this.margin;this.message;this.image;this.position=[];this.random;this.rotate;this.multi;this.density;this.hasFontWeight=!1;this.setData(t)}}o.prototype={constructor:o,setData:function(t){if(t){this.alpha=t.alpha;this.color=t.color;this.font=t.font;this.lineHeight=t.lineHeight;this.letterSpacing=t.letterSpacing;this.margin=t.margin;this.message=t.message?t.message.trim():"";this.image=t.image?t.image.trim():"";this.position=[];this.random=t.random;this.rotate=t.rotate;this.multi=t.multi;this.density=t.density;this.margin&&(this.marginRect=this.getRoundStyle(this.margin));if(t.position.length)for(var e=0;e<t.position.length;e++){var i=t.position[e];this.position.push(new s(i.name,i.seconds))}else for(var n in t.position)if(n){var r=t.position[n];switch(n){case"TL":case"TC":case"TR":case"ML":case"MC":case"MR":case"BL":case"BC":case"BR":case"NO":this.position.push(new s(n,r))}}}},setAlpha:function(t){this.alpha=t},setColor:function(t){this.color=t},setFont:function(t){this.font=t},setLineHeight:function(t){this.lineHeight=t},setLetterSpacing:function(t){this.letterSpacing=t},setMargin:function(t){this.margin=t;this.marginRect=this.getRoundStyle(this.margin)},setMessage:function(t){this.message=t?t.trim():""},getAlpha:function(){return this.alpha},getColor:function(){return this.color},getFont:function(){return this.font},getLineHeight:function(){return this.lineHeight},getLetterSpacing:function(){return this.letterSpacing},getMargin:function(){return this.margin},getMessage:function(){return this.message},getImage:function(){return this.image},getPosition:function(t){return 0<=t&&t<this.position.length?this.position[t]:null},getPositionSize:function(){return this.position.length},getRotate:function(){return this.rotate},hasMessage:function(){return!!(this.message&&0<this.message.length)},hasImage:function(){return!!(this.image&&0<this.image.length)},isFontWeight:function(){return this.hasFontWeight},isRotate:function(){return 0!==this.rotate},isRandom:function(){return this.random},getMarginRect:function(){return this.marginRect},getRoundStyle:function(t){var e,i,n,r,s=[],a=t.split(" ");for(var o in a)o&&(r=a[o])&&(r=r.trim())&&s.push(r);if(!s.length)return{top:0,right:0,bottom:0,left:0};e=parseInt(s[0]);if(1==s.length)return{top:e,right:e,bottom:e,left:e};i=parseInt(s[1]);if(2==s.length)return{top:e,right:i,bottom:e,left:i};n=parseInt(s[2]);return 3==s.length?{top:e,right:i,bottom:n,left:n}:{top:e,right:i,bottom:n,left:parseInt(s[3])}}};function m(t){this.attr;w.addClass(t,"mpv-watermark");t.style.visibility="visible";t.style.display="block";t.style.position="absolute";t.style.top="0px";t.style.left="0px";t.style.width="100%";t.style.height="100%";t.style.margin="0px 0px 0px 0px";t.style.padding="0px 0px 0px 0px";t.style.overflow="hidden";t.style.pointerEvents="none";this.p.attr.zIndex&&(t.style.zIndex=this.p.attr.zIndex+1)}w.define("imgtech.media.module.Watermark",function(){var i=w.module("imgtech.media.ModuleInterface");function p(t){try{t&&w.remove(t)}catch(e){}t=document.createElement("div");m.call(this,t);w.append(this.__deviceUi,t);return this.element=t}function t(t){i.apply(this,arguments);if(t){var e=this.p.userElement;this.__deviceUi=w.query(e,".mpv-device");this.videoSize=null;this.canvas;this.element;this.timeout=1e3;this.watermarkData=new o(this.attr);this.roundPosition=-1;this.currentDisplayList}}t.WatermarkPosition=s;w.extendClass(t,i,{onAddEvent:function(){p.call(this);this.autoPlay()},onStateChange:function(t){var e=this;switch(t.type){case n.EVENT.SIZE_CHANGE:case n.EVENT.RESIZE_WINDOW:setTimeout(function(){e.onResize()},1);break;case n.EVENT.VIDEO_SIZE_DATA:this.videoSize=t.data;setTimeout(function(){e.onResize()},1);break;case n.EVENT.STATE_CHANGE:t.data==n.STATE.SETSOURCE&&(this.videoSize=null)}},onResize:function(){var t=w.getBoundingClientRect(this.__deviceUi);t.width()&&t.height()&&this.draw()},createData:function(t){var e,i=new r;t.isRandom()?e=Math.floor(Math.random()*t.getPositionSize()):(e=this.roundPosition)>=t.getPositionSize()&&(e=this.roundPosition=0);var n=t.getPosition(e);n||(n=new s("TL",1));i.index=e;i.seconds=n.seconds;i.position=n.name;this.roundPosition++;return i},createDataWithCDL:function(t,e){for(var i=this.roundPosition;;){var n=this.createData(t);if(!t.isRandom())return n;if(!e.hasPosition(n))return n;if(i===this.roundPosition)return n}},createCDL:function(t){var e=this.currentDisplayList;e||(e=new a);var i=e.computedClone(),n=(t.multi?t.multi:1)-i.size();if(0<n)for(var r=0;r<n&&!(i.size()>=t.getPositionSize());r++){var s=this.createDataWithCDL(t,i);s&&i.push(s)}return i},drawWatermarkText:function(t,e){var i,n=e&&e.hasMessage()?e.getMessage():null,r=e&&e.hasImage()?e.getImage():null;if((r||n)&&(i=function g(t){var e="T",i="L";if(t){if(2!=t.length||"NO"==t){"NO"!=t&&w.error("Unknown current position: "+t);return}e=t.charAt(0);i=t.charAt(1);switch(e){case"T":case"M":case"B":break;default:w.warn("Unknown current position vertical method: "+e);return}switch(i){case"L":case"C":case"R":break;default:w.warn("Unknown current position horizon method: "+i);return}}return{vertical:e,horizon:i}}(t))){var s=this.attr,a=e.getFont(),o=e.getColor(),u=e.marginRect,l=e.getAlpha(),h=e.isRotate()?e.getRotate():0,c=document.createElement("div");c.style.visibility="visible";c.style.position="absolute";c.style.display="inline-block";c.style.margin=s.margin?s.margin:"5px 5px 5px 5px";c.style.padding=s.padding?s.padding:"0px 0px 0px 0px";this.p.attr.zIndex&&(c.style.zIndex=this.p.attr.zIndex+1);c.style.whiteSpace="nowrap";c.style.textAlign=s.textAlign?s.textAlign:"center";if(r){var d=document.createElement("img");d.style.visibility="visible";d.style.position="static";d.style.display="block";d.style.margin="0px 0px 0px 0px";d.style.padding="0px 0px 0px 0px";this.p.attr.zIndex&&(d.style.zIndex=this.p.attr.zIndex+1);d.src=r;c.appendChild(d)}else if(n){var f=n.split("\n");if(1===f.length)c.innerHTML=n;else for(var p=0;p<f.length;p++){var m=document.createElement("p");m.style.visibility="visible";m.style.position="static";m.style.display="block";m.style.margin="0px 0px 0px 0px";m.style.padding="0px 0px 0px 0px";this.p.attr.zIndex&&(m.style.zIndex=this.p.attr.zIndex+1);a&&(m.style.font=a);o&&(m.style.color=o);s.lineHeight&&(m.style.lineHeight=s.lineHeight);s.letterSpacing&&(m.style.letterSpacing=s.letterSpacing);m.innerText=f[p];c.appendChild(m)}}s.border&&(c.style.border=s.border);a&&(c.style.font=a);o&&(c.style.color=o);s.lineHeight&&(c.style.lineHeight=s.lineHeight);s.letterSpacing&&(c.style.letterSpacing=s.letterSpacing);return{uele:c,method:i,margin:u,degree:h,alpha:l}}},drawWatermarkOffset:function(t){var e=this.element,i=t.uele,n=t.method,r=t.margin,s=this.videoSize;if(!(s&&s.width&&s.height)){var a=w.getBoundingClientRect(this.__deviceUi);if(!(s={width:a.width(),height:a.height()}).width||!s.height)return}var o=t.degree,u=t.alpha,l="",h=w.getBoundingClientRect(i),c=w.getBoundingClientRect(e),d=function S(t,e){var i={};if(t.width>t.height){i.width=e.width();i.height=t.height*i.width/t.width;if(e.height()<i.height){i.height=e.height();i.width=t.width*i.height/t.height}}else{i.height=e.height();i.width=t.width*i.height/t.height;if(e.width()<i.width){i.width=e.width();i.height=t.height*i.width/t.width}}return{left:(e.width()-i.width)/2,top:(e.height()-i.height)/2,width:i.width,height:i.height}}(s,c),f=r||{top:0,left:0,bottom:0,right:0},p=0,m=0,g=0,v=0;if(o){var y=new A(h.left,h.top,h.width(),h.height()).rotate(C.degree(o)),_=new k(y.x,y.y,y.x+y.w,y.y+y.h);g=h.top-_.top;v=h.left-_.left;h=_;if(w.b.ie&&w.b.ie<9){var E;E=0<=o?Math.PI*o/180:Math.PI*(360+o)/180;var b=Math.cos(E),T=Math.sin(E);l="progid:DXImageTransform.Microsoft.Matrix(M11="+T+",M12="+-b+",M21="+b+",M22="+T+",SizingMethod='auto expand')"}i.style.transform="rotate("+o+"deg)";i.style.msTransform="rotate("+o+"deg)";i.style.MSTransform="rotate("+o+"deg)";i.style.MozTransform="rotate("+o+"deg)";i.style.WebkitTransform="rotate("+o+"deg)";i.style.OTransform="rotate("+o+"deg)"}if(u){i.style.opacity=u;if(w.b.ie&&w.b.ie<9){l&&(l+="; ");l+="alpha(opacity="+Math.floor(100*u)+");"}}if(l){i.style.filter=l;i.style.msFilter=l;i.style.MSFilter=l}switch(n.vertical){case"T":p=f.top+d.top;break;case"M":p=c.height()/2-h.height()/2;break;case"B":p=c.height()-h.height()-f.bottom-d.top}switch(n.horizon){case"L":m=f.left+d.left;break;case"C":m=c.width()/2-h.width()/2;break;case"R":m=c.width()-h.width()-f.right-d.left}p+=g;m+=v;i.style.left=m+"px";i.style.top=p+"px"},draw:function(){function t(t,e){for(var i=0;i<e.length;i++)this.drawWatermarkOffset(e[i])}if(this.attr.use){var e=this.watermarkData;if(e){var i,n=this.currentDisplayList;if(n&&n.size()){var r,s=this.element,a=[];this.element.innerText="";for(var o=0;o<n.size();o++)if((i=n.get(o))&&(r=this.drawWatermarkText(i.position,e))){a.push(r);s.appendChild(r.uele)}if(w.b.ie&&w.b.ie<9){var u=this;setTimeout(function(){t.call(u,s,a)},1)}else t.call(this,s,a)}}}else this.element&&(this.element.innerText="")},running:function(){var t=this.p,e=this.attr,i=this.watermarkData;if(e.use){if(i&&(e.ignorePause||t.isPlaying())){var n=this.__deviceUi,r=this.element,s=w.parent(r);r=n&&n!==s?p.call(this,r):function f(t){if(!t||!t.style)return p.call(this,t);var e=this.__deviceUi,i=w.getBoundingClientRect(e),n=i.width(),r=i.height();if(!n||!r)return t;var s=w.getBoundingClientRect(t),a=s.width(),o=s.height();if(!(a<n+20&&n-20<a&&o<r+20&&r-20<o))return p.call(this,t);m.call(this,t);return t}.call(this,r);this.roundPosition<0&&(this.roundPosition=0);var a,o,u,l=this.currentDisplayList,h=this.currentDisplayList=this.createCDL(i);if(l)for(a=0;a<h.list.length;a++){var c=h.list[a].index,d=!1;for(o=0;o<l.length;o++){if(c===l[o].index){d=!0;break}}d&&u++}(!l||l&&u!=h.list.length)&&this.draw()}}else this.element&&(this.element.innerText="")},autoPlay:function(){var t=this,e=this.attr,i=e&&400<e.intervalTime?e.intervalTime:3e3;this.timer&&clearInterval(this.timer);this.timer=setInterval(function(){t.running()},i);this.running()}});return t})}();!function(){"use strict";var h=getDframework(),c=h.module("imgtech.media.Media");h.define("imgtech.media.module.BookmarkInput",function(){var i=h.module("imgtech.media.ModuleInterface"),n=h.module("imgtech.media.extends.Popup");function t(t){i.apply(this,arguments);if(t){var e=this.p.userElement;this.__parent=null;this.inputLayout=h.query(e,".mpv-bookmark-input-layout");this.inputBox=h.query(this.inputLayout,".mpv-bookmark-box");this.inputTitle=h.query(this.inputLayout,".mpv-bookmark-title-input");this.inputTime=h.query(this.inputLayout,".mpv-bookmark-time-input");this.inputConfirmBtn=h.query(this.inputLayout,".mpv-bookmark-confirm-btn");this.inputCloseBtn=h.query(this.inputLayout,".mpv-bookmark-close-btn")}}h.extendClass(t,i,{onAddEvent:function(){var e=this,t=this.attr.input;this.progressMod=this.p.module("progress");this.keyMod=this.p.module("key");if(this.inputBox){h.on(this.inputBox,"click",function(t){e.setInputFocus("box");return h.igEventAll(t)});h.on(this.inputBox,"dblclick",function(t){e.setInputFocus("box");return h.igEventAll(t)})}h.attr(this.inputTitle,"maxlength",t&&t.nameLength?t.nameLength:20);h.attr(this.inputTime,"maxlength",t&&t.timeLength?t.timeLength:9);h.on(this.inputTime,"click",function(t){e.setInputFocus("time");return h.igEventAll(t)});h.on(this.inputConfirmBtn,"click",function(t){e.confirmInput();return h.igEventAll(t)});h.on(this.inputCloseBtn,"click",function(t){e.closeMenu();return h.igEventAll(t)});this.progressMod.addActionModule(this);new n(this,{player:this.p,disableControl:!0,button:[],friend:[],element:this.inputLayout}).patchOverwrite()},setInputFocus:function(t){h.removeClass(this.inputTime,"selected");switch(t){case"time":h.addClass(this.inputTime,"selected")}this.__inputFocus=t},actionChange:function(t){"progressChange"==t.type&&"time"==this.__inputFocus&&this.inputTime&&(this.inputTime.value=c.secondsToString(t.data))},alertUi:function(t,e){this.__parent.alertUi(t,e)},__openMenu:function(){var t=this.p.currentTime(),e=this.attr&&this.attr.input;this.inputTitle&&(this.inputTitle.value="");this.inputTime&&(this.inputTime.value=c.secondsToString(t||0===t?t:0));this.inputLayout&&this.keyMod&&this.keyMod.disable();e&&e.pauseOnOpen&&this.p.pause()},__closeMenu:function(){this.inputLayout&&this.keyMod&&this.keyMod.enable()},confirmInput:function(){var t=this.attr.input,e=this.p.currentMediaSource(),i=this.p.duration(),n=this.inputTitle,r=this.inputTime,s=n&&n.value&&n.value.trim(),a=r&&r.value&&r.value.trim();if(!e||!i)return this.alertUi(this.__parent.MESSAGE.M0001);if(!s)return this.alertUi(this.__parent.MESSAGE.M0002);if(!a)return this.alertUi(this.__parent.MESSAGE.M0003);var o=c.timeStringToseconds(a);if(t&&t.ignoreTime){if(o<0||i<o)return this.alertUi(this.__parent.MESSAGE.M0005)}else if(o<2||i-2<o)return this.alertUi(this.__parent.MESSAGE.M0005);if(this.__parent.addBookmarkData({seconds:o,name:s})){t&&!1!==t.hideAfterAppend&&this.closeMenu();this.alertUi(this.__parent.MESSAGE.M0006)}}});return t});h.define("imgtech.media.module.Bookmark",function(){var n=h.module("imgtech.media.ModuleInterface"),s=h.module("imgtech.media.extends.Menu"),r=h.module("imgtech.media.module.BookmarkInput");function t(t){n.apply(this,arguments);if(t){var e=this.p.userElement,i=this.attr;this.MESSAGE={M0001:"\ubbf8\ub514\uc5b4\uac00 \uc874\uc7ac \ud558\uc9c0 \uc54a\uac70\ub098 \uc7ac\uc0dd\uc2dc\uac04\uc744 \uc54c \uc218 \uc5c6\ub294 \ubbf8\ub514\uc5b4 \uc785\ub2c8\ub2e4.",M0002:"\uc774\ub984\uc774 \uc874\uc7ac \ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",M0003:"\uc2dc\uac04\uc774 \uc874\uc7ac \ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",M0004:"\uc2dc\uac04\uc740 12:34 \ud639\uc740 00:12:34 \uc640 \uac19\uc740 \ud615\uc2dd\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.",M0005:"\uc601\uc0c1\uc774 \uc5c6\uac70\ub098, \ub4f1\ub85d \uc2dc\uac04\uc774 \ucc98\uc74c \ud639\uc740 \uc885\ub8cc \uad6c\uac04\uc5d0 \uc18d\ud558\uc5ec \ucc45\uac08\ud53c\ub97c \ub4f1\ub85d \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",M0006:"\ucc45\uac08\ud53c\uac00 \ub4f1\ub85d \ub418\uc5c8\uc2b5\ub2c8\ub2e4.",M0007:"\ub3d9\uc77c\ud55c \ubd81\ub9c8\ud06c(\ucc45\uac08\ud53c)\uac00 \uc874\uc7ac \ud569\ub2c8\ub2e4.",M0008:"{timeName} \ucc45\uac08\ud53c\ub97c \uc0ad\uc81c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",M0009:"\uc601\uc0c1\uc774 \uc5c6\uac70\ub098 \ud50c\ub808\uc774 \uc2dc\uac04\uc744 \ud655\uc778 \ud560 \uc218 \uc5c6\uc5b4 \ubd81\ub9c8\ud06c\ub97c \ub4f1\ub85d \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",M0010:"\ubd81\ub9c8\ud06c\ub294 \ucd5c\ub300 {maxSize}\uac1c\ub97c \ucd08\uacfc \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."};this.setMessage(this.attr.message);this.inputData=[];this.progressMod=null;this.__bookmarkProgress=h.query(e,".mpv-bookmark-progress");this.textLayout=h.query(e,".mpv-bookmark-text-layout");this.textUi=h.query(e,".mpv-bookmark-text");this.__bookmarkLayout=h.query(e,".mpv-bookmark-layout");this.__bookmarkAddBtn=this.p.getButton("bookmarkAddBtn");this.__bookmarkMenuBtn=this.p.getButton("bookmarkMenuBtn");i.offset===undefined&&(i.offset=2);h.removeClass(this.__bookmarkLayout,"mpv-hide");this.__bookmarkAddBtn.initButton(i.addBtn);this.__bookmarkMenuBtn.initButton(i.menuBtn);this.inputMod=new r(this.p,this.c,i);(this.inputMod.__parent=this).linkedThumbnailMod=null;this.linkedThumbnailModData=null}}h.extendClass(t,n,{onAddEvent:function(){var e=this,t=h.module("imgtech.media.extends.Confirm"),i=h.module("imgtech.media.extends.Alert"),n=this.p.userElement;this.inputMod.onAddEvent();this.layoutMod=this.p.module("layout");this.progressMod=this.p.module("progress");this.confirm=new t({player:this.p});this.alert=new i({player:this.p});(function r(t){function e(e){var i=this,n=this.attr.input;h.on(e,"click",function(t){i.inputMod.isOpenMenu()?i.inputMod.closeMenu():i.isOpenMenu()&&(h.hasClass(e,"mpv-in-box")||n&&n.linkControlBtn)?i.addCurrentBookmark():i.addCurrentBookmark({clear:!0});return h.igEventAll(t)})}if(h.isArray(t))for(var i=0;i<t.length;i++)e.call(this,t[i]);else e.call(this,t)}).call(this,this.__bookmarkAddBtn.all);h.on(this.__bookmarkMenuBtn.all,"click",function(t){e.inputMod.closeMenu();e.toggleMenu();return h.igEventAll(t)});new s(this,{player:this.p,invalidate:!0,disableControl:!0,button:[this.__bookmarkMenuBtn],friend:[this.__bookmarkLayout],element:h.query(n,".mpv-bookmark-menu"),enableNoData:!0}).patchOverwrite()},onStateChange:function(t){function u(){var t=this,e=l.duration(),i=l.currentMediaSource(),n=i?i.input:null,r=n?n.bookmark:null,s=r?r.data:null,a=this.progressMod?this.progressMod.rect():null;if(s){if(!e||!a||!a.width()){if(a&&!a.width()){var o=this.p.module("layout");o&&o.showControl()}return setTimeout(function(){u.call(t)},400)}this.drawBookmarkList(s)}}var l=this.p,e=this.attr;switch(t.type){case c.EVENT.STATE_CHANGE:if(t.data==c.STATE.SETSOURCE){this.clean();if(7===h.b.ie){h.removeClass(this.__bookmarkLayout,"mpv-hide");h.removeClass(this.__bookmarkLayout,"mpv-1btn");h.removeClass(this.__bookmarkLayout,"mpv-2btn");e.addBtn&&e.addBtn.hideButton&&e.menuBtn&&e.menuBtn.hideButton?h.addClass(this.__bookmarkLayout,"mpv-hide"):e.addBtn&&!e.addBtn.hideButton&&e.menuBtn&&!e.menuBtn.hideButton?h.addClass(this.__bookmarkLayout,"mpv-2btn"):(e.addBtn&&!e.addBtn.hideButton||e.menuBtn&&!e.menuBtn.hideButton)&&h.addClass(this.__bookmarkLayout,"mpv-1btn")}this.p.isLive()||this.p.isDVR()?this.hideButton():this.showButton()}break;case c.EVENT.ON_BEFORE_PLAY:u.call(this);break;case c.EVENT.SIZE_CHANGE:case c.EVENT.RESIZE_WINDOW:u.call(this);break;case c.EVENT.CLICK_EVENT:this.inputMod.isOpenMenu()?this.attr.input&&this.attr.input.closeOnClick&&this.inputMod.closeMenu():this.attr.closeOnClick&&this.closeMenu()}},currentValue:function(){var t=this.attr,e=t.unitName?t.unitName:" \uac1c";return this.inputData?this.inputData.length+e:"0"+e},isEnableMenu:function(){return!this.p.isLive()&&!this.p.isDVR()},isSubMenu:function(){return!0},showButton:function(){var t=this.attr;this.__bookmarkAddBtn.showButton(t.addBtn);this.__bookmarkMenuBtn.showButton(t.menuBtn)},hideButton:function(){var t=this.attr;this.__bookmarkAddBtn.hideButton(t.addBtn);this.__bookmarkMenuBtn.hideButton(t.menuBtn)},setMessage:function(t){for(var e in t)this.MESSAGE[e]=t[e]},getPixelFromSeconds:function(t){var e=this.p.duration(),i=this.progressMod.rect();return i&&e?Math.floor(i.width()*(t/e)):-1},setLinkedThumbnail:function(t){this.linkedThumbnailMod=t},getLinkedThumbnailData:function(t){return this.getLinkedThumbnail(t)},getLinkedThumbnail:function(t){return this.linkedThumbnailModData},drawBookmarkList:function(t){var e=this.attr;this.clean();this.inputData=t;this.sortInputData();if(t&&t.length)for(var i=0;i<t.length;i++)e.drawData?e.drawData.call(this,t[i]):this.drawData(t[i]);this.isOpenMenu()&&this.openMenu()},drawData:function(t){if(!this.attr.disablePointer){if(!this.__bookmarkProgress)return h.warn("Not found bookmark progress ui.");var e=document.createElement("div"),i=this.progressMod.timeToPixel(t.seconds),n=this.attr;h.addClass(e,"mpv-bookmark-pointer");n.pointerClassName&&h.addClass(e,n.pointerClassName);e.style.left=i+"px";t.pointElement=e;h.append(this.__bookmarkProgress,e)}},clean:function(){this.inputData=[];var t=h.queryAll(this.__bookmarkProgress,".mpv-bookmark-pointer");if(t)for(var e=0;e<t.length;e++)h.remove(t[e])},eventMods:function(t,e){if("move"==t){this.linkedThumbnailModData=null;if(this.inputData.length&&e.active){var i=this.progressMod.rect();i=i?i.left:0;for(var n=0;n<this.inputData.length;n++){var r=this.inputData[n],s=r&&h.getBoundingClientRect(r.pointElement);if(s){var a=this.progressMod.pixelToTime(s.left-i),o=this.progressMod.pixelToTime(s.right-i);if(r&&a<=e.time&&e.time<=o){this.linkedThumbnailModData={text:r.text?r.text:r.name?r.name:null,time:r.seconds};return}}}}}},sortInputData:function(){this.inputData.sort(function(t,e){return t.seconds-e.seconds})},maxSize:function(){var t=this.attr;return t.size?t.size:0===t.size?0:10},addBookmarkData:function(t){var e=this.attr,i=e.input,n=!1,r=this.maxSize();this.inputData||(this.inputData=[]);if(r&&r<=this.inputData.length)return this.alertUi(this.MESSAGE.M0010,{maxSize:r});for(var s in this.inputData){var a=this.inputData[s];if(a.seconds==t.seconds){if(a.name===t.name)return this.alertUi(this.MESSAGE.M0007,t);a.name=t.name;n=!0;break}}if(!n){this.drawData(t);this.inputData.push(t);this.sortInputData()}(this.isOpenMenu()||i&&!0===i.showAfterAppend)&&this.openMenu();e.add&&e.add.call(this.p,t);return!0},alertUi:function(t,e){var i=this.attr,n=this.alert,r=!1!==t&&this.regexp2string(t,e);if(!1!==r)return i.message.alertAutoHide?n.show(r,{autohide:i.message.alertAutoHide}):n.show(r)},addCurrentBookmark:function(t){var e=this.attr,i=this.p.currentMediaSource(),n=this.p.duration(),r=this.p.currentTime(),s=r?Math.floor(r):0,a={seconds:s,name:c.secondsToString(s)};if(!i||!n)return this.alertUi(this.MESSAGE.M0009,a);if(e&&e.useName){t&&t.clear&&this.p.closeAllMenu("clear");return this.inputMod.openMenu(this.isOpenMenu()?{caller:this}:undefined)}return this.addBookmarkData(a)?this.alertUi(this.MESSAGE.M0006,a):void 0},removeData:function(t){var e=this.inputData;for(var i in e){if(e[i].seconds==t.seconds)return e.splice(i,1)}},regexp2string:function(t,e){var i,n,r=t,s=r.match(/\{[\s\S]+?\}/g);if(!s||s&&!s.length)return r;e.timeName=c.secondsToString(e.seconds);for(var a=0;a<s.length;a++)if((i=s[a])&&(n=i.substring(1,i.length-1).trim())){var o=e[n]+"";(o=o&&o.trim())&&(r=r.replace(i,o))}return r},getMenuList:function(){return this.inputData},drawMenu:function(i,n){var r=this,s=this.attr,t=h.query(i,".mpv-bookmark-menu-nm"),e=h.query(i,".mpv-bookmark-menu-time"),a=h.query(i,".mpv-bookmark-menu-del-btn");function o(t){var e=r.attr;e&&e.playOnClick&&r.p.play();r.p.seekTo(t)}h.text(t,n.name);h.attr(t,"title",n.name);h.text(e,c.secondsToString(n.seconds));s&&!s.useName&&h.addClass(t,"mpv-hide");a&&h.on(a,"click",function(t){var e=r.regexp2string(r.MESSAGE.M0008,n);r.confirm.show(e,function(t){if(t){r.removeData(n);h.remove(i);h.remove(n.pointElement);s.remove&&s.remove.call(r.p,n)}});return h.igEventAll(t)});if(h.b.ie&&h.b.ie<9){h.on(t,"click",function(t){o(n.seconds);return h.igEventAll(t)});h.on(e,"click",function(t){o(n.seconds);return h.igEventAll(t)})}else h.on(i,"click",function(t){o(n.seconds);return h.igEventAll(t)})}});return t})}();!function(){"use strict";var h=getDframework(),c=h.module("imgtech.media.Media");c.ERROR;h.define("imgtech.media.module.RepmarkInput",function(){var n=h.module("imgtech.media.ModuleInterface"),i=h.module("imgtech.media.extends.Popup");function t(t){n.apply(this,arguments);if(t){var e=this.p.userElement,i=this.attr;this.__parent=null;this.__inputLayout=h.query(e,".mpv-repmark-input-layout");this.__inputBox=h.query(this.__inputLayout,".mpv-repmark-box");this.__inputTitleLayout=h.query(this.__inputLayout,".mpv-repmark-title");this.__inputTitle=h.query(this.__inputLayout,".mpv-repmark-title-input");this.__inputStart=h.query(this.__inputLayout,".mpv-repmark-start-input");this.__inputEnd=h.query(this.__inputLayout,".mpv-repmark-end-input");this.__inputConfirmBtn=h.query(this.__inputLayout,".mpv-repmark-confirm-btn");this.__inputCloseBtn=h.query(this.__inputLayout,".mpv-repmark-close-btn");i.useName?h.addClass(this.__inputLayout,"mpv-with-name"):h.addClass(this.__inputTitleLayout,"mpv-hide")}}h.extendClass(t,n,{onAddEvent:function(){var e=this,t=this.attr.input;this.progressMod=this.p.module("progress");this.keyMod=this.p.module("key");this.repMod=this.p.module("repeat");if(this.__inputBox){h.on(this.__inputBox,"click",function(t){e.setInputFocus("box");return h.igEventAll(t)});h.on(this.__inputBox,"dblclick",function(t){return h.igEventAll(t)})}h.attr(this.__inputTitle,"maxlength",t&&t.nameLength?t.nameLength:20);h.attr(this.__inputStart,"maxlength",t&&t.timeLength?t.timeLength:9);h.attr(this.__inputEnd,"maxlength",t&&t.timeLength?t.timeLength:9);h.on(this.__inputStart,"click",function(t){e.setInputFocus("start");return h.igEventAll(t)});h.on(this.__inputEnd,"click",function(t){e.setInputFocus("end");return h.igEventAll(t)});h.on(this.__inputConfirmBtn,"click",function(t){e.confirmInput();return h.igEventAll(t)});h.on(this.__inputCloseBtn,"click",function(t){e.closeMenu();return h.igEventAll(t)});this.progressMod.addActionModule(this);this.repMod&&this.repMod.addActionModule(this);new i(this,{player:this.p,disableControl:!0,button:[],friend:[],element:this.__inputLayout}).patchOverwrite()},setInputFocus:function(t){h.removeClass(this.__inputStart,"selected");h.removeClass(this.__inputEnd,"selected");switch(t){case"start":h.addClass(this.__inputStart,"selected");break;case"end":h.addClass(this.__inputEnd,"selected")}this.__inputFocus=t},actionChange:function(t){switch(t.type){case"progressChange":this.isOpenMenu()&&("start"==this.__inputFocus?this.__inputStart&&(this.__inputStart.value=c.secondsToString(t.data)):"end"==this.__inputFocus&&this.__inputEnd&&(this.__inputEnd.value=c.secondsToString(t.data)));break;case"repeatMarkerChange":this.isOpenMenu()&&("start"==t.from?this.__inputStart&&(this.__inputStart.value=c.secondsToString(t.data)):"end"==t.from&&this.__inputEnd&&(this.__inputEnd.value=c.secondsToString(t.data)))}},alertUi:function(t,e){this.__parent.alertUi(t,e)},__openMenu:function(){var t=this.__inputTitle,e=this.__inputStart,i=this.__inputEnd,n=this.repMod,r=this.p.currentTime(),s=c.secondsToString;t&&(t.value="");e&&(e.value=n&&n.isShowStartMarker()?s(n.startValue()):s(r||0===r?r:0));i&&(i.value=n&&n.isShowStartMarker()?s(n.endValue()):s(r||0===r?r:0));this.__inputLayout&&this.keyMod&&this.keyMod.disable()},__closeMenu:function(){this.__inputLayout&&this.keyMod&&this.keyMod.enable()},confirmInput:function(){var t=this.attr,e=t.input,i=this.p.currentMediaSource(),n=this.p.duration(),r=this.__inputTitle,s=this.__inputStart,a=this.__inputEnd,o=r&&r.value&&r.value.trim(),u=s&&s.value&&s.value.trim(),l=a&&a.value&&a.value.trim();if(!i||!n)return this.alertUi(this.__parent.MESSAGE.M0001);if(!o&&t&&t.useName)return this.alertUi(this.__parent.MESSAGE.M0002);if(!u||!l)return this.alertUi(this.__parent.MESSAGE.M0003);if(null===(u=c.timeStringToseconds(u))||null===(l=c.timeStringToseconds(l)))return this.alertUi(this.__parent.MESSAGE.M0004);if(u<2||n-2<u||l<2||n-2<l)return this.alertUi(this.__parent.MESSAGE.M0005);if(l<=u)return this.alertUi(this.__parent.MESSAGE.M0011);if(this.__parent.addRepmarkData({start:u,end:l,name:o})){e&&!1!==e.hideAfterAppend&&this.closeMenu();this.alertUi(this.__parent.MESSAGE.M0006)}}});return t});h.define("imgtech.media.module.Repmark",function(){var n=h.module("imgtech.media.ModuleInterface"),s=h.module("imgtech.media.extends.Menu"),r=h.module("imgtech.media.module.RepmarkInput");function t(t){n.apply(this,arguments);if(t){var e=this.p.userElement,i=this.attr;this.MESSAGE={M0001:"\ubbf8\ub514\uc5b4\uac00 \uc874\uc7ac \ud558\uc9c0 \uc54a\uac70\ub098 \uc7ac\uc0dd\uc2dc\uac04\uc744 \uc54c \uc218 \uc5c6\ub294 \ubbf8\ub514\uc5b4 \uc785\ub2c8\ub2e4.",M0002:"\uc774\ub984\uc774 \uc874\uc7ac \ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",M0003:"\uc2dc\uac04\uc774 \uc874\uc7ac \ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",M0004:"\uc2dc\uac04\uc740 12:34 \ud639\uc740 00:12:34 \uc640 \uac19\uc740 \ud615\uc2dd\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.",M0005:"\uc601\uc0c1\uc774 \uc5c6\uac70\ub098, \ub4f1\ub85d \uc2dc\uac04\uc774 \ucc98\uc74c \ud639\uc740 \uc885\ub8cc \uad6c\uac04\uc5d0 \uc18d\ud558\uc5ec \ubd81\ub9c8\ud06c\ub97c \ub4f1\ub85d \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",M0006:"\uad6c\uac04\ubc18\ubcf5\uc774 \ub4f1\ub85d \ub418\uc5c8\uc2b5\ub2c8\ub2e4.",M0007:"\ub3d9\uc77c\ud55c \ubd81\ub9c8\ud06c(\uad6c\uac04\ubc18\ubcf5)\uac00 \uc874\uc7ac \ud569\ub2c8\ub2e4.",M0008:"\uad6c\uac04\ubc18\ubcf5 ({startName}-{endName}) \uc744 \uc0ad\uc81c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",M0009:"\uc601\uc0c1\uc774 \uc5c6\uac70\ub098 \ud50c\ub808\uc774 \uc2dc\uac04\uc744 \ud655\uc778 \ud560 \uc218 \uc5c6\uc5b4 \uad6c\uac04\ubc18\ubcf5 \ubd81\ub9c8\ud06c\ub97c \ub4f1\ub85d \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",M0010:"\ubd81\ub9c8\ud06c\ub294 \ucd5c\ub300 {maxSize}\uac1c\ub97c \ucd08\uacfc \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",M0011:"\uc2dc\uc791\uc2dc\uac04({startName})\uc774 \uc885\ub8cc\uc2dc\uac04({endName}) \ubcf4\ub2e4 \ucee4\uc57c \ud569\ub2c8\ub2e4."};this.setMessage(this.attr.message);this.inputData=[];this.progressMod=null;this.__repmarkLayout=h.query(e,".mpv-repmark-layout");this.__repmarkAddBtn=this.p.getButton("repmarkAddBtn");this.__repmarkMenuBtn=this.p.getButton("repmarkMenuBtn");h.removeClass(this.__repmarkLayout,"mpv-hide");this.__repmarkAddBtn.initButton(i.addBtn);this.__repmarkMenuBtn.initButton(i.menuBtn);i.useName&&h.addClass(this.__repmarkLayout,"mpv-with-name");this.inputMod=new r(this.p,this.c,i);this.inputMod.__parent=this}}h.extendClass(t,n,{onAddEvent:function(){var e=this,t=h.module("imgtech.media.extends.Confirm"),i=h.module("imgtech.media.extends.Alert"),n=this.p.userElement;this.inputMod.onAddEvent();this.layoutMod=this.p.module("layout");this.progressMod=this.p.module("progress");this.repMod=this.p.module("repeat");this.confirm=new t({player:this.p});this.alert=new i({player:this.p});(function r(t){function e(e){var i=this,n=this.attr.input;h.on(e,"click",function(t){i.inputMod.isOpenMenu()?i.inputMod.closeMenu():i.isOpenMenu()&&(h.hasClass(e,"mpv-in-box")||n&&n.linkControlBtn)?i.addCurrentRepmark():i.addCurrentRepmark({clear:!0});return h.igEventAll(t)})}if(h.isArray(t))for(var i=0;i<t.length;i++)e.call(this,t[i]);else e.call(this,t)}).call(this,this.__repmarkAddBtn.all);h.on(this.__repmarkMenuBtn.all,"click",function(t){e.inputMod.closeMenu();e.toggleMenu();return h.igEventAll(t)});new s(this,{player:this.p,invalidate:!0,disableControl:!0,button:[this.__repmarkMenuBtn],friend:[this.__repmarkLayout],element:h.query(n,".mpv-repmark-menu"),enableNoData:!0}).patchOverwrite()},onStateChange:function(t){function u(){var t=this,e=l.duration(),i=l.currentMediaSource(),n=i?i.input:null,r=n?n.repmark:null,s=r?r.data:null,a=this.progressMod.rect();if(s){if(!e||!a||!a.width()){if(a&&!a.width()){var o=this.p.module("layout");o&&o.showControl()}return setTimeout(function(){u.call(t)},400)}this.drawRepmarkList(s)}}var l=this.p,e=this.attr;switch(t.type){case c.EVENT.STATE_CHANGE:if(t.data==c.STATE.SETSOURCE){this.clean();if(7===h.b.ie){h.removeClass(this.__repmarkLayout,"mpv-hide");h.removeClass(this.__repmarkLayout,"mpv-1btn");h.removeClass(this.__repmarkLayout,"mpv-2btn");e.addBtn&&e.addBtn.hideButton&&e.menuBtn&&e.menuBtn.hideButton?h.addClass(this.__repmarkLayout,"mpv-hide"):e.addBtn&&!e.addBtn.hideButton&&e.menuBtn&&!e.menuBtn.hideButton?h.addClass(this.__repmarkLayout,"mpv-2btn"):(e.addBtn&&!e.addBtn.hideButton||e.menuBtn&&!e.menuBtn.hideButton)&&h.addClass(this.__repmarkLayout,"mpv-1btn")}this.p.isLive()||this.p.isDVR()?this.hideButton():this.showButton()}break;case c.EVENT.ON_BEFORE_PLAY:u.call(this);break;case c.EVENT.SIZE_CHANGE:case c.EVENT.RESIZE_WINDOW:u.call(this);break;case c.EVENT.CLICK_EVENT:this.inputMod.isOpenMenu()?this.attr.input&&this.attr.input.closeOnClick&&this.inputMod.closeMenu():this.attr.closeOnClick&&this.closeMenu()}},currentValue:function(){var t=this.attr,e=t.unitName?t.unitName:" \uac1c";return this.inputData?this.inputData.length+e:"0"+e},isEnableMenu:function(){return!this.p.isLive()&&!this.p.isDVR()},isSubMenu:function(){return!0},showButton:function(){var t=this.attr;this.__repmarkAddBtn.showButton(t.addBtn);this.__repmarkMenuBtn.showButton(t.menuBtn)},hideButton:function(){var t=this.attr;this.__repmarkAddBtn.hideButton(t.addBtn);this.__repmarkMenuBtn.hideButton(t.menuBtn)},setMessage:function(t){for(var e in t)this.MESSAGE[e]=t[e]},regexp2string:function(t,e){var i,n,r=t,s=r.match(/\{[\s\S]+?\}/g);if(!s||s&&!s.length)return r;e.startName=c.secondsToString(e.start);e.endName=c.secondsToString(e.end);for(var a=0;a<s.length;a++)if((i=s[a])&&(n=i.substring(1,i.length-1).trim())){var o=e[n]+"";(o=o&&o.trim())&&(r=r.replace(i,o))}return r},alertUi:function(t,e){var i=this.attr,n=this.alert,r=this.regexp2string(t,e);return i.message.alertAutoHide?n.show(r,{autohide:i.message.alertAutoHide}):n.show(r)},sortInputData:function(){this.inputData.sort(function(t,e){return t.start===e.start?t.end-e.end:t.start-e.start})},maxSize:function(){var t=this.attr;return t.size?t.size:0===t.size?0:10},addRepmarkData:function(t){var e=this.attr,i=e.input,n=!1,r=this.maxSize();this.inputData||(this.inputData=[]);if(r&&r<=this.inputData.length)return this.alertUi(this.MESSAGE.M0010,{maxSize:r});for(var s in this.inputData){var a=this.inputData[s];if(a.start==t.start&&a.end==t.end){if(a.name===t.name)return this.alertUi(this.MESSAGE.M0007,t);a.name=t.name;n=!0;break}}if(!n){this.inputData.push(t);this.sortInputData()}(this.isOpenMenu()||i&&!0===i.showAfterAppend)&&this.openMenu();e.add&&e.add.call(this.p,t);return!0},drawRepmarkList:function(t){this.clean();this.inputData=t;this.sortInputData();this.isOpenMenu()&&this.openMenu()},addCurrentRepmark:function(t){var e=this.p.currentMediaSource(),i=this.p.duration();if(!e||!i)return this.alertUi(this.MESSAGE.M0009,{});t&&t.clear&&this.p.closeAllMenu("clear");return this.inputMod.openMenu(this.isOpenMenu()?{caller:this}:undefined)},removeData:function(t){var e=this.inputData;for(var i in e){var n=e[i];if(n.start==t.start&&n.end==t.end)return e.splice(i,1)}},clean:function(){this.inputData=[]},getMenuList:function(){return this.inputData},drawMenu:function(i,n){var r=this,s=this.attr,t=h.query(i,".mpv-repmark-menu-nm"),e=h.query(i,".mpv-repmark-menu-start"),a=h.query(i,".mpv-repmark-menu-end"),o=h.query(i,".mpv-repmark-menu-del-btn"),u=this.repMod;h.text(t,n.name);h.attr(t,"title",n.name);h.text(e,c.secondsToString(n.start));h.text(a,c.secondsToString(n.end));s&&!s.useName&&h.addClass(t,"mpv-hide");function l(){if((0===n.start||n.start)&&(0===n.end||n.end)){r.layoutMod&&r.layoutMod.showControl();setTimeout(function(){if(u){u.min(n.start);u.max(n.end);u.show(!0)}},1)}}h.on(o,"click",function(t){var e=r.regexp2string(r.MESSAGE.M0008,n);r.confirm.show(e,function(t){if(t){r.removeData(n);h.remove(i);s.remove&&s.remove.call(r.p,n)}});return h.igEventAll(t)});if(h.b.ie&&h.b.ie<9){h.on(t,"click",function(){return l()});h.on(e,"click",function(){return l()});h.on(a,"click",function(){return l()})}else h.on(i,"click",function(){return l()})}});return t})}();!function(){"use strict";var d=getDframework(),f=d.module("imgtech.media.Media");d.define("imgtech.media.module.ThumbnailOld",function(){var n=d.module("imgtech.media.ModuleInterface");function t(t){n.apply(this,arguments);if(t){var e=this.p.userElement,i=this.attr;this.__isMouseOver=!1;this.__lastEvent=null;this.is_error=!0;this.current_thumbnail=0;this.linkedMods=[];this.progressMod=null;this.radioMod=null;this.is_draw_thumbnail=null;this.virtualData=null;this.thumbnailLayout=d.query(e,".mpv-thumbnail");this.thumbnailImage=d.query(e,".mpv-thumbnail .mpv-thumbnail-image");this.thumbnailText=d.query(e,".mpv-thumbnail .mpv-thumbnail-text");this.thumbnailTime=d.query(e,".mpv-thumbnail .mpv-thumbnail-time");i.type||(i.type="atype");d.addClass(this.thumbnailLayout,i.type);i.margin||0===i.margin||(i.margin=5);i.typeSize=this.__patchTypeSize(i.typeSize);i.typeImageSize=this.__patchTypeSize(i.typeImageSize);i.ts=this.__typeSize(i.type,i.typeSize);i.image=this.__typeSize(i.typeImageSize,i.typeImageSize);this.hideThumbnail()}}d.extendClass(t,n,{__patchTypeSize:function(t){return t||{atype:{w:120,h:80},btype:{w:120,h:80},ctype:{w:150,h:80}}},__typeSize:function(t,e){var i=e[t];return i||{w:120,h:80}},onAddEvent:function(){var e=this.thumbnailLayout,t=this.thumbnailImage,i=(this.p.userElement,this),n=this.attr;this.progressMod=this.p.module("progress");this.radioMod=this.p.module("radio");t&&d.on(t,"error",function(t){if(!i.is_error){i.is_error=!0;d.ui.hide(e)}});if(n.linkedMods)for(var r=0;r<n.linkedMods.length;r++)this.setLinkedMods(n.linkedMods[r])},onStateChange:function(t){switch(t.type){case f.EVENT.RESET:this.hideThumbnail();break;case f.EVENT.STATE_CHANGE:t.data===f.STATE.SETSOURCE&&(this.is_error=!1)}},setLinkedMods:function(t){for(var e=!1,i=0;i<this.linkedMods.length;i++){var n=this.linkedMods[i];if(n&&n.name==t){e=!0;break}}if(!e){var r=this.p.module(t);this.linkedMods.push({name:t,mod:r});r&&r.setLinkedThumbnail(this)}},getLinkedData:function(t){for(var e=0;e<this.linkedMods.length;e++){var i=this.linkedMods[e],n=i&&i.mod,r=n&&n.getLinkedThumbnail&&i.mod.getLinkedThumbnail(t);if(r){r.modName=i.name;return r}}},isEnableThumbnail:function(){var t=this.p.currentMediaSource(),e=t&&t.input;return!!this.attr.use&&(!!e&&(!(this.radioMod&&this.radioMod.isRadio()&&e.radio&&!e.radio.useThumbnail)&&!1!==e.thumbnail))},eventMods:function(t,e){"move"==t&&(e.active?this.mousemove(e):this.mouseout())},mouseout:function(t){this.__isMouseOver=!1;this.hideThumbnail()},mousemove:function(t,e){this.__lastEvent=e?null:t;this.__isMouseOver=!0;var i=this.getLinkedData(t);if(!i&&!this.isEnableThumbnail())return this.hideThumbnail();var n=this.is_draw_thumbnail,r=(new Date).getTime();if(!(!e&&n&&r-n<150)){this.is_draw_thumbnail=null;t.active&&this.drawTime({time:t.time,text:i?i.text:"",originTime:i?i.time:t.time,modName:i?i.modName:""})}},showThumbnail:function(t,e){(function c(t,e){var i=this.attr,n=this.thumbnailImage,r=this.thumbnailText,s=this.thumbnailTime,a=this.p.duration(),o=this.progressMod.rect(),u="mod-"+i.type;if(o&&this.thumbnailLayout&&n&&a){var l=f.secondsToString(t.time),h=t.time/a*100*o.width()/100-i.ts.w/2;h<=i.margin?h=i.margin:h+i.ts.w>=o.width()-i.margin&&(h=o.width()-i.margin-i.ts.w);this.thumbnailLayout.style.left=h+"px";d.text(s,l);d.text(r,t&&t.text?t.text:"");if(t&&t.modName)d.addClass(this.thumbnailLayout,u+" "+u+"-"+t.modName);else{d.removeClass(this.thumbnailLayout,u);(t=this.__thumbnailData)&&t.modName&&d.removeClass(this.thumbnailLayout,u+"-"+t.modName)}this.__thumbnailData=t;n.style.backgroundImage="url("+e+")";d.removeClass(this.thumbnailLayout,"mpv-hide");this.__lastEvent&&this.mousemove(this.__lastEvent,!0);return!0}this.hideThumbnail()}).call(this,t,e)},hideThumbnail:function(){this.__isMouseOver=!1;d.addClass(this.thumbnailLayout,"mpv-hide")},drawTime:function(e){var t=this.attr,i=this;if(this.is_error&&!t.is_always_hide_onerror)return this.hideThumbnail();if(t.callback){this.is_draw_thumbnail=(new Date).getTime();t.callback.call(this,e.time,function(t){i.is_draw_thumbnail=null;if(!t)return i.hideThumbnail();i.showThumbnail(e,t)})}}});return t});d.define("imgtech.media.module.Thumbnail",function(){var n=d.module("imgtech.media.module.ThumbnailOld");function a(t){n.apply(this,arguments);if(t){var e=this.attr,i=this;d.b.ie&&d.b.ie<9&&(e.auto=!1);if(e.auto){this.virtualCanvas=document.createElement("canvas");this.virtualContext=this.virtualCanvas.getContext("2d")}this.isHLS=!1;this.hls=new window.Hls;this.hls.on(Hls.Events.MEDIA_ATTACHED,function(){i.hls.loadSource(i.____src)});this.hls.on(Hls.Events.ERROR,function(t,e){d.error("## HLS ERROR: ",t,e);i.is_error=!0})}}d.extendClass(a,n,{attach:function(){var a,o=this,t=this.attr,e=this.p.attr;this.reset();d.removeClass(this.thumbnailLayout,"mpv-thumbnail-auto");if(t.auto){!0===t.auto&&(t.auto={});d.addClass(this.thumbnailLayout,"mpv-thumbnail-auto");this.virtualData=null;this.virtualWidth=t.image.w;this.virtualHeight=t.image.h;this.virtualVideo=a=document.createElement("video");this.virtualVideo.setAttribute("muted",!0);this.virtualVideo.setAttribute("autoplay","false");this.virtualVideo.style.width=this.virtualWidth+"px";this.virtualVideo.style.height=this.virtualHeight+"px";e&&e.crossOrigin&&this.virtualVideo.setAttribute("crossorigin",e.crossOrigin);d.on(a,"error",function(t){o.hideThumbnail();d.error("thumbnail error : ",a.error&&a.error.code,a.error)});d.on(a,"seeked",function(){o.is_draw_thumbnail=null;try{var t=o.virtualWidth,e=o.virtualHeight,i=o.virtualCanvas;i.width=t;i.height=e;o.virtualContext.drawImage(a,0,0,t,e);var n=i.toDataURL(),r=o.virtualData;n&&(o.__isMouseOver?o.showThumbnail(r,n):o.hideThumbnail())}catch(s){o.p.error(s);o.hideThumbnail()}})}return a},reset:function(){var t=this.virtualVideo;if(t){t.removeAttribute("src");t.load()}},onStateChange:function(t){var e,i=this.attr;a.__super.onStateChange.apply(this,arguments);if(i.auto)switch(t.type){case f.EVENT.RESET:this.reset();break;case f.EVENT.STATE_CHANGE:if(t.data===f.STATE.SETSOURCE){this.is_error=!1;this.isHLS=!1;e=this.attach();this.virtualData=null;var n=this.p.currentMediaSource(),r=n&&n.source(),s=n.deviceType();if(e){e.muted=!0;e.autoplay=!1;if(r){this.____src=r;if("hls"==s){this.isHLS=!0;this.hls.attachMedia(e)}else e.src=r}e.pause?e.pause():d.warn("Not found pause method on virtual video element for thumbnail.")}}}},drawTime:function(t){var i=this.attr,n=this.virtualVideo;if(!i.auto)return a.__super.drawTime.apply(this,arguments);if(this.is_error&&!i.is_always_hide_onerror)return this.hideThumbnail();try{if(n){this.is_draw_thumbnail=(new Date).getTime();n.currentTime=this.p.getVirtualSeekToValue(t.time);this.virtualData=t}}catch(e){this.is_draw_thumbnail=null;d.warn("Warning currentTime on virtual video element.",e)}}});return a});d.define("imgtech.media.module.ThumbnailEx",function(){return d.module("imgtech.media.module.Thumbnail")})}();!function(){"use strict";var a=getDframework(),d=a.module("imgtech.media.Media"),g=a.guid();a.define("imgtech.media.module.Screenshot",function(){var i=a.module("imgtech.media.ModuleInterface");function t(t){i.apply(this,arguments);if(t){this.__used=!1;this.__testNo=0;this.__sliceCanvas=null;this._virtualVideoElement=null;this.__spaceBox={input:null,status:"none",interrupt:!1,current:-1,length:0,settingDepth:0,callback:null,jobs:[],downloadZip:null,downloadThumb:null,downloadScreenshot:null,thumb:{width:120,height:0,count:10},ui:null};this.status="none";this.__workerCount=this.attr.noworker?0:4;this.__worker=[];this.workerNo=null;this.__isSettingWorker=!1;this.__apiCreateMediaPlayer=window.createMediaPlayer;this.jobRound=0;this.beginTime=0;this.finishTime=0}}a.extendClass(t,i,{onAddEvent:function(){},onStateChange:function(t){if(this.__used&&!this.__spaceBox.isVirtual)switch(t.type){case d.EVENT.STATE_CHANGE:t.data==d.STATE.SETSOURCE&&this.clearUserInterface();break;case d.EVENT.ON_BEFORE_PLAY:this._onBeforePlay();break;case d.EVENT.WAITTING:"seeked"==t.stype&&this._onSeeked()}},_onSeeked:function(){var t=this.__spaceBox;if(t.interrupt)return this.error("Interrupted at screenshot.start");if("run"!==t.status)return this.error("Wrong status at screenshot.start: ",t.status);this.shot({canvas:!0},function(t){var e=this.__spaceBox,i=e.jobs[e.current],n=i.canvas.getContext("2d"),r={round:i.round,time:i.ctime,stime:t.time,wtime:t.wtime,screenshotItemElement:this._drawScreenshotUI(e.ui,t),screenshotName:null};n.drawImage(t.videoElement,i.ts.w*(i.round%i.ts.horizonCount),i.ts.h*Math.floor(i.round/i.ts.horizonCount),i.ts.w,i.ts.h);i.fname,function s(t,e){return(t+="").length>=e?t:new Array(e-t.length+1).join("0")+t}(i.round+1+"",(i.totalRound+"").length);i.results.push(r);this._onSeeked2(i,r)})},_onSeeked2:function(e,t){var i,n=this.__spaceBox,r=e.round+1,s=r*e.depth,a=e.workerFinishTime<=s,o=n.current===n.jobs.length-1,u={allRunTime:{start:n.startTime,end:0,run:0,runText:null},runTime:{start:e.startTime,end:0,run:0,runText:null},isLastScreenshot:a,isLastFile:o,files:{total:n.jobs.length,current:n.current},screenshot:{total:e.totalRound,current:t.round,time:e.ctime},horizonCount:e.ts.horizonCount,jsonData:null,thumbnailDataUrl:null,thumbnailBlob:null,thumbnailImageElement:null,job:e};if(a){var l=e.canvas;if(n.ui&&n.ui.thumb){var h=l.toDataURL(),c=document.createElement("img");c.src=h;n.ui.thumb.appendChild(c);u.thumbnailImageElement=c}l.toBlob(function(t){(void 0)._onSeekLasted(e,u,t,o)})}else{i=(new Date).getTime();e.runTimeText=d.secondsToTimeString((e.runTime=i-e.startTime)/1e3,2);n.runTimeText=d.secondsToTimeString((n.runTime=i-n.startTime)/1e3,2);u.allRunTime.run=n.runTime;u.allRunTime.runText=n.runTimeText;u.runTime.run=e.runTime;u.runTime.runText=e.runTimeText;n.callback.call(this,u);e.round=r;e.ctime=s;this._seekTo(s)}},_onSeekLasted:function(t,e,i,n){var r=this.__spaceBox,s=t.fname+".thumb",a=(t.fname,{name:t.fname,duration:t.duration,totalRound:t.totalRound,depth:t.depth,thumbName:s+"."+this.getBlobImageExtName(i),horizonCount:t.ts.horizonCount,thumbWidth:t.ts.w,thumbHeight:t.ts.h,videoWidth:t.vs.w,videoHeight:t.vs.h}),o=(JSON.stringify(a),t.endTime=(new Date).getTime());n&&(r.endTime=o);t.runTimeText=d.secondsToTimeString((t.runTime=o-t.startTime)/1e3,2);r.runTimeText=d.secondsToTimeString((r.runTime=o-r.startTime)/1e3,2);e.allRunTime.end=r.endTime;e.allRunTime.run=r.runTime;e.allRunTime.runText=r.runTimeText;e.runTime.end=t.endTime;e.runTime.run=t.runTime;e.runTime.runText=t.runTimeText;r.callback.call(this,e);!n||"screenshot"!=r.downloadZip&&"thumb"!=r.downloadZip?n||this._nextSource():this.downloadZip(r.downloadZip)},_startWorker:function(i,n){var t=this.__spaceBox,e={isVirtual:!1,url:n.src.src,baseurl:t.baseurl,depth:n.depth,thumb:{width:n.ts.w,height:n.ts.h,count:n.ts.horizonCount},downloadZip:"none",isWorker:g,workerJobRound:i.jobRound,workerBeginTime:i.beginTime,workerFinishTime:i.finishTime};i.start(e,function(t){n.roundCounter++;if(n.roundCounter>=n.totalRound){var e=(new Date).getTime()-n.startTime;a.log("finish~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");a.log(d.secondsToTimeString(e/1e3,2))}n.roundCounter%10==0&&a.log("callback>>> ",i.workerNo,"duration:",t.job.duration,"depth:",t.job.depth,"totalround:",t.job.totalRound,"round:",t.job.round,"ctime:",t.job.ctime,"finishtime:",t.job.workerFinishTime,"lastfile:",t.isLastFile,"lastscreen:",t.isLastScreenshot,"roundcounter: ",n.roundCounter);t.isLastScreenshot&&i._reset()})},_patchWorker:function(t,e){var i,n,r=this.__worker.length;if(!r)return!1;for(n=0;n<r;n++){(i=this.__worker[n]).status="none";i.jobRound=0}var s=function d(t,e,i){for(var n=[],r=e.length,s=Math.floor(i/r),a=i%r,o=0,u=0,l=0,h=0;h<r;h++){var c=e[h];if(o<a){l=s+1;o++}else l=s;c.beginTime=u*t.depth;c.jobRound=u;n.push(c);if(i<=(u+=l))return n}return n}(t,this.__worker,e);for(n=0;n<s.length;n++){i=s[n];var a=s[n+1];i.finishTime=a?a.beginTime:e*t.depth}for(n=0;n<s.length;n++){i=s[n];this._startWorker(i,t)}return!0},_onBeforePlay:function(){var t,e=this.__spaceBox,i=e.jobs[e.current];if(e.interrupt)return this.error("Interrupted at screenshot.start");if("run"!==e.status)return this.error("Wrong status at screenshot.start: ",e.status);var n=this._getVideoSize();if(!n)return this.error("Not found video size at screenshots.start: ",i.src);i.vs.w=n.width;i.vs.h=n.height;i.ts.w=e.thumb.width;i.ts.h=e.thumb.height?e.thumb.height:Math.floor(e.thumb.width*n.height/n.width);i.ts.horizonCount=e.thumb.count;i.duration=this._duration();i.totalRound=t=Math.floor(i.duration/i.depth)+1;var r=i.canvas=document.createElement("canvas");r.width=i.ts.w*i.ts.horizonCount;r.height=i.ts.h*(Math.floor(i.totalRound/i.ts.horizonCount)+(i.totalRound%i.ts.horizonCount?1:0));r.getContext("2d").fillRect(0,0,r.width,r.height);if(!this._patchWorker(i,t)){e.isWorker||(i.workerFinishTime=t*i.depth);this._seekTo(i.ctime)}},_nextSource:function(){var t=this.__spaceBox,e=t.current+1,i=t.jobs[e];if(t.interrupt)return this.error("Interrupted at screenshot.start");if(!(e<t.length))return this.error("Dont next source. current: "+e+", length: "+t.length);t.current++;i.startTime=(new Date).getTime();this._source(i.src)},start:function(t,e){this.__used=!0;if(!t)return this.error("Not found params at screenshot.start");if(!t.baseurl)return this.error("Not found params's baseurl at screenshot.start");if(!e)return this.error("Not found callback at screenshot.start");this._settingWorker();var i=t.url;if("string"==typeof i){var n=(i=i.trim()).split("\n"),r=[];n.forEach(function(t){(t=t.trim())&&r.push(t)});i=r}if(!i.length)return this.error("url must has at screenshot.start !!!");for(var s=t.isWorker===g,a=this.__spaceBox={input:t,isVirtual:t.isVirtual,isWorker:s,status:"none",interrupt:!1,current:-1,length:0,startTime:(new Date).getTime(),endTime:0,runTime:0,runTimeText:null,settingDepth:t.depth?Math.floor(t.depth):300,callback:e,jobs:[],baseurl:t.baseurl,downloadZip:t.downloadZip,downloadZipName:t.downloadZipName,downloadThumb:t.downloadThumb,downloadScreenshot:t.downloadScreenshot,thumb:{width:t.thumb&&t.thumb.width?t.thumb.width:120,height:t.thumb&&t.thumb.height?t.thumb.height:0,count:t.thumb&&t.thumb.count?t.thumb.count:10},ui:t.ui},o=0;o<i.length;o++){var u=i[o];"string"==typeof u&&(u=i[o]={src:u,fname:undefined});var l=u.src,h=u.fname;if("string"!=typeof l)return this.error("url must be string at screenshot.start !!!");var c=l.lastIndexOf("/"),d=0<=c?l.substring(0,c):"",f=0===d.indexOf(a.baseurl)?d.substring(a.baseurl.length):"",p=function(t){var e=f.split("/"),i=[];e.forEach(function(t){t&&i.push(t)});return i.join("/")}();h||0<(c=(h=0<=c?l.substring(c+1):l).indexOf("?"))&&(h=h.substring(0,c));var m={fname:h,basedir:p,depth:a.settingDepth,startTime:0,endTime:0,runTime:0,runTimeText:null,duration:0,round:s?t.workerJobRound:0,totalRound:0,roundCounter:0,ctime:s?t.workerBeginTime:0,vs:{w:0,h:0},ts:{w:0,h:0,horizonCount:0},src:{src:l},canvas:null,results:[],workerFinishTime:s?t.workerFinishTime:0,jsonName:null,jsonData:null,thumbnailName:null,thumbnailDataUrl:null,thumbnailBlob:null};a.jobs.push(m)}a.length=a.jobs.length;a.status="run";this._nextSource()},_settingWorker:function(){if(!this.__isSettingWorker){this.__isSettingWorker=!0;if(!this.attr.noworker)for(var t=0;t<this.__workerCount;t++){var e=document.createElement("div"),i=this.__apiCreateMediaPlayer(e,null,{debug:{use:!1},autoplay:!1,module:{screenshot:{noworker:!0}}},null).module("screenshot");i.workerNo=t;this.__worker.push(i)}}},getBlobImageExtName:function(t){switch(t.type.toLowerCase()){case"image/png":return"png";case"image/jpeg":case"image/jpg":return"jpg";case"image/gif":return"gif"}return"jpg"},downloadZip:function(t){var e=this,i=this.__spaceBox,n=i.jobs,r=new JSZip,s=i.downloadZipName;if("screenshot"==t||"thumb"==t){for(var a=0;a<n.length;a++){var o=n[a],u=o.basedir?r.folder(o.basedir):r;"thumb"!=t&&"screenshot"!=t||!o.thumbnailBlob||u.file(o.thumbnailName,o.thumbnailBlob,{base64:!0});"thumb"!=t&&"screenshot"!=t||!o.jsonBlob||u.file(o.jsonName,o.jsonBlob);if("screenshot"==t)for(var l=0;l<o.results.length;l++){var h=o.results[l];h.screenshotBlob&&u.file(h.screenshotName,h.screenshotBlob,{base64:!0})}s||0!==a||(s=o.fname)}r.generateAsync({type:"blob"}).then(function(t){e.downloadBlob(new Blob([t],{type:t.type}),s+".zip")})}},_drawScreenshotUI:function(t,e){if(!t)return null;var i=a.element(t.html),n=a.query(i,t.image),r=a.query(i,t.text);if(n){var s=document.createElement("img");s.src=e.dataUrl;n.appendChild(s)}r&&a.text(r,d.secondsToTimeString(e.time));t.root&&t.auto&&a.append(t.root,i);return i},downloadBlob:function(t,e){var i=URL.createObjectURL(t),n=document.createElement("a");n.style.display="none";a.append(n);n.href=i;e&&(n.download=e);n.click();window.URL.revokeObjectURL(i);a.remove(n)},clearUserInterface:function(){var t=this.__spaceBox.ui;if(t){t.thumb&&(t.thumb.innerText="");t.root&&(t.root.innerHTML="")}},shot:function(t,e){e||(e=t);var i=this.__sliceCanvas;i||(i=this.__sliceCanvas=document.createElement("canvas"));var n=i.getContext("2d"),r=this._videoElement();if(!r)return this.error("Not found video element.");var s=r.videoWidth,a=r.videoHeight;i.width=s;i.height=a;n.fillRect(0,0,s,a);n.drawImage(r,0,0,s,a);var o=i.toDataURL(),u=null;t&&t.canvas?u=i:n.clearRect(0,0,s,a);var l=this._currentTime();return e.call(this,{time:Math.floor(l),wtime:l,videoElement:r,canvas:u,dataUrl:o})},error:function(t){this.p.error("## "+t);this.__used=!1},_virtualElement:function(){var e=this;if(!this._virtualVideoElement){var i=this._virtualVideoElement=document.createElement("video");i.muted=!0;i.autoplay=!1;a.on(i,"error",function(t){return e.error("screenshot error : ",i.error&&i.error.code,i.error)});a.on(i,"seeked",function(t){e._onSeeked()});a.on(i,"canplay",function(t){if(!e.__canplay){e.__canplay=!0;if(e.__canplay&&e.__loadeddata&&!e.__beforeplay){e.__beforeplay=!0;e._onBeforePlay()}}});a.on(i,"loadeddata",function(t){if(!e.__loadeddata){e.__loadeddata=!0;if(e.__canplay&&e.__loadeddata&&!e.__beforeplay){e.__beforeplay=!0;e._onBeforePlay()}}})}return this._virtualVideoElement},_currentTime:function(){if(this.__spaceBox.isVirtual){var t=this._virtualElement();return t&&t.currentTime?t.currentTime:0}return this.p.currentTime()},_source:function(t){if(!this.__spaceBox.isVirtual)return this.p.source(t);var e=this._virtualElement();e.muted=!0;e.autoplay=!1;e.src=t.src;this.__loadeddata=!1;this.__canplay=!1;this.__beforeplay=!1;this.clearUserInterface()},_getVideoSize:function(){if(this.__spaceBox.isVirtual){var t=this._virtualElement();return{width:t&&t.videoWidth?t.videoWidth:0,height:t&&t.videoHeight?t.videoHeight:0}}return this.p.getVideoSize()},_duration:function(){if(this.__spaceBox.isVirtual){var t=this._virtualElement();return t&&t.duration?t.duration:0}return this.p.duration()},_seekTo:function(t){if(!this.__spaceBox.isVirtual)return this.p.seekTo(t);this._virtualElement().currentTime=t},_videoElement:function(){if(this.__spaceBox.isVirtual)return this._virtualElement();var t=this.p.device(),e=t&&t.currentDevice,i=e&&e.instance;return i&&i.vp},_reset:function(){this.p.reset();var t=this._virtualElement();if(t){try{t.pause()}catch(e){}try{t.removeAttribute("src");t.load()}catch(e){}}}});return t})}();!function(){"use strict";var h=getDframework(),a=h.module("imgtech.media.Media");function o(){return(new Date).getTime()/1e3}h.define("imgtech.media.module.WatchTimeEx",function(){var i=h.module("imgtech.media.ModuleInterface");function e(t,e){this.name="SourceTime";if(t){this.parent=e;this.p=e.p;this.attr=t;this.input=null;this.previous=0;this.old=0;this._value=0}}e.prototype={constructor:e,source:function(t){this.input=t;this.realStart=o();this.old=0;this._value=0;t&&t.old&&(this._value=this.old=this.previous=t.old)},playing:function(){},paused:function(){},stoped:function(){},ended:function(){},previousSeekTo:function(t){},seektoMedia:function(t){},currentTimeChange:function(t){},value:function(){this.attr;var t=this.previous,e={},i=this._sum();e.value=i;e.previous=t||0;e.depth=parseFloat((e.value-e.previous).toFixed(3));e.old=this.old;this.previous=i;return e},_sum:function(){return parseFloat((o()-this.realStart).toFixed(3))}};function n(t,e){this.name="PlayTime";if(t){this.parent=e;this.p=e.p;this.attr=t;this.input=null;this.previous=0;this.old=0}}n.prototype={constructor:n,source:function(t){this.input=t;this.vodRange=[];this.vodStart=0;this.vodEnd=0;this.old=0;if(t){t.old&&(this.old=this.previous=t.old);if(t.range){var e,i;for(e in t.range)(i=t.range[e])&&this._rangePush(this.vodRange,{start:i.start,end:i.end});this.old=this.previous=this._rangeSum(this.vodRange)}}},playing:function(){},paused:function(){},stoped:function(){this._rangeUpdate();this.vodStart=this.vodEnd=null},ended:function(){this._rangeUpdate();this.vodStart=this.vodEnd=null},previousSeekTo:function(t){this._rangeUpdate();this.vodStart=this.vodEnd=t},seektoMedia:function(t){this._rangeUpdate();this.vodStart=this.vodEnd=t},currentTimeChange:function(t){null===this.vodStart?this.vodStart=this.vodEnd=t:this.vodEnd<t&&(this.vodEnd=t)},value:function(){var t=this.attr,e=this.previous,i=t&&t.useRange&&t.useRangeSort?this._rangeSort(this.vodRange):this.vodRange,n=null!==this.vodStart&&this.vodStart<this.vodEnd?this._rangeRepaire(i,{start:this.vodStart,end:this.vodEnd}):i,r=this._rangeSum(n),s={};s.value=r;s.previous=e||0;s.depth=parseFloat((s.value-s.previous).toFixed(3));s.old=this.old;if(t.useRange){s.range=n;t.useRangeString&&(s.rangeString=this._rangeToString(n))}this.previous=r;return s},_rangeUpdate:function(){null!==this.vodStart&&this.vodStart<this.vodEnd&&this._rangePush(this.vodRange,{start:this.vodStart,end:this.vodEnd})},_rangePush:function(t,e){function i(t,e,i){t.splice(i,1);return this._rangePush(t,e)}e.start=parseFloat(e.start.toFixed(3));e.end=parseFloat(e.end.toFixed(3));for(var n in t){var r=t[n];if(r.start<=e.start&&e.start<=r.end){if(r.end<e.end){r.end=e.end;return i.call(this,t,r,n)}return t}if(r.start<=e.end&&e.end<=r.end){if(r.start>e.start){r.start=e.start;return i.call(this,t,r,n)}return t}if(r.start===e.start&&r.end===e.end)return t;if(r.start>e.start&&r.end<e.end)return i.call(this,t,e,n)}t.push(e);return t},_rangeRepaire:function(t,e){var i=[];for(var n in t){var r=t[n];i.push({start:r.start,end:r.end})}return e?this._rangePush(i,e):i},_rangeSum:function(t){var e=0;for(var i in t){var n=t[i];e+=n.end-n.start}return parseFloat(e.toFixed(3))},_rangeSort:function(t){t.sort(function(t,e){return t.start-e.start});return t},_rangeToString:function(t){var e="[";for(var i in t){var n=t[i];0<i&&(e+=",");e+="{";e+='"start":'+n.start;e+=',"end":'+n.end;e+="}"}return e+="]"}};function r(t,e){this.name="OverLapPlayTime";if(t){this.parent=e;this.p=e.p;this.attr=t;this.input=null;this.previous=0;this.old=0;this._value=0}}r.prototype={constructor:r,source:function(t){this.input=t;this.vodStart=0;this.vodEnd=0;this.old=0;this._value=0;t&&t.old&&(this._value=this.old=this.previous=t.old)},playing:function(){},paused:function(){},stoped:function(){this._rangeUpdate();this.vodStart=this.vodEnd=null},ended:function(){this._rangeUpdate();this.vodStart=this.vodEnd=null},previousSeekTo:function(t){this._rangeUpdate();this.vodStart=this.vodEnd=t},seektoMedia:function(t){this._rangeUpdate();this.vodStart=this.vodEnd=t},currentTimeChange:function(t){null===this.vodStart?this.vodStart=this.vodEnd=t:this.vodEnd<t&&(this.vodEnd=t)},value:function(){var t=this.previous,e={},i=this._sum();e.value=i;e.previous=t||0;e.depth=parseFloat((e.value-e.previous).toFixed(3));e.old=this.old;this.previous=i;return e},_rangeUpdate:function(){if(null!==this.vodStart&&this.vodStart<this.vodEnd){var t=this._value+(this.vodEnd-this.vodStart);this._value=parseFloat(t.toFixed(3))}},_sum:function(){var t=0;null!==this.vodStart&&this.vodStart<this.vodEnd&&(t=this.vodEnd-this.vodStart);return parseFloat((this._value+t).toFixed(3))}};function s(t,e){this.name="OverlapRealTime";if(t){this.parent=e;this.p=e.p;this.attr=t;this.input=null;this.previous=0;this.old=0;this._value=0}}s.prototype={constructor:s,source:function(t){this.input=t;this.realStart=null;this.old=0;this._value=0;t&&t.old&&(this._value=this.old=this.previous=t.old)},playing:function(){this._rangeUpdate();this.realStart=o()},paused:function(){this._rangeUpdate();this.realStart=null},stoped:function(){this._rangeUpdate();this.realStart=null},ended:function(){this._rangeUpdate();this.realStart=null},previousSeekTo:function(t){},seektoMedia:function(t){},currentTimeChange:function(t){},value:function(){this.attr;var t=this.previous,e={},i=this._sum();e.value=i;e.previous=t||0;e.depth=parseFloat((e.value-e.previous).toFixed(3));e.old=this.old;this.previous=i;return e},_rangeUpdate:function(){if(null!==this.realStart){var t=this._value+(o()-this.realStart);this._value=parseFloat(t.toFixed(3))}},_sum:function(){var t=0;null!==this.realStart&&(t=o()-this.realStart);return parseFloat((this._value+t).toFixed(3))}};function t(t){i.apply(this,arguments);if(t){var e=this.attr;e.depthSeconds||(e.depthSeconds=5);this.p.addWatchTimeModule(this);this._init()}}h.extendClass(t,i,{onAddEvent:function(){},onStateChange:function(t){switch(t.type){case a.EVENT.STATE_CHANGE:switch(t.data){case a.STATE.SETSOURCE:this._source();break;case a.STATE.PLAYING:this._playing();break;case a.STATE.PAUSED:this._paused();break;case a.STATE.SYSTEM_ENDED:this._ended()}break;case a.EVENT.STOP_MEDIA:this._stoped();break;case a.EVENT.SEEKTO_MEDIA:case a.EVENT.SEEKTO_CONTINUE_TIME:this._seektoMedia(t.data.value);break;case a.EVENT.CURRENT_TIME_CHANGE:this._currentTimeChange(t.data.currentTime)}},_init:function(){var t=this.attr;this.process={};t.sourceTime&&(this.process.sourceTime=new e(t.sourceTime,this));t.overlapPlayTime&&(this.process.overlapPlayTime=new r(t.overlapPlayTime,this));t.overlapRealTime&&(this.process.overlapRealTime=new s(t.overlapRealTime,this));t.playTime&&(this.process.playTime=new n(t.playTime,this))},_initBeforeUnload:function(){var e=this;if(h.b.firefox)return h.on(window,"unload",function(t){e.beforeunload()});h.on(window,"beforeunload",function(t){e.beforeunload();h.b.ie||h.b.chrome&&t.preventDefault()})},_source:function(){var t=this.attr,e=this;t.debug&&h.log("[WatchTimeEx] _source");if(!this.is_sourced){(this.is_sourced=!0)===t.beforeunload&&this._initBeforeUnload();if(t.alwaysEvent){if(this.intervalId){clearInterval(this.intervalId);this.intervalId=null}this.intervalId=setInterval(function(){e.update()},1e3*t.depthSeconds)}}this._init();var i=this.p.currentMediaSource(),n=i&&i.input;if(n)for(var r in this.process)this.process[r].source(n[r])},_playing:function(){this.attr.debug&&h.log("[WatchTimeEx] _playing");var t;for(t in this.process)this.process[t].playing()},_paused:function(){this.attr.debug&&h.log("[WatchTimeEx] _paused");for(var t in this.process)this.process[t].paused()},_ended:function(){this.attr.debug&&h.log("[WatchTimeEx] _ended");for(var t in this.process)this.process[t].ended();this.attr.debug&&h.warn("[WatchTimeEx] ended !!!");this._createEvent({ended:!0})},_stoped:function(){this.attr.debug&&h.log("[WatchTimeEx] _stoped");for(var t in this.process)this.process[t].stoped();this.attr.debug&&h.warn("[WatchTimeEx] stoped !!!");this._createEvent({stoped:!0})},_previousSeekTo:function(t,e){for(var i in this.process)this.process[i].previousSeekTo(t)},_seektoMedia:function(t){var e=parseFloat(t.toFixed(3)),i=this.attr.debug;(!0===i||"object"==typeof i&&!1!==i.seek)&&h.log("[WatchTimeEx] _seektoMedia: "+e.toFixed(3));for(var n in this.process)this.process[n].seektoMedia(e)},_currentTimeChange:function(t){var e=this.attr;for(var i in this.process)this.process[i].currentTimeChange(t);if(!e.alwaysEvent){var n=(new Date).getTime()/1e3;this.syncTime||(this.syncTime=n);if(n-this.syncTime<e.depthSeconds)return;this.syncTime=n;this.update()}},_createEvent:function(t){function e(t,e){var i=t+" => ",n=e.depth;if(0===n||n){for(var r in e)"range"!=r&&"testRange"!=r&&"rangeString"!=r&&"originRange"!=r&&(i+=r+": "+e[r]+", ");n<0||n>s.depthSeconds+1?h.error("[WatchTimeEx] <differnce depthtime> "+i):h.log("[WatchTimeEx] "+i)}}var s=this.attr,i={},n=this.p.currentMediaSource();if(s.use&&n){for(var r in this.process)i[r]=this.process[r].value();if(s.debug){var a="[WatchTimeEx] ----- (",o=!1;for(r in i){a+=(o?", ":"")+r;o=!0}a+=") -----";h.warn(a);for(r in i){var u=i[r];if(u){e(r,u);u.range&&h.log("[WatchTimeEx] range: ",u.range);u.originRange&&h.log("[WatchTimeEx] originRange: ",u.originRange);u.testRange&&h.log("[WatchTimeEx] testRange: ",u.testRange);u.rangeString&&h.log("[WatchTimeEx] rangeString: ",u.rangeString)}}}if(t){for(var l in t)i[l]=t[l];i.when=t}s.callback&&s.callback.call(this,i);return i}},update:function(t){return this._createEvent(t)},beforeunload:function(){this._createEvent({beforeunload:!0})},changeSource:function(){this._createEvent({changeSource:!0})}});return t});h.define("imgtech.media.module.WatchTime",function(){return h.module("imgtech.media.module.WatchTimeEx")})}();!function(){"use strict";var n=getDframework(),o=n.module("imgtech.media.Media");n.define("imgtech.media.module.Recommend",function(){var i=n.module("imgtech.media.ModuleInterface");function t(t){i.apply(this,arguments);if(t){this.attr;var e=this.p.userElement;this.isRecommend=!1;this.__recommendLayter=n.query(e,".mpv-recommend-layer");this.__recommendLeft=n.query(this.__recommendLayter,".mpv-recommend-left");this.__recommendRight=n.query(this.__recommendLayter,".mpv-recommend-right");this.hide()}}n.extendClass(t,i,{onAddEvent:function(){var e=this;n.on(this.__recommendLeft,"click",function(t){e.onClickLeft(t);return n.igEventAll(t)});n.on(this.__recommendRight,"click",function(t){e.onClickRight(t);return n.igEventAll(t)})},onStateChange:function(t){var e,i,n=!1;switch(t.type){case o.EVENT.STATE_CHANGE:if(t.data==o.STATE.SETSOURCE)if(this.sourceAttr()){this.isRecommend=!0;var r=(e=this.sourceAttr())&&e.src,s=r&&r.left,a=r&&r.right;s&&this.setElement(this.__recommendLeft,s);a&&this.setElement(this.__recommendRight,a)}else{this.isRecommend=!1;this.hide()}break;case o.EVENT.CURRENT_TIME_CHANGE:if(this.isRecommend){(e=this.sourceAttr())&&(i=e.time)&&this.p.duration()-t.data.currentTime<=i&&(n=!0);n?this.show():this.hide()}}},sourceAttr:function(){var t=this.p.currentMediaSource();return t&&t.input&&t.input.recommend},onClickLink:function(t){if(t){var e=t.link,i=t.target;if(e){"top"==i?top:document;location.href=e}}},onClickLeft:function(){var t=this.sourceAttr(),e=t&&t.src,i=e&&e.left;this.onClickLink(i)},onClickRight:function(){var t=this.sourceAttr(),e=t&&t.src,i=e&&e.right;this.onClickLink(i)},setElement:function(t,e){t&&e&&(t.style.backgroundImage="url('"+e.poster+"')")},show:function(){n.addClass(this.__recommendLayter,"mpv-show-recommend");n.removeClass(this.__recommendLayter,"mpv-hide");n.removeClass(this.__recommendLeft,"mpv-hide");n.removeClass(this.__recommendRight,"mpv-hide")},hide:function(){n.removeClass(this.__recommendLayter,"mpv-show-recommend");n.addClass(this.__recommendLayter,"mpv-hide");n.addClass(this.__recommendLeft,"mpv-hide");n.addClass(this.__recommendRight,"mpv-hide")}});return t})}();!function(){"use strict";var C=getDframework(),A=C.module("imgtech.media.Media"),k=window.MediaSource||window.WebKitMediaSource;C.define("imgtech.media.MP4Player",function(){var d="Location: ",o="application",u="deviceInfo",n=[],l="Not found source info !!!",p=function(t){for(var e=0;e<n.length;e++)if(n[e].obj===t)return n[e];var i={obj:t,status:0};n.push(i);return i},h=function(t){var e=t.input;return e&&e.drm},m=function(t){return!h(t)},c=function(n,r){function i(t){if(t.error)return r(t.error);var e=p(this),i=function(t,e){var i=t.status;if(0===i){var n=e.split("|");t._v=parseInt(n[0]);t._b=parseInt(n[4]);t._o=parseInt(n[5]);t.status=1;var r,s=t._a,a=t._m,o=n[6],u=0,l=[],h=t._b;s=parseInt(n[2]),a=parseInt(n[3]);for(r=0;r<o.length;r+=2){l[u]=parseInt(o[r]+o[r+1],16);u++}switch(s){case 1:for(r=0;r<h;r++)l[r]=(l[r]+a)%256;break;case 2:for(r=0;r<h;r++)l[r]=Math.abs(l[r]-a)%256;break;case 3:for(r=0;r<h;r++)l[r]=(l[r]^a)%256}t._d=l}else if(1===i){t.status=2;var c=e.indexOf(d);return 0!==c?null:e.substring(c+d.length)}}(e,t.response);if(1===e.status)return c.call(s,n,r);if(2===e.status){t.dm&&t.dm.clientCertificateKey?this.url=t.dm.src:this.url=i;r(!0)}}if(m(n)){p(this).status=2;this.url=n.source();return r(!0)}var s=this,t=h(n),e=function(t){var e=p(this);if(m(t))return t.source();var i=h(t),n="?Client-Id="+i.clientId;n+="&User-Id="+i.userId;i.userKey&&(n+="&User-Key="+i.userKey);i.userPw&&(n+="&User-Pw="+i.userPw);i.etcinfo&&(n+="&Etcinfo="+i.etcinfo);n+="&Application=(html5streamplayer:3.0.x;)"+(i[o]?i[o]:"");i[u]&&(n+="&Device-Info="+i[u]);var r=0===e.status?"http://api.zonedrm.imgtech.co.kr/service/certificate_stream/":1===e.status?"http://api.zonedrm.imgtech.co.kr/service/certificate_stream_dn/":null;return r&&r+i.fileNm+n}.call(this,n);if(!e)return i.call(this,{error:!0});if(t&&t.clientCertificateKey)return i.call(this,{response:t.clientCertificateKey,dm:t});var a=new XMLHttpRequest;a.open("GET",e,!0);a.onerror=function(t){r({error:t})};a.onreadystatechange=function(){(function e(t){return 0!==t.status&&200!==t.status?i.call(this,{error:"status: ",status:t.status,response:t.response}):t.readyState==t.DONE?i.call(this,{response:t.response}):void 0}).call(s,a)};a.send()},s=function(t){var e,i,n,r=this.contentLength,s=null===t?this.runningOffset:t,a=this.attr;if(this.status===this.OPENING){if(this.mediaInfo)return{info:this.mediaInfo};e=a.chunkSize}else{if(this.status!==this.OPEN)throw new Error("Unknown status.");e=a.chunkSize}if(null===r)throw new Error("Not found contents length.");if(r<=s){if(this.status!==this.OPEN)throw new Error(l);this.log(">> reach the eof.");return{eof:!0}}if((i=s+e)<r){n=i-1;var o;(o=r-i)<this.eofAllSize&&(n+=o)}else n=s+(r-s-1);return{offset:s,end:n}},a=function(t,e){var i=new XMLHttpRequest;i.open("GET",this.url,!0);i.responseType="arraybuffer";i.setRequestHeader("Range","bytes="+t.offset+"-"+t.end);i.onerror=function(t){e({error:t})};i.onreadystatechange=function(){i.readyState==i.DONE&&(200==i.status||206==i.status||304==i.status?e({xhr:i}):e({error:!0}))};i.send()},f=function(e,i){e.call(this,function(t){t?i.call(this,t):f.call(this,e,i)}.bind(this))},g=function(t){var e;return 0===(e=function(t,e){var i,n=this.attr,r=this.contentLength-1,s=n.chunkSize,a=[],o=Math.floor(t/s)*s;if(r<t)return a;for(;;){if(r<=(i=o+s-1)){a.push({offset:o,end:r});return a}a.push({offset:o,end:i});if(e<=i)return a;o+=s}}.call(this,t.offset,t.end)).length?null:function(t){for(var e=this.__cacheBuffer._cached,i=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];if(e.offset===n.offset){e.buffer=n.buffer;e.eof=n.eof;e.status=n.status;return}}e.need=!0},n=0;n<t.length;n++)i(e,t[n]);return t}.call(this,e)},i=function(t){this.status=this.OPENING;a.call(this,{offset:0,end:0},function(t,e){var i,n,r;if(e.error)return t(e);if(!(i=e.xhr.getResponseHeader("Content-Range")))return t({error:"Not found range header."});if(!(-1<(n=i.indexOf("/"))))return t({error:"Not found range header."});if(!(r=+i.slice(n+1)))return t({error:"Not found contents length."});this.contentLength=r;_.call(this,{offset:0},t)}.bind(this,t))},v=function(t,e){return this.isoFile.appendBuffer(function(t){if(m(this.src))return t;if(window.Uint8Array){var e=new ArrayBuffer(t.byteLength);e.fileStart=t.fileStart;for(var i=new Uint8Array(t),n=new Uint8Array(e),r=0;r<t.byteLength;r++)n[r]=i[r];var s,a,o=p(this),u=e.fileStart,l=u+e.byteLength,h=o._b,c=o._o,d=0,f=o._d;1===o._v&&(c=0);if(0<c)for(;u<l;)if((s=u%h)<c){n[d]^=f[s];d++;u++}else{d+=a=h-s;u+=a}else for(;u<l;){n[d]^=f[u%h];d++;u++}return e}}.call(this,t),e)},y=function(r,s){var i=0;f.call(this,function(t){if(i>=r.length)t(!0);else{var e=r[i++];e.need?a.call(this,{offset:e.offset,end:e.end},function(t,e,i,n){if(n.error)return i(n);(function(t,e){var i=e.response.byteLength,n=t.offset,r=t.offset+i>=this.contentLength,s=e.response;s.fileStart=n;s.fileStart||((s=s.slice(0)).fileStart=n);t.buffer=s;t.eof=r;t.status=this.status;this.__cacheBuffer.addBuffer({offset:t.offset,end:t.end,eof:r,status:t.status,buffer:s});this.__cacheBuffer.fixBuffer(this)}).call(this,t,n.xhr);e()}.bind(this,e,t,s)):t()}},function(){var t,e;try{for(var i=0;i<r.length;i++){e=r[i];t=v.call(this,e.buffer,e.eof)}}catch(n){t=null}s({nextOffset:t})})},_=function(t,e){var i,n=s.call(this,t.offset);if(n.info)return e(n);if(n.eof)return e({error:l});if(!(i=g.call(this,n)))return e({error:l});y.call(this,i,function(t,e){if(e&&e.error)return t(e);if(!e.nextOffset||this.status!==this.OPENING)return t({error:l});_.call(this,{offset:e.nextOffset},t)}.bind(this,e))},E=function(t){var e=t.target;if("open"===this.mediaSource.readyState){e.sampleNum=0;e.removeEventListener("updateend",this.__updateEndRemoveable);e.addEventListener("updateend",this.onUpdateEnd.bind(this,e,"updateend"));this.__pendingInits--;0===this.__pendingInits&&this.onOpen()}},r=function(t){if(t.error)return this.error(t.error);var e,i,n=this.mediaSource,r=t.info,s=r.mime,a=s.indexOf(" "),o=0<a?s.substring(0,a):null,u=this;if(!o)return this.error("Not supported mime type: "+s);this.mediaInfo=r;this.mime=s;for(e=0;e<r.tracks.length;e++){var l=r.tracks[e],h=l.codec,c=l.id,d=o+' codecs="'+h+'"';if("video"==l.type||"audio"==l.type){if(!k.isTypeSupported(d))throw new Error("Not supported mime type: "+d+" of "+s);try{(i=n.addSourceBuffer(d)).addEventListener("error",function(t){u.error("MSE SourceBuffer #"+c+" ",t)});i.id=c;i.trackType=l.type;this.isoFile.setSegmentOptions(c,i,{nbSamples:this.segmentSize});i.pendingAppends=[]}catch(p){throw new Error("SourceBuffer #"+c,"Cannot create buffer with type '"+d+"'\n    "+p)}}}this.__updateEndRemoveable=function(t){E.call(this,t)}.bind(this);var f=this.isoFile.initializeSegmentation();for(e=this.__pendingInits=0;e<f.length;e++){(i=f[e].user).addEventListener("updateend",this.__updateEndRemoveable);i.appendBuffer(f[e].buffer);i.segmentIndex=0;this.__pendingInits++}},b=function(t,e){if(this.status===this.OPEN&&this.requestId!==t){this.warn("Cancel requestId: "+t+", byRequestId: "+this.requestId);return e(!1)}(function(t,e,i){if(this.status!==this.OPENING&&this.status!==this.OPEN)throw new Error("Not excute reader. status: "+this.statusName(this.status));var n,r=s.call(this,t);if(r.eof||r.info)return i(r);if(!(n=g.call(this,r)))return i({eof:!0});y.call(this,n,function(t,e,i){if(i&&i.error)return e(i);if(this.requestId!==t){this.warn("Cancel requestId: "+t+", byRequestId: "+this.requestId);return e(!1)}var n,r,s,a=this.attr;if(null!==(n=i.nextOffset)){r=a.maxBufferTime;s=a.maxBufferLength;this.isoFile.seek(this.video.currentTime+r,!0,!0).offset<=n?n=null:!s&&this.runningOffset-this.beginOffset>s&&(n=null)}return e({nextOffset:n,requestId:t})}.bind(this,e,i))}).call(this,null,t,e)},T=function(t,e){if(null!==t.readerId){clearTimeout(t.readerId);t.readerId=null}t.getRequestId();t.setBeginOffset(e);S.call(t,t.syncWaitTime)},S=function(t){if(null!==this.readerId){clearTimeout(this.readerId);this.readerId=null}var e,i=this.mediaSource;if(!i)return this.warn(">> Stoped reader (mediasource is null.)");if("closed"===i.readyState)return this.warn(">> Stoped reader (mediasource's readyState is closed.)");if(null!==this.runningOffset){t=t||1;e=this.getRequestId();this.readerId=setTimeout(b.bind(this,e,function(t){if(!1===t)return S.call(this,1);if(t.error)return this.error(t.error);t.eof&&this.isoFile.flush();if(t.nextOffset||0===t.nextOffset){this.setRunningOffset(t.nextOffset);S.call(this,1)}else this.breakBeginOffset()}.bind(this)),t)}},e=function(i){var n=this;c.call(this,i,function(t){if(t.error)return n.error(t.error);!0===t&&function e(t){this.lastSource===t?this.isEqualSource=!0:this.isEqualSource=!1;this.src=t;this.isEqualSource||(this.__cacheBuffer=new w);this.lastSource=t;this.isPatchEndOfStream=!1;this._openMediaSource()}.call(n,i)})};function w(){this.totalByteLength=0;this._cached=[]}w.prototype={constructor:w,addBuffer:function(t){for(var e=this._cached,i=0;i<e.length;i++){var n=e[i];if(n.offset===t.offset)return;if(n.offset>t.offset){this.totalByteLength+=t.buffer.byteLength;return e.splice(i,0,t)}}this.totalByteLength+=t.buffer.byteLength;e.push(t)},fixBuffer:function(t){var e,i,n,r,s,a,o,u=t.attr,l=u.maxCacheLength,h=u.minCacheLength;if(!((o=this.totalByteLength-l)<=0)){if((o=l-h)<=0)return t.error(" ## wrong maxCacheLength("+l+") or minCacheLength("+h+")");(e=t.video.currentTime)||(e=0);try{n=t.isoFile.seek(e,!0,!0).offset}catch(c){return}t.log(">> current cache: "+this.totalByteLength+", maxCacheLength: "+l);0;for(r=(s=this._cached).length-1;0<=r;r--)if((a=s[r]).status!==t.OPENING&&a.end<n){s.splice(r,1);o-=a.buffer.byteLength;this.totalByteLength-=a.buffer.byteLength;if(o<=0)return t.log(">> fixed cache (prefix) : "+this.totalByteLength)}if((i=t.video.duration)&&!((e+=u.maxBufferTime)>=i)){try{n=t.isoFile.seek(e,!0,!0).offset}catch(c){return}for(r=s.length-1;0<=r;r--)if((a=s[r]).status!==t.OPENING&&a.end>=n){s.splice(r,1);o-=a.buffer.byteLength;this.totalByteLength-=a.buffer.byteLength;if(o<=0)return t.log(">> fixed cache (sufix) : "+this.totalByteLength)}t.warn(">> no-fixed cache: "+this.totalByteLength)}}}};function t(t){t||(t={debug:!1});t.maxBufferTime?t.maxBufferTime<120?t.maxBufferTime=120:600<t.maxBufferTime&&(t.maxBufferTime=600):t.maxBufferTime=180;(!t.minBufferTime||t.minBufferTime<60||t.minBufferTime>t.maxBufferTime-60)&&(t.minBufferTime=t.maxBufferTime-60);t.chunkSize?t.chunkSize<2e5?t.chunkSize=2e5:1e7<t.chunkSize&&(t.chunkSize=1e7):t.chunkSize=1e6;t.maxBufferLength?t.maxBufferLength<10*t.chunkSize?t.maxBufferLength=10*t.chunkSize:t.maxBufferLength>50*t.chunkSize?t.maxBufferLength=50*t.chunkSize:t.maxBufferLength=t.maxBufferLength-t.maxBufferLength%t.chunkSize:t.maxBufferLength=10*t.chunkSize;(!t.maxCacheLength||t.maxCacheLength<5e8)&&(t.maxCacheLength=5e8);t.minCacheLength&&t.minCacheLength<t.maxCacheLength-1e8&&(t.minCacheLength=t.maxCacheLength-1e8);(!t.minCacheLength||t.minCacheLength<4e8)&&(t.minCacheLength=4e8);this.segmentSize=10;this.segmentSeconds=2;this.eofAllSize=1e7;this.syncWaitTime=400;this.limitedDuration=8;this.maxLimitedDuration=3;this.attr=t;this.autoplay=!0;this.video=null;this.lastSource=null;this.mediaSource=null;this.isoFile=null;this.mediaInfo=null;this.readerId=null;this.mime=null;this.status=this.NONE;this.contentLength=null;this.isEqualSource=!1;this.requestId=0;this.lastSeekTime=-1;this.setBeginOffset(0);this.isPatchEndOfStream=!1;this.isSetLastSegmentBuffer=!1;this.__lastSegmentBuffer={};this.__pendingInits=0;this.__isStartPlay=!1;this.__cacheBuffer=new w;this.__binder_sourceopen=function(){var a=this,t=this.isoFile=MP4Box.createFile(),e=this.mediaSource;this.log(">> sourceopen: ms: "+(e?e.readyState:"none")+", player: "+this.statusName(this.status));t.onMoovStart=function(){};t.onReady=function(t){a.mediaInfo=t};t.onSegment=function(t,e,i,n,r){var s=e;s.segmentIndex++;s.pendingAppends.push({id:t,buffer:i,sampleNum:n,is_last:r});a.appendBuffer(s,"onSegment")};i.call(this,r.bind(this))}.bind(this);this.__binder_sourceclose=this.onSourceClose.bind(this);this.__binder_sourceended=this.onSourceEnded.bind(this);this.log(">> attribute: ",t)}t.MP4Box=C.module("imgtech.media.MP4Box");t.prototype={constructor:t,NONE:0,OPENING:1,OPEN:2,statusName:function(t){switch(t){case this.NONE:return"NONE";case this.OPENING:return"OPENING";case this.OPEN:return"OPEN"}},attachVideo:function(t){var e=this;(this.video=t).addEventListener("error",function(){e.onVideoError()});t.addEventListener("timeupdate",function(){e.onVideoTimeUpdate()});t.addEventListener("seeking",function(){e.onVideoSeeking()});t.addEventListener("ended",function(){e.onVideoEnded()})},setBeginOffset:function(t){this.beginOffset=t;this.runningOffset=t},setRunningOffset:function(t){this.runningOffset=t},breakBeginOffset:function(){this.beginOffset=null;this.runningOffset=null},getRequestId:function(){this.requestId>=Infinity&&(this.requestId=0);this.requestId++;return this.requestId},onVideoError:function(){this.error("video error")},onVideoEnded:function(){this.log(">> ended: "+this.mediaSource.readyState);this.patchEndOfStream(!0)},onVideoSeeking:function(){if(this.status!==this.OPEN)throw new Error("Not seeking. This status is not open. "+this.statusName(this.status));var t=this.video,e=t.currentTime,i=t.duration;if(this.lastSeekTime!==e){this.log(" >> seeking: time: "+e+", string: "+A.secondsToString(e)+", ms: "+this.mediaSource.readyState+", ended: "+t.ended);this.lastSeekTime=e;if(this.isSetLastSegmentBuffer)return this.patchEndOfStream(!0);if(i-e<this.limitedDuration){(e=i-this.limitedDuration-2)<0&&(e=0);t.currentTime=e;return}if(!this.patchEndOfStream()){var n=this.isoFile.seek(e,!0).offset;(0===n||n)&&T(this,n)}}},onVideoTimeUpdate:function(){if(this.status>this.NONE){var t,e=this.attr,i=this.video,n=i.currentTime,r=i.buffered,s=Math.floor(i.duration);if(s&&s-n<this.maxLimitedDuration&&!this.isSetLastSegmentBuffer){var a=this.__lastSegmentBuffer;for(var o in a)if(t=a[o]){this.log(">> timeupdate, appendBuffer: "+t.sb.trackType);t.sb.appendBuffer(t.buffer);a[o]=null;this.isSetLastSegmentBuffer=!0}}if(null===this.beginOffset){var u=this.isoFile.seek(n,!0,!0).offset,l=n,h=n+e.minBufferTime;s<h&&(h=s);for(var c=!1,d=0;d<r.length;d++){var f=r.start(d),p=r.end(d);if(f<=l&&h<=p){c=!0;break}}c||(0===u||u)&&T(this,u)}}},patchEndOfStream:function(t){var e=this.mediaSource;if(t||this.status==this.OPEN&&e&&"ended"==e.readyState){this.lastSeekTime=-1;this.isPatchEndOfStream=!0;this._openMediaSource();return!0}},onSourceClose:function(){var t=this.mediaSource;this.log(">> sourceclose: ms: "+(t?t.readyState:"none")+", player: "+this.statusName(this.status))},onSourceEnded:function(){var t=this.mediaSource;this.log(">> sourceended: ms: "+(t?t.readyState:"none")+", player: "+this.statusName(this.status))},onUpdateEnd:function(t,e){if(t.sampleNum){this.isoFile.releaseUsedSamples(t.id,t.sampleNum);delete t.sampleNum}if(t.is_last){this.log(">> endOfStream: updating: "+t.updating+", readyState: "+this.mediaSource.readyState);try{this.mediaSource.endOfStream()}catch(i){"video"===t.trackType&&this.error(i)}}this.appendBuffer(t,e)},appendBuffer:function(t,e){if("open"===this.mediaSource.readyState&&!1===t.updating&&0<t.pendingAppends.length){var i=t.pendingAppends.shift();t.sampleNum=i.sampleNum;t.is_last=i.is_last;if(t.is_last){this.log("appendBuffer: Save buffer: "+t.trackType);this.__lastSegmentBuffer[t.trackType]={sb:t,buffer:i.buffer};return}try{t.appendBuffer(i.buffer)}catch(n){22==n.code&&this.warn("SourceBuffer("+t.trackType+") is full. from: "+e);throw n}}},onOpen:function(){this.log(">> onOpen");var t=this.mediaSource,e=this.mediaInfo,i=e.isFragmented?e.fragment_duration/e.timescale:e.duration/e.timescale;t.duration=this.duration=i;this.status=this.OPEN;this.isoFile.start();this.isPatchEndOfStream&&this.video.pause();(this.isPatchEndOfStream||this.autoplay)&&function(){if(this.__isStartPlay)return this.error(">> Already started.");this.__isStartPlay=!0;this.log(">> start");this.setBeginOffset(0);S.call(this,1)}.call(this)},unloadSource:function(){var t=this.isoFile,e=this.mediaSource,i=this.video;if(i){i.removeAttribute("src");i.load()}if(e){e.removeEventListener("sourceopen",this.__binder_sourceopen);e.removeEventListener("sourceclose",this.__binder_sourceclose);e.removeEventListener("sourceended",this.__binder_sourceended);this.mediaSource=null}if(t){t.onMoovStart=null;t.onReady=null;this.isoFile=null}if(null!==this.readerId){clearTimeout(this.readerId);this.readerId=null}this.mime=null;this.mediaInfo=null;this.status=this.NONE;this.setBeginOffset(0);this.lastSeekTime=-1;this.__isStartPlay=!1;this.__pendingInits=0;this.isSetLastSegmentBuffer=!1;this.__lastSegmentBuffer={}},source:function(t){this.log(">> source: ",t);e.call(this,t)},_openMediaSource:function(){var t=this.video,e=this.mediaSource;this.log(">> _openMediaSource: ms: "+(e?e.readyState:"none")+", player: "+this.statusName(this.status));this.unloadSource();(e=this.mediaSource=new k).addEventListener("sourceopen",this.__binder_sourceopen);e.addEventListener("sourceclose",this.__binder_sourceclose);e.addEventListener("sourceended",this.__binder_sourceended);t.src=window.URL.createObjectURL(e)},_createUnshift:function(t,e){var i=[];i.push(e);if(t&&t.length)for(var n=0;n<t.length;n++)i.push(t[n]);return i},log:function(t){this.attr.debug&&C.log.apply(null,this._createUnshift(arguments," [MediaSource] Log:: "))},warn:function(t){C.warn.apply(null,this._createUnshift(arguments," [MediaSource] Warn:: "))},error:function(t){C.error.apply(null,this._createUnshift(arguments," [MediaSource] Error:: "))}};return t})}();!function(){"use strict";var u=window.getDframework(),l=u.module("imgtech.media.Media"),t=!1;u.define("imgtech.recorder.Recorder",function(){var e=u.module("imgtech.media.module.Device");function s(t){s.install();e.apply(this,arguments);if(t){this.currentState=l.STATE.UNSTARTED;this.audioContext=s.createAudioContext();!function(i){i.p.test=function(t){return i.test(t)};i.p.cancel=function(){return i.cancel()};i.p.record=function(){return i.play()};i.p.loadRecorded=function(t,e){return i.loadRecorded(t,e)};i.p.playRecorded=function(){return i.playRecorded()};i.p.pauseRecorded=function(){return i.pauseRecorded()};i.p.stopRecorded=function(){return i.stopRecorded()};i.p.download=function(){return i.download()};i.p.clear=function(t){return i.clearData(t)}}(this)}}s.install=function(){if(!t){t=!0;navigator.getUserMedia||(navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia);navigator.cancelAnimationFrame||(navigator.cancelAnimationFrame=navigator.webkitCancelAnimationFrame||navigator.mozCancelAnimationFrame||navigator.msCancelAnimationFrame||navigator.oCancelAnimationFrame);navigator.requestAnimationFrame||(navigator.requestAnimationFrame=navigator.webkitRequestAnimationFrame||navigator.mozRequestAnimationFrame||navigator.msRequestAnimationFrame||navigator.oRequestAnimationFrame)}};s.createAudioContext=function(){return window.webkitAudioContext?new window.webkitAudioContext:window.mozAudioContext?new window.mozAudioContext:window.msAudioContext?new window.msAudioContext:window.oAudioContext?new window.oAudioContext:window.AudioContext?new window.AudioContext:null};s.getMediaParam=function(t){var e,i=typeof t;if(!t)return!1;if("boolean"==i)t={};else if("object"!=i)throw new Error("getMediaParam parameter is boolean or object.");t.mandatory||(t.mandatory={});t.optional||(t.optional=[]);e=t.mandatory;t.optional;e.googEchoCancellation||(e.googEchoCancellation=!1);e.googAutoGainControl||(e.googAutoGainControl=!1);e.googNoiseSuppression||(e.googNoiseSuppression=!1);e.googHighpassFilter||(e.googHighpassFilter=!1);return t};s.audioTest=function(e){s.install();var t={audio:!0};t.audio=s.getMediaParam(t.audio);navigator.getUserMedia(t,function(t){e(!0)},function(t){e(!1)})};u.extendClass(s,e,{getClassName:function(){return"imgtech.recorder.Recorder"},getPlayerType:function(){return"recorder"},currentMediaSource:function(){return null},onReady:function(t){this.p;t.callback&&t.callback()},onStateChange:function(t){var e=this,i=this.p;switch(t.type){case l.EVENT.ON_READY:this.onReady(t);break;case l.EVENT.STATE_CHANGE:switch(t.data){case l.STATE.CUED:this.is_called_cued||(this.is_called_cued=!0);setTimeout(function(){i.callStateChange({type:l.EVENT.CAN_PLAY,parent:t})},2);if(this.is_called_record){this.is_called_record=!1;setTimeout(function(){e.is_called_autoplay_recorded=!0;e.record(t)},3)}}}s.__super.onStateChange.apply(this,arguments)},autoplay:function(t){var e=this;this.p.attr.autoplay&&setTimeout(function(){e.is_called_autoplay_recorded||e.record(t);e.is_called_autoplay_recorded=!1},1)},getVolume:function(){},setVolume:function(){},currentTime:function(){},duration:function(){},isMuted:function(){},getBuffering:function(){},source:function(t){var e=this.p.attr;e.autoplay?this.record():e.onloadPermission&&this.permission()},getPlayerState:function(){return this.currentState},permission:function(i){var n=this;if(!this.audioRecorder&&!this.is_called_getusermedia){n=this;(function r(e){if(!this.is_called_getusermedia){this.is_called_getusermedia=!0;var i=this,t=this.p.attr.data;if(!t||!t.audio)throw new Error("Not found audio configure.");t.audio&&(t.audio=s.getMediaParam(t.audio));if(t.video){t.video=!1;u.log("AudioCapture:: video configure is ignored.")}this.lastUseData=t;navigator.getUserMedia(t,function(t){i.p.log("## Access capture media OK.");e&&e(t)},function(t){e?e(null,t):u.error(t)});return this}}).call(this,function(t,e){if(e){u.error(e);p.callStateChange({type:l.EVENT.ON_ERROR,data:e})}else t?n.onReadyStream(t,i):p.callStateChange({type:l.EVENT.ON_ERROR,data:"Not found stream"})})}},record:function(t){if(!this.audioRecorder){this.is_called_record=!0;return this.permission(t)}this.audioRecorder&&this.audioRecorder.record(t)},play:function(t){this.record(t)},cancel:function(){if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.audioRecorder.cancel()},pause:function(t){if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.audioRecorder.pause(t)},stop:function(){if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.audioRecorder.pause();return this.clearData()},onReadyStream:function(t,e){var i=this,n=this.p,r=n.controller.m;if(this.currentState!=l.STATE.UNSTARTED)throw new Error("Wrong recorder life cycle.");if(!this.audioContext)throw new Error("Not found AudioContext");if(!(this.inputPoint=this.audioContext.createGain()))throw new Error("Not found input point");if(!(this.streamSource=this.audioContext.createMediaStreamSource(t)))throw new Error("Not found stream source");this.streamSource.connect(this.inputPoint);var s=u.module("imgtech.recorder.DeviceRecorder"),a=r.soundAnalyser,o=this.p.attr;a&&a.connect(this.audioContext,this.inputPoint);this.audioRecorder=new s(this.inputPoint,{arrayRecord:o.arrayRecord,onStateChange:function(t){e&&(t.recorder_parent_event=e);t.type==l.EVENT.STATE_CHANGE&&(i.currentState=t.data);n.callStateChange(t)}})},getBLOBData:function(t,e){if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.p;if(0===t||t){if(!this.audioRecorder.indexWAV)throw new Error("Not found audio recorder indexWAV !");this.audioRecorder.indexWAV(t,function(t){t.blob&&e(t.blob)})}else{if(!this.audioRecorder.exportWAV)throw new Error("Not found audio recorder exportWAV!");this.audioRecorder.exportWAV(function(t){t.blob&&e(t.blob)})}},getAudioRecorded:function(t,n){this.getBLOBData(t,function(t){var e=(window.URL||window.webkitURL).createObjectURL(t),i=new Audio(e);n(i)})},loadRecorded:function(t,e){var i=this,n=this.p;this.__audio=null;this.getAudioRecorded(t,function(t){(i.__audio=t).onended=function(){n.callStateChange({type:"record-listen-ended"})};i.playRecorded();e&&e()})},playRecorded:function(){if(!this.__audio)throw new Error("Not load recorded autio.");this.__audio.play()},pauseRecorded:function(){if(!this.__audio)throw new Error("Not load recorded autio.");this.__audio.pause()},stopRecorded:function(){if(!this.__audio)throw new Error("Not load recorded autio.");this.__audio.pause();this.__audio.currentTime=0},download:function(){var s=this;if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.audioRecorder.exportWAV(function(t){var e="recording-"+s.filenameIndex+".wav",i=(window.URL||window.webkitURL).createObjectURL(t),n=s.downloadNode,r=n?null:document.createElement("a");if(r){r.style.display="none";document.body.appendChild(r);n=r}n.href=i;n.download=e||"output.wav";n.click();window.URL.revokeObjectURL(i)})},clearData:function(t){if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.audioRecorder.clear(t)},test:function(t){s.audioTest(t)}});return s})}();!function(){var a=window.getDframework(),o=a.module("imgtech.media.Media");a.define("imgtech.recorder.DeviceRecorder",function(){function r(t,e){this.config=e||{};var i=this.config.bufferLen||4096,n=r.getDeviceRecorderWorkerPath();if(!n)throw new Error("Not found worker path.");this.context=t.context;this.context.createScriptProcessor?this.node=this.context.createScriptProcessor(i,2,2):this.node=this.context.createJavaScriptNode(i,2,2);this.is_started=!1;this.is_recording=!1;this.is_recorded=!1;this.callbackId=0;this.callbacks=[];this.recordData=[];this.config.arrayRecord;this.worker=new Worker(n);this.worker.postMessage({command:"init",config:{sampleRate:this.context.sampleRate}});!function(e){e.node.onaudioprocess=function(t){e.onaudioprocess(t)};e.worker.onmessage=function(t){e.onworkermessage(t)}}(this);t.connect(this.node);this.node.connect(this.context.destination)}r.getDeviceRecorderWorkerPath=function(){for(var t,e=a.queryAll("script"),i="js/source/source.js",n=0;n<e.length;n++){var r=e[n].src,s=r.lastIndexOf("?");-1!==s&&(r=r.substring(0,s));if(-1!==(s=r.lastIndexOf(o.filename))){if(r.substring(s)===o.filename)return r.substring(0,s)+"worker/DeviceRecorderWorker.js"}else-1!==(s=r.lastIndexOf(i))&&r.substring(s)===i&&(t=r.substring(0,s)+"js/recorder/worker/DeviceRecorderWorker.js")}return t||null};r.prototype={constructor:r,configure:function(t){for(var e in t)t.hasOwnProperty(e)&&(this.config[e]=t[e])},cancel:function(){if(this.is_recording){this.is_recording=!1;this.clearWorker();this.onstatechange({type:"record-cancel",data:this.recordData.length-1})}},record:function(e){var i=this;if(this.is_started&&!this.is_recording){!function(){for(var t=e;t.recorder_parent_event;)t=t.recorder_parent_event;t.data&&t.data.limitSeconds&&"number"==typeof t.data.limitSeconds&&setTimeout(function(){i.pause()},1e3*t.data.limitSeconds)}();this.is_recording=!0}},pause:function(){var e=this;if(this.is_started&&this.is_recording){this.is_recording=!1;this.exportWAV(function(t){if(t&&t.blob){e.recordData.push(t);e.clearWorker();e.onstatechange({type:"record-pause",data:e.recordData.length-1})}})}},clearWorker:function(){this.worker.postMessage({command:"clear"})},clear:function(t){if(t||0===t){var e=this.recordData;return e&&e.length>t?e.splice(t,1):a.warn("Not found index value for clear")}this.recordData=[];this.clearWorker()},onaudioprocess:function(t){if(this.is_started){if(this.is_recording){if(!this.is_recorded){this.is_recorded=!0;this.onstatechange({type:o.EVENT.STATE_CHANGE,data:o.STATE.PLAYING})}this.worker.postMessage({command:"record",buffer:[t.inputBuffer.getChannelData(0),t.inputBuffer.getChannelData(1)]})}else if(this.is_recorded){this.is_recorded=!1;this.onstatechange({type:o.EVENT.STATE_CHANGE,data:o.STATE.PAUSED})}}else{this.is_started=!0;this.onstatechange({type:o.EVENT.STATE_CHANGE,data:o.STATE.CUED})}},onworkermessage:function(t){var e,i=t.data;if(i.id)for(var n=0;n<this.callbacks.length;n++){var r=this.callbacks[n];if(r.id===i.id){this.callbacks.splice(n,1);e=r.callback;break}}return e?e(i):this.config.callback?this.config.callback(i):void 0},onstatechange:function(t){this.config.onStateChange&&this.config.onStateChange(t)},createCallbackData:function(t,e){var i=++this.callbackId;t.id=i;t.ctime=(new Date).getTime();e&&this.callbacks.push({id:i,ctime:t.ctime,callback:e});return t},getBuffers:function(t){var e=this.createCallbackData({command:"getBuffers",type:type},t);this.worker.postMessage(e)},indexWAV:function(t,e){var i=this.recordData.length;if(i&&t<i&&(t||0===t))return e(this.recordData[t]);a.warn("Not found index wave data.")},exportWAV:function(t,e){e=e||this.config.type||"audio/wav";var i=this.createCallbackData({command:"exportWAV",type:e},t);this.worker.postMessage(i)},exportMonoWAV:function(t,e){e=e||this.config.type||"audio/wav";var i=this.createCallbackData({command:"exportMonoWAV",type:e},t);this.worker.postMessage(i)}};return r})}();!function(){"use strict";var n=getDframework();n.module("imgtech.media.Media");n.define("imgtech.recorder.module.SoundAnalyser",function(){var r=n.module("imgtech.media.ModuleInterface");function t(t){r.apply(this,arguments);if(t){this.setSelfElementObject("analyserCurrentCanvas");var e=this.analyserCurrentCanvas,i=e&&e.element,n=this.attr;if(i){n.width&&(i.width=n.width);n.height&&(i.height=n.height)}}}n.extendClass(t,r,{onAddEvent:function(){var t=this.analyserCurrentCanvas,e=t?t.element:null,i=e?n.getBoundingClientRect(t.element):null;if(e){e.width=i.width();e.height=i.height();this.context2d=e.getContext("2d")}},onStateChange:function(t){},connect:function(t,e){if(!(this.analyser=t.createAnalyser?t.createAnalyser():null))throw new Error("Not found create analyser at audio context.");this.analyser.fftSize=2048;e.connect(this.analyser);this.update()},update:function(t){var e,i,n,r,s=this,a=this.analyserCurrentCanvas,o=a?a.element:null,u=o?o.width:0,l=o?o.height:0,h=Math.round(u/3),c=new Uint8Array(this.analyser.frequencyBinCount),d=this.analyser.frequencyBinCount/h;this.analyser.getByteFrequencyData(c);this.context2d.clearRect(0,0,u,l);this.context2d.fillStyle="#F6D565";this.context2d.lineCap="round";for(e=0;e<h;++e){n=0;r=Math.floor(e*d);for(i=0;i<d;i++)n+=c[r+i];n/=d;c[e*d];this.context2d.fillStyle="hsl( "+Math.round(360*e/h)+", 100%, 50%)";this.context2d.fillRect(3*e,l,1,-n)}window.requestAnimationFrame?this.lastAnimationFrameId=window.requestAnimationFrame(function(t){s.update(t)}):this.lastAnimationFrameId=window.setTimeout(function(){s.update()},Math.floor(1e3/60))}});return t})}();!function(){"use strict";var n=getDframework();n.module("imgtech.media.Media");n.define("imgtech.recorder.module.ListenRecorded",function(){var e=n.module("imgtech.media.ModuleInterface");function t(t){e.apply(this,arguments);t&&this.setSelfElementObject("listenRecordedBtn")}n.extendClass(t,e,{onAddEvent:function(){var t=this.listenRecordedBtn,e=t?t.element:null,i=this.p;e&&n.on(e,"click",function(){i.toggleListenRecorded()})}});return t})}();!function(){"use strict";var n=getDframework();n.module("imgtech.media.Media");n.define("imgtech.recorder.module.Download",function(){var e=n.module("imgtech.media.ModuleInterface");function t(t){e.apply(this,arguments);t&&this.setSelfElementObject("downloadBtn")}n.extendClass(t,e,{onAddEvent:function(){var t=this.downloadBtn,e=t?t.element:null,i=this.p;e&&n.on(e,"click",function(){i.download()})}});return t})}();!function(){"use strict";var n=getDframework();n.module("imgtech.media.Media");n.define("imgtech.recorder.module.Clear",function(){var e=n.module("imgtech.media.ModuleInterface");function t(t){e.apply(this,arguments);t&&this.setSelfElementObject("clearBtn")}n.extendClass(t,e,{onAddEvent:function(){var t=this.clearBtn,e=t?t.element:null,i=this.p;e&&n.on(e,"click",function(){i.clear()})}});return t})}();!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Hls=e():t.Hls=e()}(this,function(){return function(i){function n(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,n),e.l=!0,e.exports}var r={};return n.m=i,n.c=r,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=8)}([function(t,e,i){"use strict";function a(){}function n(i){for(var t=arguments.length,e=Array(1<t?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];e.forEach(function(t){o[t]=i[t]?i[t].bind(i):function e(r){var s=self.console[r];return s?function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];e[0]&&(e[0]=function n(t,e){return"["+t+"] > "+e}(r,e[0])),s.apply(self.console,e)}:a}(t)})}i.d(e,"a",function(){return u}),i.d(e,"b",function(){return l});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s={trace:a,debug:a,log:a,warn:a,info:a,error:a},o=s,u=function(t){if(!0===t||"object"===(void 0===t?"undefined":r(t))){n(t,"debug","log","info","warn","error");try{o.log()}catch(t){o=s}}else o=s},l=s},function(t,e,i){"use strict";e.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCH:"hlsLevelSwitch",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(t,e,i){"use strict";i.d(e,"b",function(){return n}),i.d(e,"a",function(){return r});var n={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},r={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(t,e,i){"use strict";i.d(e,"b",function(){return r});var n=function(){function o(){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o)}return o.isHeader=function(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},o.isFooter=function(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},o.getID3Data=function(t,e){for(var i=e,n=0;o.isHeader(t,e);){n+=10;n+=o._readSize(t,e+6),o.isFooter(t,e+10)&&(n+=10),e+=n}if(0<n)return t.subarray(i,i+n)},o._readSize=function(t,e){var i=0;return i=(127&t[e])<<21,i|=(127&t[e+1])<<14,(i|=(127&t[e+2])<<7)|127&t[e+3]},o.getTimeStamp=function(t){for(var e=o.getID3Frames(t),i=0;i<e.length;i++){var n=e[i];if(o.isTimeStampFrame(n))return o._readTimeStamp(n)}},o.isTimeStampFrame=function(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info},o._getFrameData=function(t){var e=String.fromCharCode(t[0],t[1],t[2],t[3]),i=o._readSize(t,4);return{type:e,size:i,data:t.subarray(10,10+i)}},o.getID3Frames=function(t){for(var e=0,i=[];o.isHeader(t,e);){for(var n=o._readSize(t,e+6),r=(e+=10)+n;e+8<r;){var s=o._getFrameData(t.subarray(e)),a=o._decodeFrame(s);a&&i.push(a),e+=s.size+10}o.isFooter(t,e)&&(e+=10)}return i},o._decodeFrame=function(t){return"PRIV"===t.type?o._decodePrivFrame(t):"T"===t.type[0]?o._decodeTextFrame(t):"W"===t.type[0]?o._decodeURLFrame(t):void 0},o._readTimeStamp=function(t){if(8===t.data.byteLength){var e=new Uint8Array(t.data),i=1&e[3],n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,i&&(n+=47721858.84),Math.round(n)}},o._decodePrivFrame=function(t){if(!(t.size<2)){var e=o._utf8ArrayToStr(t.data,!0),i=new Uint8Array(t.data.subarray(e.length+1));return{key:t.type,info:e,data:i.buffer}}},o._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var e=1,i=o._utf8ArrayToStr(t.data.subarray(e));e+=i.length+1;var n=o._utf8ArrayToStr(t.data.subarray(e));return{key:t.type,info:i,data:n}}var r=o._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:r}}},o._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var e=1,i=o._utf8ArrayToStr(t.data.subarray(e));e+=i.length+1;var n=o._utf8ArrayToStr(t.data.subarray(e));return{key:t.type,info:i,data:n}}var r=o._utf8ArrayToStr(t.data);return{key:t.type,data:r}},o._utf8ArrayToStr=function(t){for(var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=t.length,n=void 0,r=void 0,s=void 0,a="",o=0;o<i;){if(0===(n=t[o++])&&e)return a;if(0!==n&&3!==n)switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(n);break;case 12:case 13:r=t[o++],a+=String.fromCharCode((31&n)<<6|63&r);break;case 14:r=t[o++],s=t[o++],a+=String.fromCharCode((15&n)<<12|(63&r)<<6|(63&s)<<0)}}return a},o}(),r=n._utf8ArrayToStr;e.a=n},function(t,e,i){"use strict";var o=function(){function n(t,e){(function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,n),this.subtle=t,this.aesIV=e}return n.prototype.decrypt=function(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)},n}(),u=function(){function n(t,e){(function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,n),this.subtle=t,this.key=e}return n.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},n}(),l=function(){function t(){(function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return t.prototype.uint8ArrayToUint32Array_=function(t){for(var e=new DataView(t),i=new Uint32Array(4),n=0;n<4;n++)i[n]=e.getUint32(4*n);return i},t.prototype.initTable=function(){var t=this.sBox,e=this.invSBox,i=this.subMix,n=i[0],r=i[1],s=i[2],a=i[3],o=this.invSubMix,u=o[0],l=o[1],h=o[2],c=o[3],d=new Uint32Array(256),f=0,p=0,m=0;for(m=0;m<256;m++)d[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^255&g^99;var v=d[e[t[f]=g]=f],y=d[v],_=d[y],E=257*d[g]^16843008*g;n[f]=E<<24|E>>>8,r[f]=E<<16|E>>>16,s[f]=E<<8|E>>>24,a[f]=E,E=16843009*_^65537*y^257*v^16843008*f,u[g]=E<<24|E>>>8,l[g]=E<<16|E>>>16,h[g]=E<<8|E>>>24,c[g]=E,f?(f=v^d[d[d[_^v]]],p^=d[d[p]]):f=p=1}},t.prototype.expandKey=function(t){for(var e=this.uint8ArrayToUint32Array_(t),i=!0,n=0;n<e.length&&i;)i=e[n]===this.key[n],n++;if(!i){this.key=e;var r=this.keySize=e.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);var s=this.ksRows=4*(r+6+1),a=void 0,o=void 0,u=this.keySchedule=new Uint32Array(s),l=this.invKeySchedule=new Uint32Array(s),h=this.sBox,c=this.rcon,d=this.invSubMix,f=d[0],p=d[1],m=d[2],g=d[3],v=void 0,y=void 0;for(a=0;a<s;a++)a<r?v=u[a]=e[a]:(y=v,a%r==0?(y=h[(y=y<<8|y>>>24)>>>24]<<24|h[y>>>16&255]<<16|h[y>>>8&255]<<8|h[255&y],y^=c[a/r|0]<<24):6<r&&a%r==4&&(y=h[y>>>24]<<24|h[y>>>16&255]<<16|h[y>>>8&255]<<8|h[255&y]),u[a]=v=(u[a-r]^y)>>>0);for(o=0;o<s;o++)a=s-o,y=3&o?u[a]:u[a-4],l[o]=o<4||a<=4?y:f[h[y>>>24]]^p[h[y>>>16&255]]^m[h[y>>>8&255]]^g[h[255&y]],l[o]=l[o]>>>0}},t.prototype.networkToHostOrderSwap=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},t.prototype.decrypt=function(t,e,i){for(var n,r,s=this.keySize+6,a=this.invKeySchedule,o=this.invSBox,u=this.invSubMix,l=u[0],h=u[1],c=u[2],d=u[3],f=this.uint8ArrayToUint32Array_(i),p=f[0],m=f[1],g=f[2],v=f[3],y=new Int32Array(t),_=new Int32Array(y.length),E=void 0,b=void 0,T=void 0,S=void 0,w=void 0,C=void 0,A=void 0,k=void 0,N=void 0,x=void 0,M=void 0,R=void 0,D=this.networkToHostOrderSwap;e<y.length;){for(N=D(y[e]),x=D(y[e+1]),M=D(y[e+2]),R=D(y[e+3]),w=N^a[0],C=R^a[1],A=M^a[2],k=x^a[3],n=4,r=1;r<s;r++)E=l[w>>>24]^h[C>>16&255]^c[A>>8&255]^d[255&k]^a[n],b=l[C>>>24]^h[A>>16&255]^c[k>>8&255]^d[255&w]^a[n+1],T=l[A>>>24]^h[k>>16&255]^c[w>>8&255]^d[255&C]^a[n+2],S=l[k>>>24]^h[w>>16&255]^c[C>>8&255]^d[255&A]^a[n+3],w=E,C=b,A=T,k=S,n+=4;E=o[w>>>24]<<24^o[C>>16&255]<<16^o[A>>8&255]<<8^o[255&k]^a[n],b=o[C>>>24]<<24^o[A>>16&255]<<16^o[k>>8&255]<<8^o[255&w]^a[n+1],T=o[A>>>24]<<24^o[k>>16&255]<<16^o[w>>8&255]<<8^o[255&C]^a[n+2],S=o[k>>>24]<<24^o[w>>16&255]<<16^o[C>>8&255]<<8^o[255&A]^a[n+3],n+=3,_[e]=D(E^p),_[e+1]=D(S^m),_[e+2]=D(T^g),_[e+3]=D(b^v),p=N,m=x,g=M,v=R,e+=4}return _.buffer},t.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},t}(),s=i(2),h=i(0),n=function(){function r(t,e){(function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,r),this.observer=t,this.config=e,this.logEnabled=!0;try{var i=crypto||self.crypto;this.subtle=i.subtle||i.webkitSubtle}catch(r){}this.disableWebCrypto=!this.subtle}return r.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},r.prototype.decrypt=function(e,i,n,r){var s=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(h.b.log("JS AES decrypt"),this.logEnabled=!1);var t=this.decryptor;t||(this.decryptor=t=new l),t.expandKey(i),r(t.decrypt(e,0,n))}else{this.logEnabled&&(h.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var a=this.subtle;this.key!==i&&(this.key=i,this.fastAesKey=new u(a,i)),this.fastAesKey.expandKey().then(function(t){new o(a,n).decrypt(e,t)["catch"](function(t){s.onWebCryptoError(t,e,i,n,r)}).then(function(t){r(t)})})["catch"](function(t){s.onWebCryptoError(t,e,i,n,r)})}},r.prototype.onWebCryptoError=function(t,e,i,n,r){this.config.enableSoftwareAES?(h.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(e,i,n,r)):(h.b.error("decrypting error : "+t.message),this.observer.trigger(Event.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:t.message}))},r.prototype.destroy=function(){var t=this.decryptor;t&&(t.destroy(),this.decryptor=void 0)},r}();e.a=n},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function u(t){return"function"==typeof t}function l(t){return"object"==typeof t&&null!==t}function h(t){return void 0===t}((t.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!function e(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,i,n,r,s,a;if(this._events||(this._events={}),"error"===t&&(!this._events.error||l(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var o=new Error('Uncaught, unspecified "error" event. ('+e+")");throw o.context=e,o}if(h(i=this._events[t]))return!1;if(u(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(l(i))for(r=Array.prototype.slice.call(arguments,1),n=(a=i.slice()).length,s=0;s<n;s++)a[s].apply(this,r);return!0},n.prototype.on=n.prototype.addListener=function(t,e){var i;if(!u(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,u(e.listener)?e.listener:e),this._events[t]?l(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,l(this._events[t])&&!this._events[t].warned&&(i=h(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&0<i&&this._events[t].length>i&&(this._events[t].warned=!0,console.trace),this},n.prototype.once=function(t,e){function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}if(!u(e))throw TypeError("listener must be a function");var n=!1;return i.listener=e,this.on(t,i),this},n.prototype.removeListener=function(t,e){var i,n,r,s;if(!u(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=(i=this._events[t]).length,n=-1,i===e||u(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(l(i)){for(s=r;0<s--;)if(i[s]===e||i[s].listener&&i[s].listener===e){n=s;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(u(i=this._events[t]))this.removeListener(t,i);else if(i)for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?u(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(u(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,i){n=/^((?:[^\/;?#]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,h=/^([^\/;?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,c={buildAbsoluteURL:function(t,e,i){if(i=i||{},t=t.trim(),!(e=e.trim())){if(!i.alwaysNormalize)return t;var n=this.parseURL(t);if(!s)throw new Error("Error trying to parse base URL.");return n.path=c.normalizePath(n.path),c.buildURLFromParts(n)}var r=this.parseURL(e);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return i.alwaysNormalize?(r.path=c.normalizePath(r.path),c.buildURLFromParts(r)):e;var s=this.parseURL(t);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var a=h.exec(s.path);s.netLoc=a[1],s.path=a[2]}s.netLoc&&!s.path&&(s.path="/");var o={scheme:s.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(o.netLoc=s.netLoc,"/"!==r.path[0]))if(r.path){var u=s.path,l=u.substring(0,u.lastIndexOf("/")+1)+r.path;o.path=c.normalizePath(l)}else o.path=s.path,r.params||(o.params=s.params,r.query||(o.query=s.query));return null===o.path&&(o.path=i.alwaysNormalize?c.normalizePath(r.path):r.path),c.buildURLFromParts(o)},parseURL:function(t){var e=n.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(r,"");t.length!==(t=t.replace(s,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}},t.exports=c;var n,h,r,s,c},function(t,e,i){"use strict";function r(t,e){return 255===t[e]&&240==(246&t[e+1])}function c(t,e){return 1&t[e+1]?7:9}function d(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function g(t,e){return!!(e+1<t.length&&r(t,e))}function n(t,e){if(e+1<t.length&&r(t,e)){var i=c(t,e);e+5<t.length&&(i=d(t,e));var n=e+i;if(n===t.length||n+1<t.length&&r(t,n))return!0}return!1}function v(t,e,i,n,r){if(!t.samplerate){var s=function d(t,e,i,n){var r,s,a,o,u,l=navigator.userAgent.toLowerCase(),h=n,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return r=1+((192&e[i+2])>>>6),(s=(60&e[i+2])>>>2)>c.length-1?void t.trigger(Event.ERROR,{type:et.b.MEDIA_ERROR,details:et.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s}):(o=(1&e[i+2])<<2,o|=(192&e[i+3])>>>6,it.b.log("manifest codec:"+n+",ADTS data:type:"+r+",sampleingIndex:"+s+"["+c[s]+"Hz],channelConfig:"+o),a=/firefox/i.test(l)?6<=s?(r=5,u=new Array(4),s-3):(r=2,u=new Array(2),s):-1!==l.indexOf("android")?(r=2,u=new Array(2),s):(r=5,u=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&6<=s?s-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(6<=s&&1===o||/vivaldi/i.test(l))||!n&&1===o)&&(r=2,u=new Array(2)),s)),u[0]=r<<3,u[0]|=(14&s)>>1,u[1]|=(1&s)<<7,u[1]|=o<<3,5===r&&(u[1]|=(14&a)>>1,u[2]=(1&a)<<7,u[2]|=8,u[3]=0),{config:u,samplerate:c[s],channelCount:o,codec:"mp4a.40."+r,manifestCodec:h})}(e,i,n,r);t.config=s.config,t.samplerate=s.samplerate,t.channelCount=s.channelCount,t.codec=s.codec,t.manifestCodec=s.manifestCodec,it.b.log("parsed codec:"+t.codec+",rate:"+s.samplerate+",nb channel:"+s.channelCount)}}function y(t){return 9216e4/t}function _(t,e,i,n,r){var s=function h(t,e,i,n,r){var s,a,o=t.length;if(s=c(t,e),a=d(t,e),0<(a-=s)&&e+s+a<=o)return{headerLength:s,frameLength:a,stamp:i+n*r}}(e,i,n,r,y(t.samplerate));if(s){var a=s.stamp,o=s.headerLength,u=s.frameLength,l={unit:e.subarray(i+o,i+o+u),pts:a,dts:a};return t.samples.push(l),t.len+=u,{sample:l,length:u+o}}}var tt=i(1),et=i(2),m=i(4),it=i(0),p=i(3),S=function(){function r(t,e,i){(function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,r),this.observer=t,this.config=i,this.remuxer=e}return r.prototype.resetInitSegment=function(t,e,i,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:e,duration:n,inputTimeScale:9e4}},r.prototype.resetTimeStamp=function(){},r.probe=function(t){if(!t)return!1;for(var e=(p.a.getID3Data(t,0)||[]).length,i=t.length;e<i;e++)if(n(t,e))return it.b.log("ADTS sync word found !"),!0;return!1},r.prototype.append=function(t,e,i,n){for(var r=this._audioTrack,s=p.a.getID3Data(t,0)||[],a=p.a.getTimeStamp(s),o=a?90*a:9e4*e,u=0,l=o,h=t.length,c=s.length,d=[{pts:l,dts:l,data:s}];c<h-1;)if(g(t,c)&&c+5<h){v(r,this.observer,t,c,r.manifestCodec);var f=_(r,t,c,o,u);if(!f){it.b.log("Unable to parse AAC frame");break}c+=f.length,l=f.sample.pts,u++}else p.a.isHeader(t,c)?(s=p.a.getID3Data(t,c),d.push({pts:l,dts:l,data:s}),c+=s.length):c++;this.remuxer.remux(r,{samples:[]},{samples:d,inputTimeScale:9e4},{samples:[]},e,i,n)},r.prototype.destroy=function(){},r}(),o=Math.pow(2,32)-1,w=function(){function d(t,e){(function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,d),this.observer=t,this.remuxer=e}return d.prototype.resetTimeStamp=function(t){this.initPTS=t},d.prototype.resetInitSegment=function(t,e,i,n){if(t&&t.byteLength){var r=this.initData=d.parseInitSegment(t);null==e&&(e="mp4a.40.5"),null==i&&(i="avc1.42e01e");var s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:e+","+i,initSegment:n?t:null}:(r.audio&&(s.audio={container:"audio/mp4",codec:e,initSegment:n?t:null}),r.video&&(s.video={container:"video/mp4",codec:i,initSegment:n?t:null})),this.observer.trigger(tt.a.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else e&&(this.audioCodec=e),i&&(this.videoCodec=i)},d.probe=function(t){return 0<d.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length},d.bin2str=function(t){return String.fromCharCode.apply(null,t)},d.readUint32=function(t,e){t.data&&(e+=t.start,t=t.data);var i=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3];return i<0?4294967296+i:i},d.writeUint32=function(t,e,i){t.data&&(e+=t.start,t=t.data),t[e]=i>>24,t[e+1]=i>>16&255,t[e+2]=i>>8&255,t[e+3]=255&i},d.findBox=function(t,e){var i,n,r,s,a,o,u=[];if(t.data?(a=t.start,r=t.end,t=t.data):(a=0,r=t.byteLength),!e.length)return null;for(i=a;i<r;)o=1<(n=d.readUint32(t,i))?i+n:r,d.bin2str(t.subarray(i+4,i+8))===e[0]&&(1===e.length?u.push({data:t,start:i+8,end:o}):(s=d.findBox({data:t,start:i+8,end:o},e.slice(1))).length&&(u=u.concat(s))),i=o;return u},d.parseInitSegment=function(t){var c=[];return d.findBox(t,["moov","trak"]).forEach(function(t){var e=d.findBox(t,["tkhd"])[0];if(e){var i=e.data[e.start],n=0===i?12:20,r=d.readUint32(e,n),s=d.findBox(t,["mdia","mdhd"])[0];if(s){i=s.data[s.start];var a=d.readUint32(s,n=0===i?12:20),o=d.findBox(t,["mdia","hdlr"])[0];if(o){var u={soun:"audio",vide:"video"}[d.bin2str(o.data.subarray(o.start+8,o.start+12))];if(u){var l=d.findBox(t,["mdia","minf","stbl","stsd"]);if(l.length){l=l[0];var h=d.bin2str(l.data.subarray(l.start+12,l.start+16));it.b.log("MP4Demuxer:"+u+":"+h+" found")}c[r]={timescale:a,type:u},c[u]={timescale:a,id:r}}}}}}),c},d.getStartDTS=function(r,t){var e,i,n;return e=d.findBox(t,["moof","traf"]),i=[].concat.apply([],e.map(function(n){return d.findBox(n,["tfhd"]).map(function(t){var e,i;return e=d.readUint32(t,4),i=r[e].timescale||9e4,d.findBox(n,["tfdt"]).map(function(t){var e,i;return e=t.data[t.start],i=d.readUint32(t,4),1===e&&(i*=Math.pow(2,32),i+=d.readUint32(t,8)),i})[0]/i})})),n=Math.min.apply(null,i),isFinite(n)?n:0},d.offsetStartDTS=function(n,t,a){d.findBox(t,["moof","traf"]).map(function(i){return d.findBox(i,["tfhd"]).map(function(t){var e=d.readUint32(t,4),s=n[e].timescale||9e4;d.findBox(i,["tfdt"]).map(function(t){var e=t.data[t.start],i=d.readUint32(t,4);if(0===e)d.writeUint32(t,4,i-a*s);else{i*=Math.pow(2,32),i+=d.readUint32(t,8),i-=a*s,i=Math.max(i,0);var n=Math.floor(i/(o+1)),r=Math.floor(i%(o+1));d.writeUint32(t,4,n),d.writeUint32(t,8,r)}})})})},d.prototype.append=function(t,e,i,n){var r=this.initData;r||(this.resetInitSegment(t,this.audioCodec,this.videoCodec),r=this.initData);var s,a=this.initPTS;if(void 0===a){var o=d.getStartDTS(r,t);this.initPTS=a=o-e,this.observer.trigger(tt.a.INIT_PTS_FOUND,{initPTS:a})}d.offsetStartDTS(r,t,a),s=d.getStartDTS(r,t),this.remuxer.remux(r.audio,r.video,null,null,s,i,n,t)},d.prototype.destroy=function(){},d}(),E={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(t,e,i,n,r){if(!(i+24>e.length)){var s=this.parseHeader(e,i);if(s&&i+s.frameLength<=e.length){var a=n+r*(9e4*s.samplesPerFrame/s.sampleRate),o={unit:e.subarray(i,i+s.frameLength),pts:a,dts:a};return t.config=[],t.channelCount=s.channelCount,t.samplerate=s.sampleRate,t.samples.push(o),t.len+=s.frameLength,{sample:o,length:s.frameLength}}}},parseHeader:function(t,e){var i=t[e+1]>>3&3,n=t[e+1]>>1&3,r=t[e+2]>>4&15,s=t[e+2]>>2&3,a=t[e+2]>>1&1;if(1!==i&&0!==r&&15!==r&&3!==s){var o=3===i?3-n:3===n?3:4,u=1e3*E.BitratesMap[14*o+r-1],l=3===i?0:2===i?1:2,h=E.SamplingRateMap[3*l+s],c=t[e+3]>>6==3?1:2,d=E.SamplesCoefficients[i][n],f=E.BytesInSlot[n],p=8*d*f;return{sampleRate:h,channelCount:c,frameLength:parseInt(d*u/h+a,10)*f,samplesPerFrame:p}}},isHeaderPattern:function(t,e){return 255===t[e]&&224==(224&t[e+1])&&0!=(6&t[e+1])},isHeader:function(t,e){return!!(e+1<t.length&&this.isHeaderPattern(t,e))},probe:function(t,e){if(e+1<t.length&&this.isHeaderPattern(t,e)){var i=this.parseHeader(t,e),n=4;i&&i.frameLength&&(n=i.frameLength);var r=e+n;if(r===t.length||r+1<t.length&&this.isHeaderPattern(t,r))return!0}return!1}},b=E,C=function(){function e(t){(function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return e.prototype.loadWord=function(){var t=this.data,e=this.bytesAvailable,i=t.byteLength-e,n=new Uint8Array(4),r=Math.min(4,e);if(0===r)throw new Error("no bytes available");n.set(t.subarray(i,i+r)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r},e.prototype.skipBits=function(t){var e;this.bitsAvailable>t||(t-=this.bitsAvailable,t-=(e=t>>3)>>3,this.bytesAvailable-=e,this.loadWord()),this.word<<=t,this.bitsAvailable-=t},e.prototype.readBits=function(t){var e=Math.min(this.bitsAvailable,t),i=this.word>>>32-e;return 32<t&&it.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,0<this.bitsAvailable?this.word<<=e:0<this.bytesAvailable&&this.loadWord(),0<(e=t-e)&&this.bitsAvailable?i<<e|this.readBits(e):i},e.prototype.skipLZ=function(){var t;for(t=0;t<this.bitsAvailable;++t)if(0!=(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()},e.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.readUEG=function(){var t=this.skipLZ();return this.readBits(t+1)-1},e.prototype.readEG=function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)},e.prototype.readBoolean=function(){return 1===this.readBits(1)},e.prototype.readUByte=function(){return this.readBits(8)},e.prototype.readUShort=function(){return this.readBits(16)},e.prototype.readUInt=function(){return this.readBits(32)},e.prototype.skipScalingList=function(t){var e,i=8,n=8;for(e=0;e<t;e++)0!==n&&(n=(i+this.readEG()+256)%256),i=0===n?i:n},e.prototype.readSPS=function(){var t,e,i,n,r,s,a,o=0,u=0,l=0,h=0,c=this.readUByte.bind(this),d=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),m=this.skipBits.bind(this),g=this.skipEG.bind(this),v=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(c(),t=c(),d(5),m(3),c(),v(),100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t){var _=f();if(3===_&&m(1),v(),v(),m(1),p())for(s=3!==_?8:12,a=0;a<s;a++)p()&&y(a<6?16:64)}v();var E=f();if(0===E)f();else if(1===E)for(m(1),g(),g(),e=f(),a=0;a<e;a++)g();v(),m(1),i=f(),n=f(),0===(r=d(1))&&m(1),m(1),p()&&(o=f(),u=f(),l=f(),h=f());var b=[1,1];if(p()&&p())switch(c()){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:b=[c()<<8|c(),c()<<8|c()]}return{width:Math.ceil(16*(i+1)-2*o-2*u),height:(2-r)*(n+1)*16-(r?2:4)*(l+h),pixelRatio:b}},e.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),s=function(){function s(t,e,i,n){(function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,s),this.decryptdata=i,this.discardEPB=n,this.decrypter=new m.a(t,e)}return s.prototype.decryptBuffer=function(t,e){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,e)},s.prototype.decryptAacSample=function(e,i,n,r){var s=e[i].unit,t=s.subarray(16,s.length-s.length%16),a=t.buffer.slice(t.byteOffset,t.byteOffset+t.length),o=this;this.decryptBuffer(a,function(t){t=new Uint8Array(t),s.set(t,16),r||o.decryptAacSamples(e,i+1,n)})},s.prototype.decryptAacSamples=function(t,e,i){for(;;e++){if(e>=t.length)return void i();if(!(t[e].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(t,e,i,n),!n)return}}},s.prototype.getAvcEncryptedData=function(t){for(var e=16*Math.floor((t.length-48)/160)+16,i=new Int8Array(e),n=0,r=32;r<=t.length-16;r+=160,n+=16)i.set(t.subarray(r,r+16),n);return i},s.prototype.getAvcDecryptedUnit=function(t,e){e=new Uint8Array(e);for(var i=0,n=32;n<=t.length-16;n+=160,i+=16)t.set(e.subarray(i,i+16),n);return t},s.prototype.decryptAvcSample=function(e,i,n,r,s,a){var o=this.discardEPB(s.data),t=this.getAvcEncryptedData(o),u=this;this.decryptBuffer(t.buffer,function(t){s.data=u.getAvcDecryptedUnit(o,t),a||u.decryptAvcSamples(e,i,n+1,r)})},s.prototype.decryptAvcSamples=function(t,e,i,n){for(;;e++,i=0){if(e>=t.length)return void n();for(var r=t[e].units;!(i>=r.length);i++){var s=r[i];if(!(s.length<=48||1!==s.type&&5!==s.type)){var a=this.decrypter.isSync();if(this.decryptAvcSample(t,e,i,n,s,a),!a)return}}}},s}(),a={video:0,audio:1,id3:2,text:3},A=function(){function R(t,e,i,n){(function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,R),this.observer=t,this.config=i,this.typeSupported=n,this.remuxer=e,this.sampleAes=null}return R.prototype.setDecryptData=function(t){null!=t&&null!=t.key&&"SAMPLE-AES"===t.method?this.sampleAes=new s(this.observer,this.config,t,this.discardEPB):this.sampleAes=null},R.probe=function(t){var e=R._syncOffset(t);return!(e<0||(e&&it.b.warn("MPEG2-TS detected but first sync word found @ offset "+e+", junk ahead ?"),0))},R._syncOffset=function(t){for(var e=Math.min(1e3,t.length-564),i=0;i<e;){if(71===t[i]&&71===t[i+188]&&71===t[i+376])return i;i++}return-1},R.createTrack=function(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:a[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===t?0:void 0,isAAC:"audio"===t||void 0,duration:"audio"===t?e:void 0}},R.prototype.resetInitSegment=function(t,e,i,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=R.createTrack("video",n),this._audioTrack=R.createTrack("audio",n),this._id3Track=R.createTrack("id3",n),this._txtTrack=R.createTrack("text",n),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=e,this.videoCodec=i,this._duration=n},R.prototype.resetTimeStamp=function(){},R.prototype.append=function(t,e,i,n){var r,s,a,o,u,l=t.length,h=!1;this.contiguous=i;var c=this.pmtParsed,d=this._avcTrack,f=this._audioTrack,p=this._id3Track,m=d.pid,g=f.pid,v=p.pid,y=this._pmtId,_=d.pesData,E=f.pesData,b=p.pesData,T=this._parsePAT,S=this._parsePMT,w=this._parsePES,C=this._parseAVCPES.bind(this),A=this._parseAACPES.bind(this),k=this._parseMPEGPES.bind(this),N=this._parseID3PES.bind(this),x=R._syncOffset(t);for(l-=(l+x)%188,r=x;r<l;r+=188)if(71===t[r]){if(s=!!(64&t[r+1]),a=((31&t[r+1])<<8)+t[r+2],1<(48&t[r+3])>>4){if((o=r+5+t[r+4])===r+188)continue}else o=r+4;switch(a){case m:s&&(_&&(u=w(_))&&C(u,!1),_={data:[],size:0}),_&&(_.data.push(t.subarray(o,r+188)),_.size+=r+188-o);break;case g:s&&(E&&(u=w(E))&&(f.isAAC?A(u):k(u)),E={data:[],size:0}),E&&(E.data.push(t.subarray(o,r+188)),E.size+=r+188-o);break;case v:s&&(b&&(u=w(b))&&N(u),b={data:[],size:0}),b&&(b.data.push(t.subarray(o,r+188)),b.size+=r+188-o);break;case 0:s&&(o+=t[o]+1),y=this._pmtId=T(t,o);break;case y:s&&(o+=t[o]+1);var M=S(t,o,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);0<(m=M.avc)&&(d.pid=m),0<(g=M.audio)&&(f.pid=g,f.isAAC=M.isAAC),0<(v=M.id3)&&(p.pid=v),h&&!c&&(it.b.log("reparse from beginning"),h=!1,r=x-188),c=this.pmtParsed=!0;break;case 17:case 8191:break;default:h=!0}}else this.observer.trigger(tt.a.ERROR,{type:et.b.MEDIA_ERROR,details:et.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});_&&(u=w(_))?(C(u,!0),d.pesData=null):d.pesData=_,E&&(u=w(E))?(f.isAAC?A(u):k(u),f.pesData=null):(E&&E.size&&it.b.log("last AAC PES packet truncated,might overlap between fragments"),f.pesData=E),b&&(u=w(b))?(N(u),p.pesData=null):p.pesData=b,null==this.sampleAes?this.remuxer.remux(f,d,p,this._txtTrack,e,i,n):this.decryptAndRemux(f,d,p,this._txtTrack,e,i,n)},R.prototype.decryptAndRemux=function(t,e,i,n,r,s,a){if(t.samples&&t.isAAC){var o=this;this.sampleAes.decryptAacSamples(t.samples,0,function(){o.decryptAndRemuxAvc(t,e,i,n,r,s,a)})}else this.decryptAndRemuxAvc(t,e,i,n,r,s,a)},R.prototype.decryptAndRemuxAvc=function(t,e,i,n,r,s,a){if(e.samples){var o=this;this.sampleAes.decryptAvcSamples(e.samples,0,0,function(){o.remuxer.remux(t,e,i,n,r,s,a)})}else this.remuxer.remux(t,e,i,n,r,s,a)},R.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},R.prototype._parsePAT=function(t,e){return(31&t[e+10])<<8|t[e+11]},R.prototype._parsePMT=function(t,e,i,n){var r,s,a={audio:-1,avc:-1,id3:-1,isAAC:!0};for(r=e+3+((15&t[e+1])<<8|t[e+2])-4,e+=12+((15&t[e+10])<<8|t[e+11]);e<r;){switch(s=(31&t[e+1])<<8|t[e+2],t[e]){case 207:if(!n){it.b.log("unkown stream type:"+t[e]);break}case 15:-1===a.audio&&(a.audio=s);break;case 21:-1===a.id3&&(a.id3=s);break;case 219:if(!n){it.b.log("unkown stream type:"+t[e]);break}case 27:-1===a.avc&&(a.avc=s);break;case 3:case 4:i?-1===a.audio&&(a.audio=s,a.isAAC=!1):it.b.log("MPEG audio found, not supported in this browser for now");break;case 36:it.b.warn("HEVC stream type found, not supported for now");break;default:it.b.log("unkown stream type:"+t[e])}e+=5+((15&t[e+3])<<8|t[e+4])}return a},R.prototype._parsePES=function(t){var e,i,n,r,s,a,o,u,l=0,h=t.data;if(!t||0===t.size)return null;for(;h[0].length<19&&1<h.length;){var c=new Uint8Array(h[0].length+h[1].length);c.set(h[0]),c.set(h[1],h[0].length),h[0]=c,h.splice(1,1)}if(1!==((e=h[0])[0]<<16)+(e[1]<<8)+e[2])return null;if((n=(e[4]<<8)+e[5])&&n>t.size-6)return null;192&(i=e[7])&&(4294967295<(a=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2)&&(a-=8589934592),64&i?(4294967295<(o=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2)&&(o-=8589934592),54e5<a-o&&(it.b.warn(Math.round((a-o)/9e4)+"s delta between PTS and DTS, align them"),a=o)):o=a),u=(r=e[8])+9,t.size-=u,s=new Uint8Array(t.size);for(var d=0,f=h.length;d<f;d++){var p=(e=h[d]).byteLength;if(u){if(p<u){u-=p;continue}e=e.subarray(u),p-=u,u=0}s.set(e,l),l+=p}return n&&(n-=r+3),{data:s,pts:a,dts:o,len:n}},R.prototype.pushAccesUnit=function(t,e){if(t.units.length&&t.frame){var i=e.samples,n=i.length;!this.config.forceKeyFrameOnDiscontinuity||!0===t.key||e.sps&&(n||this.contiguous)?(t.id=n,i.push(t)):e.dropped++}t.debug.length&&it.b.log(t.pts+"/"+t.dts+":"+t.debug)},R.prototype._parseAVCPES=function(p,t){var m,g,v,y=this,_=this._avcTrack,e=this._parseAVCNALu(p.data),E=this.avcSample,b=!1,T=this.pushAccesUnit.bind(this),S=function(t,e,i,n){return{key:t,pts:e,dts:i,units:[],debug:n}};p.data=null,E&&e.length&&!_.audFound&&(T(E,_),E=this.avcSample=S(!1,p.pts,p.dts,"")),e.forEach(function(t){switch(t.type){case 1:g=!0,E||(E=y.avcSample=S(!0,p.pts,p.dts,"")),E.frame=!0;var e=t.data;if(b&&4<e.length){var i=new C(e).readSliceType();2!==i&&4!==i&&7!==i&&9!==i||(E.key=!0)}break;case 5:g=!0,E||(E=y.avcSample=S(!0,p.pts,p.dts,"")),E.key=!0,E.frame=!0;break;case 6:g=!0,(m=new C(y.discardEPB(t.data))).readUByte();for(var n=0,r=0,s=!1,a=0;!s&&1<m.bytesAvailable;){n=0;for(;n+=a=m.readUByte(),255===a;);r=0;for(;r+=a=m.readUByte(),255===a;);if(4===n&&0!==m.bytesAvailable){s=!0;if(181===m.readUByte()&&49===m.readUShort()&&1195456820===m.readUInt()&&3===m.readUByte()){var o=m.readUByte(),u=31&o,l=[o,m.readUByte()];for(v=0;v<u;v++)l.push(m.readUByte()),l.push(m.readUByte()),l.push(m.readUByte());y._insertSampleInOrder(y._txtTrack.samples,{type:3,pts:p.pts,bytes:l})}}else if(r<m.bytesAvailable)for(v=0;v<r;v++)m.readUByte()}break;case 7:if(b=g=!0,!_.sps){var h=(m=new C(t.data)).readSPS();_.width=h.width,_.height=h.height,_.pixelRatio=h.pixelRatio,_.sps=[t.data],_.duration=y._duration;var c=t.data.subarray(1,4),d="avc1.";for(v=0;v<3;v++){var f=c[v].toString(16);f.length<2&&(f="0"+f),d+=f}_.codec=d}break;case 8:g=!0,_.pps||(_.pps=[t.data]);break;case 9:g=!1,_.audFound=!0,E&&T(E,_),E=y.avcSample=S(!1,p.pts,p.dts,"");break;case 12:g=!1;break;default:g=!1,E&&(E.debug+="unknown NAL "+t.type+" ")}E&&g&&E.units.push(t)}),t&&E&&(T(E,_),this.avcSample=null)},R.prototype._insertSampleInOrder=function(t,e){var i=t.length;if(0<i){if(e.pts>=t[i-1].pts)t.push(e);else for(var n=i-1;0<=n;n--)if(e.pts<t[n].pts){t.splice(n,0,e);break}}else t.push(e)},R.prototype._getLastNalUnit=function(){var t=this.avcSample,e=void 0;if(!t||0===t.units.length){var i=this._avcTrack.samples;t=i[i.length-1]}if(t){var n=t.units;e=n[n.length-1]}return e},R.prototype._parseAVCNALu=function(t){var e,i,n,r,s=0,a=t.byteLength,o=this._avcTrack,u=o.naluState||0,l=u,h=[],c=-1;for(-1===u&&(r=31&t[c=0],u=0,s=1);s<a;)if(e=t[s++],u)if(1!==u)if(e)if(1===e){if(0<=c)n={data:t.subarray(c,s-u-1),type:r},h.push(n);else{var d=this._getLastNalUnit();if(d&&(l&&s<=4-l&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-l)),0<(i=s-u-1))){var f=new Uint8Array(d.data.byteLength+i);f.set(d.data,0),f.set(t.subarray(0,i),d.data.byteLength),d.data=f}}u=s<a?(r=31&t[c=s],0):-1}else u=0;else u=3;else u=e?0:2;else u=e?0:1;if(0<=c&&0<=u&&(n={data:t.subarray(c,a),type:r,state:u},h.push(n)),0===h.length){var p=this._getLastNalUnit();if(p){var m=new Uint8Array(p.data.byteLength+t.byteLength);m.set(p.data,0),m.set(t,p.data.byteLength),p.data=m}}return o.naluState=u,h},R.prototype.discardEPB=function(t){for(var e,i,n=t.byteLength,r=[],s=1;s<n-2;)0===t[s]&&0===t[s+1]&&3===t[s+2]?(r.push(s+2),s+=2):s++;if(0===r.length)return t;e=n-r.length,i=new Uint8Array(e);var a=0;for(s=0;s<e;a++,s++)a===r[0]&&(a++,r.shift()),i[s]=t[a];return i},R.prototype._parseAACPES=function(t){var e,i,n,r,s,a=this._audioTrack,o=t.data,u=t.pts,l=this.aacOverFlow,h=this.aacLastPTS;if(l){var c=new Uint8Array(l.byteLength+o.byteLength);c.set(l,0),c.set(o,l.byteLength),o=c}for(n=0,s=o.length;n<s-1&&!g(o,n);n++);if(n){var d,f;if(f=n<s-1?(d="AAC PES did not start with ADTS header,offset:"+n,!1):(d="no ADTS header found in AAC PES",!0),it.b.warn("parsing error:"+d),this.observer.trigger(tt.a.ERROR,{type:et.b.MEDIA_ERROR,details:et.a.FRAG_PARSING_ERROR,fatal:f,reason:d}),f)return}if(v(a,this.observer,o,n,this.audioCodec),i=0,e=y(a.samplerate),l&&h){var p=h+e;1<Math.abs(p-u)&&(it.b.log("AAC: align PTS for overlapping frames by "+Math.round((p-u)/90)),u=p)}for(;n<s;)if(g(o,n)&&n+5<s){var m=_(a,o,n,u,i);if(!m)break;n+=m.length,r=m.sample.pts,i++}else n++;l=n<s?o.subarray(n,s):null,this.aacOverFlow=l,this.aacLastPTS=r},R.prototype._parseMPEGPES=function(t){for(var e=t.data,i=e.length,n=0,r=0,s=t.pts;r<i;)if(b.isHeader(e,r)){var a=b.appendFrame(this._audioTrack,e,r,s,n);if(!a)break;r+=a.length,n++}else r++},R.prototype._parseID3PES=function(t){this._id3Track.samples.push(t)},R}(),k=function(){function r(t,e,i){(function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,r),this.observer=t,this.config=i,this.remuxer=e}return r.prototype.resetInitSegment=function(t,e,i,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:e,duration:n,inputTimeScale:9e4}},r.prototype.resetTimeStamp=function(){},r.probe=function(t){var e,i,n=p.a.getID3Data(t,0);if(n&&void 0!==p.a.getTimeStamp(n))for(e=n.length,i=Math.min(t.length-1,e+100);e<i;e++)if(b.probe(t,e))return it.b.log("MPEG Audio sync word found !"),!0;return!1},r.prototype.append=function(t,e,i,n){for(var r=p.a.getID3Data(t,0),s=p.a.getTimeStamp(r),a=s?90*s:9e4*e,o=r.length,u=t.length,l=0,h=0,c=this._audioTrack,d=[{pts:a,dts:a,data:r}];o<u;)if(b.isHeader(t,o)){var f=b.appendFrame(c,t,o,a,l);if(!f)break;o+=f.length,h=f.sample.pts,l++}else p.a.isHeader(t,o)?(r=p.a.getID3Data(t,o),d.push({pts:h,dts:h,data:r}),o+=r.length):o++;this.remuxer.remux(c,{samples:[]},{samples:d,inputTimeScale:9e4},{samples:[]},e,i,n)},r.prototype.destroy=function(){},r}(),z=function(){function t(){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.getSilentFrame=function(t,e){switch(t){case"mp4a.40.2":if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},t}(),u=Math.pow(2,32)-1,nt=function(){function d(){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d)}return d.init=function(){d.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t;for(t in d.types)d.types.hasOwnProperty(t)&&(d.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);d.HDLR_TYPES={video:e,audio:i};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);d.STTS=d.STSC=d.STCO=r,d.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),d.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),d.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),d.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);d.FTYP=d.box(d.types.ftyp,s,o,s,a),d.DINF=d.box(d.types.dinf,d.box(d.types.dref,n))},d.box=function(t){for(var e,i=Array.prototype.slice.call(arguments,1),n=8,r=i.length,s=r;r--;)n+=i[r].byteLength;for((e=new Uint8Array(n))[0]=n>>24&255,e[1]=n>>16&255,e[2]=n>>8&255,e[3]=255&n,e.set(t,4),r=0,n=8;r<s;r++)e.set(i[r],n),n+=i[r].byteLength;return e},d.hdlr=function(t){return d.box(d.types.hdlr,d.HDLR_TYPES[t])},d.mdat=function(t){return d.box(d.types.mdat,t)},d.mdhd=function(t,e){e*=t;var i=Math.floor(e/(u+1)),n=Math.floor(e%(u+1));return d.box(d.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},d.mdia=function(t){return d.box(d.types.mdia,d.mdhd(t.timescale,t.duration),d.hdlr(t.type),d.minf(t))},d.mfhd=function(t){return d.box(d.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},d.minf=function(t){return"audio"===t.type?d.box(d.types.minf,d.box(d.types.smhd,d.SMHD),d.DINF,d.stbl(t)):d.box(d.types.minf,d.box(d.types.vmhd,d.VMHD),d.DINF,d.stbl(t))},d.moof=function(t,e,i){return d.box(d.types.moof,d.mfhd(t),d.traf(i,e))},d.moov=function(t){for(var e=t.length,i=[];e--;)i[e]=d.trak(t[e]);return d.box.apply(null,[d.types.moov,d.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(d.mvex(t)))},d.mvex=function(t){for(var e=t.length,i=[];e--;)i[e]=d.trex(t[e]);return d.box.apply(null,[d.types.mvex].concat(i))},d.mvhd=function(t,e){e*=t;var i=Math.floor(e/(u+1)),n=Math.floor(e%(u+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return d.box(d.types.mvhd,r)},d.sdtp=function(t){var e,i,n=t.samples||[],r=new Uint8Array(4+n.length);for(i=0;i<n.length;i++)e=n[i].flags,r[i+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return d.box(d.types.sdtp,r)},d.stbl=function(t){return d.box(d.types.stbl,d.stsd(t),d.box(d.types.stts,d.STTS),d.box(d.types.stsc,d.STSC),d.box(d.types.stsz,d.STSZ),d.box(d.types.stco,d.STCO))},d.avc1=function(t){var e,i,n,r=[],s=[];for(e=0;e<t.sps.length;e++)n=(i=t.sps[e]).byteLength,r.push(n>>>8&255),r.push(255&n),r=r.concat(Array.prototype.slice.call(i));for(e=0;e<t.pps.length;e++)n=(i=t.pps[e]).byteLength,s.push(n>>>8&255),s.push(255&n),s=s.concat(Array.prototype.slice.call(i));var a=d.box(d.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|t.sps.length].concat(r).concat([t.pps.length]).concat(s))),o=t.width,u=t.height,l=t.pixelRatio[0],h=t.pixelRatio[1];return d.box(d.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,d.box(d.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),d.box(d.types.pasp,new Uint8Array([l>>24,l>>16&255,l>>8&255,255&l,h>>24,h>>16&255,h>>8&255,255&h])))},d.esds=function(t){var e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))},d.mp4a=function(t){var e=t.samplerate;return d.box(d.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,e>>8&255,255&e,0,0]),d.box(d.types.esds,d.esds(t)))},d.mp3=function(t){var e=t.samplerate;return d.box(d.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,e>>8&255,255&e,0,0]))},d.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?d.box(d.types.stsd,d.STSD,d.mp4a(t)):d.box(d.types.stsd,d.STSD,d.mp3(t)):d.box(d.types.stsd,d.STSD,d.avc1(t))},d.tkhd=function(t){var e=t.id,i=t.duration*t.timescale,n=t.width,r=t.height,s=Math.floor(i/(u+1)),a=Math.floor(i%(u+1));return d.box(d.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,r>>8&255,255&r,0,0]))},d.traf=function(t,e){var i=d.sdtp(t),n=t.id,r=Math.floor(e/(u+1)),s=Math.floor(e%(u+1));return d.box(d.types.traf,d.box(d.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),d.box(d.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s])),d.trun(t,i.length+16+20+8+16+8+8),i)},d.trak=function(t){return t.duration=t.duration||4294967295,d.box(d.types.trak,d.tkhd(t),d.mdia(t))},d.trex=function(t){var e=t.id;return d.box(d.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},d.trun=function(t,e){var i,n,r,s,a,o,u=t.samples||[],l=u.length,h=12+16*l,c=new Uint8Array(h);for(e+=8+h,c.set([0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,255&l,e>>>24&255,e>>>16&255,e>>>8&255,255&e],0),i=0;i<l;i++)r=(n=u[i]).duration,s=n.size,a=n.flags,o=n.cts,c.set([r>>>24&255,r>>>16&255,r>>>8&255,255&r,s>>>24&255,s>>>16&255,s>>>8&255,255&s,a.isLeading<<2|a.dependsOn,a.isDependedOn<<6|a.hasRedundancy<<4|a.paddingValue<<1|a.isNonSync,61440&a.degradPrio,15&a.degradPrio,o>>>24&255,o>>>16&255,o>>>8&255,255&o],12+16*i);return d.box(d.types.trun,c)},d.initSegment=function(t){d.types||d.init();var e,i=d.moov(t);return(e=new Uint8Array(d.FTYP.byteLength+i.byteLength)).set(d.FTYP),e.set(i,d.FTYP.byteLength),e},d}(),N=function(){function a(t,e,i,n){(function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,a),this.observer=t,this.config=e,this.typeSupported=i;var r=navigator.userAgent;this.isSafari=n&&-1<n.indexOf("Apple")&&r&&!r.match("CriOS"),this.ISGenerated=!1}return a.prototype.destroy=function(){},a.prototype.resetTimeStamp=function(t){this._initPTS=this._initDTS=t},a.prototype.resetInitSegment=function(){this.ISGenerated=!1},a.prototype.remux=function(t,e,i,n,r,s,a){if(this.ISGenerated||this.generateIS(t,e,r),this.ISGenerated){var o=t.samples.length,u=e.samples.length,l=r,h=r;if(o&&u){var c=(t.samples[0].dts-e.samples[0].dts)/e.inputTimeScale;l+=Math.max(0,c),h+=Math.max(0,-c)}if(o){t.timescale||(it.b.warn("regenerate InitSegment as audio detected"),this.generateIS(t,e,r));var d=this.remuxAudio(t,l,s,a);if(u){var f=void 0;d&&(f=d.endPTS-d.startPTS),e.timescale||(it.b.warn("regenerate InitSegment as video detected"),this.generateIS(t,e,r)),this.remuxVideo(e,h,s,f,a)}}else{var p=void 0;u&&(p=this.remuxVideo(e,h,s,a)),p&&t.codec&&this.remuxEmptyAudio(t,l,s,p)}}i.samples.length&&this.remuxID3(i,r),n.samples.length&&this.remuxText(n,r),this.observer.trigger(tt.a.FRAG_PARSED)},a.prototype.generateIS=function(t,e,i){var n,r,s=this.observer,a=t.samples,o=e.samples,u=this.typeSupported,l="audio/mp4",h={},c={tracks:h},d=void 0===this._initPTS;if(d&&(n=r=1/0),t.config&&a.length&&(t.timescale=t.samplerate,it.b.log("audio sampling rate : "+t.samplerate),t.isAAC||(u.mpeg?(l="audio/mpeg",t.codec=""):u.mp3&&(t.codec="mp3")),h.audio={container:l,codec:t.codec,initSegment:!t.isAAC&&u.mpeg?new Uint8Array:nt.initSegment([t]),metadata:{channelCount:t.channelCount}},d&&(n=r=a[0].pts-t.inputTimeScale*i)),e.sps&&e.pps&&o.length){var f=e.inputTimeScale;e.timescale=f,h.video={container:"video/mp4",codec:e.codec,initSegment:nt.initSegment([e]),metadata:{width:e.width,height:e.height}},d&&(n=Math.min(n,o[0].pts-f*i),r=Math.min(r,o[0].dts-f*i),this.observer.trigger(tt.a.INIT_PTS_FOUND,{initPTS:n}))}Object.keys(h).length?(s.trigger(tt.a.FRAG_PARSING_INIT_SEGMENT,c),this.ISGenerated=!0,d&&(this._initPTS=n,this._initDTS=r)):s.trigger(tt.a.ERROR,{type:et.b.MEDIA_ERROR,details:et.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},a.prototype.remuxVideo=function(t,e,i,n,r){var s,a,o,u,l,h,c,d=8,f=t.timescale,p=t.samples,m=[],g=p.length,v=this._PTSNormalize,y=this._initDTS,_=this.nextAvcDts,E=this.isSafari;E&&(i|=p.length&&_&&(r&&Math.abs(e-_/f)<.1||Math.abs(p[0].pts-_-y)<f/5)),i||(_=e*f),p.forEach(function(t){t.pts=v(t.pts-y,_),t.dts=v(t.dts-y,_)}),p.sort(function(t,e){var i=t.dts-e.dts,n=t.pts-e.pts;return i||n||t.id-e.id});var b=p.reduce(function(t,e){return Math.max(Math.min(t,e.pts-e.dts),-18e3)},0);if(b<0){it.b.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(b/90)+" ms to overcome this issue");for(var T=0;T<p.length;T++)p[T].dts+=b}var S=p[0];l=Math.max(S.dts,0),u=Math.max(S.pts,0);var w=Math.round((l-_)/90);i&&w&&(1<w?it.b.log("AVC:"+w+" ms hole between fragments detected,filling it"):w<-1&&it.b.log("AVC:"+-w+" ms overlapping between fragments detected"),l=_,p[0].dts=l,u=Math.max(u-w,_),p[0].pts=u,it.b.log("Video/PTS/DTS adjusted: "+Math.round(u/90)+"/"+Math.round(l/90)+",delta:"+w+" ms")),S=p[p.length-1],c=Math.max(S.dts,0),h=Math.max(S.pts,0,c),E&&(s=Math.round((c-l)/(p.length-1)));for(var C=0,A=0,k=0;k<g;k++){for(var N=p[k],x=N.units,M=x.length,R=0,D=0;D<M;D++)R+=x[D].data.length;A+=R,C+=M,N.length=R,N.dts=E?l+k*s:Math.max(N.dts,l),N.pts=Math.max(N.pts,N.dts)}var L=A+4*C+8;try{a=new Uint8Array(L)}catch(t){return void this.observer.trigger(tt.a.ERROR,{type:et.b.MUX_ERROR,details:et.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:L,reason:"fail allocating video mdat "+L})}var I=new DataView(a.buffer);I.setUint32(0,L),a.set(nt.types.mdat,4);for(var O=0;O<g;O++){for(var P=p[O],B=P.units,F=0,U=void 0,V=0,H=B.length;V<H;V++){var G=B[V],j=G.data,q=G.data.byteLength;I.setUint32(d,q),d+=4,a.set(j,d),d+=q,F+=4+q}if(E)U=Math.max(0,s*Math.round((P.pts-P.dts)/s));else{if(O<g-1)s=p[O+1].dts-P.dts;else{var z=this.config,W=P.dts-p[0<O?O-1:O].dts;if(z.stretchShortVideoTrack){var Y=z.maxBufferHole,K=z.maxSeekHole,X=Math.floor(Math.min(Y,K)*f),Q=(n?u+n*f:this.nextAudioPts)-P.pts;X<Q?((s=Q-W)<0&&(s=W),it.b.log("It is approximately "+Q/90+" ms to the next segment; using duration "+s/90+" ms for the last video frame.")):s=W}else s=W}U=Math.round(P.pts-P.dts)}m.push({size:F,duration:s,cts:U,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:P.key?2:1,isNonSync:P.key?0:1}})}this.nextAvcDts=c+s;var J=t.dropped;if(t.len=0,t.nbNalu=0,t.dropped=0,m.length&&-1<navigator.userAgent.toLowerCase().indexOf("chrome")){var $=m[0].flags;$.dependsOn=2,$.isNonSync=0}t.samples=m,o=nt.moof(t.sequenceNumber++,l,t),t.samples=[];var Z={data1:o,data2:a,startPTS:u/f,endPTS:(h+s)/f,startDTS:l/f,endDTS:this.nextAvcDts/f,type:"video",nb:m.length,dropped:J};return this.observer.trigger(tt.a.FRAG_PARSING_DATA,Z),Z},a.prototype.remuxAudio=function(t,e,i,n){var r,s,a,o,u,l,h,c=t.inputTimeScale,d=t.timescale,f=c/d,p=(t.isAAC?1024:1152)*f,m=this._PTSNormalize,g=this._initDTS,v=!t.isAAC&&this.typeSupported.mpeg,y=t.samples,_=[],E=this.nextAudioPts;if(i|=y.length&&E&&(n&&Math.abs(e-E/c)<.1||Math.abs(y[0].pts-E-g)<20*p),y.forEach(function(t){t.pts=t.dts=m(t.pts-g,e*c)}),0!==(y=y.filter(function(t){return 0<=t.pts})).length){if(i||(E=n?e*c:y[0].pts),t.isAAC)for(var b=this.config.maxAudioFramesDrift,T=0,S=E;T<y.length;){var w,C=y[T];w=C.pts-S;var A=Math.abs(1e3*w/c);if(w<=-b*p)it.b.warn("Dropping 1 audio frame @ "+(S/c).toFixed(3)+"s due to "+Math.round(A)+" ms overlap."),y.splice(T,1),t.len-=C.unit.length;else if(b*p<=w&&A<1e4&&S){var k=Math.round(w/p);it.b.warn("Injecting "+k+" audio frame @ "+(S/c).toFixed(3)+"s due to "+Math.round(1e3*w/c)+" ms gap.");for(var N=0;N<k;N++){var x=Math.max(S,0);(a=z.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(it.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),a=C.unit.subarray()),y.splice(T,0,{unit:a,pts:x,dts:x}),t.len+=a.length,S+=p,T++}C.pts=C.dts=S,S+=p,T++}else Math.abs(w),C.pts=C.dts=S,S+=p,T++}for(var M=0,R=y.length;M<R;M++){var D=y[M],L=D.unit,I=D.pts;if(void 0!==h)s.duration=Math.round((I-h)/f);else{var O=Math.round(1e3*(I-E)/c),P=0;if(i&&t.isAAC&&O){if(0<O&&O<1e4)P=Math.round((I-E)/p),it.b.log(O+" ms hole between AAC samples detected,filling it"),0<P&&((a=z.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(a=L.subarray()),t.len+=P*a.length);else if(O<-12){it.b.log("drop overlapping AAC sample, expected/parsed/delta:"+(E/c).toFixed(3)+"s/"+(I/c).toFixed(3)+"s/"+-O+"ms"),t.len-=L.byteLength;continue}I=E}if(l=I,!(0<t.len))return;var B=v?t.len:t.len+8;r=v?0:8;try{o=new Uint8Array(B)}catch(t){return void this.observer.trigger(tt.a.ERROR,{type:et.b.MUX_ERROR,details:et.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:B,reason:"fail allocating audio mdat "+B})}v||(new DataView(o.buffer).setUint32(0,B),o.set(nt.types.mdat,4));for(var F=0;F<P;F++)(a=z.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(it.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),a=L.subarray()),o.set(a,r),r+=a.byteLength,s={size:a.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},_.push(s)}o.set(L,r);var U=L.byteLength;r+=U,s={size:U,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},_.push(s),h=I}var V=0,H=_.length;if(2<=H&&(V=_[H-2].duration,s.duration=V),H){this.nextAudioPts=E=h+f*V,t.len=0,t.samples=_,u=v?new Uint8Array:nt.moof(t.sequenceNumber++,l/f,t),t.samples=[];var G=l/c,j=E/c,q={data1:u,data2:o,startPTS:G,endPTS:j,startDTS:G,endDTS:j,type:"audio",nb:H};return this.observer.trigger(tt.a.FRAG_PARSING_DATA,q),q}return null}},a.prototype.remuxEmptyAudio=function(t,e,i,n){var r=t.inputTimeScale,s=r/(t.samplerate?t.samplerate:r),a=this.nextAudioPts,o=(void 0!==a?a:n.startDTS*r)+this._initDTS,u=n.endDTS*r+this._initDTS,l=1024*s,h=Math.ceil((u-o)/l),c=z.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(it.b.warn("remux empty Audio"),c){for(var d=[],f=0;f<h;f++){var p=o+f*l;d.push({unit:c,pts:p,dts:p}),t.len+=c.length}t.samples=d,this.remuxAudio(t,e,i)}else it.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},a.prototype.remuxID3=function(t,e){var i,n=t.samples.length,r=t.inputTimeScale,s=this._initPTS,a=this._initDTS;if(n){for(var o=0;o<n;o++)(i=t.samples[o]).pts=(i.pts-s)/r,i.dts=(i.dts-a)/r;this.observer.trigger(tt.a.FRAG_PARSING_METADATA,{samples:t.samples})}t.samples=[],e=e},a.prototype.remuxText=function(t,e){t.samples.sort(function(t,e){return t.pts-e.pts});var i,n=t.samples.length,r=t.inputTimeScale,s=this._initPTS;if(n){for(var a=0;a<n;a++)(i=t.samples[a]).pts=(i.pts-s)/r;this.observer.trigger(tt.a.FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[],e=e},a.prototype._PTSNormalize=function(t,e){var i;if(void 0===e)return t;for(i=e<t?-8589934592:8589934592;4294967296<Math.abs(t-e);)t+=i;return t},a}(),x=function(){function e(t){(function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),this.observer=t}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(){},e.prototype.resetInitSegment=function(){},e.prototype.remux=function(t,e,i,n,r,s,a,o){var u=this.observer,l="";t&&(l+="audio"),e&&(l+="video"),u.trigger(tt.a.FRAG_PARSING_DATA,{data1:o,startPTS:r,startDTS:r,type:l,nb:1,dropped:0}),u.trigger(tt.a.FRAG_PARSED)},e}(),l=function(){function s(t,e,i,n){(function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,s),this.observer=t,this.typeSupported=e,this.config=i,this.vendor=n}return s.prototype.destroy=function(){var t=this.demuxer;t&&t.destroy()},s.prototype.push=function(t,i,n,r,s,a,o,u,l,h,c,d){if(0<t.byteLength&&null!=i&&null!=i.key&&"AES-128"===i.method){var e=this.decrypter;null==e&&(e=this.decrypter=new m.a(this.observer,this.config));var f,p=this;try{f=performance.now()}catch(t){f=Date.now()}e.decrypt(t,i.key.buffer,i.iv.buffer,function(t){var e;try{e=performance.now()}catch(t){e=Date.now()}p.observer.trigger(tt.a.FRAG_DECRYPTED,{stats:{tstart:f,tdecrypt:e}}),p.pushDecrypted(new Uint8Array(t),i,new Uint8Array(n),r,s,a,o,u,l,h,c,d)})}else this.pushDecrypted(new Uint8Array(t),i,new Uint8Array(n),r,s,a,o,u,l,h,c,d)},s.prototype.pushDecrypted=function(t,e,i,n,r,s,a,o,u,l,h,c){var d=this.demuxer;if(!d||a&&!this.probe(t)){for(var f=this.observer,p=this.typeSupported,m=this.config,g=[{demux:A,remux:N},{demux:w,remux:x},{demux:S,remux:N},{demux:k,remux:N}],v=0,y=g.length;v<y;v++){var _=g[v],E=_.demux.probe;if(E(t)){var b=this.remuxer=new _.remux(f,m,p,this.vendor);d=new _.demux(f,b,m,p),this.probe=E;break}}if(!d)return void f.trigger(tt.a.ERROR,{type:et.b.MEDIA_ERROR,details:et.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=d}var T=this.remuxer;(a||o)&&(d.resetInitSegment(i,n,r,l),T.resetInitSegment()),a&&(d.resetTimeStamp(c),T.resetTimeStamp(c)),"function"==typeof d.setDecryptData&&d.setDecryptData(e),d.append(t,s,u,h)},s}();e.a=l},function(t,e,i){"use strict";function h(t,e){return MediaSource.isTypeSupported((e||"video")+'/mp4;codecs="'+t+'"')}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)return null;for(var i=null,n=0;n<t.length;n++){var r=t[n];r.id===e&&(i=r)}return i}function a(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}function f(t,e,i){var n=t[e],r=t[i],s=r.startPTS;isNaN(s)?r.start=e<i?n.start+n.duration:Math.max(n.start-r.duration,0):e<i?(n.duration=s-n.start,n.duration<0&&P.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(r.duration=n.start-s,r.duration<0&&P.b.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!"))}function p(t,e,i,n,r,s){var a=i;if(!isNaN(e.startPTS)){var o=Math.abs(e.startPTS-i);isNaN(e.deltaPTS)?e.deltaPTS=o:e.deltaPTS=Math.max(o,e.deltaPTS),a=Math.max(i,e.startPTS),i=Math.min(i,e.startPTS),n=Math.max(n,e.endPTS),r=Math.min(r,e.startDTS),s=Math.max(s,e.endDTS)}var u=i-e.start;e.start=e.startPTS=i,e.maxStartPTS=a,e.endPTS=n,e.startDTS=r,e.endDTS=s,e.duration=n-i;var l,h,c,d=e.sn;if(!t||d<t.startSN||d>t.endSN)return 0;for(l=d-t.startSN,(h=t.fragments)[l]=e,c=l;0<c;c--)f(h,c,c-1);for(c=l;c<h.length-1;c++)f(h,c,c+1);return t.PTSKnown=!0,u}function l(t,e){var i,n=Math.max(t.startSN,e.startSN)-e.startSN,r=Math.min(t.endSN,e.endSN)-e.startSN,s=e.startSN-t.startSN,a=t.fragments,o=e.fragments,u=0;if(r<n)e.PTSKnown=!1;else{for(var l=n;l<=r;l++){var h=a[s+l],c=o[l];c&&h&&(u=h.cc-c.cc,isNaN(h.startPTS)||(c.start=c.startPTS=h.startPTS,c.endPTS=h.endPTS,c.duration=h.duration,c.backtracked=h.backtracked,c.dropped=h.dropped,i=c))}if(u)for(P.b.log("discontinuity sliding from playlist, take drift into account"),l=0;l<o.length;l++)o[l].cc+=u;if(i)p(e,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS);else if(0<=s&&s<a.length){var d=a[s].start;for(l=0;l<o.length;l++)o[l].start+=d}e.PTSKnown=t.PTSKnown}}function u(i,t){t.fragments.forEach(function(t){if(t){var e=t.start+i;t.start=t.startPTS=e,t.endPTS=e+t.duration}}),t.PTSKnown=!0}function d(t,e,i){if(function a(t,e,i){var n=!1;return e&&e.details&&i&&(i.endCC>i.startCC||t&&t.cc<i.startCC)&&(n=!0),n}(t,e,i)){var n=function o(t,e){var i=t.fragments,n=e.fragments;if(n.length&&i.length){var r=function s(t,e){for(var i=null,n=0;n<t.length;n+=1){var r=t[n];if(r&&r.cc===e){i=r;break}}return i}(i,n[0].cc);return!r||r&&!r.startPTS?void P.b.log("No frag in previous level to align on"):r}P.b.log("No fragments to align")}(e.details,i);n&&(P.b.log("Adjusting PTS using last level due to CC increase within current level"),u(n.start,i))}if(!1===i.PTSKnown&&e&&e.details){var r=e.details.programDateTime,s=(i.programDateTime-r)/1e3+e.details.fragments[0].start;isNaN(s)||(P.b.log("adjusting PTS using programDateTime delta, sliding:"+s.toFixed(3)),u(s,i))}}function n(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new zt,this.regionList=[]}function o(){this.values=Object.create(null)}function m(t,e,i,n){var r=n?t.split(n):[t];for(var s in r)if("string"==typeof r[s]){var a=r[s].split(i);if(2===a.length){e(a[0],a[1])}}}function g(e,t,a){function i(){var t=function n(t){function e(t,e,i,n){return 3600*(0|t)+60*(0|e)+(0|i)+(0|n)/1e3}var i=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?e(i[1],i[2],i[3].replace(":",""),i[4]):59<i[1]?e(i[1],i[2],0,i[4]):e(0,i[1],i[2],i[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function n(){e=e.replace(/^\s+/,"")}var r=e;if(n(),t.startTime=i(),n(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),n(),t.endTime=i(),n(),function(t,e){var s=new o;m(t,function(t,e){switch(t){case"region":for(var i=a.length-1;0<=i;i--)if(a[i].id===e){s.set(t,a[i].region);break}break;case"vertical":s.alt(t,e,["rl","lr"]);break;case"line":var n=e.split(","),r=n[0];s.integer(t,r),s.percent(t,r)&&s.set("snapToLines",!1),s.alt(t,r,["auto"]),2===n.length&&s.alt("lineAlign",n[1],["start",Yt,"end"]);break;case"position":n=e.split(","),s.percent(t,n[0]),2===n.length&&s.alt("positionAlign",n[1],["start",Yt,"end","line-left","line-right","auto"]);break;case"size":s.percent(t,e);break;case"align":s.alt(t,e,["start",Yt,"end","left","right"])}},/:/,/\s/),e.region=s.get("region",null),e.vertical=s.get("vertical","");var i=s.get("line","auto");"auto"===i&&-1===Wt.line&&(i=-1),e.line=i,e.lineAlign=s.get("lineAlign","start"),e.snapToLines=s.get("snapToLines",!0),e.size=s.get("size",100),e.align=s.get("align",Yt);var n=s.get("position","auto");"auto"===n&&50===Wt.position&&(n="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=n}(e,t)}function v(t){return t.replace(/<br(?: \/)?>/gi,"\n")}function r(t,e,i,n){for(var r,s,a,o,u,l=window.VTTCue||window.TextTrackCue,h=0;h<n.rows.length;h++)if(a=!0,o=0,u="",!(r=n.rows[h]).isEmpty()){for(var c=0;c<r.chars.length;c++)r.chars[c].uchar.match(/\s/)&&a?o++:(u+=r.chars[c].uchar,a=!1);(r.cueStartTime=e)===i&&(i+=1e-4),s=new l(e,i,v(u.trim())),16<=o?o--:o++,navigator.userAgent.match(/Firefox\//)?s.line=h+1:s.line=7<h?h-2:h+1,s.align="left",s.position=Math.max(0,Math.min(100,o/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),t.addCue(s)}}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t){if(t&&t.cues)for(;0<t.cues.length;)t.removeCue(t.cues[0])}function E(t){for(var e=[],i=0;i<t.length;i++)"subtitles"===t[i].kind&&e.push(t[i]);return e}Object.defineProperty(e,"__esModule",{value:!0});var b={};i.d(b,"newCue",function(){return r});var T=i(6),S=i.n(T),I=i(1),O=i(2),P=i(0),w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C=function(){function s(t){(function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,s),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var e=arguments.length,i=Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];this.handledEvents=i,this.useGenericHandler=!0,this.registerListeners()}return s.prototype.destroy=function(){this.unregisterListeners()},s.prototype.isEventHandler=function(){return"object"===w(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent},s.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){if("hlsEventGeneric"===t)throw new Error("Forbidden event name: "+t);this.hls.on(t,this.onEvent)},this)},s.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){this.hls.off(t,this.onEvent)},this)},s.prototype.onEvent=function(t,e){this.onEventGeneric(t,e)},s.prototype.onEventGeneric=function(t,e){try{(function(t,e){var i="on"+t.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,e)}).call(this,t,e).call()}catch(e){P.b.error("internal error happened while processing "+t+":"+e.message),this.hls.trigger(I.a.ERROR,{type:O.b.OTHER_ERROR,details:O.a.INTERNAL_EXCEPTION,fatal:!1,event:t,err:e})}},s}(),A=/^(\d+)x(\d+)$/,k=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,N=function(){function n(t){(function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,n),"string"==typeof t&&(t=n.parseAttrList(t));for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e])}return n.prototype.decimalInteger=function(t){var e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e},n.prototype.hexadecimalInteger=function(t){if(this[t]){var e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;for(var i=new Uint8Array(e.length/2),n=0;n<e.length/2;n++)i[n]=parseInt(e.slice(2*n,2*n+2),16);return i}return null},n.prototype.hexadecimalIntegerAsNumber=function(t){var e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e},n.prototype.decimalFloatingPoint=function(t){return parseFloat(this[t])},n.prototype.enumeratedString=function(t){return this[t]},n.prototype.decimalResolution=function(t){var e=A.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},n.parseAttrList=function(t){var e,i={};for(k.lastIndex=0;null!==(e=k.exec(t));){var n=e[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),i[e[1]]=n}return i},n}(),x={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}},M=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),R=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,D=/#EXT-X-MEDIA:(.*)/g,L=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),B=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,F=function(){function t(){s(this,t),this.method=null,this.key=null,this.iv=null,this._uri=null}return M(t,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=S.a.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),t}(),U=function(){function t(){s(this,t),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return t.prototype.createInitializationVector=function(t){for(var e=new Uint8Array(16),i=12;i<16;i++)e[i]=t>>8*(15-i)&255;return e},t.prototype.fragmentDecryptdataFromLevelkey=function(t,e){var i=t;return t&&t.method&&t.uri&&!t.iv&&((i=new F).method=t.method,i.baseuri=t.baseuri,i.reluri=t.reluri,i.iv=this.createInitializationVector(e)),i},t.prototype.cloneObj=function(t){return JSON.parse(JSON.stringify(t))},M(t,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=S.a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(t){this._url=t}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var t=this._byteRange=[];if(this.rawByteRange){var e=this.rawByteRange.split("@",2);if(1===e.length){var i=this.lastByteRangeEndOffset;t[0]=i||0}else t[0]=parseInt(e[1]);t[1]=parseInt(e[0])+t[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),t}(),V=function(n){function r(t){s(this,r);var e=function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,n.call(this,t,I.a.MANIFEST_LOADING,I.a.LEVEL_LOADING,I.a.AUDIO_TRACK_LOADING,I.a.SUBTITLE_TRACK_LOADING));return e.loaders={},e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,n),r.prototype.destroy=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy()}this.loaders={},C.prototype.destroy.call(this)},r.prototype.onManifestLoading=function(t){this.load(t.url,{type:"manifest"})},r.prototype.onLevelLoading=function(t){this.load(t.url,{type:"level",level:t.level,id:t.id})},r.prototype.onAudioTrackLoading=function(t){this.load(t.url,{type:"audioTrack",id:t.id})},r.prototype.onSubtitleTrackLoading=function(t){this.load(t.url,{type:"subtitleTrack",id:t.id})},r.prototype.load=function(t,e){var i=this.loaders[e.type];if(void 0!==i){var n=i.context;if(n&&n.url===t)return void P.b.trace("playlist request ongoing");P.b.warn("abort previous loader for type:"+e.type),i.abort()}var r=this.hls.config,s=void 0,a=void 0,o=void 0,u=void 0;"manifest"===e.type?(s=r.manifestLoadingMaxRetry,a=r.manifestLoadingTimeOut,o=r.manifestLoadingRetryDelay,u=r.manifestLoadingMaxRetryTimeout):"level"===e.type?(s=0,a=r.levelLoadingTimeOut):(s=r.levelLoadingMaxRetry,a=r.levelLoadingTimeOut,o=r.levelLoadingRetryDelay,u=r.levelLoadingMaxRetryTimeout,P.b.log("loading playlist for "+e.type+" "+(e.level||e.id))),i=this.loaders[e.type]=e.loader=void 0!==r.pLoader?new r.pLoader(r):new r.loader(r),e.url=t,e.responseType="";var l,h;l={timeout:a,maxRetry:s,retryDelay:o,maxRetryDelay:u},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},i.load(e,l,h)},r.prototype.resolve=function(t,e){return S.a.buildAbsoluteURL(e,t,{alwaysNormalize:!0})},r.prototype.parseMasterPlaylist=function(t,e){var i=[],n=void 0;for(R.lastIndex=0;null!=(n=R.exec(t));){var r={},s=r.attrs=new N(n[1]);r.url=this.resolve(n[2],e);var a=s.decimalResolution("RESOLUTION");a&&(r.width=a.width,r.height=a.height),r.bitrate=s.decimalInteger("AVERAGE-BANDWIDTH")||s.decimalInteger("BANDWIDTH"),r.name=s.NAME,function(i,r){["video","audio"].forEach(function(n){var e=i.filter(function(t){return e=t,!!(i=x[n])&&!0===i[e.slice(0,4)];var e,i});if(e.length){var t=e.filter(function(t){return 0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0)});r[n+"Codec"]=0<t.length?t[0]:e[0],i=i.filter(function(t){return-1===e.indexOf(t)})}}),r.unknownCodecs=i}([].concat((s.CODECS||"").split(/[ ,]+/)),r),r.videoCodec&&-1!==r.videoCodec.indexOf("avc1")&&(r.videoCodec=this.avc1toavcoti(r.videoCodec)),i.push(r)}return i},r.prototype.parseMasterPlaylistMedia=function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],r=void 0,s=[],a=0;for(D.lastIndex=0;null!==(r=D.exec(t));){var o={},u=new N(r[1]);if(u.TYPE===i){if(o.groupId=u["GROUP-ID"],o.name=u.NAME,o.type=i,o["default"]="YES"===u.DEFAULT,o.autoselect="YES"===u.AUTOSELECT,o.forced="YES"===u.FORCED,u.URI&&(o.url=this.resolve(u.URI,e)),o.lang=u.LANGUAGE,o.name||(o.name=o.lang),n.length){var l=c(n,o.groupId);o.audioCodec=l?l.codec:n[0].codec}o.id=a++,s.push(o)}}return s},r.prototype.avc1toavcoti=function(t){var e,i=t.split(".");return 2<i.length?(e=i.shift()+".",e+=parseInt(i.shift()).toString(16),e+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):e=t,e},r.prototype.parseLevelPlaylist=function(t,e,i,n){var r,s,a=0,o=0,u={type:null,version:null,url:e,fragments:[],live:!0,startSN:0},l=new F,h=0,c=null,d=new U;for(L.lastIndex=0;null!==(r=L.exec(t));){var f=r[1];if(f){d.duration=parseFloat(f);var p=(" "+r[2]).slice(1);d.title=p||null,d.tagList.push(p?["INF",f,p]:["INF",f])}else if(r[3]){if(!isNaN(d.duration)){var m=a++;d.type=n,d.start=o,d.levelkey=l,d.sn=m,d.level=i,d.cc=h,d.baseurl=e,d.relurl=(" "+r[3]).slice(1),u.fragments.push(d),o+=(c=d).duration,d=new U}}else if(r[4]){if(d.rawByteRange=(" "+r[4]).slice(1),c){var g=c.byteRangeEndOffset;g&&(d.lastByteRangeEndOffset=g)}}else if(r[5])d.rawProgramDateTime=(" "+r[5]).slice(1),d.tagList.push(["PROGRAM-DATE-TIME",d.rawProgramDateTime]),void 0===u.programDateTime&&(u.programDateTime=new Date(new Date(Date.parse(r[5]))-1e3*o));else{for(r=r[0].match(B),s=1;s<r.length&&void 0===r[s];s++);var v=(" "+r[s+1]).slice(1),y=(" "+r[s+2]).slice(1);switch(r[s]){case"#":d.tagList.push(y?[v,y]:[v]);break;case"PLAYLIST-TYPE":u.type=v.toUpperCase();break;case"MEDIA-SEQUENCE":a=u.startSN=parseInt(v);break;case"TARGETDURATION":u.targetduration=parseFloat(v);break;case"VERSION":u.version=parseInt(v);break;case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"DIS":h++,d.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":h=parseInt(v);break;case"KEY":var _=new N(v),E=_.enumeratedString("METHOD"),b=_.URI,T=_.hexadecimalInteger("IV");E&&(l=new F,b&&0<=["AES-128","SAMPLE-AES"].indexOf(E)&&(l.method=E,l.baseuri=e,l.reluri=b,l.key=null,l.iv=T));break;case"START":var S=new N(v).decimalFloatingPoint("TIME-OFFSET");isNaN(S)||(u.startTimeOffset=S);break;case"MAP":var w=new N(v);d.relurl=w.URI,d.rawByteRange=w.BYTERANGE,d.baseurl=e,d.level=i,d.type=n,d.sn="initSegment",u.initSegment=d,d=new U;break;default:P.b.warn("line parsed but not handled: "+r)}}}return(d=c)&&!d.relurl&&(u.fragments.pop(),o-=d.duration),u.totalduration=o,u.averagetargetduration=o/u.fragments.length,u.endSN=a-1,u.startCC=u.fragments[0]?u.fragments[0].cc:0,u.endCC=h,u},r.prototype.loadsuccess=function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,r=t.data,s=t.url,a=i.type,o=i.id,u=i.level,l=this.hls;if((this.loaders[a]=void 0)!==s&&0!==s.indexOf("data:")||(s=i.url),e.tload=performance.now(),0===r.indexOf("#EXTM3U"))if(0<r.indexOf("#EXTINF:")){var h="audioTrack"!==a&&"subtitleTrack"!==a,c=isNaN(u)?isNaN(o)?0:o:u,d=this.parseLevelPlaylist(r,s,c,"audioTrack"===a?"audio":"subtitleTrack"===a?"subtitle":"main");d.tload=e.tload,"manifest"===a&&l.trigger(I.a.MANIFEST_LOADED,{levels:[{url:s,details:d}],audioTracks:[],url:s,stats:e,networkDetails:n}),e.tparsed=performance.now(),d.targetduration?h?l.trigger(I.a.LEVEL_LOADED,{details:d,level:u||0,id:o||0,stats:e,networkDetails:n}):"audioTrack"===a?l.trigger(I.a.AUDIO_TRACK_LOADED,{details:d,id:o,stats:e,networkDetails:n}):"subtitleTrack"===a&&l.trigger(I.a.SUBTITLE_TRACK_LOADED,{details:d,id:o,stats:e,networkDetails:n}):l.trigger(I.a.ERROR,{type:O.b.NETWORK_ERROR,details:O.a.MANIFEST_PARSING_ERROR,fatal:!0,url:s,reason:"invalid targetduration",networkDetails:n})}else{var f=this.parseMasterPlaylist(r,s);if(f.length){var p=f.map(function(t){return{id:t.attrs.AUDIO,codec:t.audioCodec}}),m=this.parseMasterPlaylistMedia(r,s,"AUDIO",p),g=this.parseMasterPlaylistMedia(r,s,"SUBTITLES");if(m.length){var v=!1;m.forEach(function(t){t.url||(v=!0)}),!1===v&&f[0].audioCodec&&!f[0].attrs.AUDIO&&(P.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),m.unshift({type:"main",name:"main"}))}l.trigger(I.a.MANIFEST_LOADED,{levels:f,audioTracks:m,subtitles:g,url:s,stats:e,networkDetails:n})}else l.trigger(I.a.ERROR,{type:O.b.NETWORK_ERROR,details:O.a.MANIFEST_PARSING_ERROR,fatal:!0,url:s,reason:"no level found in manifest",networkDetails:n})}else l.trigger(I.a.ERROR,{type:O.b.NETWORK_ERROR,details:O.a.MANIFEST_PARSING_ERROR,fatal:!0,url:s,reason:"no EXTM3U delimiter",networkDetails:n})},r.prototype.loaderror=function(t,e){var i,n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,s=e.loader;switch(e.type){case"manifest":i=O.a.MANIFEST_LOAD_ERROR,n=!0;break;case"level":i=O.a.LEVEL_LOAD_ERROR,n=!1;break;case"audioTrack":i=O.a.AUDIO_TRACK_LOAD_ERROR,n=!1}s&&(s.abort(),this.loaders[e.type]=void 0),this.hls.trigger(I.a.ERROR,{type:O.b.NETWORK_ERROR,details:i,fatal:n,url:s.url,loader:s,response:t,context:e,networkDetails:r})},r.prototype.loadtimeout=function(t,e){var i,n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,s=e.loader;switch(e.type){case"manifest":i=O.a.MANIFEST_LOAD_TIMEOUT,n=!0;break;case"level":i=O.a.LEVEL_LOAD_TIMEOUT,n=!1;break;case"audioTrack":i=O.a.AUDIO_TRACK_LOAD_TIMEOUT,n=!1}s&&(s.abort(),this.loaders[e.type]=void 0),this.hls.trigger(I.a.ERROR,{type:O.b.NETWORK_ERROR,details:i,fatal:n,url:s.url,loader:s,context:e,networkDetails:r})},r}(C),H=function(r){function s(t){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,I.a.FRAG_LOADING));return e.loaders={},e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.destroy=function(){var t=this.loaders;for(var e in t){var i=t[e];i&&i.destroy()}this.loaders={},C.prototype.destroy.call(this)},s.prototype.onFragLoading=function(t){var e=t.frag,i=e.type,n=this.loaders[i],r=this.hls.config;e.loaded=0,n&&(P.b.warn("abort previous fragment loader for type:"+i),n.abort()),n=this.loaders[i]=e.loader=void 0!==r.fLoader?new r.fLoader(r):new r.loader(r);var s,a,o=void 0;o={url:e.url,frag:e,responseType:"arraybuffer",progressData:!1};var u=e.byteRangeStartOffset,l=e.byteRangeEndOffset;isNaN(u)||isNaN(l)||(o.rangeStart=u,o.rangeEnd=l),s={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:r.fragLoadingMaxRetryTimeout},a={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},n.load(o,s,a)},s.prototype.loadsuccess=function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,r=t.data,s=i.frag;s.loader=void 0,this.loaders[s.type]=void 0,this.hls.trigger(I.a.FRAG_LOADED,{payload:r,frag:s,stats:e,networkDetails:n})},s.prototype.loaderror=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=e.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(I.a.ERROR,{type:O.b.NETWORK_ERROR,details:O.a.FRAG_LOAD_ERROR,fatal:!1,frag:e.frag,response:t,networkDetails:i})},s.prototype.loadtimeout=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=e.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(I.a.ERROR,{type:O.b.NETWORK_ERROR,details:O.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e.frag,networkDetails:i})},s.prototype.loadprogress=function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,r=e.frag;r.loaded=t.loaded,this.hls.trigger(I.a.FRAG_LOAD_PROGRESS,{frag:r,stats:t,networkDetails:n})},s}(C),G=function(r){function s(t){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,I.a.KEY_LOADING));return e.loaders={},e.decryptkey=null,e.decrypturl=null,e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.destroy=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy()}this.loaders={},C.prototype.destroy.call(this)},s.prototype.onKeyLoading=function(t){var e=t.frag,i=e.type,n=this.loaders[i],r=e.decryptdata,s=r.uri;if(s!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;n&&(P.b.warn("abort previous key loader for type:"+i),n.abort()),e.loader=this.loaders[i]=new a.loader(a),this.decrypturl=s,this.decryptkey=null;var o,u,l;o={url:s,frag:e,responseType:"arraybuffer"},u={timeout:a.fragLoadingTimeOut,maxRetry:a.fragLoadingMaxRetry,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},e.loader.load(o,u,l)}else this.decryptkey&&(r.key=this.decryptkey,this.hls.trigger(I.a.KEY_LOADED,{frag:e}))},s.prototype.loadsuccess=function(t,e,i){var n=i.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(t.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(I.a.KEY_LOADED,{frag:n})},s.prototype.loaderror=function(t,e){var i=e.frag,n=i.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(I.a.ERROR,{type:O.b.NETWORK_ERROR,details:O.a.KEY_LOAD_ERROR,fatal:!1,frag:i,response:t})},s.prototype.loadtimeout=function(t,e){var i=e.frag,n=i.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(I.a.ERROR,{type:O.b.NETWORK_ERROR,details:O.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},s}(C),j={search:function(t,e){for(var i=0,n=t.length-1,r=null,s=null;i<=n;){var a=e(s=t[r=(i+n)/2|0]);if(0<a)i=r+1;else{if(!(a<0))return s;n=r-1}}return null}},q={isBuffered:function(t,e){try{if(t)for(var i=t.buffered,n=0;n<i.length;n++)if(e>=i.start(n)&&e<=i.end(n))return!0}catch(t){}return!1},bufferInfo:function(t,e,i){try{if(t){var n,r=t.buffered,s=[];for(n=0;n<r.length;n++)s.push({start:r.start(n),end:r.end(n)});return this.bufferedInfo(s,e,i)}}catch(t){}return{len:0,start:e,end:e,nextStart:void 0}},bufferedInfo:function(t,e,i){var n,r,s,a,o,u=[];for(t.sort(function(t,e){return t.start-e.start||e.end-t.end}),o=0;o<t.length;o++){var l=u.length;if(l){var h=u[l-1].end;t[o].start-h<i?t[o].end>h&&(u[l-1].end=t[o].end):u.push(t[o])}else u.push(t[o])}for(n=o=0,r=s=e;o<u.length;o++){var c=u[o].start,d=u[o].end;if(c<=e+i&&e<d)r=c,n=(s=d)-e;else if(e+i<c){a=c;break}}return{len:n,start:r,end:s,nextStart:a}}},z=i(7),W=i(5),Y=i.n(W),K=i(9),X=i.n(K),Q=a(),J=function(){function l(i,t){(function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,l),this.hls=i,this.id=t;var r=this.observer=new Y.a,e=i.config;r.trigger=function(t){for(var e=arguments.length,i=Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];r.emit.apply(r,[t,t].concat(i))},r.off=function(t){for(var e=arguments.length,i=Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];r.removeListener.apply(r,[t].concat(i))};var n=function(t,e){(e=e||{}).frag=this.frag,e.id=this.id,i.trigger(t,e)}.bind(this);r.on(I.a.FRAG_DECRYPTED,n),r.on(I.a.FRAG_PARSING_INIT_SEGMENT,n),r.on(I.a.FRAG_PARSING_DATA,n),r.on(I.a.FRAG_PARSED,n),r.on(I.a.ERROR,n),r.on(I.a.FRAG_PARSING_METADATA,n),r.on(I.a.FRAG_PARSING_USERDATA,n),r.on(I.a.INIT_PTS_FOUND,n);var s={mp4:Q.isTypeSupported("video/mp4"),mpeg:Q.isTypeSupported("audio/mpeg"),mp3:Q.isTypeSupported('audio/mp4; codecs="mp3"')},a=navigator.vendor;if(e.enableWorker&&"undefined"!=typeof Worker){P.b.log("demuxing in webworker");var o=void 0;try{o=this.w=X()(10),this.onwmsg=this.onWorkerMessage.bind(this),o.addEventListener("message",this.onwmsg),o.onerror=function(t){i.trigger(I.a.ERROR,{type:O.b.OTHER_ERROR,details:O.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},o.postMessage({cmd:"init",typeSupported:s,vendor:a,id:t,config:JSON.stringify(e)})}catch(l){P.b.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),o&&URL.revokeObjectURL(o.objectURL),this.demuxer=new z.a(r,s,e,a),this.w=void 0}}else this.demuxer=new z.a(r,s,e,a)}return l.prototype.destroy=function(){var t=this.w;if(t)t.removeEventListener("message",this.onwmsg),t.terminate(),this.w=null;else{var e=this.demuxer;e&&(e.destroy(),this.demuxer=null)}var i=this.observer;i&&(i.removeAllListeners(),this.observer=null)},l.prototype.push=function(t,e,i,n,r,s,a,o){var u=this.w,l=isNaN(r.startDTS)?r.start:r.startDTS,h=r.decryptdata,c=this.frag,d=!(c&&r.cc===c.cc),f=!(c&&r.level===c.level),p=c&&r.sn===c.sn+1,m=!f&&p;if(d&&P.b.log(this.id+":discontinuity detected"),f&&P.b.log(this.id+":switch detected"),this.frag=r,u)u.postMessage({cmd:"demux",data:t,decryptdata:h,initSegment:e,audioCodec:i,videoCodec:n,timeOffset:l,discontinuity:d,trackSwitch:f,contiguous:m,duration:s,accurateTimeOffset:a,defaultInitPTS:o},t instanceof ArrayBuffer?[t]:[]);else{var g=this.demuxer;g&&g.push(t,h,e,i,n,l,d,f,m,s,a,o)}},l.prototype.onWorkerMessage=function(t){var e=t.data,i=this.hls;switch(e.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case I.a.FRAG_PARSING_DATA:e.data.data1=new Uint8Array(e.data1),e.data2&&(e.data.data2=new Uint8Array(e.data2));default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,i.trigger(e.event,e.data)}},l}(),$={toString:function(t){for(var e="",i=t.length,n=0;n<i;n++)e+="["+t.start(n).toFixed(3)+","+t.end(n).toFixed(3)+"]";return e}},Z=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),tt="STOPPED",et="IDLE",it="KEY_LOADING",nt="FRAG_LOADING",rt="FRAG_LOADING_WAITING_RETRY",st="WAITING_LEVEL",at="PARSING",ot="PARSED",ut="BUFFER_FLUSHING",lt="ENDED",ht="ERROR",ct=function(r){function s(t){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,I.a.MEDIA_ATTACHED,I.a.MEDIA_DETACHING,I.a.MANIFEST_LOADING,I.a.MANIFEST_PARSED,I.a.LEVEL_LOADED,I.a.KEY_LOADED,I.a.FRAG_LOADED,I.a.FRAG_LOAD_EMERGENCY_ABORTED,I.a.FRAG_PARSING_INIT_SEGMENT,I.a.FRAG_PARSING_DATA,I.a.FRAG_PARSED,I.a.ERROR,I.a.AUDIO_TRACK_SWITCHING,I.a.AUDIO_TRACK_SWITCHED,I.a.BUFFER_CREATED,I.a.BUFFER_APPENDED,I.a.BUFFER_FLUSHED));return e.config=t.config,e.audioCodecSwap=!1,e.ticks=0,e._state=tt,e.ontick=e.tick.bind(e),e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.destroy=function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),C.prototype.destroy.call(this),this.state=tt},s.prototype.startLoad=function(t){if(this.levels){var e=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=i.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=i.nextLoadLevel=n,this.loadedmetadata=!1}0<e&&-1===t&&(P.b.log("override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e),this.state=et,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this.forceStartLoad=!0,this.state=tt},s.prototype.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=tt,this.forceStartLoad=!1},s.prototype.tick=function(){1==++this.ticks&&(this.doTick(),1<this.ticks&&setTimeout(this.tick,1),this.ticks=0)},s.prototype.doTick=function(){switch(this.state){case ht:break;case ut:this.fragLoadError=0;break;case et:this._doTickIdle();break;case st:var t=this.levels[this.level];t&&t.details&&(this.state=et);break;case rt:var e=performance.now(),i=this.retryDate;(!i||i<=e||this.media&&this.media.seeking)&&(P.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=et)}this._checkBuffer(),this._checkFragmentChanged()},s.prototype._doTickIdle=function(){var t=this.hls,e=t.config,i=this.media;if(void 0!==this.levelLastLoaded&&(i||!this.startFragRequested&&e.startFragPrefetch)){var n;n=this.loadedmetadata?i.currentTime:this.nextLoadPosition;var r=t.nextLoadLevel,s=this.levels[r];if(s){var a=s.bitrate,o=void 0;o=a?Math.max(8*e.maxBufferSize/a,e.maxBufferLength):e.maxBufferLength,o=Math.min(o,e.maxMaxBufferLength);var u=q.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,n,e.maxBufferHole),l=u.len;if(!(o<=l)){P.b.trace("buffer length of "+l.toFixed(3)+" is below max of "+o.toFixed(3)+". checking for more payload ..."),this.level=t.nextLoadLevel=r;var h=s.details;if(void 0===h||!0===h.live&&this.levelLastLoaded!==r)return void(this.state=st);var c=this.fragPrevious;if(!h.live&&c&&!c.backtracked&&c.sn===h.endSN&&!u.nextStart&&Math.min(i.duration,c.start+c.duration)-Math.max(u.end,c.start)<=Math.max(.2,c.duration)){var d={};return this.altAudio&&(d.type="video"),this.hls.trigger(I.a.BUFFER_EOS,d),void(this.state=lt)}this._fetchPayloadOrEos(n,u,h)}}}},s.prototype._fetchPayloadOrEos=function(t,e,i){var n=this.fragPrevious,r=this.level,s=i.fragments,a=s.length;if(0!==a){var o=s[0].start,u=s[a-1].start+s[a-1].duration,l=e.end,h=void 0;if(i.initSegment&&!i.initSegment.data)h=i.initSegment;else if(i.live){var c=this.config.initialLiveManifestSize;if(a<c)return void P.b.warn("Can not start playback of a level, reason: not enough fragments "+a+" < "+c);if(null===(h=this._ensureFragmentAtLivePoint(i,l,o,u,n,s,a)))return}else l<o&&(h=s[0]);h||(h=this._findFragment(o,n,a,s,l,u,i)),h&&this._loadFragmentOrKey(h,r,i,t,l)}},s.prototype._ensureFragmentAtLivePoint=function(t,e,i,n,r,s,a){var o=this.hls.config,u=this.media,l=void 0,h=void 0!==o.liveMaxLatencyDuration?o.liveMaxLatencyDuration:o.liveMaxLatencyDurationCount*t.targetduration;if(e<Math.max(i-o.maxFragLookUpTolerance,n-h)){var c=this.liveSyncPosition=this.computeLivePosition(i,t);P.b.log("buffer end: "+e.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+c.toFixed(3)),e=c,u&&u.readyState&&u.duration>c&&(u.currentTime=c),this.nextLoadPosition=c}if(t.PTSKnown&&n<e&&u&&u.readyState)return null;if(this.startFragRequested&&!t.PTSKnown){if(r){var d=r.sn+1;if(d>=t.startSN&&d<=t.endSN){var f=s[d-t.startSN];r.cc===f.cc&&(l=f,P.b.log("live playlist, switching playlist, load frag with next SN: "+l.sn))}l||(l=j.search(s,function(t){return r.cc-t.cc}))&&P.b.log("live playlist, switching playlist, load frag with same CC: "+l.sn)}l||(l=s[Math.min(a-1,Math.round(a/2))],P.b.log("live playlist, switching playlist, unknown, load middle frag : "+l.sn))}return l},s.prototype._findFragment=function(t,e,i,n,r,s,a){var o=this.hls.config,u=void 0,l=void 0,h=o.maxFragLookUpTolerance,c=e?n[e.sn-n[0].sn+1]:void 0,d=function(t){var e=Math.min(h,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-e<=r?1:t.start-e>r&&t.start?-1:0};if(l=r<s?(s-h<r&&(h=0),c&&!d(c)?c:j.search(n,d)):n[i-1]){var f=(u=l).sn-a.startSN,p=e&&u.level===e.level,m=n[f-1],g=n[f+1];if(e&&u.sn===e.sn)if(p&&!u.backtracked)if(u.sn<a.endSN){var v=e.deltaPTS;v&&v>o.maxBufferHole&&e.dropped&&f?(u=m,P.b.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),e.loadCounter--):(u=g,P.b.log("SN just loaded, load next one: "+u.sn))}else u=null;else u.backtracked&&(g&&g.backtracked?(P.b.warn("Already backtracked from fragment "+g.sn+", will not backtrack to fragment "+u.sn+". Loading fragment "+g.sn),u=g):(P.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),u.dropped=0,m?(m.loadCounter&&m.loadCounter--,(u=m).backtracked=!0):f&&(u=null)))}return u},s.prototype._loadFragmentOrKey=function(t,e,i,n,r){var s=this.hls,a=s.config;if(!t.decryptdata||null==t.decryptdata.uri||null!=t.decryptdata.key){if(P.b.log("Loading "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+e+", currentTime:"+n.toFixed(3)+",bufferEnd:"+r.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,t.loadCounter){t.loadCounter++;var o=a.fragLoadingLoopThreshold;if(t.loadCounter>o&&Math.abs(this.fragLoadIdx-t.loadIdx)<o)return void s.trigger(I.a.ERROR,{type:O.b.MEDIA_ERROR,details:O.a.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:t})}else t.loadCounter=1;return t.loadIdx=this.fragLoadIdx,t.autoLevel=s.autoLevelEnabled,t.bitrateTest=this.bitrateTest,this.fragCurrent=t,this.startFragRequested=!0,isNaN(t.sn)||t.bitrateTest||(this.nextLoadPosition=t.start+t.duration),s.trigger(I.a.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new J(s,"main")),void(this.state=nt)}P.b.log("Loading key for "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+e),this.state=it,s.trigger(I.a.KEY_LOADING,{frag:t})},s.prototype.getBufferedFrag=function(e){return j.search(this._bufferedFrags,function(t){return e<t.startPTS?-1:e>t.endPTS?1:0})},s.prototype.followingBufferedFrag=function(t){return t?this.getBufferedFrag(t.endPTS+.5):null},s.prototype._checkFragmentChanged=function(){var t,e,i=this.media;if(i&&i.readyState&&!1===i.seeking&&((e=i.currentTime)>i.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=e),q.isBuffered(i,e)?t=this.getBufferedFrag(e):q.isBuffered(i,e+.1)&&(t=this.getBufferedFrag(e+.1)),t)){var n=t;if(n!==this.fragPlaying){this.hls.trigger(I.a.FRAG_CHANGED,{frag:n});var r=n.level;this.fragPlaying&&this.fragPlaying.level===r||this.hls.trigger(I.a.LEVEL_SWITCHED,{level:r}),this.fragPlaying=n}}},s.prototype.immediateLevelSwitch=function(){if(P.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t=this.media,e=void 0;t?(e=t.paused,t.pause()):e=!0,this.previouslyPaused=e}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},s.prototype.immediateLevelSwitchEnd=function(){var t=this.media;t&&t.buffered.length&&(this.immediateSwitch=!1,q.isBuffered(t,t.currentTime)&&(t.currentTime-=1e-4),this.previouslyPaused||t.play())},s.prototype.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var e,i=void 0,n=void 0;if(void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),(e=this.getBufferedFrag(t.currentTime))&&1<e.startPTS&&this.flushMainBuffer(0,e.startPTS-1),t.paused)i=0;else{var r=this.hls.nextLoadLevel,s=this.levels[r],a=this.fragLastKbps;i=a&&this.fragCurrent?this.fragCurrent.duration*s.bitrate/(1e3*a)+1:0}if((n=this.getBufferedFrag(t.currentTime+i))&&(n=this.followingBufferedFrag(n))){var o=this.fragCurrent;o&&o.loader&&o.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}},s.prototype.flushMainBuffer=function(t,e){this.state=ut;var i={startOffset:t,endOffset:e};this.altAudio&&(i.type="video"),this.hls.trigger(I.a.BUFFER_FLUSHING,i)},s.prototype.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("seeked",this.onvseeked),e.addEventListener("ended",this.onvended);var i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition)},s.prototype.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(P.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var e=this.levels;e&&e.forEach(function(t){t.details&&t.details.fragments.forEach(function(t){t.loadCounter=void 0,t.backtracked=void 0})}),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("seeked",this.onvseeked),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},s.prototype.onMediaSeeking=function(){var t=this.media,e=t?t.currentTime:void 0,i=this.config;isNaN(e)||P.b.log("media seeking to "+e.toFixed(3));var n=this.mediaBuffer?this.mediaBuffer:t,r=q.bufferInfo(n,e,this.config.maxBufferHole);if(this.state===nt){var s=this.fragCurrent;if(0===r.len&&s){var a=i.maxFragLookUpTolerance,o=s.start-a,u=s.start+s.duration+a;e<o||u<e?(s.loader&&(P.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),s.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=et):P.b.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===lt&&(0===r.len&&(this.fragPrevious=0),this.state=et);t&&(this.lastCurrentTime=e),this.state!==nt&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*i.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=e),this.tick()},s.prototype.onMediaSeeked=function(){var t=this.media,e=t?t.currentTime:void 0;isNaN(e)||P.b.log("media seeked to "+e.toFixed(3)),this.tick()},s.prototype.onMediaEnded=function(){P.b.log("media ended"),this.startPosition=this.lastCurrentTime=0},s.prototype.onManifestLoading=function(){P.b.log("trigger BUFFER_RESET"),this.hls.trigger(I.a.BUFFER_RESET),this._bufferedFrags=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0},s.prototype.onManifestParsed=function(t){var e,i=!1,n=!1;t.levels.forEach(function(t){(e=t.audioCodec)&&(-1!==e.indexOf("mp4a.40.2")&&(i=!0),-1!==e.indexOf("mp4a.40.5")&&(n=!0))}),this.audioCodecSwitch=i&&n,this.audioCodecSwitch&&P.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1;var r=this.config;(r.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(r.startPosition)},s.prototype.onLevelLoaded=function(t){var e=t.details,i=t.level,n=this.levels[this.levelLastLoaded],r=this.levels[i],s=e.totalduration,a=0;if(P.b.log("level "+i+" loaded ["+e.startSN+","+e.endSN+"],duration:"+s),e.live){var o=r.details;o&&0<e.fragments.length?(l(o,e),a=e.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,o),e.PTSKnown&&!isNaN(a)?P.b.log("live playlist sliding:"+a.toFixed(3)):(P.b.log("live playlist - outdated PTS, unknown sliding"),d(this.fragPrevious,n,e))):(P.b.log("live playlist - first load, unknown sliding"),e.PTSKnown=!1,d(this.fragPrevious,n,e))}else e.PTSKnown=!1;if(r.details=e,this.levelLastLoaded=i,this.hls.trigger(I.a.LEVEL_UPDATED,{details:e,level:i}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var u=e.startTimeOffset;isNaN(u)?e.live?(this.startPosition=this.computeLivePosition(a,e),P.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(u<0&&(P.b.log("negative start time offset "+u+", count from end of last fragment"),u=a+s+u),P.b.log("start time offset found in playlist, adjust startPosition to "+u),this.startPosition=u),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===st&&(this.state=et),this.tick()},s.prototype.onKeyLoaded=function(){this.state===it&&(this.state=et,this.tick())},s.prototype.onFragLoaded=function(t){var e=this.fragCurrent,i=t.frag;if(this.state===nt&&e&&"main"===i.type&&i.level===e.level&&i.sn===e.sn){var n=t.stats,r=this.levels[e.level],s=r.details;if(P.b.log("Loaded  "+e.sn+" of ["+s.startSN+" ,"+s.endSN+"],level "+e.level),this.bitrateTest=!1,this.stats=n,!0===i.bitrateTest&&this.hls.nextLoadLevel)this.state=et,this.startFragRequested=!1,n.tparsed=n.tbuffered=performance.now(),this.hls.trigger(I.a.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.tick();else if("initSegment"===i.sn)this.state=et,n.tparsed=n.tbuffered=performance.now(),s.initSegment.data=t.payload,this.hls.trigger(I.a.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.tick();else{this.state=at;var a=s.totalduration,o=e.level,u=e.sn,l=this.config.defaultAudioCodec||r.audioCodec;this.audioCodecSwap&&(P.b.log("swapping playlist audio codec"),void 0===l&&(l=this.lastAudioCodec),l&&(l=-1!==l.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,P.b.log("Parsing "+u+" of ["+s.startSN+" ,"+s.endSN+"],level "+o+", cc "+e.cc);var h=this.demuxer;h||(h=this.demuxer=new J(this.hls,"main"));var c=this.media,d=!(c&&c.seeking)&&(s.PTSKnown||!s.live),f=s.initSegment?s.initSegment.data:[];h.push(t.payload,f,l,r.videoCodec,e,a,d,void 0)}}this.fragLoadError=0},s.prototype.onFragParsingInitSegment=function(t){var e=this.fragCurrent,i=t.frag;if(e&&"main"===t.id&&i.sn===e.sn&&i.level===e.level&&this.state===at){var n,r,s=t.tracks;if(s.audio&&this.altAudio&&delete s.audio,r=s.audio){var a=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();a&&this.audioCodecSwap&&(P.b.log("swapping playlist audio codec"),a=-1!==a.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==r.metadata.channelCount&&-1===o.indexOf("firefox")&&(a="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==r.container&&(a="mp4a.40.2",P.b.log("Android: force audio codec to "+a)),r.levelCodec=a,r.id=t.id}(r=s.video)&&(r.levelCodec=this.levels[this.level].videoCodec,r.id=t.id),this.hls.trigger(I.a.BUFFER_CODECS,s);for(n in s){r=s[n],P.b.log("main track:"+n+",container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var u=r.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(I.a.BUFFER_APPENDING,{type:n,data:u,parent:"main",content:"initSegment"}))}this.tick()}},s.prototype.onFragParsingData=function(e){var i=this,t=this.fragCurrent,n=e.frag;if(t&&"main"===e.id&&n.sn===t.sn&&n.level===t.level&&("audio"!==e.type||!this.altAudio)&&this.state===at){var r=this.levels[this.level],s=t;if(isNaN(e.endPTS)&&(e.endPTS=e.startPTS+t.duration,e.endDTS=e.startDTS+t.duration),P.b.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(s.dropped=e.dropped,s.dropped)if(s.backtracked)P.b.warn("Already backtracked on this fragment, appending with the gap");else{var a=r.details;if(!a||s.sn!==a.startSN)return P.b.warn("missing video frame(s), backtracking fragment"),s.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=et,this.fragPrevious=s,void this.tick();P.b.warn("missing video frame(s) on first frag, appending with gap")}else s.backtracked=!1;var o=p(r.details,s,e.startPTS,e.endPTS,e.startDTS,e.endDTS),u=this.hls;u.trigger(I.a.LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach(function(t){t&&t.length&&i.state===at&&(i.appended=!0,i.pendingBuffering=!0,u.trigger(I.a.BUFFER_APPENDING,{type:e.type,data:t,parent:"main",content:"data"}))}),this.tick()}},s.prototype.onFragParsed=function(t){var e=this.fragCurrent,i=t.frag;e&&"main"===t.id&&i.sn===e.sn&&i.level===e.level&&this.state===at&&(this.stats.tparsed=performance.now(),this.state=ot,this._checkAppendedParsed())},s.prototype.onAudioTrackSwitching=function(t){var e=!!t.url,i=t.id;if(!e){if(this.mediaBuffer!==this.media){P.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(P.b.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=et}var r=this.hls;r.trigger(I.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),r.trigger(I.a.AUDIO_TRACK_SWITCHED,{id:i}),this.altAudio=!1}},s.prototype.onAudioTrackSwitched=function(t){var e=t.id,i=!!this.hls.audioTracks[e].url;if(i){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(P.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=i,this.tick()},s.prototype.onBufferCreated=function(t){var e=t.tracks,i=void 0,n=void 0,r=!1;for(var s in e){var a=e[s];"main"===a.id?(i=a,"video"===(n=s)&&(this.videoBuffer=e[s].buffer)):r=!0}r&&i?(P.b.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media},s.prototype.onBufferAppended=function(t){if("main"===t.parent){var e=this.state;e!==at&&e!==ot||(this.pendingBuffering=0<t.pending,this._checkAppendedParsed())}},s.prototype._checkAppendedParsed=function(){if(!(this.state!==ot||this.appended&&this.pendingBuffering)){var t=this.fragCurrent;if(t){var e=this.mediaBuffer?this.mediaBuffer:this.media;P.b.log("main buffered : "+$.toString(e.buffered));var i=this._bufferedFrags.filter(function(t){return q.isBuffered(e,(t.startPTS+t.endPTS)/2)});i.push(t),this._bufferedFrags=i.sort(function(t,e){return t.startPTS-e.startPTS}),this.fragPrevious=t;var n=this.stats;n.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(I.a.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.state=et}this.tick()}},s.prototype.onError=function(t){var e=t.frag||this.fragCurrent;if(!e||"main"===e.type){var i=!!this.media&&q.isBuffered(this.media,this.media.currentTime)&&q.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case O.a.FRAG_LOAD_ERROR:case O.a.FRAG_LOAD_TIMEOUT:case O.a.KEY_LOAD_ERROR:case O.a.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);e.loadCounter=0,P.b.warn("mediaController: frag loading failed, retry in "+n+" ms"),this.retryDate=performance.now()+n,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=rt}else P.b.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=ht;break;case O.a.FRAG_LOOP_LOADING_ERROR:t.fatal||(i?(this._reduceMaxBufferLength(e.duration),this.state=et):e.autoLevel&&0!==e.level||(t.fatal=!0,this.state=ht));break;case O.a.LEVEL_LOAD_ERROR:case O.a.LEVEL_LOAD_TIMEOUT:this.state!==ht&&(t.fatal?(this.state=ht,P.b.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):t.levelRetry||this.state!==st||(this.state=et));break;case O.a.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==at&&this.state!==ot||(i?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=et):(P.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},s.prototype._reduceMaxBufferLength=function(t){var e=this.config;e.maxMaxBufferLength>=t&&(e.maxMaxBufferLength/=2,P.b.warn("main:reduce max buffer length to "+e.maxMaxBufferLength+"s"),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*e.fragLoadingLoopThreshold))},s.prototype._checkBuffer=function(){var t=this.media,e=this.config;if(t&&t.readyState){var i=t.currentTime,n=this.mediaBuffer?this.mediaBuffer:t,r=n.buffered;if(!this.loadedmetadata&&r.length){this.loadedmetadata=!0;var s=t.seeking?i:this.startPosition,a=q.isBuffered(n,s),o=r.start(0),u=!a&&Math.abs(s-o)<e.maxSeekHole;(i!==s||u)&&(P.b.log("target start position:"+s),u&&(s=o,P.b.log("target start position not buffered, seek to buffered.start(0) "+s)),P.b.log("adjust currentTime from "+i+" to "+s),t.currentTime=s)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var l=q.bufferInfo(t,i,0),h=!(t.paused||t.ended||0===t.buffered.length);if(i!==this.lastCurrentTime)this.stallReported&&(P.b.warn("playback not stuck anymore @"+i+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(h){var c=performance.now(),d=this.hls;if(this.stalled){var f=c-this.stalled,p=l.len,m=this.nudgeRetry||0;if(p<=.5&&f>1e3*e.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,P.b.warn("playback stalling in low buffer @"+i),d.trigger(I.a.ERROR,{type:O.b.MEDIA_ERROR,details:O.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:p}));var g=l.nextStart,v=g-i;if(g&&v<e.maxSeekHole&&0<v){this.nudgeRetry=++m;var y=m*e.nudgeOffset;P.b.log("adjust currentTime from "+t.currentTime+" to next buffered @ "+g+" + nudge "+y),t.currentTime=g+y,this.stalled=void 0,d.trigger(I.a.ERROR,{type:O.b.MEDIA_ERROR,details:O.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:g+y-i})}}else if(.5<p&&f>1e3*e.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,P.b.warn("playback stalling in high buffer @"+i),d.trigger(I.a.ERROR,{type:O.b.MEDIA_ERROR,details:O.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:p})),this.stalled=void 0,this.nudgeRetry=++m,m<e.nudgeMaxRetry){var _=t.currentTime,E=_+m*e.nudgeOffset;P.b.log("adjust currentTime from "+_+" to "+E),t.currentTime=E,d.trigger(I.a.ERROR,{type:O.b.MEDIA_ERROR,details:O.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else P.b.error("still stuck in high buffer @"+i+" after "+e.nudgeMaxRetry+", raise fatal error"),d.trigger(I.a.ERROR,{type:O.b.MEDIA_ERROR,details:O.a.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=c,this.stallReported=!1}}}},s.prototype.onFragLoadEmergencyAborted=function(){this.state=et,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},s.prototype.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;this._bufferedFrags=this._bufferedFrags.filter(function(t){return q.isBuffered(e,(t.startPTS+t.endPTS)/2)}),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.state=et,this.fragPrevious=null},s.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},s.prototype.computeLivePosition=function(t,e){var i=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*e.targetduration;return t+Math.max(0,e.totalduration-i)},Z(s,[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,P.b.log("main stream:"+e+"->"+t),this.hls.trigger(I.a.STREAM_STATE_TRANSITION,{previousState:e,nextState:t})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var t=this.media;if(t){var e=this.getBufferedFrag(t.currentTime);if(e)return e.level}return-1}},{key:"nextBufferedFrag",get:function(){var t=this.media;return t?this.followingBufferedFrag(this.getBufferedFrag(t.currentTime)):null}},{key:"nextLevel",get:function(){var t=this.nextBufferedFrag;return t?t.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(t){this._liveSyncPosition=t}}]),s}(C),dt=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),ft=function(r){function s(t){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,I.a.MANIFEST_LOADED,I.a.LEVEL_LOADED,I.a.FRAG_LOADED,I.a.ERROR));return e.canload=!1,e.currentLevelIndex=null,e.manualLevelIndex=-1,e.timer=null,e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.destroy=function(){this.cleanTimer(),this.manualLevelIndex=-1},s.prototype.cleanTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},s.prototype.startLoad=function(){var t=this._levels;this.canload=!0,this.levelRetryCount=0,t&&t.forEach(function(t){t.loadError=0;var e=t.details;e&&e.live&&(t.details=void 0)}),null!==this.timer&&this.loadLevel()},s.prototype.stopLoad=function(){this.canload=!1},s.prototype.onManifestLoaded=function(t){var e=[],i=void 0,n={},r=null,s=!1,a=!1,o=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),u=[];if(t.levels.forEach(function(t){t.loadError=0,t.fragmentError=!1,s=s||!!t.videoCodec,a=a||!!t.audioCodec||!(!t.attrs||!t.attrs.AUDIO),!0===o&&t.audioCodec&&-1!==t.audioCodec.indexOf("mp4a.40.34")&&(t.audioCodec=void 0),void 0===(r=n[t.bitrate])?(t.url=[t.url],t.urlId=0,n[t.bitrate]=t,e.push(t)):r.url.push(t.url)}),!0===s&&!0===a&&(e=e.filter(function(t){return!!t.videoCodec})),e=e.filter(function(t){var e=t.audioCodec,i=t.videoCodec;return(!e||h(e))&&(!i||h(i))}),t.audioTracks&&(u=t.audioTracks.filter(function(t){return!t.audioCodec||h(t.audioCodec,"audio")})),0<e.length){i=e[0].bitrate,e.sort(function(t,e){return t.bitrate-e.bitrate}),this._levels=e;for(var l=0;l<e.length;l++)if(e[l].bitrate===i){this._firstLevel=l,P.b.log("manifest loaded,"+e.length+" level(s) found, first bitrate:"+i);break}this.hls.trigger(I.a.MANIFEST_PARSED,{levels:e,audioTracks:u,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:s,altAudio:0<u.length})}else this.hls.trigger(I.a.ERROR,{type:O.b.MEDIA_ERROR,details:O.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},s.prototype.setLevelInternal=function(t){var e=this._levels,i=this.hls;if(0<=t&&t<e.length){if(this.cleanTimer(),this.currentLevelIndex!==t){P.b.log("switching to level "+t);var n=e[this.currentLevelIndex=t];n.level=t,i.trigger(I.a.LEVEL_SWITCH,n),i.trigger(I.a.LEVEL_SWITCHING,n)}var r=e[t],s=r.details;if(!s||!0===s.live){var a=r.urlId;i.trigger(I.a.LEVEL_LOADING,{url:r.url[a],level:t,id:a})}}else i.trigger(I.a.ERROR,{type:O.b.OTHER_ERROR,details:O.a.LEVEL_SWITCH_ERROR,level:t,fatal:!1,reason:"invalid level idx"})},s.prototype.onError=function(t){if(!0!==t.fatal){var e=!1,i=!1,n=void 0;switch(t.details){case O.a.FRAG_LOAD_ERROR:case O.a.FRAG_LOAD_TIMEOUT:case O.a.FRAG_LOOP_LOADING_ERROR:case O.a.KEY_LOAD_ERROR:case O.a.KEY_LOAD_TIMEOUT:n=t.frag.level,i=!0;break;case O.a.LEVEL_LOAD_ERROR:case O.a.LEVEL_LOAD_TIMEOUT:n=t.context.level,e=!0;break;case O.a.REMUX_ALLOC_ERROR:n=t.level,e=!0}void 0!==n&&this.recoverLevel(t,n,e,i)}else t.type===O.b.NETWORK_ERROR&&this.cleanTimer()},s.prototype.recoverLevel=function(t,e,i,n){var r=this,s=this.hls.config,a=t.details,o=this._levels[e],u=void 0,l=void 0,h=void 0;if(o.loadError++,o.fragmentError=n,!0===i){if(!(this.levelRetryCount+1<=s.levelLoadingMaxRetry))return P.b.error("level controller, cannot recover from "+a+" error"),this.currentLevelIndex=null,this.cleanTimer(),void(t.fatal=!0);l=Math.min(Math.pow(2,this.levelRetryCount)*s.levelLoadingRetryDelay,s.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return r.loadLevel()},l),t.levelRetry=!0,this.levelRetryCount++,P.b.warn("level controller, "+a+", retry in "+l+" ms, current retry count is "+this.levelRetryCount)}!0!==i&&!0!==n||(1<(u=o.url.length)&&o.loadError<u?(P.b.warn("level controller, "+a+" for level "+e+": switching to redundant stream id "+o.urlId),o.urlId=(o.urlId+1)%u,o.details=void 0):-1===this.manualLevelIndex?(h=0===e?this._levels.length-1:e-1,P.b.warn("level controller, "+a+": switch to "+h),this.hls.nextAutoLevel=this.currentLevelIndex=h):!0===n&&(P.b.warn("level controller, "+a+": reload a fragment"),this.currentLevelIndex=null))},s.prototype.onFragLoaded=function(t){var e=t.frag;if(void 0!==e&&"main"===e.type){var i=this._levels[e.level];void 0!==i&&(i.fragmentError=!1,i.loadError=0,this.levelRetryCount=0)}},s.prototype.onLevelLoaded=function(t){var e=this,i=t.level;if(i===this.currentLevelIndex){var n=this._levels[i];!1===n.fragmentError&&(n.loadError=0,this.levelRetryCount=0);var r=t.details;if(r.live){var s=1e3*(r.averagetargetduration?r.averagetargetduration:r.targetduration),a=n.details;a&&r.endSN===a.endSN&&(s/=2,P.b.log("same live playlist, reload twice faster")),s-=performance.now()-t.stats.trequest,s=Math.max(1e3,Math.round(s)),P.b.log("live playlist, reload in "+s+" ms"),this.timer=setTimeout(function(){return e.loadLevel()},s)}else this.cleanTimer()}},s.prototype.loadLevel=function(){var t=void 0,e=void 0;null!==this.currentLevelIndex&&!0===this.canload&&void 0!==(t=this._levels[this.currentLevelIndex])&&0<t.url.length&&(e=t.urlId,this.hls.trigger(I.a.LEVEL_LOADING,{url:t.url[e],level:this.currentLevelIndex,id:e}))},dt(s,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(t){var e=this._levels;e&&(t=Math.min(t,e.length-1),this.currentLevelIndex===t&&void 0!==e[t].details||this.setLevelInternal(t))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(t){this._firstLevel=t}},{key:"startLevel",get:function(){if(void 0!==this._startLevel)return this._startLevel;var t=this.hls.config.startLevel;return void 0!==t?t:this._firstLevel},set:function(t){this._startLevel=t}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}}]),s}(C),pt=i(3),mt=function(r){function s(t){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,I.a.MEDIA_ATTACHED,I.a.MEDIA_DETACHING,I.a.FRAG_PARSING_METADATA));return e.id3Track=void 0,e.media=void 0,e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.destroy=function(){C.prototype.destroy.call(this)},s.prototype.onMediaAttached=function(t){this.media=t.media,this.media},s.prototype.onMediaDetaching=function(){this.media=void 0},s.prototype.onFragParsingMetadata=function(t){var e=t.frag,i=t.samples;this.id3Track||(this.id3Track=this.media.addTextTrack("metadata","id3"),this.id3Track.mode="hidden");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,r=0;r<i.length;r++){var s=pt.a.getID3Frames(i[r].data);if(s){var a=i[r].pts,o=r<i.length-1?i[r+1].pts:e.endPTS;a===o&&(o+=1e-4);for(var u=0;u<s.length;u++){var l=s[u];if(!pt.a.isTimeStampFrame(l)){var h=new n(a,o,"");h.value=l,this.id3Track.addCue(h)}}}}},s}(C),gt=function(){function e(t){(function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return e.prototype.sample=function(t,e){var i=Math.pow(this.alpha_,t);this.estimate_=e*(1-i)+i*this.estimate_,this.totalWeight_+=t},e.prototype.getTotalWeight=function(){return this.totalWeight_},e.prototype.getEstimate=function(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/t}return this.estimate_},e}(),vt=function(){function s(t,e,i,n){(function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,s),this.hls=t,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new gt(e),this.fast_=new gt(i)}return s.prototype.sample=function(t,e){var i=8e3*e/(t=Math.max(t,this.minDelayMs_)),n=t/1e3;this.fast_.sample(n,i),this.slow_.sample(n,i)},s.prototype.canEstimate=function(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_},s.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},s.prototype.destroy=function(){},s}(),yt=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),_t=function(r){function s(t){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,I.a.FRAG_LOADING,I.a.FRAG_LOADED,I.a.FRAG_BUFFERED,I.a.ERROR));return e.lastLoadedFragLevel=0,e._nextAutoLevel=-1,e.hls=t,e.timer=null,e._bwEstimator=null,e.onCheck=e._abandonRulesCheck.bind(e),e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.destroy=function(){this.clearTimer(),C.prototype.destroy.call(this)},s.prototype.onFragLoading=function(t){var e=t.frag;if("main"===e.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var i=this.hls,n=t.frag.level,r=i.levels[n].details.live,s=i.config,a=void 0,o=void 0;o=r?(a=s.abrEwmaFastLive,s.abrEwmaSlowLive):(a=s.abrEwmaFastVoD,s.abrEwmaSlowVoD),this._bwEstimator=new vt(i,o,a,s.abrEwmaDefaultEstimate)}this.fragCurrent=e}},s.prototype._abandonRulesCheck=function(){var t=this.hls,e=t.media,i=this.fragCurrent,n=i.loader,r=t.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return P.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var s=n.stats;if(e&&s&&(!e.paused&&0!==e.playbackRate||!e.readyState)&&i.autoLevel&&i.level){var a=performance.now()-s.trequest,o=Math.abs(e.playbackRate);if(a>500*i.duration/o){var u=t.levels,l=Math.max(1,s.bw?s.bw/8:1e3*s.loaded/a),h=u[i.level],c=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,d=s.total?s.total:Math.max(s.loaded,Math.round(i.duration*c/8)),f=e.currentTime,p=(d-s.loaded)/l,m=(q.bufferInfo(e,f,t.config.maxBufferHole).end-f)/o;if(m<2*i.duration/o&&m<p){var g=void 0,v=void 0;for(v=i.level-1;r<v;v--){var y=u[v].realBitrate?Math.max(u[v].realBitrate,u[v].bitrate):u[v].bitrate;if((g=i.duration*y/(6.4*l))<m)break}g<p&&(P.b.warn("loading too slow, abort fragment loading and switch to level "+v+":fragLoadedDelay["+v+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+g.toFixed(1)+"<"+p.toFixed(1)+":"+m.toFixed(1)),t.nextLoadLevel=v,this._bwEstimator.sample(a,s.loaded),n.abort(),this.clearTimer(),t.trigger(I.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:s}))}}}},s.prototype.onFragLoaded=function(t){var e=t.frag;if("main"===e.type&&!isNaN(e.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=e.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[e.level],n=(i.loaded?i.loaded.bytes:0)+t.stats.loaded,r=(i.loaded?i.loaded.duration:0)+t.frag.duration;i.loaded={bytes:n,duration:r},i.realBitrate=Math.round(8*n/r)}if(t.frag.bitrateTest){var s=t.stats;s.tparsed=s.tbuffered=s.tload,this.onFragBuffered(t)}}},s.prototype.onFragBuffered=function(t){var e=t.stats,i=t.frag;if(!(!0===e.aborted||1!==i.loadCounter||"main"!==i.type||isNaN(i.sn)||i.bitrateTest&&e.tload!==e.tbuffered)){var n=e.tparsed-e.trequest;P.b.log("latency/loading/parsing/append/kbps:"+Math.round(e.tfirst-e.trequest)+"/"+Math.round(e.tload-e.tfirst)+"/"+Math.round(e.tparsed-e.tload)+"/"+Math.round(e.tbuffered-e.tparsed)+"/"+Math.round(8*e.loaded/(e.tbuffered-e.trequest))),this._bwEstimator.sample(n,e.loaded),e.bwEstimate=this._bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}},s.prototype.onError=function(t){switch(t.details){case O.a.FRAG_LOAD_ERROR:case O.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},s.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},s.prototype._findBestLevel=function(t,e,i,n,r,s,a,o,u){for(var l=r;n<=l;l--){var h,c=u[l].details,d=c?c.totalduration/c.fragments.length:e,f=!!c&&c.live;h=l<=t?a*i:o*i;var p=u[l].realBitrate?Math.max(u[l].realBitrate,u[l].bitrate):u[l].bitrate,m=p*d/h;if(P.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+l+"/"+Math.round(h)+"/"+p+"/"+d+"/"+s+"/"+m),p<h&&(!m||f&&!this.bitrateTestDelay||m<s))return l}return-1},yt(s,[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,e=this._bwEstimator;if(!(-1===t||e&&e.canEstimate()))return t;var i=this._nextABRAutoLevel;return-1!==t&&(i=Math.min(t,i)),i},set:function(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function(){var t=this.hls,e=t.maxAutoLevel,i=t.levels,n=t.config,r=t.minAutoLevel,s=t.media,a=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,u=s?s.currentTime:0,l=s&&0!==s.playbackRate?Math.abs(s.playbackRate):1,h=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,c=(q.bufferInfo(s,u,n.maxBufferHole).end-u)/l,d=this._findBestLevel(a,o,h,r,e,c,n.abrBandWidthFactor,n.abrBandWidthUpFactor,i);if(0<=d)return d;P.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var f=o?Math.min(o,n.maxStarvationDelay):n.maxStarvationDelay,p=n.abrBandWidthFactor,m=n.abrBandWidthUpFactor;if(0===c){var g=this.bitrateTestDelay;g&&(f=(o?Math.min(o,n.maxLoadingDelay):n.maxLoadingDelay)-g,P.b.trace("bitrate test took "+Math.round(1e3*g)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*f)+" ms"),p=m=1)}return d=this._findBestLevel(a,o,h,r,e,c+f,p,m,i),Math.max(d,0)}}]),s}(C),Et=a(),bt=function(r){function s(t){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,I.a.MEDIA_ATTACHING,I.a.MEDIA_DETACHING,I.a.MANIFEST_PARSED,I.a.BUFFER_RESET,I.a.BUFFER_APPENDING,I.a.BUFFER_CODECS,I.a.BUFFER_EOS,I.a.BUFFER_FLUSHING,I.a.LEVEL_PTS_UPDATED,I.a.LEVEL_UPDATED));return e._msDuration=null,e._levelDuration=null,e._live=null,e._objectUrl=null,e.onsbue=e.onSBUpdateEnd.bind(e),e.onsbe=e.onSBUpdateError.bind(e),e.pendingTracks={},e.tracks={},e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.destroy=function(){C.prototype.destroy.call(this)},s.prototype.onLevelPtsUpdated=function(t){var e=t.type,i=this.tracks.audio;if("audio"===e&&i&&"audio/mpeg"===i.container){var n=this.sourceBuffer.audio;if(.1<Math.abs(n.timestampOffset-t.start)){var r=n.updating;try{n.abort()}catch(t){r=!0,P.b.warn("can not abort audio buffer: "+t)}r?this.audioTimestampOffset=t.start:(P.b.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+t.start),n.timestampOffset=t.start)}}},s.prototype.onManifestParsed=function(t){var e=t.audio,i=t.video||t.levels.length&&t.audio,n=0;t.altAudio&&(e||i)&&(n=(e?1:0)+(i?1:0),P.b.log(n+" sourceBuffer(s) expected")),this.sourceBufferNb=n},s.prototype.onMediaAttaching=function(t){var e=this.media=t.media;if(e){var i=this.mediaSource=new Et;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),i.addEventListener("sourceopen",this.onmso),i.addEventListener("sourceended",this.onmse),i.addEventListener("sourceclose",this.onmsc),e.src=URL.createObjectURL(i),this._objectUrl=e.src}},s.prototype.onMediaDetaching=function(){P.b.log("media source detaching");var t=this.mediaSource;if(t){if("open"===t.readyState)try{t.endOfStream()}catch(t){P.b.warn("onMediaDetaching:"+t.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this.onmso),t.removeEventListener("sourceended",this.onmse),t.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):P.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(I.a.MEDIA_DETACHED)},s.prototype.onMediaSourceOpen=function(){P.b.log("media source opened"),this.hls.trigger(I.a.MEDIA_ATTACHED,{media:this.media});var t=this.mediaSource;t&&t.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},s.prototype.checkPendingTracks=function(){var t=this.pendingTracks,e=Object.keys(t).length;e&&(this.sourceBufferNb<=e||0===this.sourceBufferNb)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},s.prototype.onMediaSourceClose=function(){P.b.log("media source closed")},s.prototype.onMediaSourceEnded=function(){P.b.log("media source ended")},s.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var t=this.sourceBuffer.audio;P.b.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+this.audioTimestampOffset),t.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var i=this.parent,e=this.segments.reduce(function(t,e){return e.parent===i?t+1:t},0);this.hls.trigger(I.a.BUFFER_APPENDED,{parent:i,pending:e}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()},s.prototype.onSBUpdateError=function(t){P.b.error("sourceBuffer error:",t),this.hls.trigger(I.a.ERROR,{type:O.b.MEDIA_ERROR,details:O.a.BUFFER_APPENDING_ERROR,fatal:!1})},s.prototype.onBufferReset=function(){var t=this.sourceBuffer;for(var e in t){var i=t[e];try{this.mediaSource.removeSourceBuffer(i),i.removeEventListener("updateend",this.onsbue),i.removeEventListener("error",this.onsbe)}catch(t){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},s.prototype.onBufferCodecs=function(t){if(0===Object.keys(this.sourceBuffer).length){for(var e in t)this.pendingTracks[e]=t[e];var i=this.mediaSource;i&&"open"===i.readyState&&this.checkPendingTracks()}},s.prototype.createSourceBuffers=function(t){var e=this.sourceBuffer,i=this.mediaSource;for(var n in t)if(!e[n]){var r=t[n],s=r.levelCodec||r.codec,a=r.container+";codecs="+s;P.b.log("creating sourceBuffer("+a+")");try{var o=e[n]=i.addSourceBuffer(a);o.addEventListener("updateend",this.onsbue),o.addEventListener("error",this.onsbe),this.tracks[n]={codec:s,container:r.container},r.buffer=o}catch(t){P.b.error("error while trying to add sourceBuffer:"+t.message),this.hls.trigger(I.a.ERROR,{type:O.b.MEDIA_ERROR,details:O.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:t,mimeType:a})}}this.hls.trigger(I.a.BUFFER_CREATED,{tracks:t})},s.prototype.onBufferAppending=function(t){this._needsFlush||(this.segments?this.segments.push(t):this.segments=[t],this.doAppending())},s.prototype.onBufferAppendFail=function(t){P.b.error("sourceBuffer error:",t.event),this.hls.trigger(I.a.ERROR,{type:O.b.MEDIA_ERROR,details:O.a.BUFFER_APPENDING_ERROR,fatal:!1})},s.prototype.onBufferEos=function(t){var e=this.sourceBuffer,i=t.type;for(var n in e)i&&n!==i||e[n].ended||(e[n].ended=!0,P.b.log(n+" sourceBuffer now EOS"));this.checkEos()},s.prototype.checkEos=function(){var t=this.sourceBuffer,e=this.mediaSource;if(e&&"open"===e.readyState){for(var i in t){var n=t[i];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}P.b.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{e.endOfStream()}catch(t){P.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},s.prototype.onBufferFlushing=function(t){this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type}),this.flushBufferCounter=0,this.doFlush()},s.prototype.onLevelUpdated=function(t){var e=t.details;0<e.fragments.length&&(this._levelDuration=e.totalduration+e.fragments[0].start,this._live=e.live,this.updateMediaElementDuration())},s.prototype.updateMediaElementDuration=function(){var t=this.hls.config,e=void 0;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer)if(!0===this.sourceBuffer[i].updating)return;e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(P.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||e===1/0||isNaN(e))&&(P.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},s.prototype.doFlush=function(){for(;this.flushRange.length;){var t=this.flushRange[0];if(!this.flushBuffer(t.start,t.end,t.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var e=0,i=this.sourceBuffer;try{for(var n in i)e+=i[n].buffered.length}catch(t){P.b.error("error while accessing sourceBuffer.buffered")}this.appended=e,this.hls.trigger(I.a.BUFFER_FLUSHED)}},s.prototype.doAppending=function(){var t=this.hls,e=this.sourceBuffer,i=this.segments;if(Object.keys(e).length){if(this.media.error)return this.segments=[],void P.b.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(i&&i.length){var n=i.shift();try{var r=e[n.type];r?r.updating?i.unshift(n):(r.ended=!1,this.parent=n.parent,r.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(e){P.b.error("error while trying to append buffer:"+e.message),i.unshift(n);var s={type:O.b.MEDIA_ERROR,parent:n.parent};if(22===e.code)return this.segments=[],s.details=O.a.BUFFER_FULL_ERROR,s.fatal=!1,void t.trigger(I.a.ERROR,s);if(this.appendError?this.appendError++:this.appendError=1,s.details=O.a.BUFFER_APPEND_ERROR,this.appendError>t.config.appendErrorMaxRetry)return P.b.log("fail "+t.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),i=[],s.fatal=!0,void t.trigger(I.a.ERROR,s);s.fatal=!1,t.trigger(I.a.ERROR,s)}}}},s.prototype.flushBuffer=function(t,e,i){var n,r,s,a,o,u,l=this.sourceBuffer;if(Object.keys(l).length){if(P.b.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+t+"/"+e),this.flushBufferCounter<this.appended){for(var h in l)if(!i||h===i){if((n=l[h]).ended=!1,n.updating)return P.b.warn("cannot flush, sb updating in progress"),!1;try{for(r=0;r<n.buffered.length;r++)if(s=n.buffered.start(r),a=n.buffered.end(r),u=-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&e===Number.POSITIVE_INFINITY?(o=t,e):(o=Math.max(s,t),Math.min(a,e)),.5<Math.min(u,a)-o)return this.flushBufferCounter++,P.b.log("flush "+h+" ["+o+","+u+"], of ["+s+","+a+"], pos:"+this.media.currentTime),n.remove(o,u),!1}catch(t){P.b.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else P.b.warn("abort flushing too many retries");P.b.log("buffer flushed")}return!0},s}(C),Tt=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),St=function(e){function r(t){return function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,e.call(this,t,I.a.FPS_DROP_LEVEL_CAPPING,I.a.MEDIA_ATTACHING,I.a.MANIFEST_PARSED))}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,e),r.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))},r.prototype.onFpsDropLevelCapping=function(t){r.isLevelAllowed(t.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(t.droppedLevel)},r.prototype.onMediaAttaching=function(t){this.media=t.media instanceof HTMLVideoElement?t.media:null},r.prototype.onManifestParsed=function(t){var e=this.hls;this.restrictedLevels=[],e.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=t.levels,e.firstLevel=this.getMaxLevel(t.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},r.prototype.detectPlayerSize=function(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var e=this.hls;e.autoLevelCapping=this.getMaxLevel(t-1),e.autoLevelCapping>this.autoLevelCapping&&e.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}},r.prototype.getMaxLevel=function(i){var n=this;if(!this.levels)return-1;var t=this.levels.filter(function(t,e){return r.isLevelAllowed(e,n.restrictedLevels)&&e<=i});return r.getMaxLevelByMediaSize(t,this.mediaWidth,this.mediaHeight)},r.isLevelAllowed=function(t){return-1===(1<arguments.length&&void 0!==arguments[1]?arguments[1]:[]).indexOf(t)},r.getMaxLevelByMediaSize=function(t,e,i){if(!t||t&&!t.length)return-1;for(var n=t.length-1,r=0;r<t.length;r+=1){var s=t[r];if((s.width>=e||s.height>=i)&&(a=s,!(o=t[r+1])||a.width!==o.width||a.height!==o.height)){n=r;break}}var a,o;return n},Tt(r,[{key:"mediaWidth",get:function(){var t=void 0,e=this.media;return e&&(t=e.width||e.clientWidth||e.offsetWidth,t*=r.contentScaleFactor),t}},{key:"mediaHeight",get:function(){var t=void 0,e=this.media;return e&&(t=e.height||e.clientHeight||e.offsetHeight,t*=r.contentScaleFactor),t}}],[{key:"contentScaleFactor",get:function(){var t=1;try{t=window.devicePixelRatio}catch(t){}return t}}]),r}(C),wt=function(e){function r(t){return function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,e.call(this,t,I.a.MEDIA_ATTACHING))}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,e),r.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},r.prototype.onMediaAttaching=function(t){var e=this.hls.config;e.capLevelOnFPSDrop&&("function"==typeof(this.video=t.media instanceof HTMLVideoElement?t.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),e.fpsDroppedMonitoringPeriod))},r.prototype.checkFPS=function(t,e,i){var n=performance.now();if(e){if(this.lastTime){var r=n-this.lastTime,s=i-this.lastDroppedFrames,a=e-this.lastDecodedFrames,o=1e3*s/r,u=this.hls;if(u.trigger(I.a.FPS_DROP,{currentDropped:s,currentDecoded:a,totalDroppedFrames:i}),0<o&&s>u.config.fpsDroppedMonitoringThreshold*a){var l=u.currentLevel;P.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+l),0<l&&(-1===u.autoLevelCapping||u.autoLevelCapping>=l)&&(l-=1,u.trigger(I.a.FPS_DROP_LEVEL_CAPPING,{level:l,droppedLevel:u.currentLevel}),u.autoLevelCapping=l,u.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=e}},r.prototype.checkFPSInterval=function(){var t=this.video;if(t)if(this.isVideoPlaybackQualityAvailable){var e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},r}(C),Ct=function(){function e(t){(function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return e.prototype.destroy=function(){this.abort(),this.loader=null},e.prototype.abort=function(){var t=this.loader;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.prototype.load=function(t,e,i){this.context=t,this.config=e,this.callbacks=i,this.stats={trequest:performance.now(),retry:0},this.retryDelay=e.retryDelay,this.loadInternal()},e.prototype.loadInternal=function(){var t,e=this.context;t=this.loader=new XMLHttpRequest;var i=this.stats;i.tfirst=0,i.loaded=0;var n=this.xhrSetup;try{if(n)try{n(t,e.url)}catch(i){t.open("GET",e.url,!0),n(t,e.url)}t.readyState||t.open("GET",e.url,!0)}catch(i){return void this.callbacks.onError({code:t.status,text:i.message},e,t)}e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},e.prototype.readystatechange=function(t){var e=t.currentTarget,i=e.readyState,n=this.stats,r=this.context,s=this.config;if(!n.aborted&&2<=i)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(performance.now(),n.trequest)),4===i){var a=e.status;if(200<=a&&a<300){n.tload=Math.max(n.tfirst,performance.now());var o=void 0,u=void 0;u="arraybuffer"===r.responseType?(o=e.response).byteLength:(o=e.responseText).length,n.loaded=n.total=u;var l={url:e.responseURL,data:o};this.callbacks.onSuccess(l,n,r,e)}else n.retry>=s.maxRetry||400<=a&&a<499?(P.b.error(a+" while loading "+r.url),this.callbacks.onError({code:a,text:e.statusText},r,e)):(P.b.warn(a+" while loading "+r.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,s.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),s.timeout)},e.prototype.loadtimeout=function(){P.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},e.prototype.loadprogress=function(t){var e=t.currentTarget,i=this.stats;i.loaded=t.loaded,t.lengthComputable&&(i.total=t.total);var n=this.callbacks.onProgress;n&&n(i,this.context,null,e)},e}(),At=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),kt=function(r){function s(t){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,I.a.MANIFEST_LOADING,I.a.MANIFEST_PARSED,I.a.AUDIO_TRACK_LOADED,I.a.ERROR));return e.ticks=0,e.ontick=e.tick.bind(e),e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.destroy=function(){this.cleanTimer(),C.prototype.destroy.call(this)},s.prototype.cleanTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},s.prototype.tick=function(){1==++this.ticks&&(this.doTick(),1<this.ticks&&setTimeout(this.tick,1),this.ticks=0)},s.prototype.doTick=function(){this.updateTrack(this.trackId)},s.prototype.onError=function(t){t.fatal&&t.type===O.b.NETWORK_ERROR&&this.cleanTimer()},s.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},s.prototype.onManifestParsed=function(t){var e=this,i=t.audioTracks||[],n=!1;this.tracks=i,this.hls.trigger(I.a.AUDIO_TRACKS_UPDATED,{audioTracks:i});var r=0;i.forEach(function(t){if(t["default"]&&!n)return e.audioTrack=r,void(n=!0);r++}),!1===n&&i.length&&(P.b.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)},s.prototype.onAudioTrackLoaded=function(t){t.id<this.tracks.length&&(P.b.log("audioTrack "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*t.details.targetduration)),!t.details.live&&this.timer&&this.cleanTimer())},s.prototype.setAudioTrackInternal=function(t){if(0<=t&&t<this.tracks.length){this.cleanTimer(),this.trackId=t,P.b.log("switching to audioTrack "+t);var e=this.tracks[t],i=this.hls,n=e.type,r=e.url,s={id:t,type:n,url:r};i.trigger(I.a.AUDIO_TRACK_SWITCH,s),i.trigger(I.a.AUDIO_TRACK_SWITCHING,s);var a=e.details;!r||void 0!==a&&!0!==a.live||(P.b.log("(re)loading playlist for audioTrack "+t),i.trigger(I.a.AUDIO_TRACK_LOADING,{url:r,id:t}))}},s.prototype.updateTrack=function(t){if(0<=t&&t<this.tracks.length){this.cleanTimer(),this.trackId=t,P.b.log("updating audioTrack "+t);var e=this.tracks[t],i=e.url,n=e.details;!i||void 0!==n&&!0!==n.live||(P.b.log("(re)loading playlist for audioTrack "+t),this.hls.trigger(I.a.AUDIO_TRACK_LOADING,{url:i,id:t}))}},At(s,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(t){this.trackId===t&&void 0!==this.tracks[t].details||this.setAudioTrackInternal(t)}}]),s}(C),Nt=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),xt="STOPPED",Mt="STARTING",Rt="IDLE",Dt="PAUSED",Lt="KEY_LOADING",It="FRAG_LOADING",Ot="FRAG_LOADING_WAITING_RETRY",Pt="WAITING_TRACK",Bt="PARSING",Ft="PARSED",Ut="BUFFER_FLUSHING",Vt="ENDED",Ht="ERROR",Gt="WAITING_INIT_PTS",jt=function(r){function s(t){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,I.a.MEDIA_ATTACHED,I.a.MEDIA_DETACHING,I.a.AUDIO_TRACKS_UPDATED,I.a.AUDIO_TRACK_SWITCHING,I.a.AUDIO_TRACK_LOADED,I.a.KEY_LOADED,I.a.FRAG_LOADED,I.a.FRAG_PARSING_INIT_SEGMENT,I.a.FRAG_PARSING_DATA,I.a.FRAG_PARSED,I.a.ERROR,I.a.BUFFER_RESET,I.a.BUFFER_CREATED,I.a.BUFFER_APPENDED,I.a.BUFFER_FLUSHED,I.a.INIT_PTS_FOUND));return e.config=t.config,e.audioCodecSwap=!1,e.ticks=0,e._state=xt,e.ontick=e.tick.bind(e),e.initPTS=[],e.waitingFragment=null,e.videoTrackCC=null,e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.destroy=function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),C.prototype.destroy.call(this),this.state=xt},s.prototype.onInitPtsFound=function(t){var e=t.id,i=t.frag.cc,n=t.initPTS;"main"===e&&(this.initPTS[i]=n,this.videoTrackCC=i,P.b.log("InitPTS for cc:"+i+" found from video track:"+n),this.state===Gt&&this.tick())},s.prototype.startLoad=function(t){if(this.tracks){var e=this.lastCurrentTime;this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),(this.fragLoadError=0)<e&&-1===t?(P.b.log("audio:override startPosition with lastCurrentTime @"+e.toFixed(3)),this.state=Rt):(this.lastCurrentTime=this.startPosition?this.startPosition:t,this.state=Mt),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=t,this.state=xt},s.prototype.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=xt},s.prototype.tick=function(){1==++this.ticks&&(this.doTick(),1<this.ticks&&setTimeout(this.tick,1),this.ticks=0)},s.prototype.doTick=function(){var t,e,i,n=this.hls,r=n.config;switch(this.state){case Ht:case Dt:case Ut:break;case Mt:this.state=Pt,this.loadedmetadata=!1;break;case Rt:var s=this.tracks;if(!s)break;if(!this.media&&(this.startFragRequested||!r.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(void 0===(t=this.nextLoadPosition))break;var a=this.mediaBuffer?this.mediaBuffer:this.media,o=this.videoBuffer?this.videoBuffer:this.media,u=q.bufferInfo(a,t,r.maxBufferHole),l=q.bufferInfo(o,t,r.maxBufferHole),h=u.len,c=u.end,d=this.fragPrevious,f=Math.max(r.maxBufferLength,l.len),p=this.audioSwitch,m=this.trackId;if((h<f||p)&&m<s.length){if(void 0===(i=s[m].details)){this.state=Pt;break}if(!p&&!i.live&&d&&d.sn===i.endSN&&!u.nextStart&&(!this.media.seeking||this.media.duration-c<d.duration/2)){this.hls.trigger(I.a.BUFFER_EOS,{type:"audio"}),this.state=Vt;break}var g=i.fragments,v=g.length,y=g[0].start,_=g[v-1].start+g[v-1].duration,E=void 0;if(p)if(i.live&&!i.PTSKnown)P.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),c=0;else if(c=t,i.PTSKnown&&t<y){if(!(u.end>y||u.nextStart))return;P.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=y+.05}if(i.initSegment&&!i.initSegment.data)E=i.initSegment;else if(c<=y){if(E=g[0],null!==this.videoTrackCC&&E.cc!==this.videoTrackCC&&(E=function L(t,e){return j.search(t,function(t){return t.cc<e?1:t.cc>e?-1:0})}(g,this.videoTrackCC)),i.live&&E.loadIdx&&E.loadIdx===this.fragLoadIdx){var b=u.nextStart?u.nextStart:y;return P.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(b+.05)),void(this.media.currentTime=b+.05)}}else{var T=void 0,S=r.maxFragLookUpTolerance,w=d?g[d.sn-g[0].sn+1]:void 0,C=function(t){var e=Math.min(S,t.duration);return t.start+t.duration-e<=c?1:t.start-e>c&&t.start?-1:0};(T=c<_?(_-S<c&&(S=0),w&&!C(w)?w:j.search(g,C)):g[v-1])&&(y=(E=T).start,d&&E.level===d.level&&E.sn===d.sn&&(E.sn<i.endSN?(E=g[E.sn+1-i.startSN],P.b.log("SN just loaded, load next one: "+E.sn)):E=null))}if(E)if(E.decryptdata&&null!=E.decryptdata.uri&&null==E.decryptdata.key)P.b.log("Loading key for "+E.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+m),this.state=Lt,n.trigger(I.a.KEY_LOADING,{frag:E});else{if(P.b.log("Loading "+E.sn+", cc: "+E.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+m+", currentTime:"+t+",bufferEnd:"+c.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,E.loadCounter){E.loadCounter++;var A=r.fragLoadingLoopThreshold;if(E.loadCounter>A&&Math.abs(this.fragLoadIdx-E.loadIdx)<A)return void n.trigger(I.a.ERROR,{type:O.b.MEDIA_ERROR,details:O.a.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:E})}else E.loadCounter=1;E.loadIdx=this.fragLoadIdx,this.fragCurrent=E,this.startFragRequested=!0,isNaN(E.sn)||(this.nextLoadPosition=E.start+E.duration),n.trigger(I.a.FRAG_LOADING,{frag:E}),this.state=It}}break;case Pt:(e=this.tracks[this.trackId])&&e.details&&(this.state=Rt);break;case Ot:var k=performance.now(),N=this.retryDate,x=(a=this.media)&&a.seeking;(!N||N<=k||x)&&(P.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=Rt);break;case Gt:var M=this.videoTrackCC;if(void 0===this.initPTS[M])break;var R=this.waitingFragment;if(R){var D=R.frag.cc;M!==D?(e=this.tracks[this.trackId]).details&&e.details.live&&(P.b.warn("Waiting fragment CC ("+D+") does not match video track CC ("+M+")"),this.waitingFragment=null,this.state=Rt):(this.state=It,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=Rt}},s.prototype.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("ended",this.onvended);var i=this.config;this.tracks&&i.autoStartLoad&&this.startLoad(i.startPosition)},s.prototype.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(P.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var e=this.tracks;e&&e.forEach(function(t){t.details&&t.details.fragments.forEach(function(t){t.loadCounter=void 0})}),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},s.prototype.onMediaSeeking=function(){this.state===Vt&&(this.state=Rt),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()},s.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},s.prototype.onAudioTracksUpdated=function(t){P.b.log("audio tracks updated"),this.tracks=t.audioTracks},s.prototype.onAudioTrackSwitching=function(t){var e=!!t.url;this.trackId=t.id,this.fragCurrent=null,this.state=Dt,this.waitingFragment=null,e?this.timer||(this.timer=setInterval(this.ontick,100)):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),e&&(this.audioSwitch=!0,this.state=Rt,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold)),this.tick()},s.prototype.onAudioTrackLoaded=function(t){var e=t.details,i=t.id,n=this.tracks[i],r=e.totalduration,s=0;if(P.b.log("track "+i+" loaded ["+e.startSN+","+e.endSN+"],duration:"+r),e.live){var a=n.details;a&&0<e.fragments.length?(l(a,e),s=e.fragments[0].start,e.PTSKnown?P.b.log("live audio playlist sliding:"+s.toFixed(3)):P.b.log("live audio playlist - outdated PTS, unknown sliding")):(e.PTSKnown=!1,P.b.log("live audio playlist - first load, unknown sliding"))}else e.PTSKnown=!1;if(n.details=e,!this.startFragRequested){if(-1===this.startPosition){var o=e.startTimeOffset;isNaN(o)?this.startPosition=0:(P.b.log("start time offset found in playlist, adjust startPosition to "+o),this.startPosition=o)}this.nextLoadPosition=this.startPosition}this.state===Pt&&(this.state=Rt),this.tick()},s.prototype.onKeyLoaded=function(){this.state===Lt&&(this.state=Rt,this.tick())},s.prototype.onFragLoaded=function(t){var e=this.fragCurrent,i=t.frag;if(this.state===It&&e&&"audio"===i.type&&i.level===e.level&&i.sn===e.sn){var n=this.tracks[this.trackId],r=n.details,s=r.totalduration,a=e.level,o=e.sn,u=e.cc,l=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",h=this.stats=t.stats;if("initSegment"===o)this.state=Rt,h.tparsed=h.tbuffered=performance.now(),r.initSegment.data=t.payload,this.hls.trigger(I.a.FRAG_BUFFERED,{stats:h,frag:e,id:"audio"}),this.tick();else{this.state=Bt,this.appended=!1,this.demuxer||(this.demuxer=new J(this.hls,"audio"));var c=this.initPTS[u],d=r.initSegment?r.initSegment.data:[];if(r.initSegment||void 0!==c){this.pendingBuffering=!0,P.b.log("Demuxing "+o+" of ["+r.startSN+" ,"+r.endSN+"],track "+a);this.demuxer.push(t.payload,d,l,null,e,s,!1,c)}else P.b.log("unknown video PTS for continuity counter "+u+", waiting for video PTS before demuxing audio frag "+o+" of ["+r.startSN+" ,"+r.endSN+"],track "+a),this.waitingFragment=t,this.state=Gt}}this.fragLoadError=0},s.prototype.onFragParsingInitSegment=function(t){var e=this.fragCurrent,i=t.frag;if(e&&"audio"===t.id&&i.sn===e.sn&&i.level===e.level&&this.state===Bt){var n=t.tracks,r=void 0;if(n.video&&delete n.video,r=n.audio){r.levelCodec=r.codec,r.id=t.id,this.hls.trigger(I.a.BUFFER_CODECS,n),P.b.log("audio track:audio,container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var s=r.initSegment;if(s){var a={type:"audio",data:s,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[a]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(I.a.BUFFER_APPENDING,a))}this.tick()}}},s.prototype.onFragParsingData=function(e){var i=this,t=this.fragCurrent,n=e.frag;if(t&&"audio"===e.id&&"audio"===e.type&&n.sn===t.sn&&n.level===t.level&&this.state===Bt){var r=this.trackId,s=this.tracks[r],a=this.hls;isNaN(e.endPTS)&&(e.endPTS=e.startPTS+t.duration,e.endDTS=e.startDTS+t.duration),P.b.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),p(s.details,t,e.startPTS,e.endPTS);var o=this.audioSwitch,u=this.media,l=!1;if(o&&u)if(u.readyState){var h=u.currentTime;P.b.log("switching audio track : currentTime:"+h),h>=e.startPTS&&(P.b.log("switching audio track : flushing all audio"),this.state=Ut,a.trigger(I.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),l=!0,this.audioSwitch=!1,a.trigger(I.a.AUDIO_TRACK_SWITCHED,{id:r}))}else this.audioSwitch=!1,a.trigger(I.a.AUDIO_TRACK_SWITCHED,{id:r});var c=this.pendingData;this.audioSwitch||([e.data1,e.data2].forEach(function(t){t&&t.length&&c.push({type:e.type,data:t,parent:"audio",content:"data"})}),!l&&c.length&&(c.forEach(function(t){i.state===Bt&&(i.pendingBuffering=!0,i.hls.trigger(I.a.BUFFER_APPENDING,t))}),this.pendingData=[],this.appended=!0)),this.tick()}},s.prototype.onFragParsed=function(t){var e=this.fragCurrent,i=t.frag;e&&"audio"===t.id&&i.sn===e.sn&&i.level===e.level&&this.state===Bt&&(this.stats.tparsed=performance.now(),this.state=Ft,this._checkAppendedParsed())},s.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},s.prototype.onBufferCreated=function(t){var e=t.tracks.audio;e&&(this.mediaBuffer=e.buffer,this.loadedmetadata=!0),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer)},s.prototype.onBufferAppended=function(t){if("audio"===t.parent){var e=this.state;e!==Bt&&e!==Ft||(this.pendingBuffering=0<t.pending,this._checkAppendedParsed())}},s.prototype._checkAppendedParsed=function(){if(!(this.state!==Ft||this.appended&&this.pendingBuffering)){var t=this.fragCurrent,e=this.stats,i=this.hls;if(t){this.fragPrevious=t,e.tbuffered=performance.now(),i.trigger(I.a.FRAG_BUFFERED,{stats:e,frag:t,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;P.b.log("audio buffered : "+$.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(I.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=Rt}this.tick()}},s.prototype.onError=function(t){var e=t.frag;if(!e||"audio"===e.type)switch(t.details){case O.a.FRAG_LOAD_ERROR:case O.a.FRAG_LOAD_TIMEOUT:if(!t.fatal){var i=this.fragLoadError;i?i++:i=1;var n=this.config;if(i<=n.fragLoadingMaxRetry){this.fragLoadError=i,e.loadCounter=0;var r=Math.min(Math.pow(2,i-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);P.b.warn("audioStreamController: frag loading failed, retry in "+r+" ms"),this.retryDate=performance.now()+r,this.state=Ot}else P.b.error("audioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=Ht}break;case O.a.FRAG_LOOP_LOADING_ERROR:case O.a.AUDIO_TRACK_LOAD_ERROR:case O.a.AUDIO_TRACK_LOAD_TIMEOUT:case O.a.KEY_LOAD_ERROR:case O.a.KEY_LOAD_TIMEOUT:this.state!==Ht&&(this.state=t.fatal?Ht:Rt,P.b.warn("audioStreamController: "+t.details+" while loading frag,switch to "+this.state+" state ..."));break;case O.a.BUFFER_FULL_ERROR:if("audio"===t.parent&&(this.state===Bt||this.state===Ft)){var s=this.mediaBuffer,a=this.media.currentTime;if(s&&q.isBuffered(s,a)&&q.isBuffered(s,a+.5)){var o=this.config;o.maxMaxBufferLength>=o.maxBufferLength&&(o.maxMaxBufferLength/=2,P.b.warn("audio:reduce max buffer length to "+o.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*o.fragLoadingLoopThreshold),this.state=Rt}else P.b.warn("buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=Ut,this.hls.trigger(I.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},s.prototype.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(P.b.log("appending pending audio data on Buffer Flushed"),t.forEach(function(t){e.hls.trigger(I.a.BUFFER_APPENDING,t)}),this.appended=!0,this.pendingData=[],this.state=Ft):(this.state=Rt,this.fragPrevious=null,this.tick())},Nt(s,[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,P.b.log("audio stream:"+e+"->"+t)}},get:function(){return this._state}}]),s}(C),qt=function(){function E(t){return"string"==typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}function b(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function t(t,e,i){var n=this,r=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),s={};r?n=document.createElement("custom"):s.enumerable=!0,n.hasBeenReset=!1;var a="",o=!1,u=t,l=e,h=i,c=null,d="",f=!0,p="auto",m="start",g=50,v="middle",y=50,_="middle";if(Object.defineProperty(n,"id",b({},s,{get:function(){return a},set:function(t){a=""+t}})),Object.defineProperty(n,"pauseOnExit",b({},s,{get:function(){return o},set:function(t){o=!!t}})),Object.defineProperty(n,"startTime",b({},s,{get:function(){return u},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");u=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"endTime",b({},s,{get:function(){return l},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");l=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"text",b({},s,{get:function(){return h},set:function(t){h=""+t,this.hasBeenReset=!0}})),Object.defineProperty(n,"region",b({},s,{get:function(){return c},set:function(t){c=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"vertical",b({},s,{get:function(){return d},set:function(t){var e=function i(t){return"string"==typeof t&&!!T[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"snapToLines",b({},s,{get:function(){return f},set:function(t){f=!!t,this.hasBeenReset=!0}})),Object.defineProperty(n,"line",b({},s,{get:function(){return p},set:function(t){if("number"!=typeof t&&"auto"!==t)throw new SyntaxError("An invalid number or illegal string was specified.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"lineAlign",b({},s,{get:function(){return m},set:function(t){var e=E(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"position",b({},s,{get:function(){return g},set:function(t){if(t<0||100<t)throw new Error("Position must be between 0 and 100.");g=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"positionAlign",b({},s,{get:function(){return v},set:function(t){var e=E(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"size",b({},s,{get:function(){return y},set:function(t){if(t<0||100<t)throw new Error("Size must be between 0 and 100.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"align",b({},s,{get:function(){return _},set:function(t){var e=E(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");_=e,this.hasBeenReset=!0}})),n.displayState=void 0,r)return n}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var T={"":!0,lr:!0,rl:!0},e={start:!0,middle:!0,end:!0,left:!0,right:!0};return t.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},t}(),zt=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};o.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,i){for(var n=0;n<i.length;++n)if(e===i[n]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return!!(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(e=parseFloat(e))&&e<=100)&&(this.set(t,e),!0)}};var Wt=new qt(0,0,0),Yt="middle"===Wt.align?"middle":"center";n.prototype={parse:function(t){function e(){var t=n.buffer,e=0;for(t=v(t);e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var i=t.substr(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,n.buffer=t.substr(e),i}var n=this;t&&(n.buffer+=n.decoder.decode(t,{stream:!0}));try{var i;if("INITIAL"===n.state){if(!/\r\n|\n/.test(n.buffer))return this;var r=(i=e()).match(/^(\ucc66\uca29\uca54)?WEBVTT([ \t].*)?$/);if(!r||!r[0])throw new Error("Malformed WebVTT signature.");n.state="HEADER"}for(var s=!1;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(s?s=!1:i=e(),n.state){case"HEADER":/:/.test(i)?m(i,function(t,e){},/:/):i||(n.state="ID");continue;case"NOTE":i||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){n.state="NOTE";break}if(!i)continue;if(n.cue=new qt(0,0,""),n.state="CUE",-1===i.indexOf("--\x3e")){n.cue.id=i;continue}case"CUE":try{g(i,n.cue,n.regionList)}catch(t){n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var a=-1!==i.indexOf("--\x3e");if(!i||a&&(s=!0)){n.oncue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}n.cue.text&&(n.cue.text+="\n"),n.cue.text+=i;continue;case"BADCUE":i||(n.state="ID");continue}}}catch(t){"CUETEXT"===n.state&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state="INITIAL"===n.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new Error("Malformed WebVTT signature.")}catch(t){throw t}return t.onflush&&t.onflush(),this}};var Kt=n,Xt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Qt=function(t){var e=t;return Xt.hasOwnProperty(t)&&(e=Xt[t]),String.fromCharCode(e)},Jt={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},$t={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Zt={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},te={25:2,26:4,29:6,30:8,31:10,27:13,28:15},ee=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],ie={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(t){this.time=t},log:function(t,e){this.verboseFilter[t];this.verboseLevel}},ne=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].toString(16));return e},re=function(){function s(t,e,i,n,r){y(this,s),this.foreground=t||"white",this.underline=e||!1,this.italics=i||!1,this.background=n||"black",this.flash=r||!1}return s.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},s.prototype.setStyles=function(t){for(var e=["foreground","underline","italics","background","flash"],i=0;i<e.length;i++){var n=e[i];t.hasOwnProperty(n)&&(this[n]=t[n])}},s.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},s.prototype.equals=function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},s.prototype.copy=function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},s.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},s}(),se=function(){function a(t,e,i,n,r,s){y(this,a),this.uchar=t||" ",this.penState=new re(e,i,n,r,s)}return a.prototype.reset=function(){this.uchar=" ",this.penState.reset()},a.prototype.setChar=function(t,e){this.uchar=t,this.penState.copy(e)},a.prototype.setPenState=function(t){this.penState.copy(t)},a.prototype.equals=function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},a.prototype.copy=function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},a.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},a}(),ae=function(){function e(){y(this,e),this.chars=[];for(var t=0;t<100;t++)this.chars.push(new se);this.pos=0,this.currPenState=new re}return e.prototype.equals=function(t){for(var e=!0,i=0;i<100;i++)if(!this.chars[i].equals(t.chars[i])){e=!1;break}return e},e.prototype.copy=function(t){for(var e=0;e<100;e++)this.chars[e].copy(t.chars[e])},e.prototype.isEmpty=function(){for(var t=!0,e=0;e<100;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t},e.prototype.setCursor=function(t){this.pos!==t&&(this.pos=t),this.pos<0?(ie.log("ERROR","Negative cursor position "+this.pos),this.pos=0):100<this.pos&&(ie.log("ERROR","Too large cursor position "+this.pos),this.pos=100)},e.prototype.moveCursor=function(t){var e=this.pos+t;if(1<t)for(var i=this.pos+1;i<e+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(e)},e.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.prototype.insertChar=function(t){144<=t&&this.backSpace();var e=Qt(t);100<=this.pos?ie.log("ERROR","Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))},e.prototype.clearFromPos=function(t){var e;for(e=t;e<100;e++)this.chars[e].reset()},e.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},e.prototype.getTextString=function(){for(var t=[],e=!0,i=0;i<100;i++){var n=this.chars[i].uchar;" "!==n&&(e=!1),t.push(n)}return e?"":t.join("")},e.prototype.setPenStyles=function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)},e}(),oe=function(){function e(){y(this,e),this.rows=[];for(var t=0;t<15;t++)this.rows.push(new ae);this.currRow=14,this.nrRollUpRows=null,this.reset()}return e.prototype.reset=function(){for(var t=0;t<15;t++)this.rows[t].clear();this.currRow=14},e.prototype.equals=function(t){for(var e=!0,i=0;i<15;i++)if(!this.rows[i].equals(t.rows[i])){e=!1;break}return e},e.prototype.copy=function(t){for(var e=0;e<15;e++)this.rows[e].copy(t.rows[e])},e.prototype.isEmpty=function(){for(var t=!0,e=0;e<15;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t},e.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},e.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},e.prototype.insertChar=function(t){this.rows[this.currRow].insertChar(t)},e.prototype.setPen=function(t){this.rows[this.currRow].setPenStyles(t)},e.prototype.moveCursor=function(t){this.rows[this.currRow].moveCursor(t)},e.prototype.setCursor=function(t){ie.log("INFO","setCursor: "+t),this.rows[this.currRow].setCursor(t)},e.prototype.setPAC=function(t){ie.log("INFO","pacData = "+JSON.stringify(t));var e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(var i=0;i<15;i++)this.rows[i].clear();var n=this.currRow+1-this.nrRollUpRows,r=this.lastOutputScreen;if(r){var s=r.rows[n].cueStartTime;if(s&&s<ie.time)for(var a=0;a<this.nrRollUpRows;a++)this.rows[e-this.nrRollUpRows+a+1].copy(r.rows[n+a])}}this.currRow=e;var o=this.rows[this.currRow];if(null!==t.indent){var u=t.indent,l=Math.max(u-1,0);o.setCursor(t.indent),t.color=o.chars[l].penState.foreground}var h={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(h)},e.prototype.setBkgData=function(t){ie.log("INFO","bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)},e.prototype.setRollUpRows=function(t){this.nrRollUpRows=t},e.prototype.rollUp=function(){if(null!==this.nrRollUpRows){ie.log("TEXT",this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),ie.log("INFO","Rolling up")}else ie.log("DEBUG","roll_up but nrRollUpRows not set yet")},e.prototype.getDisplayText=function(t){t=t||!1;for(var e=[],i="",n=-1,r=0;r<15;r++){var s=this.rows[r].getTextString();s&&(n=r+1,t?e.push("Row "+n+": '"+s+"'"):e.push(s.trim()))}return 0<e.length&&(i=t?"["+e.join(" | ")+"]":e.join("\n")),i},e.prototype.getTextAndFormat=function(){return this.rows},e}(),ue=function(){function i(t,e){y(this,i),this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new oe,this.nonDisplayedMemory=new oe,this.lastOutputScreen=new oe,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return i.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},i.prototype.getHandler=function(){return this.outputFilter},i.prototype.setHandler=function(t){this.outputFilter=t},i.prototype.setPAC=function(t){this.writeScreen.setPAC(t)},i.prototype.setBkgData=function(t){this.writeScreen.setBkgData(t)},i.prototype.setMode=function(t){t!==this.mode&&(this.mode=t,ie.log("INFO","MODE="+t),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},i.prototype.insertChars=function(t){for(var e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";ie.log("INFO",i+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(ie.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},i.prototype.ccRCL=function(){ie.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},i.prototype.ccBS=function(){ie.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},i.prototype.ccAOF=function(){},i.prototype.ccAON=function(){},i.prototype.ccDER=function(){ie.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},i.prototype.ccRU=function(t){ie.log("INFO","RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},i.prototype.ccFON=function(){ie.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},i.prototype.ccRDC=function(){ie.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},i.prototype.ccTR=function(){ie.log("INFO","TR"),this.setMode("MODE_TEXT")},i.prototype.ccRTD=function(){ie.log("INFO","RTD"),this.setMode("MODE_TEXT")},i.prototype.ccEDM=function(){ie.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},i.prototype.ccCR=function(){ie.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},i.prototype.ccENM=function(){ie.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},i.prototype.ccEOC=function(){if(ie.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,ie.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},i.prototype.ccTO=function(t){ie.log("INFO","TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},i.prototype.ccMIDROW=function(t){var e={flash:!1};if(e.underline=t%2==1,e.italics=46<=t,e.italics)e.foreground="white";else{var i=Math.floor(t/2)-16;e.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]}ie.log("INFO","MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)},i.prototype.outputDataUpdate=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=ie.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),!0===t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},i.prototype.cueSplitAtTime=function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))},i}(),le=function(){function n(t,e,i){y(this,n),this.field=t||1,this.outputs=[e,i],this.channels=[new ue(1,e),new ue(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,"char":0,cmd:0,other:0}}return n.prototype.getHandler=function(t){return this.channels[t].getHandler()},n.prototype.setHandler=function(t,e){this.channels[t].setHandler(e)},n.prototype.addData=function(t,e){var i,n,r,s=!1;this.lastTime=t,ie.setTime(t);for(var a=0;a<e.length;a+=2)if(n=127&e[a],r=127&e[a+1],0!==n||0!==r){if(ie.log("DATA","["+ne([e[a],e[a+1]])+"] -> ("+ne([n,r])+")"),(i=this.parseCmd(n,r))||(i=this.parseMidrow(n,r)),i||(i=this.parsePAC(n,r)),i||(i=this.parseBackgroundAttributes(n,r)),!i&&(s=this.parseChars(n,r)))if(this.currChNr&&0<=this.currChNr){this.channels[this.currChNr-1].insertChars(s)}else ie.log("WARNING","No channel found yet. TEXT-MODE?");i?this.dataCounters.cmd+=2:s?this.dataCounters["char"]+=2:(this.dataCounters.other+=2,ie.log("WARNING","Couldn't parse cleaned data "+ne([n,r])+" orig: "+ne([e[a],e[a+1]])))}else this.dataCounters.padding+=2},n.prototype.parseCmd=function(t,e){var i;if(!((20===t||28===t)&&32<=e&&e<=47)&&!((23===t||31===t)&&33<=e&&e<=35))return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,ie.log("DEBUG","Repeated command ("+ne([t,e])+") is dropped"),!0;i=20===t||23===t?1:2;var n=this.channels[i-1];return 20===t||28===t?32===e?n.ccRCL():33===e?n.ccBS():34===e?n.ccAOF():35===e?n.ccAON():36===e?n.ccDER():37===e?n.ccRU(2):38===e?n.ccRU(3):39===e?n.ccRU(4):40===e?n.ccFON():41===e?n.ccRDC():42===e?n.ccTR():43===e?n.ccRTD():44===e?n.ccEDM():45===e?n.ccCR():46===e?n.ccENM():47===e&&n.ccEOC():n.ccTO(e-32),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=i,!0},n.prototype.parseMidrow=function(t,e){var i=null;return(17===t||25===t)&&32<=e&&e<=47&&((i=17===t?1:2)!==this.currChNr?(ie.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[i-1].ccMIDROW(e),ie.log("DEBUG","MIDROW ("+ne([t,e])+")"),!0))},n.prototype.parsePAC=function(t,e){var i,n;if(!((17<=t&&t<=23||25<=t&&t<=31)&&64<=e&&e<=127)&&!((16===t||24===t)&&64<=e&&e<=95))return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,!(this.lastCmdB=null);i=t<=23?1:2,n=64<=e&&e<=95?1===i?Jt[t]:Zt[t]:1===i?$t[t]:te[t];var r=this.interpretPAC(n,e);return this.channels[i-1].setPAC(r),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=i,!0},n.prototype.interpretPAC=function(t,e){var i,n={color:null,italics:!1,indent:null,underline:!1,row:t};return i=95<e?e-96:e-64,n.underline=1==(1&i),i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((i-16)/2),n},n.prototype.parseChars=function(t,e){var i=null,n=null,r=null;if(17<=(r=25<=t?(i=2,t-8):(i=1,t))&&r<=19){var s;s=17===r?e+80:18===r?e+112:e+144,ie.log("INFO","Special char '"+Qt(s)+"' in channel "+i),n=[s]}else 32<=t&&t<=127&&(n=0===e?[t]:[t,e]);if(n){var a=ne(n);ie.log("DEBUG","Char codes =  "+a.join(",")),this.lastCmdA=null,this.lastCmdB=null}return n},n.prototype.parseBackgroundAttributes=function(t,e){var i,n,r;return!(!((16===t||24===t)&&32<=e&&e<=47)&&!((23===t||31===t)&&45<=e&&e<=47)||(i={},16===t||24===t?(n=Math.floor((e-32)/2),i.background=ee[n],e%2==1&&(i.background=i.background+"_semi")):45===e?i.background="transparent":(i.foreground="black",47===e&&(i.underline=!0)),r=t<24?1:2,this.channels[r-1].setBkgData(i),this.lastCmdA=null,this.lastCmdB=null))},n.prototype.reset=function(){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].reset();this.lastCmdA=null,this.lastCmdB=null},n.prototype.cueSplitAtTime=function(t){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].cueSplitAtTime(t)},n}(),he=function(){function n(t,e){(function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,n),this.timelineController=t,this.track=e,this.startTime=null,this.endTime=null,this.screen=null}return n.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues("textTrack"+this.track,this.startTime,this.endTime,this.screen),this.startTime=null)},n.prototype.newCue=function(t,e,i){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=i,this.timelineController.createCaptionsTrack(this.track)},n}(),ce=function(t,e,i){return t.substr(i||0,e.length)===e},de=function(t){for(var e=5381,i=t.length;i;)e=33*e^t.charCodeAt(--i);return(e>>>0).toString()},fe={parse:function(t,a,n,r,e,i){var s=Object(pt.b)(new Uint8Array(t)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),o="00:00.000",u=0,l=0,h=0,c=[],d=void 0,f=!0,p=new Kt;p.oncue=function(t){var e=n[r],i=n.ccOffset;e&&e["new"]&&(void 0!==l?i=n.ccOffset=e.start:function(t,e,i){var n=t[e],r=t[n.prevCC];if(!r||!r["new"]&&n["new"])return t.ccOffset=t.presentationOffset=n.start,n["new"]=!1;for(;r&&r["new"];)t.ccOffset+=n.start-r.start,n["new"]=!1,r=t[(n=r).prevCC];t.presentationOffset=i}(n,r,h)),h&&(i=h+n.ccOffset-n.presentationOffset),t.startTime+=i-l,t.endTime+=i-l,t.id=de(t.startTime.toString())+de(t.endTime.toString())+de(t.text),t.text=decodeURIComponent(encodeURIComponent(t.text)),0<t.endTime&&c.push(t)},p.onparsingerror=function(t){d=t},p.onflush=function(){d&&i?i(d):e(c)},s.forEach(function(t){if(f){if(ce(t,"X-TIMESTAMP-MAP=")){f=!1,t.substr(16).split(",").forEach(function(t){ce(t,"LOCAL:")?o=t.substr(6):ce(t,"MPEGTS:")&&(u=parseInt(t.substr(7)))});try{u-=a=a<0?a+8589934592:a,l=(e=o,i=parseInt(e.substr(-3)),n=parseInt(e.substr(-6,2)),r=parseInt(e.substr(-9,2)),s=9<e.length?parseInt(e.substr(0,e.indexOf(":"))):0,isNaN(i)||isNaN(n)||isNaN(r)||isNaN(s)?-1:(i+=1e3*n,i+=6e4*r,i+=36e5*s))/1e3,h=u/9e4,-1===l&&(d=new Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(a){d=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(f=!1)}var e,i,n,r,s;p.parse(t+"\n")}),p.flush()}},pe=function(a){function o(t){!function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,a.call(this,t,I.a.MEDIA_ATTACHING,I.a.MEDIA_DETACHING,I.a.FRAG_PARSING_USERDATA,I.a.FRAG_DECRYPTED,I.a.MANIFEST_LOADING,I.a.MANIFEST_LOADED,I.a.FRAG_LOADED,I.a.LEVEL_SWITCHING,I.a.INIT_PTS_FOUND));if(e.hls=t,e.config=t.config,e.enabled=!0,e.Cues=t.config.cueHandler,e.textTracks=[],e.tracks=[],e.unparsedVttFrags=[],e.initPTS=void 0,e.cueRanges=[],e.config.enableCEA708Captions){var i=new he(e,1),n=new he(e,2);e.cea608Parser=new le(0,i,n)}return e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(o,a),o.prototype.addCues=function(t,e,i,n){for(var r=this.cueRanges,s=!1,a=r.length;a--;){var o=r[a],u=(l=o[0],h=o[1],c=e,d=i,Math.min(h,d)-Math.max(l,c));if(0<=u&&(o[0]=Math.min(o[0],e),o[1]=Math.max(o[1],i),s=!0,.5<u/(i-e)))return}var l,h,c,d;s||r.push([e,i]),this.Cues.newCue(this[t],e,i,n)},o.prototype.onInitPtsFound=function(t){var e=this;void 0===this.initPTS&&(this.initPTS=t.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(t){e.onFragLoaded(t)}),this.unparsedVttFrags=[])},o.prototype.getExistingTrack=function(t){var e=this.media;if(e)for(var i=0;i<e.textTracks.length;i++){var n=e.textTracks[i];if(!0===n["textTrack"+t])return n}return null},o.prototype.sendAddTrackEvent=function(t,e){var i=null;try{i=new window.Event("addtrack")}catch(t){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=t,e.dispatchEvent(i)},o.prototype.createCaptionsTrack=function(t){var e="textTrack"+t;if(!this[e]){var i=this.getExistingTrack(t);if(i)this[e]=i,_(this[e]),this.sendAddTrackEvent(this[e],this.media);else{var n=this.createTextTrack("captions",this.config["captionsTextTrack"+t+"Label"],this.config.captionsTextTrack1LanguageCode);n&&(n[e]=!0,this[e]=n)}}},o.prototype.createTextTrack=function(t,e,i){var n=this.media;if(n)return n.addTextTrack(t,e,i)},o.prototype.destroy=function(){C.prototype.destroy.call(this)},o.prototype.onMediaAttaching=function(t){this.media=t.media,this._cleanTracks()},o.prototype.onMediaDetaching=function(){_(this.textTrack1),_(this.textTrack2)},o.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0},this._cleanTracks()},o.prototype._cleanTracks=function(){var t=this.media;if(t){var e=t.textTracks;if(e)for(var i=0;i<e.length;i++)_(e[i])}},o.prototype.onManifestLoaded=function(t){var s=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=t.subtitles||[];var a=this.media?this.media.textTracks:[];this.tracks.forEach(function(t,e){var i=void 0;if(e<a.length){var n=a[e];(function r(t,e){return t&&t.label===e.name&&!(t.textTrack1||t.textTrack2)})(n,t)&&(i=n)}i||(i=s.createTextTrack("subtitles",t.name,t.lang)),i.mode=t["default"]?"showing":"hidden",s.textTracks.push(i)})}},o.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},o.prototype.onFragLoaded=function(t){var e=t.frag,i=t.payload;if("main"===e.type){var n=e.sn;if(n!==this.lastSn+1){var r=this.cea608Parser;r&&r.reset()}this.lastSn=n}else if("subtitle"===e.type)if(i.byteLength){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(t);var s=e.decryptdata;null!=s&&null!=s.key&&"AES-128"===s.method||this._parseVTTs(e,i)}else this.hls.trigger(I.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})},o.prototype._parseVTTs=function(e,t){var i=this.vttCCs;i[e.cc]||(i[e.cc]={start:e.start,prevCC:this.prevCC,"new":!0},this.prevCC=e.cc);var n=this.textTracks,r=this.hls;fe.parse(t,this.initPTS,i,e.cc,function(t){var i=n[e.trackId];t.forEach(function(t){if(!i.cues.getCueById(t.id))try{i.addCue(t)}catch(n){var e=new window.TextTrackCue(t.startTime,t.endTime,t.text);e.id=t.id,i.addCue(e)}}),r.trigger(I.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(t){P.b.log("Failed to parse VTT cue: "+t),r.trigger(I.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})})},o.prototype.onFragDecrypted=function(t){var e=t.payload,i=t.frag;if("subtitle"===i.type){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(t);this._parseVTTs(i,e)}},o.prototype.onFragParsingUserdata=function(t){if(this.enabled&&this.config.enableCEA708Captions)for(var e=0;e<t.samples.length;e++){var i=this.extractCea608Data(t.samples[e].bytes);this.cea608Parser.addData(t.samples[e].pts,i)}},o.prototype.extractCea608Data=function(t){for(var e,i,n,r=31&t[0],s=2,a=[],o=0;o<r;o++)e=t[s++],i=127&t[s++],n=127&t[s++],0===i&&0===n||0!=(4&e)&&0===(3&e)&&(a.push(i),a.push(n));return a},o}(C),me=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),ge=function(r){function s(t){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,I.a.MEDIA_ATTACHED,I.a.MEDIA_DETACHING,I.a.MANIFEST_LOADING,I.a.MANIFEST_LOADED,I.a.SUBTITLE_TRACK_LOADED));return e.tracks=[],e.trackId=-1,e.media=void 0,e.subtitleDisplay=!1,e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype._onTextTracksChanged=function(){if(this.media){for(var t=-1,e=E(this.media.textTracks),i=0;i<e.length;i++)"showing"===e[i].mode&&(t=i);this.subtitleTrack=t}},s.prototype.destroy=function(){C.prototype.destroy.call(this)},s.prototype.onMediaAttached=function(t){var e=this;this.media=t.media,this.media&&(void 0!==this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){e.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},s.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=void 0)},s.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},s.prototype.onManifestLoaded=function(t){var e=this,i=t.subtitles||[];this.tracks=i,this.trackId=-1,this.hls.trigger(I.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i}),i.forEach(function(t){t["default"]&&(e.media?e.subtitleTrack=t.id:e.queuedDefaultTrack=t.id)})},s.prototype.onTick=function(){var t=this.trackId,e=this.tracks[t];if(e){var i=e.details;void 0!==i&&!0!==i.live||(P.b.log("(re)loading playlist for subtitle track "+t),this.hls.trigger(I.a.SUBTITLE_TRACK_LOADING,{url:e.url,id:t}))}},s.prototype.onSubtitleTrackLoaded=function(t){var e=this;t.id<this.tracks.length&&(P.b.log("subtitle track "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.timer&&(this.timer=setInterval(function(){e.onTick()},1e3*t.details.targetduration,this)),!t.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))},s.prototype.setSubtitleTrackInternal=function(t){if(!(t<-1||t>=this.tracks.length)){this.timer&&(clearInterval(this.timer),this.timer=null);var e=E(this.media.textTracks);if(-1!==this.trackId&&this.subtitleDisplay&&(e[this.trackId].mode="hidden"),this.trackId=t,P.b.log("switching to subtitle track "+t),this.hls.trigger(I.a.SUBTITLE_TRACK_SWITCH,{id:t}),-1!==t){var i=this.tracks[t];this.subtitleDisplay&&(e[t].mode="showing");var n=i.details;void 0!==n&&!0!==n.live||(P.b.log("(re)loading playlist for subtitle track "+t),this.hls.trigger(I.a.SUBTITLE_TRACK_LOADING,{url:i.url,id:t}))}}},me(s,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.trackId!==t&&this.setSubtitleTrackInternal(t)}}]),s}(C),ve=i(4),ye="STOPPED",_e="IDLE",Ee="KEY_LOADING",be="FRAG_LOADING",Te=function(r){function s(t){!function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,I.a.MEDIA_ATTACHED,I.a.ERROR,I.a.KEY_LOADED,I.a.FRAG_LOADED,I.a.SUBTITLE_TRACKS_UPDATED,I.a.SUBTITLE_TRACK_SWITCH,I.a.SUBTITLE_TRACK_LOADED,I.a.SUBTITLE_FRAG_PROCESSED));return e.config=t.config,e.vttFragSNsProcessed={},e.vttFragQueues=void 0,e.currentlyProcessing=null,e.state=ye,e.currentTrackId=-1,e.ticks=0,e.decrypter=new ve.a(t.observer,t.config),e}return function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.destroy=function(){C.prototype.destroy.call(this),this.state=ye},s.prototype.clearVttFragQueues=function(){var e=this;this.vttFragQueues={},this.tracks.forEach(function(t){e.vttFragQueues[t.id]=[]})},s.prototype.nextFrag=function(){if(null===this.currentlyProcessing&&-1<this.currentTrackId&&this.vttFragQueues[this.currentTrackId].length){var t=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.fragCurrent=t,this.hls.trigger(I.a.FRAG_LOADING,{frag:t}),this.state=be}},s.prototype.onSubtitleFragProcessed=function(t){t.success&&this.vttFragSNsProcessed[t.frag.trackId].push(t.frag.sn),this.currentlyProcessing=null,this.state=_e,this.nextFrag()},s.prototype.onMediaAttached=function(){this.state=_e},s.prototype.onError=function(t){var e=t.frag;e&&"subtitle"!==e.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())},s.prototype.tick=function(){var t=this;1==++this.ticks&&(this.doTick(),1<this.ticks&&setTimeout(function(){t.tick()},1),this.ticks=0)},s.prototype.doTick=function(){var n=this;switch(this.state){case _e:var t,e=this.tracks,r=this.currentTrackId,s=this.vttFragSNsProcessed[r],a=this.vttFragQueues[r],o=this.currentlyProcessing?this.currentlyProcessing.sn:-1;if(!e)break;if(r<e.length&&(t=e[r].details),void 0===t)break;t.fragments.forEach(function(t){(i=t,-1<s.indexOf(i.sn))||t.sn===o||(e=t,a.some(function(t){return t.sn===e.sn}))||(t.decryptdata&&null!=t.decryptdata.uri&&null==t.decryptdata.key?(P.b.log("Loading key for "+t.sn),n.state=Ee,n.hls.trigger(I.a.KEY_LOADING,{frag:t})):(t.trackId=r,a.push(t),n.nextFrag()));var e,i})}},s.prototype.onSubtitleTracksUpdated=function(t){var e=this;P.b.log("subtitle tracks updated"),this.tracks=t.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach(function(t){e.vttFragSNsProcessed[t.id]=[]})},s.prototype.onSubtitleTrackSwitch=function(t){this.currentTrackId=t.id,this.clearVttFragQueues()},s.prototype.onSubtitleTrackLoaded=function(){this.tick()},s.prototype.onKeyLoaded=function(){this.state===Ee&&(this.state=_e,this.tick())},s.prototype.onFragLoaded=function(t){var e=this.fragCurrent,i=t.frag.decryptdata,n=t.frag,r=this.hls;if(this.state===be&&e&&"subtitle"===t.frag.type&&e.sn===t.frag.sn&&0<t.payload.byteLength&&null!=i&&null!=i.key&&"AES-128"===i.method){var s;try{s=performance.now()}catch(t){s=Date.now()}this.decrypter.decrypt(t.payload,i.key.buffer,i.iv.buffer,function(t){var e;try{e=performance.now()}catch(t){e=Date.now()}r.trigger(I.a.FRAG_DECRYPTED,{frag:n,payload:t,stats:{tstart:s,tdecrypt:e}})})}},s}(C),Se={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ct,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:_t,bufferController:bt,capLevelController:St,fpsController:wt,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0};Se.subtitleStreamController=Te,Se.subtitleTrackController=ge,Se.timelineController=pe,Se.cueHandler=b,Se.enableCEA708Captions=!0,Se.enableWebVTT=!0,Se.captionsTextTrack1Label="English",Se.captionsTextTrack1LanguageCode="en",Se.captionsTextTrack2Label="Spanish",Se.captionsTextTrack2LanguageCode="es",Se.audioStreamController=jt,Se.audioTrackController=kt;var we=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),Ce=function(){function _(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,_);var i=_.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var n in i)n in t||(t[n]=i[n]);if(void 0!==t.liveMaxLatencyDurationCount&&t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(t.liveMaxLatencyDuration<=t.liveSyncDuration||void 0===t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(P.a)(t.debug),this.config=t,this._autoLevelCapping=-1;var r=this.observer=new Y.a;r.trigger=function(t){for(var e=arguments.length,i=Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];r.emit.apply(r,[t,t].concat(i))},r.off=function(t){for(var e=arguments.length,i=Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];r.removeListener.apply(r,[t].concat(i))},this.on=r.on.bind(r),this.off=r.off.bind(r),this.trigger=r.trigger.bind(r);var s=this.abrController=new t.abrController(this),a=new t.bufferController(this),o=new t.capLevelController(this),u=new t.fpsController(this),l=new V(this),h=new H(this),c=new G(this),d=new mt(this),f=[this.levelController=new ft(this),this.streamController=new ct(this)],p=t.audioStreamController;p&&f.push(new p(this)),this.networkControllers=f;var m=[l,h,c,s,a,o,u,d];if(p=t.audioTrackController){var g=new p(this);this.audioTrackController=g,m.push(g)}if(p=t.subtitleTrackController){var v=new p(this);this.subtitleTrackController=v,m.push(v)}[t.subtitleStreamController,t.timelineController].forEach(function(t){t&&m.push(new t(e))}),this.coreComponents=m}return _.isSupported=function(){return function r(){var t=a(),e=window.SourceBuffer||window.WebKitSourceBuffer,i=t&&"function"==typeof t.isTypeSupported&&t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove;return!!i&&!!n}()},we(_,null,[{key:"version",get:function(){return"0.8.9"}},{key:"Events",get:function(){return I.a}},{key:"ErrorTypes",get:function(){return O.b}},{key:"ErrorDetails",get:function(){return O.a}},{key:"DefaultConfig",get:function(){return _.defaultConfig?_.defaultConfig:Se},set:function(t){_.defaultConfig=t}}]),_.prototype.destroy=function(){P.b.log("destroy"),this.trigger(I.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(t){t.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1},_.prototype.attachMedia=function(t){P.b.log("attachMedia"),this.media=t,this.trigger(I.a.MEDIA_ATTACHING,{media:t})},_.prototype.detachMedia=function(){P.b.log("detachMedia"),this.trigger(I.a.MEDIA_DETACHING),this.media=null},_.prototype.loadSource=function(t){t=S.a.buildAbsoluteURL(window.location.href,t,{alwaysNormalize:!0}),P.b.log("loadSource:"+t),this.url=t,this.trigger(I.a.MANIFEST_LOADING,{url:t})},_.prototype.startLoad=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;P.b.log("startLoad("+e+")"),this.networkControllers.forEach(function(t){t.startLoad(e)})},_.prototype.stopLoad=function(){P.b.log("stopLoad"),this.networkControllers.forEach(function(t){t.stopLoad()})},_.prototype.swapAudioCodec=function(){P.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},_.prototype.recoverMediaError=function(){P.b.log("recoverMediaError");var t=this.media;this.detachMedia(),this.attachMedia(t)},we(_,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(t){P.b.log("set currentLevel:"+t),this.loadLevel=t,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(t){P.b.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(t){P.b.log("set loadLevel:"+t),this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){P.b.log("set firstLevel:"+t),this.levelController.firstLevel=t}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(t){P.b.log("set startLevel:"+t);-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(t){P.b.log("set autoLevelCapping:"+t),this._autoLevelCapping=t}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var t=this.levels,e=this.config.minAutoBitrate,i=t?t.length:0,n=0;n<i;n++)if((t[n].realBitrate?Math.max(t[n].realBitrate,t[n].bitrate):t[n].bitrate)>e)return n;return 0}},{key:"maxAutoLevel",get:function(){var t=this.levels,e=this.autoLevelCapping;return-1===e&&t&&t.length?t.length-1:e}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}},{key:"audioTracks",get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var e=this.audioTrackController;e&&(e.audioTrack=t)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}},{key:"subtitleDisplay",get:function(){var t=this.subtitleTrackController;return!!t&&t.subtitleDisplay},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}}]),_}();e["default"]=Ce},function(t,e,h){function c(t){var e=[],i=t.toString(),n=i.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!n)return e;for(var r,s=n[1],a=new RegExp("(\\\\n|\\W)"+function o(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}(s)+"\\((/\\*.*?\\*/)?s?.*?([\\.|\\-|\\w|/|@]+).*?\\)","g");r=a.exec(i);)e.push(r[3]);return e}t.exports=function(t,e){e=e||{};var i=h.m,n=e.all?Object.keys(i):function u(t,e){for(var i=[e],n=[],r={};i.length;){var s=i.pop();if(!r[s]&&t[s]){r[s]=!0,n.push(s);var a=c(t[s]);i=i.concat(a)}}return n}(i,t),r="("+function l(i){function n(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,n),e.l=!0,e.exports}var r={};n.m=i,n.c=r,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n.oe=function(t){throw t};var t=n(n.s=ENTRY_MODULE);return t["default"]||t}.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+n.map(function(t){return JSON.stringify(t)+": "+i[t].toString()}).join(",")+"})(self);",s=new window.Blob([r],{type:"text/javascript"});if(e.bare)return s;var a=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(s),o=new window.Worker(a);return o.objectURL=a,o}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(7),o=i(1),u=i(0),n=i(5),l=i.n(n);e["default"]=function(r){var s=new l.a;s.trigger=function(t){for(var e=arguments.length,i=Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];s.emit.apply(s,[t,t].concat(i))},s.off=function(t){for(var e=arguments.length,i=Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];s.removeListener.apply(s,[t].concat(i))};var n=function(t,e){r.postMessage({event:t,data:e})};r.addEventListener("message",function(t){var e=t.data;switch(e.cmd){case"init":var i=JSON.parse(e.config);r.demuxer=new a.a(s,e.typeSupported,i,e.vendor);try{Object(u.a)(!0===i.debug)}catch(r){}n("init",null);break;case"demux":r.demuxer.push(e.data,e.decryptdata,e.initSegment,e.audioCodec,e.videoCodec,e.timeOffset,e.discontinuity,e.trackSwitch,e.contiguous,e.duration,e.accurateTimeOffset,e.defaultInitPTS)}}),s.on(o.a.FRAG_DECRYPTED,n),s.on(o.a.FRAG_PARSING_INIT_SEGMENT,n),s.on(o.a.FRAG_PARSED,n),s.on(o.a.ERROR,n),s.on(o.a.FRAG_PARSING_METADATA,n),s.on(o.a.FRAG_PARSING_USERDATA,n),s.on(o.a.INIT_PTS_FOUND,n),s.on(o.a.FRAG_PARSING_DATA,function(t,e){var i=[],n={event:t,data:e};e.data1&&(n.data1=e.data1.buffer,i.push(e.data1.buffer),delete e.data1),e.data2&&(n.data2=e.data2.buffer,i.push(e.data2.buffer),delete e.data2),r.postMessage(n,i)})}}])["default"]});